Keyword: DMA
Occurrences: 4930
================================================================================

Page    7: 6.2.3       Role of D3 domain DMAMUX2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 297
Page   13: 12.3    DMA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 575
Page   13: 12.3.1       MDMA (D1 domain) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 576
Page   13: 12.3.2       DMAMUX1, DMA1 and DMA2 (D2 domain) . . . . . . . . . . . . . . . . . . . . 578
Page   13: 12.3.3       DMAMUX2, BDMA (D3 domain) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 583
Page   13: 13       MDMA controller (MDMA) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 586
Page   13: 13.1    MDMA introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 586
Page   13: 13.2    MDMA main features . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 586
Page   13: 13.3    MDMA functional description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 588
Page   13: 13.3.1       MDMA block diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 588
Page   13: 13.3.2       MDMA internal signals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 588
Page   13: 13.3.3       MDMA overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 589
Page   13: 13.3.4       MDMA channel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 590
Page   13: 13.3.7       MDMA buffer transfer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 591
Page   13: 13.3.13 MDMA transfer completion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 593
Page   13: 13.3.14 MDMA transfer suspension . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 594
Page   13: 13.4    MDMA interrupts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 594
Page   13: 13.5    MDMA registers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 595
Page   13: 13.5.1       MDMA global interrupt/status register (MDMA_GISR0) . . . . . . . . . . . 595
Page   13: 13.5.2       MDMA channel x interrupt/status register (MDMA_CxISR) . . . . . . . . . 596
Page   14: 13.5.3       MDMA channel x interrupt flag clear register (MDMA_CxIFCR) . . . . . 597
Page   14: 13.5.4       MDMA channel x error status register (MDMA_CxESR) . . . . . . . . . . . 598
Page   14: 13.5.5       MDMA channel x control register (MDMA_CxCR) . . . . . . . . . . . . . . . . 600
Page   14: 13.5.6       MDMA channel x transfer configuration register (MDMA_CxTCR) . . . 602
Page   14: 13.5.7       MDMA channel x block number of data register (MDMA_CxBNDTR) . 605
Page   14: 13.5.8       MDMA channel x source address register (MDMA_CxSAR) . . . . . . . . 607
Page   14: 13.5.9       MDMA channel x destination address register (MDMA_CxDAR) . . . . 607
Page   14: 13.5.10 MDMA channel x block repeat address update register
Page   14: (MDMA_CxBRUR) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 609
Page   14: 13.5.11 MDMA channel x link address register (MDMA_CxLAR) . . . . . . . . . . . 610
Page   14: 13.5.12 MDMA channel x trigger and bus selection register (MDMA_CxTBR) 611
Page   14: 13.5.13 MDMA channel x mask address register (MDMA_CxMAR) . . . . . . . . 612
Page   14: 13.5.14 MDMA channel x mask data register (MDMA_CxMDR) . . . . . . . . . . . 612
Page   14: 13.5.15 MDMA register map . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 613
Page   14: 14         Direct memory access controller (DMA) . . . . . . . . . . . . . . . . . . . . . . . 615
Page   14: 14.1   DMA introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 615
Page   14: 14.2   DMA main features . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 615
Page   14: 14.3   DMA functional description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 617
Page   14: 14.3.1       DMA block diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 617
Page   14: 14.3.2       DMA internal signals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 617
Page   14: 14.3.3       DMA overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 618
Page   14: 14.3.4       DMA transactions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 618
Page   14: 14.3.5       DMA request mapping . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 618
Page   14: 14.3.7       DMA streams . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 619
Page   14: 14.3.15 DMA transfer completion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 629
Page   14: 14.3.16 DMA transfer suspension . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 630
Page   14: 14.3.18 Summary of the possible DMA configurations . . . . . . . . . . . . . . . . . . . 632
Page   15: 14.4   DMA interrupts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 634
Page   15: 14.5   DMA registers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 635
Page   15: 14.5.1      DMA low interrupt status register (DMA_LISR) . . . . . . . . . . . . . . . . . . 635
Page   15: 14.5.2      DMA high interrupt status register (DMA_HISR) . . . . . . . . . . . . . . . . . 636
Page   15: 14.5.3      DMA low interrupt flag clear register (DMA_LIFCR) . . . . . . . . . . . . . . 637
Page   15: 14.5.4      DMA high interrupt flag clear register (DMA_HIFCR) . . . . . . . . . . . . . 637
Page   15: 14.5.5      DMA stream x configuration register (DMA_SxCR) . . . . . . . . . . . . . . . 638
Page   15: 14.5.6      DMA stream x number of data register (DMA_SxNDTR) . . . . . . . . . . 641
Page   15: 14.5.7      DMA stream x peripheral address register (DMA_SxPAR) . . . . . . . . . 642
Page   15: 14.5.8      DMA stream x memory 0 address register (DMA_SxM0AR) . . . . . . . . 642
Page   15: 14.5.9      DMA stream x memory 1 address register (DMA_SxM1AR) . . . . . . . . 642
Page   15: 14.5.10 DMA stream x FIFO control register (DMA_SxFCR) . . . . . . . . . . . . . . 643
Page   15: 14.5.11 DMA register map . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 645
Page   15: 15       Basic direct memory access controller (BDMA) . . . . . . . . . . . . . . . . 649
Page   15: 15.2   BDMA main features . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 649
Page   15: 15.3   BDMA implementation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 649
Page   15: 15.3.1      BDMA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 649
Page   15: 15.3.2      BDMA request mapping . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 650
Page   15: 15.4   BDMA functional description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 650
Page   15: 15.4.1      BDMA block diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 650
Page   15: 15.4.2      BDMA pins and internal signals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 651
Page   15: 15.4.3      BDMA transfers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 651
Page   15: 15.4.4      BDMA arbitration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 652
Page   15: 15.4.5      BDMA channels . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 652
Page   15: 15.4.6      BDMA data width, alignment and endianness . . . . . . . . . . . . . . . . . . . 656
Page   15: 15.4.7      BDMA error management . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 657
Page   15: 15.5   BDMA interrupts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 658
Page   15: 15.6   BDMA registers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 658
Page   15: 15.6.1      BDMA interrupt status register (BDMA_ISR) . . . . . . . . . . . . . . . . . . . . 658
Page   15: 15.6.2      BDMA interrupt flag clear register (BDMA_IFCR) . . . . . . . . . . . . . . . . 661
Page   15: 15.6.3      BDMA channel x configuration register (BDMA_CCRx) . . . . . . . . . . . 662
Page   16: 15.6.4      BDMA channel x number of data to transfer register
Page   16: (BDMA_CNDTRx) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 666
Page   16: 15.6.5      BDMA channel x peripheral address register (BDMA_CPARx) . . . . . . 666
Page   16: 15.6.6      BDMA channel x memory 0 address register (BDMA_CM0ARx) . . . . 667
Page   16: 15.6.7      BDMA channel x memory 1 address register (BDMA_CM1ARx) . . . . 668
Page   16: 15.6.8      BDMA register map and reset values . . . . . . . . . . . . . . . . . . . . . . . . . 668
Page   16: 16         DMA request multiplexer (DMAMUX) . . . . . . . . . . . . . . . . . . . . . . . . . 671
Page   16: 16.2   DMAMUX main features . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 671
Page   16: 16.3   DMAMUX implementation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 672
Page   16: 16.3.1      DMAMUX1 and DMAMUX2 instantiation . . . . . . . . . . . . . . . . . . . . . . . 672
Page   16: 16.3.2      DMAMUX1 mapping . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 672
Page   16: 16.3.3      DMAMUX2 mapping . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 674
Page   16: 16.4   DMAMUX functional description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 676
Page   16: 16.4.1      DMAMUX block diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 676
Page   16: 16.4.2      DMAMUX signals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 677
Page   16: 16.4.3      DMAMUX channels . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 677
Page   16: 16.4.4      DMAMUX request line multiplexer . . . . . . . . . . . . . . . . . . . . . . . . . . . . 677
Page   16: 16.4.5      DMAMUX request generator . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 680
Page   16: 16.5   DMAMUX interrupts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 681
Page   16: 16.6   DMAMUX registers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 682
Page   16: 16.6.1      DMAMUX1 request line multiplexer channel x configuration register
Page   16: (DMAMUX1_CxCR) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 682
Page   16: 16.6.2      DMAMUX2 request line multiplexer channel x configuration register
Page   16: (DMAMUX2_CxCR) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 683
Page   16: 16.6.3      DMAMUX1 request line multiplexer interrupt channel status register
Page   16: (DMAMUX1_CSR) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 684
Page   16: 16.6.4      DMAMUX2 request line multiplexer interrupt channel status register
Page   16: (DMAMUX2_CSR) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 684
Page   16: 16.6.5      DMAMUX1 request line multiplexer interrupt clear flag register
Page   16: (DMAMUX1_CFR) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 685
Page   16: 16.6.6      DMAMUX2 request line multiplexer interrupt clear flag register
Page   16: (DMAMUX2_CFR) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 685
Page   16: 16.6.7      DMAMUX1 request generator channel x configuration register
Page   16: (DMAMUX1_RGxCR) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 686
Page   16: 16.6.8      DMAMUX2 request generator channel x configuration register
Page   16: (DMAMUX2_RGxCR) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 686
Page   17: 16.6.9       DMAMUX1 request generator interrupt status register
Page   17: (DMAMUX1_RGSR) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 688
Page   17: 16.6.10 DMAMUX2 request generator interrupt status register
Page   17: (DMAMUX2_RGSR) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 688
Page   17: 16.6.11 DMAMUX1 request generator interrupt clear flag register
Page   17: (DMAMUX1_RGCFR) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 689
Page   17: 16.6.12 DMAMUX2 request generator interrupt clear flag register
Page   17: (DMAMUX2_RGCFR) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 689
Page   17: 16.6.13 DMAMUX register map . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 690
Page   17: 17       Chrom-Art Accelerator™ controller (DMA2D) . . . . . . . . . . . . . . . . . . 692
Page   17: 17.1   DMA2D introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 692
Page   17: 17.2   DMA2D main features . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 692
Page   17: 17.3   DMA2D functional description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 693
Page   17: 17.4   DMA2D pins and internal signals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 694
Page   17: 17.4.1      DMA2D control . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 695
Page   17: 17.4.2       DMA2D foreground and background FIFOs . . . . . . . . . . . . . . . . . . . . 695
Page   17: 17.4.3       DMA2D foreground and background pixel format converter (PFC) . . . 695
Page   17: 17.4.4       DMA2D foreground and background CLUT interface . . . . . . . . . . . . . 698
Page   17: 17.4.5      DMA2D blender . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 699
Page   17: 17.4.6      DMA2D output PFC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 699
Page   17: 17.4.7      DMA2D output FIFO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 699
Page   17: 17.4.8      DMA2D output FIFO byte reordering . . . . . . . . . . . . . . . . . . . . . . . . . . 700
Page   17: 17.4.9       DMA2D AXI master port timer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 702
Page   17: 17.4.10 DMA2D transactions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 702
Page   17: 17.4.11 DMA2D configuration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 702
Page   17: 17.4.13 DMA2D transfer control (start, suspend, abort and completion) . . . . . 707
Page   17: 17.5   DMA2D interrupts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 708
Page   17: 17.6   DMA2D registers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 709
Page   17: 17.6.1       DMA2D control register (DMA2D_CR) . . . . . . . . . . . . . . . . . . . . . . . . 709
Page   17: 17.6.2       DMA2D Interrupt Status Register (DMA2D_ISR) . . . . . . . . . . . . . . . . 711
Page   17: 17.6.3       DMA2D interrupt flag clear register (DMA2D_IFCR) . . . . . . . . . . . . . . 712
Page   17: 17.6.4       DMA2D foreground memory address register (DMA2D_FGMAR) . . . 713
Page   18: 17.6.5      DMA2D foreground offset register (DMA2D_FGOR) . . . . . . . . . . . . . . 713
Page   18: 17.6.6      DMA2D background memory address register (DMA2D_BGMAR) . . 714
Page   18: 17.6.7      DMA2D background offset register (DMA2D_BGOR) . . . . . . . . . . . . . 714
Page   18: 17.6.8      DMA2D foreground PFC control register (DMA2D_FGPFCCR) . . . . . 715
Page   18: 17.6.9      DMA2D foreground color register (DMA2D_FGCOLR) . . . . . . . . . . . . 717
Page   18: 17.6.10 DMA2D background PFC control register (DMA2D_BGPFCCR) . . . . 718
Page   18: 17.6.11 DMA2D background color register (DMA2D_BGCOLR) . . . . . . . . . . . 720
Page   18: 17.6.12 DMA2D foreground CLUT memory address register
Page   18: (DMA2D_FGCMAR) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 720
Page   18: 17.6.13 DMA2D background CLUT memory address register
Page   18: (DMA2D_BGCMAR) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 721
Page   18: 17.6.14 DMA2D output PFC control register (DMA2D_OPFCCR) . . . . . . . . . . 721
Page   18: 17.6.15 DMA2D output color register (DMA2D_OCOLR) . . . . . . . . . . . . . . . . . 722
Page   18: 17.6.16 DMA2D output memory address register (DMA2D_OMAR) . . . . . . . . 724
Page   18: 17.6.17 DMA2D output offset register (DMA2D_OOR) . . . . . . . . . . . . . . . . . . 724
Page   18: 17.6.18 DMA2D number of line register (DMA2D_NLR) . . . . . . . . . . . . . . . . . 725
Page   18: 17.6.19 DMA2D line watermark register (DMA2D_LWR) . . . . . . . . . . . . . . . . . 725
Page   18: 17.6.20 DMA2D AXI master timer configuration register (DMA2D_AMTCR) . . 726
Page   18: 17.6.21 DMA2D register map . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 727
Page   25: 25.4.8      DMA requests . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1027
Page   28: 29.6   DFSDM DMA transfer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .1125
Page   29: 30.4.3      DMA interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1156
Page   33: 34.3.19 CRYP DMA interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1293
Page   33: 34.6.5      CRYP DMA control register (CRYP_DMACR) . . . . . . . . . . . . . . . . . . 1302
Page   34: 35.3.9      HASH DMA interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1325
Page   35: 36.3.21 DMA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1415
Page   36: 36.5.4      HRTIM Master Timer DMA / Interrupt Enable Register
Page   36: 36.5.15 HRTIM Timerx DMA / Interrupt Enable Register
Page   37: 36.5.60 HRTIM Burst DMA Master timer update Register
Page   37: 36.5.61 HRTIM Burst DMA Timerx update Register (HRTIM_BDTxUPR) . . . 1503
Page   37: 36.5.62 HRTIM Burst DMA Data Register (HRTIM_BDMADR) . . . . . . . . . . . 1504
Page   38: 37.3.28 DMA burst mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1571
Page   38: 37.4.4      TIMx DMA/interrupt enable register (TIMx_DIER)(x = 1, 8) . . . . . . . . 1579
Page   39: 37.4.19 TIMx DMA control register (TIMx_DCR)(x = 1, 8) . . . . . . . . . . . . . . . 1600
Page   39: 37.4.20 TIMx DMA address for full transfer (TIMx_DMAR)(x = 1, 8) . . . . . . . 1601
Page   40: 38.3.20 DMA burst mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1661
Page   40: 38.4.4      TIMx DMA/Interrupt enable register (TIMx_DIER)(x = 2 to 5) . . . . . . 1670
Page   40: 38.4.17 TIMx DMA control register (TIMx_DCR)(x = 2 to 5) . . . . . . . . . . . . . . 1684
Page   40: 38.4.18 TIMx DMA address for full transfer (TIMx_DMAR)(x = 2 to 5) . . . . . . 1684
Page   43: 40.4.20 DMA burst mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1780
Page   43: 40.5.4      TIM15 DMA/interrupt enable register (TIM15_DIER) . . . . . . . . . . . . 1787
Page   43: 40.5.16 TIM15 DMA control register (TIM15_DCR) . . . . . . . . . . . . . . . . . . . . 1803
Page   43: 40.5.17 TIM15 DMA address for full transfer (TIM15_DMAR) . . . . . . . . . . . . 1803
Page   44: 40.6.3     TIMx DMA/interrupt enable register (TIMx_DIER)(x = 16, 17) . . . . . . 1810
Page   44: 40.6.14 TIMx DMA control register (TIMx_DCR)(x = 16, 17) . . . . . . . . . . . . . 1822
Page   44: 40.6.15 TIMx DMA address for full transfer (TIMx_DMAR)(x = 16, 17) . . . . . 1823
Page   44: 41.4.3     TIM6/TIM7 DMA/Interrupt enable register (TIMx_DIER) . . . . . . . . . . 1839
Page   48: 46.4.16 DMA requests . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1983
Page   50: 47.5.19 Continuous communication using USART and DMA . . . . . . . . . . . . . 2044
Page   51: 48.3.12 Continuous communication using DMA and LPUART . . . . . . . . . . . . 2100
Page   52: 49.4.14 Communication using DMA (direct memory addressing) . . . . . . . . . . 2151
Page   52: 49.9.15 DMA Interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2180
Page   53: 50.3.16 SAI DMA interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2239
Page   54: 51.3.11 DMA Interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2288
Page   55: 51.4.3      Handling of interrupts coming from DMA . . . . . . . . . . . . . . . . . . . . . . 2293
Page   57: 54.4.7     MDMA request generation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2381
Page   57: 54.8.16 SDMMC DMA control register (SDMMC_IDMACTRLR) . . . . . . . . . . 2422
Page   58: 54.8.17 SDMMC IDMA buffer size register (SDMMC_IDMABSIZER) . . . . . . 2423
Page   58: 54.8.18 SDMMC IDMA buffer 0 base address register
Page   58: (SDMMC_IDMABASE0R) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2424
Page   58: 54.8.19 SDMMC IDMA buffer 1 base address register
Page   58: (SDMMC_IDMABASE1R) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2424
Page   63: 56.14.33 OTG host channel x DMA address register (OTG_HCDMAx)
Page   63: 56.14.53 OTG device IN endpoint x DMA address register (OTG_DIEPDMAx) . . .
Page   64: 56.14.59 OTG device OUT endpoint x DMA address register (OTG_DOEPDMAx) .
Page   64: 56.15.4 DMA mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2679
Page   64: (MAC) with DMA controller . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2737
Page   64: 57.2.2      DMA features . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2740
Page   64: 57.4.1      DMA controller . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2744
Page   65: 57.8.1      DMA interrupts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2803
Page   65: 57.9.1      DMA initialization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2806
Page   66: 57.11.2 Ethernet DMA registers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2841
Page   68: Table 44.   BDMA and DMAMUX2 interconnection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 301
Page   68: Table 45.   BDMA and DMAMUX2 initialization sequence (DMAMUX2_INIT) . . . . . . . . . . . . . . . . . . 301
Page   69: Table 95.    MDMA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 576
Page   69: Table 96.    DMAMUX1, DMA1 and DMA2 connections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 578
Page   69: Table 97.    DMAMUX2 and BDMA connections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 583
Page   69: Table 98.    MDMA internal input/output signals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 588
Page   69: Table 99.    MDMA interrupt requests . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 595
Page   69: Table 100.   MDMA register map and reset values . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 613
Page   70: Table 101.   DMA internal input/output signals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 617
Page   70: Table 107.   Possible DMA configurations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 632
Page   70: Table 108.   DMA interrupt requests . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 634
Page   70: Table 109.   DMA register map and reset values . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 645
Page   70: Table 110.   BDMA implementation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 649
Page   70: Table 111.   BDMA internal input/output signals. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 651
Page   70: Table 113.   BDMA interrupt requests . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 658
Page   70: Table 114.   BDMA register map and reset values . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 668
Page   70: Table 115.   DMAMUX1 and DMAMUX2 instantiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 672
Page   70: Table 116.   DMAMUX1: assignment of multiplexer inputs to resources . . . . . . . . . . . . . . . . . . . . . . . 672
Page   70: Table 117.   DMAMUX1: assignment of trigger inputs to resources . . . . . . . . . . . . . . . . . . . . . . . . . . . 673
Page   70: Table 118.   DMAMUX1: assignment of synchronization inputs to resources . . . . . . . . . . . . . . . . . . . 674
Page   70: Table 119.   DMAMUX2: assignment of multiplexer inputs to resources . . . . . . . . . . . . . . . . . . . . . . . 674
Page   70: Table 120.   DMAMUX2: assignment of trigger inputs to resources . . . . . . . . . . . . . . . . . . . . . . . . . . . 675
Page   70: Table 121.   DMAMUX2: assignment of synchronization inputs to resources . . . . . . . . . . . . . . . . . . . 675
Page   70: Table 122.   DMAMUX signals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 677
Page   70: Table 123.   DMAMUX interrupts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 681
Page   70: Table 124.   DMAMUX register map and reset values . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 690
Page   70: Table 125.   DMA2D internal input/output signals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 694
Page   70: Table 136.   DMA2D interrupt requests . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 708
Page   70: Table 137.   DMA2D register map and reset values . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 727
Page   73: memory-to-peripheral DMA transfers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1293
Page   73: peripheral to memory DMA transfers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1294
Page   74: Table 315.   HRTIM DMA request summary. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1415
Page   76: Table 452.   SDMMC connections to MDMA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2381
Page   78: Table 548.   ETH_DMA common register map and reset values . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2864
Page   78: Table 549.   ETH_DMA_CH register map and reset values . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2864
Page   80: Figure 36.   Timing diagram of SRAM4-to-LPUART1 transfer with BDMA and D3 domain
Page   81: Figure 73.   MDMA block diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 588
Page   81: Figure 74.   DMA block diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 617
Page   81: Figure 79.   BDMA block diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 650
Page   81: Figure 80.   DMAMUX block diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 676
Page   81: Figure 81.   Synchronization mode of the DMAMUX request line multiplexer channel . . . . . . . . . . . . 679
Page   81: Figure 82.   Event generation of the DMA request line multiplexer channel . . . . . . . . . . . . . . . . . . . . 679
Page   81: Figure 83.   DMA2D block diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 694
Page   84: Figure 195. DMA Requests in regular simultaneous mode when DAMDF=0b00 . . . . . . . . . . . . . . . . 969
Page   84: Figure 196. DMA requests in regular simultaneous mode when DAMDF=0b10 . . . . . . . . . . . . . . . . . 970
Page   84: Figure 197. DMA requests in interleaved mode when DAMDF=0b10 . . . . . . . . . . . . . . . . . . . . . . . . . 970
Page   86: Figure 332. DMA burst overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1416
Page   86: Figure 333. Burst DMA operation flowchart . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1417
Page   86: Figure 334. Registers update following DMA burst transfer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1418
Page   91: Figure 587. Transmission using DMA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2045
Page   91: Figure 588. Reception using DMA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2046
Page   92: Figure 601. Transmission using DMA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2101
Page   92: Figure 602. Reception using DMA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2102
Page   95: Figure 761. Normal bulk/control OUT/SETUP transactions - DMA . . . . . . . . . . . . . . . . . . . . . . . . . . 2702
Page   95: Figure 762. Normal bulk/control IN transaction - DMA. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2704
Page   95: Figure 763. Normal interrupt OUT transactions - DMA mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2705
Page   95: Figure 764. Normal interrupt IN transactions - DMA mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2706
Page   95: Figure 765. Normal isochronous OUT transaction - DMA mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2707
Page   95: Figure 766. Normal isochronous IN transactions - DMA mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2708
Page   95: Figure 776. DMA transmission flow (standard mode) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2746
Page   95: Figure 777. DMA transmission flow (OSP mode) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2748
Page   95: Figure 778. Receive DMA flow . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2750
Page   96: Figure 797. DMA descriptor ring . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2816
Page   96: Figure 804. Generation of ETH_DMAISR flags . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2857
Page   99: DMA1 - PERIPH
Page   99: DMA2 - PERIPH
Page   99: MDMA - AHBS
Page   99: DMA1 - MEM
Page   99: DMA2 - MEM
Page   99: BDMA - AHB
Page   99: MDMA - AXI
Page   99: DMA2D
Page  100: DMA1
Page  100: DMA2
Page  100: DMA2_PERIPH
Page  100: DMA1_PERIPH
Page  100: DMA1_MEM
Page  100: DMA2_MEM
Page  100: SDMMC1 MDMA DMA2D LTDC                   D1-to-D2 AHB bus
Page  101: dedicated TCM buses directly to the Cortex-M7 core. The MDMA controller can access the
Page  101: The AHB/APB bridges also allow APB1 and APB2 peripherals to connect to DMA1 and
Page  101: DMA2 peripheral buses, respectively, without transiting through AHB1.
Page  101: AHBS slave AHB, allowing the MDMA controller to access the ITCM and DTCM.
Page  102: The Cortex®-M7 CPU uses the 32-bit AHBS slave bus to allow the MDMA controller to
Page  103: MDMA controller
Page  103: The MDMA controller has two bus masters: an AXI 64-bit bus, connected to the AXI bus
Page  103: The MDMA is optimized for DMA data transfers between memories since it supports linked
Page  103: MDMA can access all internal and external memories through the Quad-SPI controller and
Page  103: DMA1 and DMA2 controllers
Page  103: The DMA1 and DMA2 controllers have two 32-bit buses - memory bus and peripheral bus,
Page  103: The memory bus allows DMA data transfers between memories. Through the system bus
Page  103: The peripheral bus allows DMA data transfers between two peripherals, between two
Page  103: BDMA controller
Page  103: The BDMA controller uses a 32-bit bus, connected to the AHB bus matrix in D3 domain, for
Page  103: DMA data transfers between two peripherals, between two memories or between a
Page  103: peripheral and a memory. BDMA transfers are limited to the D3 domain resources. It can
Page  103: Chrom-Art Accelerator™ (DMA2D)
Page  103: The DMA2D graphics accelerator uses a 64-bit bus, connected to the AXI bus matrix.
Page  105: Masters:         D2 AHB                C-M7         SDMMC1             MDMA               DMA2D              LTDC
Page  105: INI 4                                        MDMA                                             AXI4                  64           4/1
Page  105: INI 5                                        DMA2D                                            AXI4                  64           2/1
Page  106: such as graphics processing (LTDC, DMA2D). Assigning a high priority to masters that can
Page  126: 0x58025800 - 0x58025BFF       DMAMUX2                  Section 16.6: DMAMUX registers
Page  126: 0x58025400 - 0x580257FF         BDMA                   Section 15.6: BDMA registers
Page  127: 0x52001000 - 0x52001FFF   Chrom-Art (DMA2D)               Section 17.6: DMA2D registers
Page  127: 0x52000000 - 0x52000FFF          MDMA                     Section 13.5: MDMA registers
Page  128: 0x40020800 - 0x40020BFF       DMAMUX1                  Section 16.6: DMAMUX registers
Page  128: 0x40020400 - 0x400207FF         DMA2                   Section 14.5: DMA registers
Page  128: 0x40020000 - 0x400203FF         DMA1                   Section 14.5: DMA registers
Page  130: masters except BDMA through D1 domain AXI bus matrix. AXI SRAM can be
Page  130: masters except BDMA through D2 domain AHB matrix. AHB SRAM1 can be used
Page  130: as DMA buffers to store peripheral input/output data in D2 domain, or as code
Page  130: masters except BDMA through D2 domain AHB matrix. AHB SRAM2 can be used
Page  130: as DMA buffers to store peripheral input/output data in D2 domain, or as read-
Page  130: masters except BDMA through D2 domain AHB matrix. AHB SRAM3 can be used
Page  130: BDMA buffers to store peripheral input/output data in D3 domain. It can also be
Page  130: by Cortex®-M7, and by MDMA through AHBS slave bus of the Cortex®-M7 CPU. The
Page  130: Cortex®-M7 and by MDMA through AHBS slave bus of the Cortex®-M7 CPU. The
Page  294: each other and with the other system blocks. A detailed explanation on how the DMAMUX2
Page  295: D3 PendClear[3:0]               dmamux_evtx,
Page  297: 6.2.3    Role of D3 domain DMAMUX2
Page  297: The DMAMUX2 implemented in the D3 domain allows chaining BDMA transfers. BDMA
Page  297: requests are synchronized thanks to trigger events (dmamux2_evtx) which can be
Page  297: These events can also trigger DMAMUX2 request generators (REQ_GEN[3:0]), and thus
Page  297: chain several BDMA transfers. In fact REQ_GEN[3:0] can be triggered indirectly by all the
Page  297: Like LPTIM5 and LPTIM4 outputs, dmamux2_evt7 and dmamux2_evt6 events are
Page  298: 4.   Configure the DMAMUX2, the BDMA, the LPUART1, and the RCC (CFG).
Page  298: 1.   Transfer the data from SRAM4 to LPUART1, using BDMA.
Page  299: Figure 36. Timing diagram of SRAM4-to-LPUART1 transfer with BDMA and D3 domain
Page  299: STRT   Power-on reset startup                   CFG   Peripherals initialization (BDMA, DMAMUX2, PWR, LPUART1, EXTI)
Page  299: PROC   Data processing                          STP   Control of EXTI, BDMA and LPUART1 prior to go to CSTOP
Page  299: used for the data transfer, that is BDMA, DMAMUX2, LPUART1 and LPTIM4. These
Page  300: BDMA and DMAMUX2 programming
Page  300: Two BDMA channels are required to execute data transfers via LPUART1.
Page  300: •   A BDMA channel, such as channel 0, is used to transfer data from SRAM4 to
Page  300: •   The second BDMA channel role is to switch the D3 domain to Stop mode. For that
Page  300: purpose, DMAMUX2 request generator channel 0 (REQ_GEN0) and DMAMUX2
Page  300: channel 7 synchronization block (SYNC7) are used in conjunction with BDMA channel
Page  300: BDMA channel 0 does not use DMAMUX2 trigger capabilities. Refer to Table 45 for
Page  300: BDMA channel 7 uses REQ_GEN0 to generate BDMA requests. The generation of BDMA
Page  300: The BDMA then clears the pending interrupt by performing a write operation to the
Page  300: dmamux2_evt7 output when the BDMA request generated by the REQ_GEN0 is complete.
Page  300: dmamux2_evt7 signal is used by the EXTI to switch back the D3 domain to Stop mode.
Page  300: Figure 44 shows the active signal paths via DMAMUX2. The grayed blocks represent the
Page  301: Table 44. BDMA and DMAMUX2 interconnection
Page  301: LPUART1                          DMAMUX2
Page  301: dmamux_req[15:6]                            dmamux2_req_out0
Page  301: lpuart1_tx_dma                                           SYNC0                                 CH0
Page  301: dmamux_req7                                 TC_ReqCnt_ch0
Page  301: dmamux_req[4:0]                                               BDMA
Page  301: dmamux_req[15:1]                               dmamux2_req_out7
Page  301: dmamux_req0
Page  301: ...                 dmamux2_evt7         D3_PendClear[1]
Page  301: dmamux_trg[31:0]
Page  301: dmamux_sync[15:0]
Page  301: Table 45 explain how to program BDMA and DMAMUX2 key functions. The way errors are
Page  301: Table 45. BDMA and DMAMUX2 initialization sequence (DMAMUX2_INIT)
Page  301: DMAREQ_ID of DMAMUX2_C0CR = ‘7’                             Selects LPUART_TX BDMA request.
Page  301: SE of DMAMUX2_C0CR = ‘0’                                    Disables block synchronization.
Page  301: DMAMUX2
Page  301: EGE of DMAMUX2_C0CR = ‘0’                                   No event generation.
Page  301: NBREQ of DMAMUX2_C0CR = ‘0’                                 Generates an event every BDMA transfer (Free-running
Page  301: DMAREQ_ID of DMAMUX2_C7CR = ‘0’                             Selects of REQ_GEN0 as BDMA request.
Page  301: SE of DMAMUX2_C7CR = ‘0’                                    Disables block synchronization.
Page  301: DMAMUX2
Page  301: EGE of DMAMUX2_C7CR = ‘1’                                   Enables event generation.
Page  301: NBREQ of DMAMUX2_C7CR = ‘0’                                 Generates an event every BDMA transfer (Free-running
Page  301: SIG_ID of DMAMUX2_RG0CR = ‘0d24’                           Selects LPUART TX interrupt as trigger.
Page  301: DMAMUX2 GPOL of DMAMUX2_RG0CR = ‘0b01’                              Trigger on rising edge of the event.
Page  301: REQ_GEN0 GNBREQ of DMAMUX2_RG0CR = ‘0’                              Generates only one BDMA request.
Page  301: GE of DMAMUX2_RG0CR = ‘1’                                  Enables generator.
Page  302: Table 45. BDMA and DMAMUX2 initialization sequence (DMAMUX2_INIT) (continued)
Page  302: NDT bits of BDMA_CNDTR0 = DatNber      Number of data to transfer.
Page  302: PA of BDMA_CPAR0 = &LPUART1_TDR        Address of LPUART1_TDR.
Page  302: MA of BDMA_CMAR0 = &DatBuff            Address of memory buffer of SRAM4.
Page  302: DIR of BDMA_CCR0 = ‘1’                 Read from memory.
Page  302: BDMA -      CIRC of BDMA_CCR0 = ‘0’                Circular mode disabled.
Page  302: CH0        PINC of BDMA_CCR0 = ‘0’                Peripheral increment disabled.
Page  302: MINC of BDMA_CCR0 = ‘1’                Memory increment enabled.
Page  302: PSIZE of BDMA_CCR0 = ‘0’               Peripheral size = 8 bits.
Page  302: MSIZE of BDMA_CCR0 = ‘1’               Memory size = 8 bits.
Page  302: MEM2MEM of BDMA_CCR0 = ‘0’             Memory to memory disabled.
Page  302: NDT bits of BDMA_CNDTR7 = ‘1’          Only one data transferred.
Page  302: PA of BDMA_CPAR7 = &LPUART1_ICR        Address of LPUART1_ICR (Interrupt Flag Clear Reg.).
Page  302: MA of BDMA_CMAR7 = &DatClrTC           Address of a variable located into SRAM4. This variable
Page  302: DIR of BDMA_CCR7 = ‘1’                 Read from memory.
Page  302: BDMA -
Page  302: CIRC of BDMA_CCR7 = ‘0’                Circular mode disabled.
Page  302: PINC of BDMA_CCR7 = ‘0’                Peripheral increment disabled.
Page  302: MINC of BDMA_CCR7 = ‘1’                Memory increment disabled.
Page  302: PSIZE of BDMA_CCR7 = 2                 Peripheral size = 32 bits.
Page  302: MSIZE of BDMA_CCR7 = 2                 Memory size = 32 bits.
Page  302: MEM2MEM of BDMA_CCR7 = ‘0’             Memory to memory disabled.
Page  302: LPUART1 is programmed so that is generates a BDMA request when its TX-FIFO is not full.
Page  303: FIFOEN of LPUART1_CR1 = ‘1’     Enables FIFO. BDMA will then use TXFNF (TXFIFO Not Full) flag for generating
Page  303: the BDMA requests.
Page  303: UE of LPUART1_CR1 = ‘1’         Enables BDMA.
Page  303: DMAT of LPUART1_CR3 = ‘1’       Enables the BDMA mode for transmission.
Page  303: 2.   Full initialization of RCC, PWR, EXTI, LPUART1, GPIOs, LPTIM4, DMAMUX2, BDMA
Page  303: Only the relevant steps of RCC, EXTI, PWR, LPUART1, BDMA and DMAMUX2
Page  303: 5.   The CPU enables the BDMA to start LPUART transmission and goes to Stop mode. As
Page  303: 6.   As soon as the BDMA is enabled, it serves the request from LPUART1 in order to fill its
Page  303: 7.   When the expected amount of data has been transmitted (NDT bits of BDMA_CNDTR0
Page  303: set to 0), the BDMA no longer provides data to the LPUART1. The LPUART1
Page  303: 8.   This interrupt triggers DMAMUX2 REQ_GEN0, thus activating a data transfer via
Page  303: BDMA channel 7 (BDMA_Ch7). This transfer clears LPUART1 TC flag, and the
Page  303: 9.   The end of this transfer triggers a dmamux2_evt7 signal which is used to clear the
Page  304: g)    Start the BDMA.
Page  304: Note:            The CPU does not need to initialize BDMA, DMAMUX2 and LPUART1 again.
Page  304: DMAMUX2_INIT
Page  304: BDMA_Start
Page  304: BDMA_Start
Page  304: bdma_ch0
Page  304: bdma_ch7                                                                                                 3
Page  304: dmamux2_evt7
Page  304: the REQ_GENx of the DMAMUX2, which will perform a given number (e.g. 14) of data
Page  347: DMAMUX
Page  347: BDMA
Page  348: received from an external device via BDMA. When the amount of received data is reached,
Page  348: BDMA, and SRAM4 in Autonomous mode, while keeping D3 in DRun mode (RUN_D3 set to
Page  348: D3 domain to DRun mode. The message is then transferred into memory via BDMA,
Page  348: amount of data transferred into memory reached the transfer count, the BDMA can also
Page  406: DMA2DRST
Page  406: MDMARST
Page  407: Bit 4 DMA2DRST: DMA2D block reset
Page  407: 0: does not reset DMA2D block (default after reset)
Page  407: 1: resets DMA2D block
Page  407: Bit 0 MDMARST: MDMA block reset
Page  407: 0: does not reset MDMA block (default after reset)
Page  407: 1: resets MDMA block
Page  408: DMA2RST
Page  408: DMA1RST
Page  409: Bit 1 DMA2RST: DMA2 block reset
Page  409: 0: does not reset DMA2 block (default after reset)
Page  409: 1: resets DMA2 block
Page  409: Bit 0 DMA1RST: DMA1 block reset
Page  409: 0: does not reset DMA1 block (default after reset)
Page  409: 1: resets DMA1 block
Page  411: BDMARST
Page  411: Bit 21 BDMARST: BDMA block reset
Page  411: 0: does not reset the BDMA block (default after reset)
Page  411: 1: resets the BDMA block
Page  423: BDMAAMEN
Page  425: Bit 0   BDMAAMEN: BDMA and DMAMUX Autonomous mode enable
Page  425: 0: BDMA and DMAMUX peripheral clocks are disabled when the CPU is in CStop (default after
Page  425: 1: BDMA and DMAMUX peripheral clocks enabled when D3 domain is in DRun.
Page  428: DMA2DEN
Page  428: MDMAEN
Page  429: Bit 4 DMA2DEN: DMA2D Peripheral Clock Enable
Page  429: 0: DMA2D peripheral clock disabled (default after reset)
Page  429: 1: DMA2D peripheral clock enabled
Page  429: Bit 0 MDMAEN: MDMA Peripheral Clock Enable
Page  429: 0: MDMA peripheral clock disabled (default after reset)
Page  429: 1: MDMA peripheral clock enabled
Page  430: DMA2EN
Page  430: DMA1EN
Page  431: Bit 1 DMA2EN: DMA2 Clock Enable
Page  431: 0: DMA2 clock disabled (default after reset)
Page  431: 1: DMA2 clock enabled
Page  431: Bit 0 DMA1EN: DMA1 Clock Enable
Page  431: 0: DMA1 clock disabled (default after reset)
Page  431: 1: DMA1 clock enabled
Page  434: BDMAEN
Page  434: Bit 21 BDMAEN: BDMA and DMAMUX2 Clock Enable
Page  434: 0: BDMA and DMAMUX2 clock disabled (default after reset)
Page  434: 1: BDMA and DMAMUX2 clock enabled
Page  450: DMA2DLPEN
Page  450: MDMALPEN
Page  451: Bit 4 DMA2DLPEN: DMA2D Clock Enable During CSleep Mode
Page  451: 0: DMA2D peripheral clock disabled during CSleep mode
Page  451: 1: DMA2D peripheral clock enabled during CSleep mode (default after reset)
Page  451: Bit 0 MDMALPEN: MDMA Clock Enable During CSleep Mode
Page  451: 0: MDMA peripheral clock disabled during CSleep mode
Page  451: 1: MDMA peripheral clock enabled during CSleep mode (default after reset)
Page  452: DMA2LPEN
Page  452: DMA1LPEN
Page  453: Bit 1 DMA2LPEN: DMA2 Clock Enable During CSleep Mode
Page  453: 0: DMA2 clock disabled during CSleep mode
Page  453: 1: DMA2 clock enabled during CSleep mode (default after reset)
Page  453: Bit 0 DMA1LPEN: DMA1 Clock Enable During CSleep Mode
Page  453: 0: DMA1 clock disabled during CSleep mode
Page  453: 1: DMA1 clock enabled during CSleep mode (default after reset)
Page  456: BDMALPEN
Page  456: Bit 21 BDMALPEN: BDMA Clock Enable During CSleep Mode
Page  456: 0: BDMA clock disabled during CSleep mode
Page  456: 1: BDMA clock enabled during CSleep mode (default after reset)
Page  474: Res.                     DMA2DRST                        Res.                                                                           CSIRDYC                                CSIRDYF                              CSIRDYIE                                    Res.             4
Page  474: DMA2RST                       Res.                       LSIRDY                        LSERDY                                             LSERDYC                                LSERDYF                              LSERDYIE                              LPUART1SEL[2:0]        1
Page  474: DMA1RST                    MDMARST                        LSION                         LSEON                                             LSIRDYC                                LSIRDYF                              LSIRDYIE
Page  475: Res.                          SAI4RST                       Res.                       Res.                                I2C1RST                     Res.                              BDMARST                       Res.       21
Page  476: Res.                              BDMAEN                      Res.                          Res.                        Res.                      BORRSTF                                   SAI4AMEN       21
Page  476: Res.                              GPIOEEN                   CRYPTEN                         Res.                      DMA2DEN                        Res.                                      Res.         4
Page  476: Res.                              GPIOBEN                     Res.                        DMA2EN                        Res.                         Res.                                      Res.         1
Page  476: Res.                              GPIOAEN                    DCMIEN                       DMA1EN                      MDMAEN                         Res.                                  BDMAAMEN
Page  477: CRYPTLPEN                           Res.                       DMA2DLPEN                            Res.                  USART1EN                  OPAMPEN                              TIM6EN       4
Page  477: Res.                          DMA2LPEN                          Res.                        SYSCFGEN                     TIM8EN                   CRSEN                               TIM3EN       1
Page  477: CAMITFLPEN                        DMA1LPEN                      MDMALPEN                             Res.                    TIM1EN                    Res.                               TIM2EN
Page  478: Res.                                 SAI4LPEN                       Res.                         Res.                                  I2C1LPEN                       Res.                                BDMALPEN      21
Page  478: DMA2DEN                                 Res.                      USART1LPEN                   OPAMPLPEN                               TIM6LPEN                        Res.                                GPIOELPEN      4
Page  478: MDMAEN                                   Res.                       TIM1LPEN                      Res.                                  TIM2LPEN                        Res.                                GPIOALPEN
Page  479: SAI4EN                      Res.                    Res.                                I2C1EN                      Res.                              DMA1EN                     Res.                          Res.        21
Page  479: SYSCFGEN                    TIM8EN                   CRSEN                               TIM3EN                       Res.                              GPIOBEN                    Res.                        DMA2EN         1
Page  479: Res.                    TIM1EN                    Res.                               TIM2EN                       Res.                              GPIOAEN                   DCMIEN                       DMA1EN
Page  480: Res.                                  I2C1LPEN                       Res.                                DMA1LPEN                        Res.                             Res.                           Res.      21
Page  480: OPAMPLPEN                               TIM6LPEN                        Res.                                GPIOELPEN                    CRYPTLPEN                           Res.                       DMA2DLPEN      4
Page  480: CRSLPEN                                TIM3LPEN                        Res.                                GPIOBLPEN                       Res.                          DMA2LPEN                          Res.       1
Page  480: Res.                                 TIM2LPEN                        Res.                                GPIOALPEN                   CAMITFLPEN                        DMA1LPEN                      MDMALPEN
Page  573: bdma_ch0_it          WKUP66                        D      CPU            (1)
Page  573: bdma_ch1_it          WKUP67                        D      CPU            (1)
Page  573: bdma_ch2_it          WKUP68                        D      CPU            (1)
Page  573: bdma_ch3_it          WKUP69                        D      CPU
Page  573: D3         AHB4         BDMA
Page  573: bdma_ch4_it          WKUP70                        D      CPU            (1)
Page  573: bdma_ch5_it          WKUP71           EXTI         D      CPU            (1)
Page  573: bdma_ch6_it          WKUP72                        D      CPU
Page  573: bdma_ch7_it          WKUP73                        D      CPU            (1)
Page  573: D3         AHB4       DMAMUX2             dmamux2_it          WKUP74                               CPU            (1)
Page  574: dmamux2_evt6    d3_pendclear_in[0]                                 -
Page  574: AHB4 DMAMUX2
Page  574: dmamux2_evt7    d3_pendclear_in[1]                                 -
Page  575: 12.3     DMA
Page  575: In D1 domain, the MDMA allows the memory to transfer data. It can be triggered by software
Page  575: DMA Multiplexer in D2 domain (DMAMUX1) allows to map any peripheral DMA request to
Page  575: any stream of the DMA1 or the DMA2. In addition to this, The DMAMUX provides two other
Page  575: •   It’s possible to synchronize a peripheral DMA request with a timer, with an external pin
Page  575: or with a DMA transfer complete of another stream.
Page  575: •   DMA requests can be generated on a stream by the DMAMUX1 itself. This event can
Page  575: be triggered by a timer, by an external pin event, or by a DMA transfer complete of
Page  575: another stream. The number of DMA requests generated is configurable.
Page  575: The connections on DMAMUX1 and DMA1/DMA2 are described in Section 16: DMA
Page  575: request multiplexer (DMAMUX), Section 14: Direct memory access controller (DMA) and
Page  575: Section 15: Basic direct memory access controller (BDMA).
Page  575: DMA Multiplexer in D3 domain (DMAMUX2) has the same functionality of DMAMUX1, it is
Page  575: connected to the basic DMA (BDMA).
Page  575: The connections on DMAMUX2 and BDMA are described in Section 12.3.3: DMAMUX2,
Page  575: BDMA (D3 domain). Refer to Section 12.3.3: DMAMUX2, BDMA (D3 domain) and
Page  575: Section 15: Basic direct memory access controller (BDMA) for more details.
Page  576: 12.3.1       MDMA (D1 domain)
Page  576: Table 95. MDMA
Page  576: DMA1 stream 0 transfer
Page  576: dma1_tcif0    mdma_str0
Page  576: DMA1 stream 1 transfer
Page  576: dma1_tcif1    mdma_str1
Page  576: DMA1 stream 2 transfer
Page  576: dma1_tcif2    mdma_str2
Page  576: DMA1 stream 3 transfer
Page  576: dma1_tcif3    mdma_str3
Page  576: D2       AHB1    DMA1
Page  576: DMA1 stream 4 transfer
Page  576: dma1_tcif4    mdma_str4
Page  576: DMA1 stream 5 transfer
Page  576: dma1_tcif5    mdma_str5
Page  576: DMA1 stream 6 transfer
Page  576: dma1_tcif6    mdma_str6
Page  576: DMA1 stream 7 transfer
Page  576: dma1_tcif7    mdma_str7
Page  576: MDMA         AXI   D1   DMA2 stream 0 transfer
Page  576: dma2_tcif0    mdma_str8
Page  576: DMA2 stream 1 transfer
Page  576: dma2_tcif1    mdma_str9
Page  576: DMA2 stream 2 transfer
Page  576: dma2_tcif2    mdma_str10
Page  576: DMA2 stream 3 transfer
Page  576: dma2_tcif3    mdma_str11
Page  576: D2       AHB1    DMA2
Page  576: DMA2 stream 4 transfer
Page  576: dma2_tcif4    mdma_str12
Page  576: DMA2 stream 5 transfer
Page  576: dma2_tcif5    mdma_str13
Page  576: DMA2 stream 6 transfer
Page  576: dma2_tcif6    mdma_str14
Page  576: DMA2 stream 7 transfer
Page  576: dma2_tcif7    mdma_str15
Page  576: D1       APB3     LTDC        ltdc_li_it   mdma_str16                            LTDC line interrupt
Page  577: Table 95. MDMA (continued)
Page  577: jpeg_ift_trg    mdma_str17                            JPEG input FIFO threshold
Page  577: jpeg_ifnt_trg   mdma_str18                            JPEG input FIFO not full
Page  577: jpeg_oft_trg    mdma_str19
Page  577: jpeg_ofne_trg mdma_str20
Page  577: jpeg_oec_trg    mdma_str21                            JPEG end of conversion
Page  577: quadspi_ft_trg mdma_str22                              QUADSPI FIFO threshold
Page  577: quadspi_tc_trg mdma_str23
Page  577: DMA2D CLUT transfer
Page  577: dma2d_clut_trg mdma_str24
Page  577: D1     AHB3    DMA2D       dma2d_tc_trg mdma_str25        MDMA         AXI   D1   DMA2D transfer complete
Page  577: DMA2D transfer
Page  577: dma2d_tw_trg mdma_str26
Page  577: D1     AHB3   SDMMC1                        mdma_str29                            End of data
Page  578: 12.3.2       DMAMUX1, DMA1 and DMA2 (D2 domain)
Page  578: Table 96. DMAMUX1, DMA1 and DMA2 connections(1)
Page  578: dmamux1_req_in1
Page  578: dmamux1_req_in2
Page  578: dmamux1_req_in3
Page  578: dmamux1 internal         dmamux1_req_in4
Page  578: D2       AHB1   ADC1         adc1_dma        dmamux1_req_in9
Page  578: D2       AHB1   ADC2         adc2_dma        dmamux1_req_in10
Page  578: tim1_ch1_dma      dmamux1_req_in11
Page  578: tim1_ch2_dma      dmamux1_req_in12
Page  578: tim1_ch3_dma      dmamux1_req_in13
Page  578: D2       APB2   TIM1       tim1_ch4_dma      dmamux1_req_in14
Page  578: tim1_up_dma      dmamux1_req_in15
Page  578: tim1_trig_dma    dmamux1_req_in16
Page  578: DMAMUX1 AHB1         D2      Requests
Page  578: tim1_com_dma      dmamux1_req_in17
Page  578: tim2_ch1_dma      dmamux1_req_in18
Page  578: tim2_ch2_dma      dmamux1_req_in19
Page  578: D2       APB1   TIM2       tim2_ch3_dma      dmamux1_req_in20
Page  578: tim2_ch4_dma      dmamux1_req_in21
Page  578: tim2_up_dma      dmamux1_req_in22
Page  578: tim3_ch1_dma      dmamux1_req_in23
Page  578: tim3_ch2_dma      dmamux1_req_in24
Page  578: tim3_ch3_dma      dmamux1_req_in25
Page  578: tim3_ch4_dma      dmamux1_req_in26
Page  578: tim3_up_dma      dmamux1_req_in27
Page  578: tim3_trig_dma    dmamux1_req_in28
Page  578: tim4_ch1_dma      dmamux1_req_in29
Page  578: tim4_ch2_dma      dmamux1_req_in30
Page  578: tim4_ch3_dma      dmamux1_req_in31
Page  578: tim4_up_dma      dmamux1_req_in32
Page  579: Table 96. DMAMUX1, DMA1 and DMA2 connections(1) (continued)
Page  579: i2c1_rx_dma      dmamux1_req_in33
Page  579: i2c1_tx_dma     dmamux1_req_in34
Page  579: i2c2_rx_dma      dmamux1_req_in35
Page  579: i2c2_tx_dma     dmamux1_req_in36
Page  579: spi1_rx_dma      dmamux1_req_in37
Page  579: spi1_tx_dma     dmamux1_req_in38
Page  579: spi2_rx_dma      dmamux1_req_in39
Page  579: spi2_tx_dma     dmamux1_req_in40
Page  579: usart1_rx_dma    dmamux1_req_in41
Page  579: usart1_tx_dma    dmamux1_req_in42
Page  579: usart2_rx_dma    dmamux1_req_in43
Page  579: usart2_tx_dma    dmamux1_req_in44
Page  579: usart3_rx_dma    dmamux1_req_in45
Page  579: usart3_tx_dma    dmamux1_req_in46
Page  579: tim8_ch1_dma     dmamux1_req_in47
Page  579: tim8_ch2_dma     dmamux1_req_in48
Page  579: DMAMUX1 AHB1          D2     Requests
Page  579: tim8_ch3_dma     dmamux1_req_in49
Page  579: D2     APB2   TIM8       tim8_ch4_dma     dmamux1_req_in50
Page  579: tim8_up_dma      dmamux1_req_in51
Page  579: tim8_trig_dma    dmamux1_req_in52
Page  579: tim8_com_dma     dmamux1_req_in53
Page  579: tim5_ch1_dma     dmamux1_req_in55
Page  579: tim5_ch2_dma     dmamux1_req_in56
Page  579: tim5_ch3_dma     dmamux1_req_in57
Page  579: tim5_ch4_dma     dmamux1_req_in58
Page  579: tim5_up_dma      dmamux1_req_in59
Page  579: tim5_trig_dma    dmamux1_req_in60
Page  579: spi3_rx_dma      dmamux1_req_in61
Page  579: spi3_tx_dma     dmamux1_req_in62
Page  579: uart4_rx_dma     dmamux1_req_in63
Page  579: uart4_tx_dma     dmamux1_req_in64
Page  580: Table 96. DMAMUX1, DMA1 and DMA2 connections(1) (continued)
Page  580: uart5_rx_dma      dmamux1_req_in65
Page  580: uart5_tx_dma      dmamux1_req_in66
Page  580: D2       APB1   DAC1       dac_ch1_dma       dmamux1_req_in67
Page  580: D2       APB1   DAC2       dac_ch2_dma       dmamux1_req_in68
Page  580: D2       APB1   TIM6       tim6_up_dma       dmamux1_req_in69
Page  580: D2       APB1   TIM7       tim7_up_dma       dmamux1_req_in70
Page  580: usart6_rx_dma     dmamux1_req_in71
Page  580: usart6_tx_dma     dmamux1_req_in72
Page  580: i2c3_rx_dma      dmamux1_req_in73
Page  580: i2c3_tx_dma      dmamux1_req_in74
Page  580: D2       AHB2   DCMI         dcmi_dma        dmamux1_req_in75
Page  580: cryp_in_dma      dmamux1_req_in76
Page  580: cryp_out_dma      dmamux1_req_in77
Page  580: D2       AHB2   HASH       hash_in_dma       dmamux1_req_in78
Page  580: uart7_rx_dma      dmamux1_req_in79
Page  580: D2       APB1   UART7                                           DMAMUX1 AHB1        D2      Requests
Page  580: uart7_tx_dma      dmamux1_req_in80
Page  580: uart8_rx_dma      dmamux1_req_in81
Page  580: uart8_tx_dma      dmamux1_req_in82
Page  580: spi4_rx_dma      dmamux1_req_in83
Page  580: spi4_tx_dma      dmamux1_req_in84
Page  580: spi5_rx_dma      dmamux1_req_in85
Page  580: spi5_tx_dma      dmamux1_req_in86
Page  580: sai1_a_dma       dmamux1_req_in87
Page  580: sai1_b_dma       dmamux1_req_in88
Page  580: sai2_a_dma       dmamux1_req_in89
Page  580: sai2_b_dma       dmamux1_req_in90
Page  580: swpmi_rx_dma      dmamux1_req_in91
Page  580: swpmi_tx_dma      dmamux1_req_in92
Page  580: spdifrx_dt_dma    dmamux1_req_in93
Page  580: spdifrx_cs_dma    dmamux1_req_in94
Page  581: Table 96. DMAMUX1, DMA1 and DMA2 connections(1) (continued)
Page  581: hrtim_dma1       dmamux1_req_in95
Page  581: hrtim_dma2       dmamux1_req_in96
Page  581: hrtim_dma3       dmamux1_req_in97
Page  581: hrtim_dma4       dmamux1_req_in98
Page  581: hrtim_dma5       dmamux1_req_in99
Page  581: hrtim_dma6      dmamux1_req_in100
Page  581: dfsdm1_dma0      dmamux1_req_in101
Page  581: dfsdm1_dma1      dmamux1_req_in102
Page  581: dfsdm1_dma2      dmamux1_req_in103
Page  581: dfsdm1_dma3      dmamux1_req_in104
Page  581: tim15_ch1_dma    dmamux1_req_in105 DMAMUX1 AHB1            D2     Requests
Page  581: tim15_up_dma     dmamux1_req_in106
Page  581: tim15_trig_dma   dmamux1_req_in107
Page  581: tim15_com_dma    dmamux1_req_in108
Page  581: tim16_ch1_dma    dmamux1_req_in109
Page  581: tim16_up_dma     dmamux1_req_in110
Page  581: tim17_ch1_mda    dmamux1_req_in111
Page  581: tim17_up_dma     dmamux1_req_in112
Page  581: sai3_a_dma      dmamux1_req_in113
Page  581: sai3_b_dma      dmamux1_req_in114
Page  581: D3     AHB4   ADC3         adc3_dma       dmamux1_req_in115
Page  581: dmamux1_evt0       dmamux1_gen0
Page  581: D2     AHB1 DMAMUX1      dmamux1_evt1       dmamux1_gen1
Page  581: dmamux1_evt2       dmamux1_gen2
Page  581: D2     APB1   LPTIM1       lptim1_out       dmamux1_gen3                                    Request
Page  581: DMAMUX1 AHB1          D2
Page  581: D2     APB1   LPTIM2       lptim2_out       dmamux1_gen4                                   generation
Page  581: D2     APB1   LPTIM3       lptim3_out       dmamux1_gen5
Page  581: D3     APB4    EXTI       exti_exti0_it     dmamux1_gen6
Page  581: D2     APB1   TIM12        tim12_trgo       dmamux1_gen7
Page  582: Table 96. DMAMUX1, DMA1 and DMA2 connections(1) (continued)
Page  582: dmamux1_evt0             dmamux1_trg0
Page  582: D2    AHB1 DMAMUX1             dmamux1_evt1             dmamux1_trg1
Page  582: dmamux1_evt2             dmamux1_trg2
Page  582: D2     APB1     LPTIM1            lptim1_out            dmamux1_trg3
Page  582: DMAMUX1 AHB1          D2      Triggers
Page  582: D2     APB1     LPTIM2            lptim2_out            dmamux1_trg4
Page  582: D2     APB1     LPTIM3            lptim3_out            dmamux1_trg5
Page  582: D3     APB4       EXTI           exti_exti0_it          dmamux1_trg6
Page  582: D2     APB1      TIM12            tim12_trgo            dmamux1_trg7
Page  582: dmamux1_req_out0            dma1_str0
Page  582: dmamux1_req_out1            dma1_str1
Page  582: dmamux1_req_out2            dma1_str2
Page  582: dmamux1_req_out3            dma1_str3
Page  582: DMA1       AHB1    D2
Page  582: dmamux1_req_out4            dma1_str4
Page  582: dmamux1_req_out5            dma1_str5
Page  582: dmamux1_req_out6            dma1_str6
Page  582: dmamux1_req_out7            dma1_str7                                    Requests
Page  582: D2    AHB1 DMAMUX1
Page  582: dmamux1_req_out8            dma2_str0                                      out
Page  582: dmamux1_req_out9            dma2_str1
Page  582: dmamux1_req_out10            dma2_str2
Page  582: dmamux1_req_out11            dma2_str3
Page  582: DMA2       AHB1    D2
Page  582: dmamux1_req_out12            dma2_str4
Page  582: dmamux1_req_out13            dma2_str5
Page  582: dmamux1_req_out14            dma2_str6
Page  582: dmamux1_req_out15            dma2_str7
Page  583: 12.3.3      DMAMUX2, BDMA (D3 domain)
Page  583: Table 97. DMAMUX2 and BDMA connections
Page  583: dmamux2_req_in1
Page  583: dmamux2_req_in2
Page  583: dmamux2_req_in3
Page  583: dmamux2 internal          dmamux2_req_in4
Page  583: dma_rx_lpuart     dmamux2_req_in9   DMAMUX2 AHB4     D3     Requests
Page  583: dma_tx_lpuart    dmamux2_req_in10
Page  583: dma_rx_spi6      dmamux2_req_in11
Page  583: dma_tx_spi6      dmamux2_req_in12
Page  583: dma_rx_i2c4      dmamux2_req_in13
Page  583: dma_tx_i2c4      dmamux2_req_in14
Page  583: dma_a_sai4       dmamux2_req_in15
Page  583: dma_b_sai4       dmamux2_req_in16
Page  583: D3     APB4   ADC3         dma_adc3        dmamux2_req_in17
Page  584: Table 97. DMAMUX2 and BDMA connections (continued)
Page  584: dmamux2_evt0           dmamux2_gen0
Page  584: dmamux2_evt1           dmamux2_gen1
Page  584: dmamux2_evt2           dmamux2_gen2
Page  584: D3   AHB4 DMAMUX2        dmamux2_evt3           dmamux2_gen3
Page  584: dmamux2_evt4           dmamux2_gen4
Page  584: dmamux2_evt5           dmamux2_gen5
Page  584: dmamux2_evt6           dmamux2_gen6
Page  584: exti_lpuart_rx_it      dmamux2_gen7
Page  584: exti_lpuart_tx_it      dmamux2_gen8
Page  584: exti_lptim2_wkup       dmamux2_gen9
Page  584: exti_lptim2_out       dmamux2_gen10
Page  584: exti_lptim3_wkup      dmamux2_gen11
Page  584: exti_lptim3_out       dmamux2_gen12
Page  584: exti_lptim4_wkup      dmamux2_gen13
Page  584: D3   APB4    EXTI        exti_lptim5_wkup      dmamux2_gen14                               Request
Page  584: DMAMUX2 AHB4     D3
Page  584: exti_i2c4_wkup        dmamux2_gen15                              generation
Page  584: exti_spi6_wkup        dmamux2_gen16
Page  584: exti_comp1_out        dmamux2_gen17
Page  584: exti_comp2_out        dmamux2_gen18
Page  584: exti_rtc_wkup        dmamux2_gen19
Page  584: exti_syscfg_exti0     dmamux2_gen20
Page  584: exti_syscfg_exti2     dmamux2_gen21
Page  584: D3   APB4    I2C4           it_evt_i2c4        dmamux2_gen22
Page  584: D3   APB4    SPI6             it_spi6          dmamux2_gen23
Page  584: it_tx_lpuart1       dmamux2_gen24
Page  584: it_rx_lpuart1       dmamux2_gen25
Page  584: it_adc3           dmamux2_gen26
Page  584: out_awd1_adc3         dmamux2_gen27
Page  584: it_ch0_bdma         dmamux2_gen28
Page  584: D3   AHB4   BDMA
Page  584: it_ch1_bdma         dmamux2_gen29
Page  585: Table 97. DMAMUX2 and BDMA connections (continued)
Page  585: dmamux2_evt0            dmamux2_trg0
Page  585: dmamux2_evt1            dmamux2_trg1
Page  585: dmamux2_evt2            dmamux2_trg2
Page  585: D3   AHB4 DMAMUX2
Page  585: dmamux2_evt3            dmamux2_trg3
Page  585: dmamux2_evt4            dmamux2_trg4
Page  585: dmamux2_evt5            dmamux2_trg5
Page  585: it_exti_tx_lpuart1       dmamux2_trg6
Page  585: it_exti_rx_lpuart1       dmamux2_trg7
Page  585: DMAMUX2 AHB4         D3     Triggers
Page  585: it_exti_out_lptim2       dmamux2_trg8
Page  585: it_exti_out_lptim3       dmamux2_trg9
Page  585: it_exti_wkup_i2c4         dmamux2_trg10
Page  585: it_exti_wkup_spi6         dmamux2_trg11
Page  585: it_exti_out_comp1         dmamux2_trg12
Page  585: it_exti_wkup_rtc         dmamux2_trg13
Page  585: it_exti_exti0_syscfg      dmamux2_trg14
Page  585: it_exti_exti2_syscfg      dmamux2_trg15
Page  585: dmamux1_req_out0            bdma_ch0
Page  585: dmamux1_req_out1            bdma_ch1
Page  585: dmamux1_req_out2            bdma_ch2
Page  585: dmamux1_req_out3            bdma_ch3
Page  585: D3   AHB4 DMAMUX2                                                     BDMA      AHB4     D3   Requests out
Page  585: dmamux1_req_out4            bdma_ch4
Page  585: dmamux1_req_out5            bdma_ch5
Page  585: dmamux1_req_out6            bdma_ch6
Page  585: dmamux1_req_out7            bdma_ch7
Page  586: MDMA controller (MDMA)                                                                            RM0433
Page  586: 13         MDMA controller (MDMA)
Page  586: 13.1       MDMA introduction
Page  586: The master direct memory access (MDMA) is used in order to provide high-speed data
Page  586: quickly moved by the MDMA without any CPU action. This keeps the CPU resources free
Page  586: The MDMA controller provides a master AXI interface for main memory and peripheral
Page  586: The MDMA works in conjunction with the standard DMA controllers (DMA1 or DMA2). It
Page  586: the DMA stream memory buffer or other peripherals (w/ integrated FIFO).
Page  586: 13.2       MDMA main features
Page  586: selection is software-configurable and allows several peripherals to initiate DMA
Page  586: •   All the channels are identical and can be connected either to a standard DMA or a
Page  586: •   The priorities between the DMA channels are software-programmable (4 levels
Page  586: word): when the data widths of the source and destination are not equal, the MDMA
Page  587: RM0433                                                                   MDMA controller (MDMA)
Page  587: two MDMA channels, in the destination memory, by simply programming the 2 channels
Page  587: •   5 event flags (MDMA Channel Transfer Complete, MDMA Block Transfer complete,
Page  587: MDMA Block Repeat Transfer Complete, MDMA buffer transfer Complete, MDMA
Page  588: MDMA controller (MDMA)                                                                                      RM0433
Page  588: 13.3       MDMA functional description
Page  588: 13.3.1     MDMA block diagram
Page  588: Figure 73 shows the block diagram of the MDMA.
Page  588: Figure 73. MDMA block diagram
Page  588: mdma_it                                                         write
Page  588: mdma_str0
Page  588: mdma_str31                         32
Page  588: mdma_hclk
Page  588: 13.3.2     MDMA internal signals
Page  588: Table 98 shows the internal MDMA signals.
Page  588: Table 98. MDMA internal input/output signals
Page  588: mdma_hclk                 Digital input   MDMA AHB clock
Page  588: mdma_it                 Digital output   MDMA interrupt
Page  588: mdma_str[0:31]                   Digital input   MDMA stream request
Page  589: RM0433                                                                      MDMA controller (MDMA)
Page  589: 13.3.3   MDMA overview
Page  589: The MDMA controller performs a direct memory transfer: as an AXI/AHB master, it can take
Page  589: peripheral, which has no control over the MDMA flow. When these types of transaction are
Page  589: used and the request is coming from a standard DMA (DMA1 or DMA2), the peripheral
Page  589: register access is replaced by a memory access to the memory buffer used by this DMA.
Page  589: The AHB slave port is used to program the MDMA controller (it supports 8/16/32-bit
Page  589: DMA1/2 memory buffer) and the “real time” requirements for other MDMA channels
Page  589: MDMA without doing a new arbitration between MDMA channel requests).
Page  589: before checking for MDMA requests on other channels. This is the data array transfer
Page  589: lengths which cannot be interrupted at MDMA level (from other channel requests).
Page  589: MDMA linked list (corresponds to one entry in the linked list)
Page  589: transferred on a single MDMA request activation (for the respective channel)
Page  590: MDMA controller (MDMA)                                                                               RM0433
Page  590: 13.3.4     MDMA channel
Page  590: Each of the DMA controller channel provides a unidirectional transfer link between a source
Page  590: •    Single block transfer: one block is transferred. At the end of the block, the DMA
Page  590: If the link structure address points to a valid memory address, the MDMA will reload the
Page  590: new block transfer will then be executed (on the next MDMA channel request) based on this
Page  590: MDMA channel will be disabled and the end of channel transfer interrupt will be generated.
Page  590: and DINC[1:0] bits in the MDMA_CxCR register.
Page  590: increment size programmed in the SINCOS[1:0] or DINCOS[1:0] bits in the MDMA_CxCR
Page  591: RM0433                                                                       MDMA controller (MDMA)
Page  591: 13.3.7   MDMA buffer transfer
Page  591: MDMA request event, on one channel.
Page  591: An MDMA buffer transfer consists of a sequence of a given number of data transfers (done
Page  591: After an event requiring a data array to be transferred, the DMA/peripheral sends a request
Page  591: signal to the MDMA controller. The MDMA controller serves the request depending on the
Page  591: peripheral, the write must be set as non bufferable, in order to avoid a false new MDMA
Page  591: The total amount of data to be transferred, on the current channel, following a MDMA
Page  591: If TRGM[1:0] equals 00, a single buffer will be transferred, then the MDMA will wait for
Page  591: If TRGM[1:0] is different from 00 (multiple buffers need to be transferred), the mdma_strx for
Page  591: transferring an individual buffer, the MDMA will enter in a new arbitration phase (between
Page  591: MDMA requests would be blocked for the more than a buffer transfer period, on any lower
Page  592: MDMA controller (MDMA)                                                                             RM0433
Page  592: An arbiter manages the MDMA channel requests based on their priority. When MDMA is idle
Page  592: and after the end of each buffer transfer, all MDMA requests (hardware or software) are
Page  592: •   Software: each stream priority can be configured in the MDMA_CxCR register. There
Page  593: RM0433                                                                     MDMA controller (MDMA)
Page  593: block start address is computed (based on the information in the MDMA_CxBRUR
Page  593: the MDMA_CxLAR)
Page  593: •   It is the last block which needs to be transferred for the current MDMA channel
Page  593: (MDMA_CxLAR = 0): the channel is disabled and no further MDMA requests will be
Page  593: The Linked list mode allows to load a new MDMA configuration (CxTCR, CxBNDTR,
Page  593: 13.3.13   MDMA transfer completion
Page  593: register (MDMA_CxISR):
Page  593: •   The MDMA_CxBNDTR counter has reached zero, the Block Repeat Counter is 0 and
Page  593: MDMA_CxCR register) and all the remaining data have been transferred from the FIFO
Page  594: MDMA controller (MDMA)                                                                             RM0433
Page  594: 13.3.14    MDMA transfer suspension
Page  594: At any time, a MDMA transfer can be suspended in order to be to be restarted later on or to
Page  594: be definitively disabled before the end of the MDMA transfer.
Page  594: There is no particular action to do, besides clearing the EN bit in the MDMA_CxCR
Page  594: indicate the end of transfer. The value of the EN bit in MDMA_CxCR is now 0 to confirm
Page  594: the channel interruption. The MDMA_CxNDTR register contains the number of
Page  594: the MDMA_CxBNDTR register reaches 0. The aim is to restart the transfer later by re-
Page  594: to indicate the end of transfer. If the MDMA_CxBNDTR, SAR and DAR registers are
Page  594: The MDMA controller can detect the following errors:
Page  594: •    A bus error occurs during a MDMA read or a write access
Page  594: 13.4       MDMA interrupts
Page  594: For each MDMA channel, an interrupt can be produced on the following events:
Page  595: RM0433                                                                                         MDMA controller (MDMA)
Page  595: Table 99. MDMA interrupt requests
Page  595: 13.5            MDMA registers
Page  595: The MDMA registers can be accessed in word/half-word or byte format.
Page  595: 13.5.1          MDMA global interrupt/status register (MDMA_GISR0)
Page  596: MDMA controller (MDMA)                                                                                              RM0433
Page  596: 13.5.2            MDMA channel x interrupt/status register (MDMA_CxISR)
Page  596: This bit is set by software writing 1 to the SWRQx bit in the MDMA_CxCR register, in order
Page  596: to request a MDMA transfer, and the channel x is enabled.
Page  596: 0: The MDMA transfer mdma_strx is inactive for channel x.
Page  596: 1: The MDMA transfer mdma_strx is active for channel x
Page  596: MDMA_IFCRy register.
Page  596: This can be used as a debug feature (without interrupt), indicating that (at least) an MDMA
Page  596: MDMA_IFCRy register.
Page  596: MDMA_IFCRy register.
Page  597: RM0433                                                                                       MDMA controller (MDMA)
Page  597: MDMA_IFCRy register.
Page  597: MDMA_IFCRy register.
Page  597: 13.5.3          MDMA channel x interrupt flag clear register (MDMA_CxIFCR)
Page  597: Writing 1 into this bit clears TCIF in the MDMA_ISRy register
Page  597: Writing 1 into this bit clears BTIF in the MDMA_ISRy register
Page  597: Writing 1 into this bit clears BRTIF in the MDMA_ISRy register
Page  597: Writing 1 into this bit clears CTCIF in the MDMA_ISRy register
Page  597: Writing 1 into this bit clears TEIF in the MDMA_ISRy register
Page  598: MDMA controller (MDMA)                                                                                               RM0433
Page  598: 13.5.4            MDMA channel x error status register (MDMA_CxESR)
Page  598: It is cleared by software writing 1 to the CTEIF bit in the MDMA_IFCRy register.
Page  598: It is cleared by software writing 1 to the CTEIF bit in the MDMA_IFCRy register.
Page  598: It is cleared by software writing 1 to the CTEIF bit in the MDMA_IFCRy register.
Page  598: It is cleared by software writing 1 to the CTEIF bit in the MDMA_IFCRy register.
Page  598: These bit is set and cleared by hardware, in case of an MDMA data transfer error.
Page  599: RM0433                                                                              MDMA controller (MDMA)
Page  599: These bits are set and cleared by hardware, in case of an MDMA data transfer error. It is
Page  600: MDMA controller (MDMA)                                                                                             RM0433
Page  600: 13.5.5            MDMA channel x control register (MDMA_CxCR)
Page  600: Writing 1 into this bit sets the CRQA in MDMA_ISRy register, activating the request on
Page  601: RM0433                                                                              MDMA controller (MDMA)
Page  601: –     on a MDMA end of transfer (stream ready to be configured)
Page  602: MDMA controller (MDMA)                                                                                           RM0433
Page  602: 13.5.6           MDMA channel x transfer configuration register (MDMA_CxTCR)
Page  602: Note: All MDMA destination accesses are non-cacheable.
Page  602: value and acknowledged by the MDMA ACKx signal.
Page  602: 00: Each MDMA request (software or hardware) triggers a buffer transfer
Page  602: 01: Each MDMA request (software or hardware) triggers a block transfer
Page  602: 10: Each MDMA request (software or hardware) triggers a repeated block transfer (if the
Page  602: 11: Each MDMA request (software or hardware) triggers the transfer of the whole data for
Page  603: RM0433                                                                                MDMA controller (MDMA)
Page  604: MDMA controller (MDMA)                                                                                     RM0433
Page  605: RM0433                                                                                 MDMA controller (MDMA)
Page  605: 13.5.7         MDMA channel x block number of data register (MDMA_CxBNDTR)
Page  606: MDMA controller (MDMA)                                                                                        RM0433
Page  607: RM0433                                                                              MDMA controller (MDMA)
Page  607: 13.5.8        MDMA channel x source address register (MDMA_CxSAR)
Page  607: These bits are write-protected and can be written only when bit EN = '0' in the DMA_SxCR register.
Page  607: 13.5.9        MDMA channel x destination address register (MDMA_CxDAR)
Page  608: MDMA controller (MDMA)                                                                                      RM0433
Page  608: These bits are write-protected and can be written only when bit EN = '0' in the DMA_SxCR register.
Page  609: RM0433                                                                                MDMA controller (MDMA)
Page  609: 13.5.10        MDMA channel x block repeat address update register
Page  609: (MDMA_CxBRUR)
Page  609: These bits are write-protected and can be written only when bit EN = '0' in the MDMA_CxCR
Page  609: These bits are write-protected and can be written only when bit EN = '0' in the MDMA_CxCR
Page  610: MDMA controller (MDMA)                                                                                       RM0433
Page  610: 13.5.11         MDMA channel x link address register (MDMA_CxLAR)
Page  610: protected and can be written only when bit EN = '0' in the MDMA_CxCR register.
Page  611: RM0433                                                                                     MDMA controller (MDMA)
Page  611: 13.5.12           MDMA channel x trigger and bus selection register (MDMA_CxTBR)
Page  611: These bits are write-protected and can be written only when bit EN = '0' in the MDMA_CxCR
Page  612: MDMA controller (MDMA)                                                                                          RM0433
Page  612: 13.5.13         MDMA channel x mask address register (MDMA_CxMAR)
Page  612: generated by the DMA2 by writing to its Interrupt Clear register.
Page  612: written only when bit EN = '0' in the MDMA_CxCR register.
Page  612: 13.5.14         MDMA channel x mask data register (MDMA_CxMDR)
Page  612: clear the RQ signal generated by the DMA2 by writing to its Interrupt Clear register.
Page  612: These bits are write-protected and can be written only when bit EN = '0' in the MDMA_CxCR
Page  613: RM0433                                                                                                                                                                                                    MDMA controller (MDMA)
Page  613: 13.5.15           MDMA register map
Page  613: Table 100 summarizes the MDMA registers.
Page  613: Table 100. MDMA register map and reset values
Page  613: MDMA_GISR0
Page  613: MDMA_CxISR
Page  613: MDMA_CxIFCR
Page  613: MDMA_CxESR                                                                                                                                                                                                                                         TEA[6:0]
Page  613: MDMA_CxCR
Page  613: MDMA_CxTCR                                                                      TLEN[6:0].
Page  613: MDMA_CxBNDTR                                     BRC[11:0]                                                                                                                                            BNDT[16:0]
Page  613: 0x58         MDMA_CxSAR                                                                                                            SAR[31:0].
Page  613: 0x5C         MDMA_CxDAR                                                                                                            DAR[31:0].
Page  613: 0x60      MDMA_CxBRUR                                                    DUV[15:0].                                                                                                                               SUV[15:0].
Page  613: 0x64         MDMA_CxLAR                                                                                                            LAR[31:0].
Page  613: MDMA_CxTBR                                                                                                                                                                                                                                          TSEL[5:0]
Page  613: 0x70         MDMA_CxMAR                                                                                                            MAR[31:0].
Page  614: MDMA controller (MDMA)                                                                                                                                                                                                                 RM0433
Page  614: Table 100. MDMA register map and reset values (continued)
Page  614: 0x74         MDMA_CxMDR                                                                                                        MDR[31:0].
Page  615: RM0433                                                    Direct memory access controller (DMA)
Page  615: 14       Direct memory access controller (DMA)
Page  615: 14.1     DMA introduction
Page  615: Direct memory access (DMA) is used in order to provide high-speed data transfer between
Page  615: DMA without any CPU action. This keeps CPU resources free for other operations.
Page  615: The DMA controller combines a powerful dual AHB master bus architecture with
Page  615: The two DMA controllers (DMA1 and DMA2) have 16 streams in total (8 for each controller),
Page  615: Each DMA stream is driven by one DMAMUX1 output channel (request). Any DMAMUX1
Page  615: output request can be individually programmed in order to select the DMA request source
Page  615: Refer to the Section 16.3: DMAMUX implementation for more information about the DMA
Page  615: Each DMA controller has an arbiter for handling the priority between DMA requests.
Page  615: 14.2     DMA main features
Page  615: The main DMA features are:
Page  615: •   8 streams for each DMA controller, up to 115 channels (requests) per stream
Page  615: –    Direct mode: each DMA request immediately initiates a transfer from/to the
Page  615: memory-to-peripheral mode, the DMA preloads only one data from the memory to
Page  615: the internal FIFO to ensure an immediate data transfer as soon as a DMA request
Page  615: •   Priorities between DMA stream requests are software-programmable (4 levels
Page  616: Direct memory access controller (DMA)                                                          RM0433
Page  616: selection is software-configurable by the DMAMUX1 and allows 107 peripherals to
Page  616: initiate DMA requests
Page  616: •   The number of data items to be transferred can be managed either by the DMA
Page  616: –   DMA flow controller: the number of data items to be transferred is software-
Page  616: data widths of the source and destination are not equal, the DMA automatically
Page  616: •   5 event flags (DMA half transfer, DMA transfer complete, DMA transfer error, DMA
Page  617: RM0433                                                                                          Direct memory access controller (DMA)
Page  617: 14.3     DMA functional description
Page  617: 14.3.1   DMA block diagram
Page  617: Figure 74 shows the block diagram of a DMA.
Page  617: Figure 74. DMA block diagram
Page  617: DMA controller
Page  617: dma_str0
Page  617: dma_str1
Page  617: dma_str2
Page  617: From                  dma_str3
Page  617: DMAMUX1                 dma_str4      Arbitrer
Page  617: dma_str5
Page  617: dma_str6
Page  617: dma_str7
Page  617: dma_hclk
Page  617: dma_it[0:7]                                AHB slave
Page  617: dma_tcif[0:7]                                   programming
Page  617: To MDMA                                                                                                             interface                                  Programming port
Page  617: 14.3.2   DMA internal signals
Page  617: Table 101 shows the internal DMA signals.
Page  617: Table 101. DMA internal input/output signals
Page  617: dma_hclk                                 DMA AHB clock
Page  617: dma_it[0:7]                              DMA stream [0:7] global interrupts
Page  617: dma_tcif[0:7]                             MDMA triggers
Page  617: dma_str[0:7]                              DMA stream [0:7] requests
Page  618: Direct memory access controller (DMA)                                                          RM0433
Page  618: 14.3.3     DMA overview
Page  618: The DMA controller performs direct memory transfer: as an AHB master, it can take the
Page  618: The DMA controller provides two AHB master ports: the AHB memory port, intended to be
Page  618: The AHB slave port is used to program the DMA controller (it supports only 32-bit
Page  618: 14.3.4     DMA transactions
Page  618: A DMA transaction consists of a sequence of a given number of data transfers. The number
Page  618: Each DMA transfer consists of three operations:
Page  618: the DMA_SxPAR or DMA_SxM0AR register
Page  618: addressed through the DMA_SxPAR or DMA_SxM0AR register
Page  618: •    a post-decrement of the DMA_SxNDTR register, containing the number of transactions
Page  618: After an event, the peripheral sends a request signal to the DMA controller. The DMA
Page  618: controller serves the request depending on the channel priorities. As soon as the DMA
Page  618: DMA controller. The peripheral releases its request as soon as it gets the Acknowledge
Page  618: signal from the DMA controller. Once the request has been deasserted by the peripheral,
Page  618: the DMA controller releases the Acknowledge signal. If there are more requests, the
Page  618: 14.3.5     DMA request mapping
Page  618: The DMA request mapping from peripherals to DMA streams is described in Section 16.3.2:
Page  618: DMAMUX1 mapping.
Page  619: RM0433                                                        Direct memory access controller (DMA)
Page  619: An arbiter manages the 8 DMA stream requests based on their priority for each of the two
Page  619: •      Software: each stream priority can be configured in the DMA_SxCR register. There are
Page  619: 14.3.7   DMA streams
Page  619: Each of the 8 DMA controller streams provides a unidirectional transfer link between a
Page  619: the memory (while the DMA is reading/writing from/to a buffer, the application can
Page  619: source width of the peripheral that requests the DMA transfer connected to the peripheral
Page  619: The direction is configured using the DIR[1:0] bits in the DMA_SxCR register and offers
Page  619: DMA_SxCR register
Page  619: 00                Peripheral-to-memory    DMA_SxPAR            DMA_SxM0AR
Page  619: 01                Memory-to-peripheral    DMA_SxM0AR           DMA_SxPAR
Page  619: 10                 Memory-to-memory       DMA_SxPAR            DMA_SxM0AR
Page  620: Direct memory access controller (DMA)                                                              RM0433
Page  620: When the data width (programmed in the PSIZE or MSIZE bits in the DMA_SxCR register)
Page  620: DMA_SxPAR or DMA_SxM0AR/M1AR registers has to be aligned on a word or half-word
Page  620: When this mode is enabled (by setting the bit EN in the DMA_SxCR register), each time a
Page  620: The transfer stops once the DMA_SxNDTR register reaches zero, when the peripheral
Page  620: the DMA_SxCR register is cleared by software.
Page  620: In direct mode (when the DMDIS value in the DMA_SxFCR register is ‘0’), the threshold
Page  620: each stream using the PL[1:0] bits in the DMA_SxCR register.
Page  620: DMA controller                       DMA_SxM0AR
Page  620: DMA_SxM1AR(1)
Page  620: dma_strx                   FIFO
Page  620: DMA_SxPAR
Page  620: Peripheral DMA request connected to the DMA stream x
Page  620: via the programmed DMAMUX
Page  621: RM0433                                                           Direct memory access controller (DMA)
Page  621: When this mode is enabled (by setting the EN bit in the DMA_SxCR register), the stream
Page  621: The transfer stops once the DMA_SxNDTR register reaches zero, when the peripheral
Page  621: the DMA_SxCR register is cleared by software.
Page  621: In direct mode (when the DMDIS value in the DMA_SxFCR register is '0'), the threshold
Page  621: level of the FIFO is not used. Once the stream is enabled, the DMA preloads the first data to
Page  621: transfer into an internal FIFO. As soon as the peripheral requests a data transfer, the DMA
Page  621: to the value of the PSIZE bitfield in the DMA_SxCR register.
Page  621: each stream using the PL[1:0] bits in the DMA_SxCR register.
Page  621: DMA controller                       DMA_SxM0AR
Page  621: DMA_SxM1AR(1)
Page  621: dma_strx                  FIFO          FIFO
Page  621: DMA_SxPAR
Page  621: Peripheral DMA request connected to the DMA stream x
Page  621: via the programmed DMAMUX
Page  622: Direct memory access controller (DMA)                                                                          RM0433
Page  622: The DMA channels can also work without being triggered by a request from a peripheral.
Page  622: When the stream is enabled by setting the Enable bit (EN) in the DMA_SxCR register, the
Page  622: The transfer stops once the DMA_SxNDTR register reaches zero or when the EN bit in the
Page  622: DMA_SxCR register is cleared by software.
Page  622: each stream using the PL[1:0] bits in the DMA_SxCR register.
Page  622: DMA controller                        DMA_SxM0AR
Page  622: DMA_SxM1AR(1)
Page  622: DMA_SxPAR                                  source
Page  622: constant after each transfer depending on the PINC and MINC bits in the DMA_SxCR
Page  622: the data width programmed in the PSIZE or MSIZE bits in the DMA_SxCR register.
Page  623: RM0433                                                       Direct memory access controller (DMA)
Page  623: The PINCOS bit in the DMA_SxCR register is used to align the increment offset size with
Page  623: ADC scan mode). This feature can be enabled using the CIRC bit in the DMA_SxCR
Page  623: phase, and the DMA requests continue to be served.
Page  623: DMA_SxNDTR = Multiple of ((Mburst beat) × (Msize)/(Psize)), where:
Page  623: –    (Mburst beat) = 4, 8 or 16 (depending on the MBURST bits in the DMA_SxCR
Page  623: PSIZE bits in the DMA_SxCR register. They are byte dependent)
Page  623: –    DMA_SxNDTR = Number of data items to transfer on the AHB peripheral port
Page  623: this case: DMA_SxNDTR must be a multiple of (8 × 1/2 = 4).
Page  623: If this formula is not respected, the DMA behavior and data integrity are not guaranteed.
Page  623: size, otherwise this could result in a bad DMA behavior.
Page  623: This mode is available for all the DMA1 and DMA2 streams.
Page  623: The double-buffer mode is enabled by setting the DBM bit in the DMA_SxCR register.
Page  623: automatically enabled (CIRC bit in DMA_SxCR is not relevant) and at each end of
Page  623: In this mode, the DMA controller swaps from one memory target to another at each end of
Page  623: area is being filled/used by the DMA transfer. The double-buffer stream can work in both
Page  624: Direct memory access controller (DMA)                                                                            RM0433
Page  624: on-the-fly (DMA_SxM0AR or DMA_SxM1AR) when the stream is enabled, by respecting the
Page  624: •   When the CT bit is ‘0’ in the DMA_SxCR register, the DMA_SxM1AR register can be
Page  624: •   When the CT bit is ‘1’ in the DMA_SxCR register, the DMA_SxM0AR register can be
Page  624: memory 0 to 1 (or from 1 to 0) depending on the value of CT in the DMA_SxCR register in
Page  624: DMA_SxCR register
Page  624: 00             Peripheral-to-memory                DMA_SxPAR                 DMA_SxM0AR / DMA_SxM1AR
Page  624: 01             Memory-to-peripheral DMA_SxM0AR / DMA_SxM1AR                            DMA_SxPAR
Page  624: The number of data items to be transferred has to be programmed into DMA_SxNDTR
Page  624: flow controller is the peripheral, PFCTRL bit in DMA_SxCR is set).
Page  624: programmable through the PSIZE and MSIZE bits in the DMA_SxCR register (can be 8-,
Page  624: •   The data width of the number of data items to transfer, configured in the DMA_SxNDTR
Page  624: DMA_SxCR register). For instance, in case of peripheral-to-memory, memory-to-
Page  624: •   The DMA controller only copes with little-endian addressing for both source and
Page  625: RM0433                                                              Direct memory access controller (DMA)
Page  625: In direct mode (DMDIS = 0 in the DMA_SxFCR register), the packing/unpacking of data is
Page  625: data widths: both are equal and defined by the PSIZE bits in the DMA_SxCR register.
Page  626: Direct memory access controller (DMA)                                                           RM0433
Page  626: PSIZE[1:0] of DMA_SxCR      MSIZE[1:0] of DMA_SxCR       NDT[15:0] of DMA_SxNDTR
Page  626: The DMA controller can generate single transfers or incremental burst transfers of 4, 8 or 16
Page  626: the MBURST[1:0] and PBURST[1:0] bits in the DMA_SxCR register.
Page  626: transfers are locked and the arbiter of the AHB bus matrix does not degrant the DMA master
Page  626: Depending on the single or burst configuration, each DMA request initiates a different
Page  626: •   When the AHB peripheral port is configured for single transfers, each DMA request
Page  626: in the DMA_SxCR register
Page  626: •   When the AHB peripheral port is configured for burst transfers, each DMA request
Page  626: PBURST[1:0] and PSIZE[1:0] bits in the DMA_SxCR register.
Page  626: The address pointers (DMA_SxPAR or DMA_SxM0AR registers) must be chosen so as to
Page  626: generated, that is not reported by the DMA registers.
Page  627: RM0433                                                                                                       Direct memory access controller (DMA)
Page  627: the DMDIS bit in the DMA_SxFCR register.
Page  628: Direct memory access controller (DMA)                                                              RM0433
Page  628: Caution is required when choosing the FIFO threshold (bits FTH[1:0] of the DMA_SxFCR
Page  628: register) and the size of the memory burst (MBURST[1:0] of the DMA_SxCR register): The
Page  628: burst transfers. If this is not in the case, a FIFO error (flag FEIFx of the DMA_HISR or
Page  628: DMA_LISR register) is generated when the stream is enabled, then the stream is
Page  628: Incomplete burst transfer at the end of a DMA transfer may happen if one of the following
Page  628: DMA_SxNDTR register) is not a multiple of the burst size multiplied by the data size.
Page  628: In such cases, the remaining data to be transferred is managed in single mode by the DMA,
Page  628: even if a burst transaction is requested during the DMA stream configuration.
Page  628: (DMDIS = 1 in the DMA_SxCR register), it is mandatory to respect the following rule to
Page  628: avoid permanent underrun or overrun conditions, depending on the DMA stream direction:
Page  629: RM0433                                                      Direct memory access controller (DMA)
Page  629: DMA_SxCR register and when the stream is configured to manage peripheral-to-memory or
Page  629: disabled, the DMA controller continues transferring the remaining data to the destination
Page  629: complete status bit (TCIFx) in the DMA_LISR or DMA_HISR register is set.
Page  629: The remaining data counter DMA_SxNDTR keeps the value in this case to indicate how
Page  629: MSIZE bit in the DMA_SxCR register. This means that memory is written with an undesired
Page  629: value. The software may read the DMA_SxNDTR register to determine the memory area
Page  629: bits in DMA_SxCR register are set to configure the stream to manage burst on the AHB
Page  629: By default, the FIFO operates in direct mode (DMDIS bit in the DMA_SxFCR is reset) and
Page  629: immediate and single transfer to or from the memory after each DMA request.
Page  629: When the DMA is configured in direct mode (FIFO disabled), to transfer data in memory-to-
Page  629: peripheral mode, the DMA preloads one data from the memory to the internal FIFO to
Page  629: ensure an immediate data transfer as soon as a DMA request is triggered by a peripheral.
Page  629: PSIZE[1:0] bits in DMA_SxCR (MSIZE[1:0] bits are not relevant)
Page  629: •   burst transfers are not possible (PBURST[1:0] and MBURST[1:0] bits in DMA_SxCR
Page  629: 14.3.15   DMA transfer completion
Page  629: Different events can generate an end of transfer by setting the TCIFx bit in the DMA_LISR
Page  629: or DMA_HISR status register:
Page  629: •   In DMA flow controller mode:
Page  629: –    The DMA_SxNDTR counter has reached zero in the memory-to-peripheral mode.
Page  629: DMA_SxCR register) and (when transfers are peripheral-to-memory or memory-
Page  630: Direct memory access controller (DMA)                                                             RM0433
Page  630: and (when the DMA is operating in peripheral-to-memory mode) the remaining
Page  630: –    The stream is disabled by software, and (when the DMA is operating in peripheral-
Page  630: number of data to be transferred reaches zero), the DMA is stopped (EN bit in DMA_SxCR
Page  630: register is cleared by Hardware) and no DMA request is served unless the software
Page  630: reprograms the stream and re-enables it (by setting the EN bit in the DMA_SxCR register).
Page  630: 14.3.16    DMA transfer suspension
Page  630: At any time, a DMA transfer can be suspended to be restarted later on or to be definitively
Page  630: disabled before the end of the DMA transfer.
Page  630: DMA_SxCR register to disable the stream. The stream may take time to be disabled
Page  630: DMA_LISR or DMA_HISR register) is set in order to indicate the end of transfer. The
Page  630: value of the EN bit in DMA_SxCR is now ‘0’ to confirm the stream interruption. The
Page  630: DMA_SxNDTR register contains the number of remaining data items at the moment
Page  630: transferred in the DMA_SxNDTR register reaches 0. The aim is to restart the transfer
Page  630: stopped, the software has to read the DMA_SxNDTR register after disabling the stream
Page  630: by writing the EN bit in DMA_SxCR register (and then checking that it is at ‘0’) to know
Page  630: Note:      A transfer complete interrupt flag (TCIF in DMA_LISR or DMA_HISR) is set to indicate the
Page  631: RM0433                                                      Direct memory access controller (DMA)
Page  631: DMA_SxCR register.
Page  631: •   The DMA controller: in this case, the number of data items to be transferred is
Page  631: programmed by software into the DMA_SxNDTR register before the DMA stream is
Page  631: be transferred is unknown. The peripheral indicates by hardware to the DMA controller
Page  631: DMA_SxNDTR has no effect on the DMA transfer. Actually, whatever the value written, it will
Page  631: •   Anticipated stream interruption: EN bit in DMA_SxCR register is reset to 0 by the
Page  631: triggered in the case of a peripheral-to-memory DMA transfer. The TCIFx flag of the
Page  631: corresponding stream is set in the status register to indicate the DMA completion. To
Page  631: know the number of data items transferred during the DMA transfer, read the
Page  631: DMA_SxNDTR register and apply the following formula:
Page  631: –    Number_of_data_transferred = 0xFFFF – DMA_SxNDTR
Page  631: stream is set in the status register to indicate the DMA transfer completion. To know the
Page  631: number of data items transferred, read the DMA_SxNDTR register and apply the same
Page  631: •   The DMA_SxNDTR register reaches 0: the TCIFx flag of the corresponding stream is
Page  631: set in the status register to indicate the forced DMA transfer completion. The stream is
Page  631: maximum of 65535 data items can be managed by the DMA in a single transaction,
Page  631: Note:     When configured in memory-to-memory mode, the DMA is always the flow controller and
Page  632: Direct memory access controller (DMA)                                                                    RM0433
Page  632: 14.3.18      Summary of the possible DMA configurations
Page  632: Table 107 summarizes the different possible DMA configurations. The forbidden
Page  632: Table 107. Possible DMA configurations
Page  632: DMA transfer                                         Flow       Circular    Transfer     Direct      Double-
Page  632: DMA           Possible                           Possible
Page  632: DMA           Possible                           Possible
Page  632: DMA only      Forbidden              Forbidden Forbidden
Page  632: The following sequence must be followed to configure a DMA stream x (where x is the
Page  632: 1.    If the stream is enabled, disable it by resetting the EN bit in the DMA_SxCR register,
Page  632: register (DMA_LISR and DMA_HISR) from the previous data block DMA transfer must
Page  632: 2.    Set the peripheral port register address in the DMA_SxPAR register. The data is moved
Page  632: 3.    Set the memory address in the DMA_SxMA0R register (and in the DMA_SxMA1R
Page  632: 4.    Configure the total number of data items to be transferred in the DMA_SxNDTR
Page  632: 5.    Use DMAMUX1 to route a DMA request line to the DMA channel.
Page  632: the PFCTRL bit in the DMA_SxCR register.
Page  632: 7.    Configure the stream priority using the PL[1:0] bits in the DMA_SxCR register.
Page  633: RM0433                                                        Direct memory access controller (DMA)
Page  633: DMA_SxCR register.
Page  633: 10. Activate the stream by setting the EN bit in the DMA_SxCR register.
Page  633: As soon as the stream is enabled, it can serve any DMA request from the peripheral
Page  633: Warning:   To switch off a peripheral connected to a DMA stream
Page  633: request, it is mandatory to, first, switch off the DMA stream to
Page  633: The DMA controller can detect the following errors:
Page  633: –     a bus error occurs during a DMA read or a write access
Page  633: because requests and transfers are internally managed by the DMA)
Page  633: the DMA_SxCR register is cleared. This flag is set when a DMA request occurs while
Page  634: Direct memory access controller (DMA)                                                             RM0433
Page  634: EN bit in the corresponding stream configuration register (DMA_SxCR).
Page  634: by resetting the EN bit in the DMA_SxCR register. This is because there is no data loss
Page  634: When the stream's error interrupt flag (TEIF, FEIF, DMEIF) in the DMA_LISR or DMA_HISR
Page  634: FEIE, DMIE) in the DMA_SxCR or DMA_SxFCR register is set.
Page  634: 14.4       DMA interrupts
Page  634: For each DMA stream, an interrupt can be produced on the following events:
Page  634: Table 108. DMA interrupt requests
Page  635: RM0433                                                                        Direct memory access controller (DMA)
Page  635: 14.5             DMA registers
Page  635: The DMA registers have to be accessed by words (32 bits).
Page  635: 14.5.1           DMA low interrupt status register (DMA_LISR)
Page  635: DMA_LIFCR register.
Page  635: DMA_LIFCR register.
Page  635: DMA_LIFCR register.
Page  635: DMA_LIFCR register.
Page  635: DMA_LIFCR register.
Page  636: Direct memory access controller (DMA)                                                                               RM0433
Page  636: 14.5.2          DMA high interrupt status register (DMA_HISR)
Page  636: DMA_HIFCR register.
Page  636: DMA_HIFCR register.
Page  636: DMA_HIFCR register.
Page  636: DMA_HIFCR register.
Page  636: DMA_HIFCR register.
Page  637: RM0433                                                                                                Direct memory access controller (DMA)
Page  637: 14.5.3               DMA low interrupt flag clear register (DMA_LIFCR)
Page  637: Writing 1 to this bit clears the corresponding TCIFx flag in the DMA_LISR register.
Page  637: Writing 1 to this bit clears the corresponding HTIFx flag in the DMA_LISR register
Page  637: Writing 1 to this bit clears the corresponding TEIFx flag in the DMA_LISR register.
Page  637: Writing 1 to this bit clears the corresponding DMEIFx flag in the DMA_LISR register.
Page  637: Writing 1 to this bit clears the corresponding CFEIFx flag in the DMA_LISR register.
Page  637: 14.5.4               DMA high interrupt flag clear register (DMA_HIFCR)
Page  637: Writing 1 to this bit clears the corresponding TCIFx flag in the DMA_HISR register.
Page  637: Writing 1 to this bit clears the corresponding HTIFx flag in the DMA_HISR register.
Page  637: Writing 1 to this bit clears the corresponding TEIFx flag in the DMA_HISR register.
Page  638: Direct memory access controller (DMA)                                                                                RM0433
Page  638: Writing 1 to this bit clears the corresponding DMEIFx flag in the DMA_HISR register.
Page  638: Writing 1 to this bit clears the corresponding CFEIFx flag in the DMA_HISR register.
Page  638: 14.5.5            DMA stream x configuration register (DMA_SxCR)
Page  638: 0: current target memory is Memory 0 (addressed by the DMA_SxM0AR pointer)
Page  638: 1: current target memory is Memory 1 (addressed by the DMA_SxM1AR pointer)
Page  639: RM0433                                                               Direct memory access controller (DMA)
Page  639: 1: memory target switched at the end of the DMA transfer
Page  640: Direct memory access controller (DMA)                                                                     RM0433
Page  640: 0: DMA is the flow controller
Page  641: RM0433                                                                 Direct memory access controller (DMA)
Page  641: –     on a DMA end of transfer (stream ready to be configured)
Page  641: stream in DMA_LISR or DMA_HISR register must be cleared.
Page  641: 14.5.6          DMA stream x number of data register (DMA_SxNDTR)
Page  641: decrements after each DMA transfer.
Page  642: Direct memory access controller (DMA)                                                                     RM0433
Page  642: 14.5.7          DMA stream x peripheral address register (DMA_SxPAR)
Page  642: These bits are write-protected and can be written only when bit EN = '0' in the DMA_SxCR
Page  642: 14.5.8          DMA stream x memory 0 address register (DMA_SxM0AR)
Page  642: –    the stream is disabled (bit EN= '0' in the DMA_SxCR register) or
Page  642: –    the stream is enabled (EN=’1’ in DMA_SxCR register) and bit CT = '1' in the
Page  642: DMA_SxCR register (in double-buffer mode).
Page  642: 14.5.9          DMA stream x memory 1 address register (DMA_SxM1AR)
Page  643: RM0433                                                                     Direct memory access controller (DMA)
Page  643: –     the stream is disabled (bit EN= '0' in the DMA_SxCR register) or
Page  643: –     the stream is enabled (EN=’1’ in DMA_SxCR register) and bit CT = '0' in the
Page  643: DMA_SxCR register.
Page  643: 14.5.10         DMA stream x FIFO control register (DMA_SxFCR)
Page  643: DMA_SxCR are “10”) and the EN bit in the DMA_SxCR register is ‘1’ because the direct
Page  644: Direct memory access controller (DMA)                                                           RM0433
Page  645: DMA_LISR
Page  645: DMA_HISR
Page  645: DMA_S1CR
Page  645: DMA_S0CR
Page  645: DMA_LIFCR
Page  645: DMA_HIFCR
Page  645: DMA_S0PAR
Page  645: DMA_S0FCR
Page  645: DMA_S1NDTR
Page  645: DMA_S0NDTR
Page  645: DMA_S0M1AR
Page  645: DMA_S0M0AR
Page  645: DMA register map
Page  645: Table 109 summarizes the DMA registers.
Page  645: Table 109. DMA register map and reset values
Page  645: Direct memory access controller (DMA)
Page  646: Direct memory access controller (DMA)                                                                                                                                                                                                                  RM0433
Page  646: Table 109. DMA register map and reset values (continued)
Page  646: DMA_S1PAR                                                                                                               PA[31:0]
Page  646: DMA_S1M0AR                                                                                                            M0A[31:0]
Page  646: DMA_S1M1AR                                                                                                            M1A[31:0]
Page  646: DMA_S1FCR                                                                                                                                                                                                                 FS[2:0]
Page  646: DMA_S2CR
Page  646: DMA_S2NDTR                                                                                                                                                                                  NDT[15:0]
Page  646: DMA_S2PAR                                                                                                               PA[31:0]
Page  646: DMA_S2M0AR                                                                                                            M0A[31:0]
Page  646: DMA_S2M1AR                                                                                                            M1A[31:0]
Page  646: DMA_S2FCR                                                                                                                                                                                                                 FS[2:0]
Page  646: DMA_S3CR
Page  646: DMA_S3NDTR                                                                                                                                                                                  NDT[15:0]
Page  646: DMA_S3PAR                                                                                                               PA[31:0]
Page  646: DMA_S3M0AR                                                                                                            M0A[31:0]
Page  647: RM0433                                                                                                                                              Direct memory access controller (DMA)
Page  647: Table 109. DMA register map and reset values (continued)
Page  647: DMA_S3M1AR                                                                                                                   M1A[31:0]
Page  647: DMA_S3FCR                                                                                                                                                                                                                          FS[2:0]
Page  647: DMA_S4CR
Page  647: DMA_S4NDTR                                                                                                                                                                                         NDT[15:0]
Page  647: DMA_S4PAR                                                                                                                        PA[31:0]
Page  647: DMA_S4M0AR                                                                                                                   M0A[31:0]
Page  647: DMA_S4M1AR                                                                                                                   M1A[31:0]
Page  647: DMA_S4FCR                                                                                                                                                                                                                          FS[2:0]
Page  647: DMA_S5CR
Page  647: DMA_S5NDTR                                                                                                                                                                                         NDT[15:0]
Page  647: DMA_S5PAR                                                                                                                        PA[31:0]
Page  647: DMA_S5M0AR                                                                                                                   M0A[31:0]
Page  647: DMA_S5M1AR                                                                                                                   M1A[31:0]
Page  647: DMA_S5FCR                                                                                                                                                                                                                          FS[2:0]
Page  648: Direct memory access controller (DMA)                                                                                                                                                                                                                  RM0433
Page  648: Table 109. DMA register map and reset values (continued)
Page  648: DMA_S6CR
Page  648: DMA_S6NDTR                                                                                                                                                                                  NDT[15:0]
Page  648: DMA_S6PAR                                                                                                               PA[31:0]
Page  648: DMA_S6M0AR                                                                                                            M0A[31:0]
Page  648: DMA_S6M1AR                                                                                                            M1A[31:0]
Page  648: DMA_S6FCR                                                                                                                                                                                                                 FS[2:0]
Page  648: DMA_S7CR
Page  648: DMA_S7NDTR                                                                                                                                                                                  NDT[15:0]
Page  648: DMA_S7PAR                                                                                                               PA[31:0]
Page  648: DMA_S7M0AR                                                                                                            M0A[31:0]
Page  648: DMA_S7M1AR                                                                                                            M1A[31:0]
Page  648: DMA_S7FCR                                                                                                                                                                                                                 FS[2:0]
Page  649: RM0433                                           Basic direct memory access controller (BDMA)
Page  649: 15       Basic direct memory access controller (BDMA)
Page  649: The basic direct memory access (BDMA) controller is a bus master and system peripheral.
Page  649: The BDMA is used to perform programmable data transfers between memory-mapped
Page  649: The BDMA controller features a single AHB master architecture.
Page  649: There is one instance of BDMA with 8 channels.
Page  649: peripherals. The BDMA includes an arbiter for handling the priority between DMA requests.
Page  649: 15.2     BDMA main features
Page  649: •   Access to D3 domain SRAM and AHB/APB peripherals (BDMA)
Page  649: •   All BDMA channels independently configurable:
Page  649: –    Each channel is associated either with a DMA request signal coming from a
Page  649: any of the three DMA events: transfer complete, half transfer, or transfer error.
Page  649: 15.3     BDMA implementation
Page  649: 15.3.1   BDMA
Page  649: BDMA is implemented with the hardware configuration parameters shown in Table 110.
Page  649: Table 110. BDMA implementation
Page  649: Feature                                       BDMA
Page  650: Basic direct memory access controller (BDMA)                                                                 RM0433
Page  650: 15.3.2         BDMA request mapping
Page  650: The BDMA controller is connected to DMA requests from the AHB/APB peripherals through
Page  650: the DMAMUX peripheral.
Page  650: For the mapping of the different requests, refer to the Section 16.3: DMAMUX
Page  650: 15.4           BDMA functional description
Page  650: 15.4.1         BDMA block diagram
Page  650: The BDMA block diagram is shown in Figure 79.
Page  650: Figure 79. BDMA block diagram
Page  650: BDMA                                  bdma_hclk
Page  650: DMA_CMAR[0..7]
Page  650: bdma_tcif[0..7]
Page  650: DMA_CPAR[0..7]
Page  650: bdma_it[0..7]        Arbiter                 DMA_CCR[0..7]
Page  650: DMA_CNDTR[0..7]
Page  650: bdma_req[0..7]
Page  650: The BDMA controller performs direct memory transfer by sharing the AHB system bus with
Page  650: other system masters. The bus matrix implements round-robin scheduling. DMA requests
Page  650: BDMA target the same destination (memory or peripheral).
Page  650: The BDMA controller is connected to DMA requests from the AHB/APB peripherals through
Page  650: the DMAMUX peripheral.
Page  650: According to its configuration through the AHB slave interface, the BDMA controller
Page  650: arbitrates between the DMA channels and their associated received requests. The BDMA
Page  650: controller also schedules the DMA data transfers over the single AHB port master.
Page  650: The BDMA controller generates an interrupt per channel to the interrupt controller.
Page  651: RM0433                                                 Basic direct memory access controller (BDMA)
Page  651: 15.4.2   BDMA pins and internal signals
Page  651: Table 111. BDMA internal input/output signals
Page  651: bdma_req[x]                 Input      BDMA channel x request
Page  651: bdma_ack[x]                Output      BDMA channel x acknowledge
Page  651: bdma_it[x]                Output      BDMA channel x interrupt
Page  651: 15.4.3   BDMA transfers
Page  651: The software configures the BDMA controller at channel level, in order to perform a block
Page  651: A BDMA block transfer may be requested from a peripheral, or triggered by the software in
Page  651: After an event, the following steps of a single BDMA transfer occur:
Page  651: 1.   The peripheral sends a single DMA request signal to the BDMA controller.
Page  651: 2.   The BDMA controller serves the request, depending on the priority of the channel
Page  651: 3.   As soon as the BDMA controller grants the peripheral, an acknowledge is sent to the
Page  651: peripheral by the BDMA controller.
Page  651: 4.   The peripheral releases its request as soon as it gets the acknowledge from the BDMA
Page  651: 5.   Once the request is de-asserted by the peripheral, the BDMA controller releases the
Page  651: The peripheral may order a further single request and initiate another single BDMA transfer.
Page  651: peripheral initiates the transfer by driving its single request signal to the BDMA controller.
Page  651: The BDMA controller reads then a single data in the memory and writes this data to the
Page  651: For a given channel x, a BDMA block transfer consists of a repeated sequence of:
Page  651: •    a single BDMA transfer, encapsulating two AHB transfers of a single data, over the
Page  651: BDMA AHB bus master:
Page  651: peripheral or memory, and is programmed in the BDMA_CPARx or
Page  651: BDMA_CM0/1ARx register.
Page  652: Basic direct memory access controller (BDMA)                                                      RM0433
Page  652: memory, and is programmed in the BDMA_CPARx or BDMA_CM0/1ARx register.
Page  652: •    post-decrementing of the programmed BDMA_CNDTRx register
Page  652: This sequence is repeated until BDMA_CNDTRx is null.
Page  652: 15.4.4     BDMA arbitration
Page  652: The BDMA arbiter manages the priority between the different channels.
Page  652: triggered), a single BDMA transfer is issued (such as a AHB ‘read followed by write’ transfer
Page  652: •    software: priority of each channel is configured in the BDMA_CCRx register, to one of
Page  652: re arbitration is considered between each single BDMA transfer of this channel x. Whenever
Page  652: there is another concurrent active requested channel, the BDMA arbiter automatically
Page  652: 15.4.5     BDMA channels
Page  652: Each channel may handle a BDMA transfer between a peripheral register located at a fixed
Page  652: A DMA channel is programmed at block transfer level.
Page  652: BDMA_CCRx register.
Page  652: depending on the PINC and MINC bits of the BDMA_CCRx register.
Page  653: RM0433                                             Basic direct memory access controller (BDMA)
Page  653: in the BDMA_CPARx or BDMA_CM0/1ARx register. During transfers, these registers keep
Page  653: If the channel x is configured in non-circular mode, no DMA request is served after the last
Page  653: data transfer (once the number of single data to transfer reaches zero). The DMA channel
Page  653: must be disabled in order to reload a new number of data items into the BDMA_CNDTRx
Page  653: Note:    If the channel x is disabled, the BDMA registers are not reset. The DMA channel registers
Page  653: (BDMA_CCRx, BDMA_CPARx and BDMA_CM0ARx) retain the initial values programmed
Page  653: In circular mode, after the last data transfer, the BDMA_CNDTRx register is automatically
Page  653: reloaded with the base address values from the BDMA_CPARx and BDMA_CM0/1ARx
Page  653: The following sequence is needed to configure a DMA channel x:
Page  653: 1.   Set the peripheral register address in the BDMA_CPARx register.
Page  653: 2.   Set the memory address in the BDMA_CM0ARx register.
Page  653: 3.   Configure the total number of data to transfer in the BDMA_CNDTRx register.
Page  653: 4.   Configure the parameters listed below in the BDMA_CCRx register:
Page  653: 5.   Activate the channel by setting the EN bit in the BDMA_CCRx register.
Page  653: A channel, as soon as enabled, may serve any BDMA request from the peripheral
Page  653: access to the BDMA_CCRx register, to configure and enable the channel.
Page  653: separate write accesses to the BDMA_CCRx register, to disable the channel, then to
Page  653: Some fields of the BDMA_CCRx register are read-only when the EN bit is set to 1.
Page  654: Basic direct memory access controller (BDMA)                                                     RM0433
Page  654: transfer. The BDMA controller is not able to resume an aborted active channel with a
Page  654: To correctly stop and disable a channel, the software clears the EN bit of the BDMA_CCRx
Page  654: BDMA controller before the transfer completion. The software waits for the transfer
Page  654: When a channel transfer error occurs, the EN bit of the BDMA_CCRx register is cleared by
Page  654: TEIFx bit of the BDMA_CxISR register is set.
Page  654: ADC scan mode). This feature is enabled using the CIRC bit in the BDMA_CCRx register.
Page  654: BDMA_CCRx register. When the circular mode is activated, the amount of data to transfer is
Page  654: phase, and the DMA requests continue to be served.
Page  654: DMA requests (such as quit the ADC scan mode), before disabling the DMA channel.
Page  654: The software must explicitly program the BDMA_CNDTRx value before starting/enabling a
Page  654: The BDMA channels may operate without being triggered by a request from a peripheral.
Page  654: If the MEM2MEM bit in the BDMA_CCRx register is set, the channel, if enabled, initiates
Page  654: transfers. The transfer stops once the BDMA_CNDTRx register reaches zero.
Page  654: bit of the BDMA_CCRx register.
Page  654: The BDMA channels can operate in double-buffer mode.
Page  654: The difference compared to a regular operation is that the BDMA controller toggles between
Page  654: two memory address pointers at the end of each BDMA transfer, thus accessing two
Page  654: memory areas while the BDMA controller accesses the other one. The double-buffer mode
Page  654: BDMA_CCRx register.
Page  655: RM0433                                             Basic direct memory access controller (BDMA)
Page  655: The steps described below allow the configuration of a BDMA channel x in double-buffer
Page  655: •   Set the DBM and CIRC bits and clear the MEM2MEM bit of the BDMA_CCRx register.
Page  655: •   Configure the second memory address register BDMA_CM1ARx.
Page  655: channel by setting the EN bit of the BDMA_CCRx register. The first BDMA transfer
Page  655: target memory of the corresponding BDMA channel x, is given by the CT bit of the
Page  655: BDMA_CCRx register.
Page  655: Note:    Independently from the value of DBM bit of the BDMA_CCRx register, if CT = 1, the memory
Page  655: address pointer for the BDMA transfer is defined by BDMA_CM1ARx, and not by
Page  655: BDMA_CM0ARx.
Page  655: Any BDMA channel can operate in peripheral-to-peripheral mode:
Page  655: •   when the hardware request from a peripheral is selected to trigger the BDMA channel
Page  655: This peripheral is the BDMA initiator and paces the data transfer from/to this peripheral
Page  655: configured in DMA mode).
Page  655: •   when no peripheral request is selected and connected to the BDMA channel
Page  655: the BDMA_CCRx register.
Page  655: The value of the DIR bit of the BDMA_CCRx register sets the direction of the transfer, and
Page  655: –    The source attributes are defined by the BDMA_MARx register, the MSIZE[1:0]
Page  655: field and MINC bit of the BDMA_CCRx register.
Page  655: –    The destination attributes are defined by the BDMA_PARx register, the
Page  655: PSIZE[1:0] field and PINC bit of the BDMA_CCRx register.
Page  655: –   The source attributes are defined by the BDMA_PARx register, the PSIZE[1:0]
Page  655: field and PINC bit of the BDMA_CCRx register.
Page  655: –    The destination attributes are defined by the BDMA_MARx register, the
Page  655: MSIZE[1:0] field and MINC bit of the BDMA_CCRx register.
Page  656: Basic direct memory access controller (BDMA)                                                                              RM0433
Page  656: 15.4.6             BDMA data width, alignment and endianness
Page  656: When PSIZE[1:0] and MSIZE[1:0] are not equal, the BDMA controller performs some data
Page  656: items to   (BDMA_CM0/1ARx                                DMA transfers
Page  656: if          if                                                                                                 (BDMA_CPARx if
Page  656: (NDT)      BDMA_CPARx)
Page  656: else       else                                                                                                BDMA_CM0/1ARx)
Page  657: RM0433                                             Basic direct memory access controller (BDMA)
Page  657: When the BDMA controller initiates an AHB byte or half-word write transfer, the data are
Page  657: not generate any error, the BDMA controller writes the 32 HWDATA bits as shown in the two
Page  657: •    To write the half-word 0xABCD, the BDMA controller sets the HWDATA bus to
Page  657: •    To write the byte 0xAB, the BDMA controller sets the HWDATA bus to 0xABABABAB
Page  657: 15.4.7   BDMA error management
Page  657: A BDMA transfer error is generated when reading from or writing to a reserved address
Page  657: space. When a BDMA transfer error occurs during a BDMA read or write access, the faulty
Page  657: corresponding BDMA_CCRx register.
Page  657: The TEIFx bit of the BDMA_ISR register is set. An interrupt is then generated if the TEIE bit
Page  657: of the BDMA_CCRx register is set.
Page  657: The EN bit of the BDMA_CCRx register can not be set again by software (channel x re-
Page  657: activated) until the TEIFx bit of the BDMA_ISR register is cleared (by setting the CTEIFx bit
Page  657: of the BDMA_IFCR register).
Page  657: peripheral, the software has first to stop this peripheral in DMA mode, in order to disable any
Page  657: pending or future DMA request. Then software may normally reconfigure both BDMA and
Page  657: the peripheral in DMA mode for a new transfer.
Page  658: Basic direct memory access controller (BDMA)                                                                           RM0433
Page  658: 15.5            BDMA interrupts
Page  658: DMA channel x. Separate interrupt enable bits are available for flexibility.
Page  658: Table 113. BDMA interrupt requests
Page  658: 15.6            BDMA registers
Page  658: The BDMA registers have to be accessed by words (32-bit).
Page  658: 15.6.1          BDMA interrupt status register (BDMA_ISR)
Page  658: or the corresponding global clear bit CGIFx, in the BDMA_IFCR register.
Page  659: RM0433                                                  Basic direct memory access controller (BDMA)
Page  660: Basic direct memory access controller (BDMA)                         RM0433
Page  661: RM0433                                                                    Basic direct memory access controller (BDMA)
Page  661: 15.6.2             BDMA interrupt flag clear register (BDMA_IFCR)
Page  661: Setting the global clear bit CGIFx of the channel x in this BDMA_IFCR register, causes the
Page  661: BDMA hardware to clear the corresponding GIFx bit and any individual flag among TEIFx,
Page  661: HTIFx, TCIFx, in the BDMA_ISR register.
Page  661: Setting any individual clear bit among CTEIFx, CHTIFx, CTCIFx in this BDMA_IFCR
Page  661: register, causes the BDMA hardware to clear the corresponding individual flag and the
Page  661: global flag GIFx in the BDMA_ISR register, provided that none of the two other individual
Page  662: Basic direct memory access controller (BDMA)                                                                        RM0433
Page  662: 15.6.3             BDMA channel x configuration register (BDMA_CCRx)
Page  663: RM0433                                                      Basic direct memory access controller (BDMA)
Page  663: Bit 16 CT: current target memory of DMA transfer in double-buffer mode
Page  663: 0: memory 0 (addressed by the BDMA_CM0AR pointer)
Page  663: 1: memory 1 (addressed by the BDMA_CM1AR pointer)
Page  663: 0: disabled (no memory address switch at the end of the BDMA transfer)
Page  663: 1: enabled (memory address switched at the end of the BDMA transfer)
Page  663: Defines the data size of each DMA transfer to the identified memory.
Page  664: Basic direct memory access controller (BDMA)                                                                 RM0433
Page  664: Defines the data size of each DMA transfer to the identified peripheral.
Page  664: Defines the increment mode for each DMA transfer to the identified memory.
Page  664: Defines the increment mode for each DMA transfer to the identified peripheral.
Page  665: RM0433                                                Basic direct memory access controller (BDMA)
Page  665: –      Source attributes are defined by PSIZE and PINC, plus the BDMA_CPARx register.
Page  665: –      Destination attributes are defined by MSIZE and MINC, plus the BDMA_CM0/1ARx
Page  665: –      Destination attributes are defined by PSIZE and PINC, plus the BDMA_CPARx
Page  665: –      Source attributes are defined by MSIZE and MINC, plus the BDMA_CM0/1ARx
Page  665: by software (channel x re-activated) until the TEIFx bit of the BDMA_ISR register is cleared
Page  665: (by setting the CTEIFx bit of the BDMA_IFCR register).
Page  666: Basic direct memory access controller (BDMA)                                                                      RM0433
Page  666: 15.6.4          BDMA channel x number of data to transfer register
Page  666: (BDMA_CNDTRx)
Page  666: –      It is decremented after each single BDMA ‘read followed by write’ transfer, indicating
Page  666: channel is not in circular mode (CIRC = 0 in the BDMA_CCRx register).
Page  666: 15.6.5          BDMA channel x peripheral address register (BDMA_CPARx)
Page  667: RM0433                                                        Basic direct memory access controller (BDMA)
Page  667: 15.6.6        BDMA channel x memory 0 address register (BDMA_CM0ARx)
Page  668: Basic direct memory access controller (BDMA)                                                                                                                                                                                                                                                    RM0433
Page  668: 15.6.7           BDMA channel x memory 1 address register (BDMA_CM1ARx)
Page  668: 15.6.8           BDMA register map and reset values
Page  668: Table 114 gives the BDMA register map and reset values.
Page  668: Table 114. BDMA register map and reset values
Page  668: BDMA_ISR
Page  668: BDMA_IFCR
Page  668: BDMA_CCR0
Page  668: BDMA_CNDTR0                                                                                                                                                                                                               NDTR[15:0]
Page  668: BDMA_CPAR0                                                                                                                                        PA[31:0]
Page  668: BDMA_CM0AR0                                                                                                                                       MA[31:0]
Page  668: BDMA_CM1AR0                                                                                                                                       MA[31:0]
Page  669: RM0433                                                                                                        Basic direct memory access controller (BDMA)
Page  669: Table 114. BDMA register map and reset values (continued)
Page  669: BDMA_CCR1
Page  669: BDMA_CNDTR1                                                                                                                                                                    NDTR[15:0]
Page  669: BDMA_CPAR1                                                                                                             PA[31:0]
Page  669: BDMA_CM0AR1                                                                                                            MA[31:0]
Page  669: BDMA_CM1AR1                                                                                                            MA[31:0]
Page  669: BDMA_CCR2
Page  669: BDMA_CNDTR2                                                                                                                                                                    NDTR[15:0]
Page  669: BDMA_CPAR2                                                                                                             PA[31:0]
Page  669: BDMA_CM0AR2                                                                                                            MA[31:0]
Page  669: BDMA_CM1AR2                                                                                                            MA[31:0]
Page  669: BDMA_CCR3
Page  669: BDMA_CNDTR3                                                                                                                                                                    NDTR[15:0]
Page  669: BDMA_CPAR3                                                                                                             PA[31:0]
Page  669: BDMA_CM0AR3                                                                                                            MA[31:0]
Page  669: BDMA_CM1AR3                                                                                                            MA[31:0]
Page  669: BDMA_CCR4
Page  669: BDMA_CNDTR4                                                                                                                                                                    NDTR[15:0]
Page  669: BDMA_CPAR4                                                                                                             PA[31:0]
Page  669: BDMA_CM0AR4                                                                                                            MA[31:0]
Page  669: BDMA_CM1AR4                                                                                                            MA[31:0]
Page  670: Basic direct memory access controller (BDMA)                                                                                                                                                                                            RM0433
Page  670: Table 114. BDMA register map and reset values (continued)
Page  670: BDMA_CCR5
Page  670: BDMA_CNDTR5                                                                                                                                                                    NDTR[15:0]
Page  670: BDMA_CPAR5                                                                                                             PA[31:0]
Page  670: BDMA_CM0AR5                                                                                                            MA[31:0]
Page  670: BDMA_CM1AR5                                                                                                            MA[31:0]
Page  670: BDMA_CCR6
Page  670: BDMA_CNDTR6                                                                                                                                                                    NDTR[15:0]
Page  670: BDMA_CPAR6                                                                                                             PA[31:0]
Page  670: BDMA_CM0AR6                                                                                                            MA[31:0]
Page  670: BDMA_CM1AR6                                                                                                            MA[31:0]
Page  670: BDMA_CCR7
Page  670: BDMA_CNDTR7                                                                                                                                                                    NDTR[15:0]
Page  670: BDMA_CPAR7                                                                                                             PA[31:0]
Page  670: BDMA_CM0AR7                                                                                                            MA[31:0]
Page  670: BDMA_CM1AR7                                                                                                            MA[31:0]
Page  671: RM0433                                                         DMA request multiplexer (DMAMUX)
Page  671: 16       DMA request multiplexer (DMAMUX)
Page  671: A peripheral indicates a request for DMA transfer by setting its DMA request signal. The
Page  671: DMA request is pending until it is served by the DMA controller that generates a DMA
Page  671: acknowledge signal, and the corresponding DMA request signal is de-asserted.
Page  671: In this document, the set of control signals required for the DMA request/acknowledge
Page  671: protocol is not explicitly shown or described, and it is referred to as DMA request line.
Page  671: The DMAMUX request multiplexer enables routing a DMA request line between the
Page  671: peripherals and the DMA controllers of the product. The routing function is ensured by a
Page  671: programmable multi-channel DMA request line multiplexer. Each channel selects a unique
Page  671: DMA request line, unconditionally or synchronously with events from its DMAMUX
Page  671: synchronization inputs. The DMAMUX may also be used as a DMA request generator from
Page  671: The number of DMAMUX instances and their main characteristics are specified in
Page  671: The assignment of DMAMUX request multiplexer inputs to the DMA request lines from
Page  671: peripherals and to the DMAMUX request generator outputs, the assignment of DMAMUX
Page  671: request multiplexer outputs to DMA controller channels, and the assignment of DMAMUX
Page  671: 16.2     DMAMUX main features
Page  671: •    Up to 16-channel programmable DMA request line multiplexer output
Page  671: •    Up to 8-channel DMA request generator
Page  671: •    Up to 32 trigger inputs to DMA request generator
Page  671: •    Per DMA request generator channel:
Page  671: –   DMA request trigger input selector
Page  671: –   DMA request counter
Page  671: –   Event overrun flag for selected DMA request trigger input
Page  671: •    Per DMA request line multiplexer channel output:
Page  671: –   Up to 107 input DMA request lines from peripherals
Page  671: –   One DMA request line output
Page  671: –   DMA request counter
Page  671: –   One event output, for DMA request chaining
Page  672: DMA request multiplexer (DMAMUX)                                                                      RM0433
Page  672: 16.3       DMAMUX implementation
Page  672: 16.3.1     DMAMUX1 and DMAMUX2 instantiation
Page  672: The product integrates two instances of DMA request multiplexer:
Page  672: •    DMAMUX1 for DMA1 and DMA2 (D2 domain)
Page  672: •    DMAMUX2 for BDMA (D3 domain)
Page  672: DMAMUX1 and DMAMUX2 are instantiated with the hardware configuration parameters
Page  672: Table 115. DMAMUX1 and DMAMUX2 instantiation
Page  672: Feature                                DMAMUX1            DMAMUX2
Page  672: Number of DMAMUX output request channels                      16                 8
Page  672: Number of DMAMUX request generator channels                     8                 8
Page  672: Number of DMAMUX request trigger inputs                   8                  32
Page  672: Number of DMAMUX synchronization inputs                      8                  16
Page  672: Number of DMAMUX peripheral request inputs                    107                12
Page  672: 16.3.2     DMAMUX1 mapping
Page  672: The mapping of resources to DMAMUX1 is hardwired.
Page  672: DMAMUX1 is used with the DMA1 and DMA2 in D2 domain:
Page  672: •    DMAMUX1 channels 0 to 7 are connected to DMA1 channels 0 to 7
Page  672: •    DMAMUX1 channels 8 to 15 are connected to DMA2 channels 0 to 7
Page  672: Table 116. DMAMUX1: assignment of multiplexer inputs to resources
Page  672: DMA                               DMA                              DMA
Page  672: 1        dmamux1_req_gen0         44          usart2_tx_dma         87       sai1a_dma
Page  672: 2        dmamux1_req_gen1         45          usart3_rx_dma         88       sai1b_dma
Page  672: 3        dmamux1_req_gen2         46          usart3_tx_dma         89       sai2a_dma
Page  672: 4        dmamux1_req_gen3         47           TIM8_CH1             90       sai2b_dma
Page  672: 5        dmamux1_req_gen4         48           TIM8_CH2             91     swpmi_rx_dma
Page  672: 6        dmamux1_req_gen5         49           TIM8_CH3             92     swpmi_tx_dma
Page  672: 7        dmamux1_req_gen6         50           TIM8_CH4             93     spdifrx_dat_dma
Page  672: 8        dmamux1_req_gen7         51            TIM8_UP             94     spdifrx_ctrl_dma
Page  672: 9             adc1_dma            52           TIM8_TRIG            95       HR_REQ(1)
Page  672: 10             adc2_dma            53           TIM8_COM             96       HR_REQ(2)
Page  673: RM0433                                                          DMA request multiplexer (DMAMUX)
Page  673: Table 116. DMAMUX1: assignment of multiplexer inputs to resources (continued)
Page  673: DMA                              DMA                              DMA
Page  673: 15              TIM1_UP           58           TIM5_CH4           101         dfsdm1_dma0
Page  673: 16             TIM1_TRIG          59           TIM5_UP            102         dfsdm1_dma1
Page  673: 17             TIM1_COM           60          TIM5_TRIG           103         dfsdm1_dma2
Page  673: 18             TIM2_CH1           61          spi3_rx_dma         104         dfsdm1_dma3
Page  673: 19             TIM2_CH2           62          spi3_tx_dma         105          TIM15_CH1
Page  673: 20             TIM2_CH3           63       uart4_rx_dma           106           TIM15_UP
Page  673: 21             TIM2_CH4           64       uart4_tx_dma           107          TIM15_TRIG
Page  673: 22              TIM2_UP           65       uart5_rx_dma           108          TIM15_COM
Page  673: 23             TIM3_CH1           66       uart5_tx_dma           109          TIM16_CH1
Page  673: 24             TIM3_CH2           67       dac_ch1_dma             110          TIM16_UP
Page  673: 25             TIM3_CH3           68       dac_ch2_dma             111         TIM17_CH1
Page  673: 27              TIM3_UP           70           TIM7_UP             113         sai3_a_dma
Page  673: 28             TIM3_TRIG          71       usart6_rx_dma           114         sai3_b_dma
Page  673: 29             TIM4_CH1           72       usart6_tx_dma           115          adc3_dma
Page  673: 30             TIM4_CH2           73          i2c3_rx_dma          116          Reserved
Page  673: 31             TIM4_CH3           74          i2c3_tx_dma          117          Reserved
Page  673: 32              TIM4_UP           75           dcmi_dma            118          Reserved
Page  673: 33             i2c1_rx_dma        76          cryp_in_dma          119          Reserved
Page  673: 34             i2c1_tx_dma        77       cryp_out_dma           120           Reserved
Page  673: 35             i2c2_rx_dma        78          hash_in_dma         121           Reserved
Page  673: 36             i2c2_tx_dma        79       uart7_rx_dma           122           Reserved
Page  673: 37             spi1_rx_dma        80       uart7_tx_dma           123           Reserved
Page  673: 38             spi1_tx_dma        81       uart8_rx_dma           124           Reserved
Page  673: 39             spi2_rx_dma        82       uart8_tx_dma           125           Reserved
Page  673: 40             spi2_tx_dma        83          spi4_rx_dma         126           Reserved
Page  673: 41          usart1_rx_dma         84          spi4_tx_dma         127           Reserved
Page  673: 42          usart1_tx_dma         85          spi5_rx_dma           -                -
Page  673: 43          usart2_rx_dma         86          spi5_tx_dma           -                -
Page  673: Table 117. DMAMUX1: assignment of trigger inputs to resources
Page  673: 0                 dmamux1_evt0                  4                      lptim2_out
Page  673: 1                 dmamux1_evt1                  5                      lptim3_out
Page  674: DMA request multiplexer (DMAMUX)                                                          RM0433
Page  674: Table 117. DMAMUX1: assignment of trigger inputs to resources (continued)
Page  674: 2             dmamux1_evt2               6                  extit0
Page  674: Table 118. DMAMUX1: assignment of synchronization inputs to resources
Page  674: 0             dmamux1_evt0               4                lptim2_out
Page  674: 1             dmamux1_evt1               5                lptim3_out
Page  674: 2             dmamux1_evt2               6                  extit0
Page  674: 16.3.3     DMAMUX2 mapping
Page  674: DMAMUX2 channels 0 to 7 are connected to BDMA channels 0 to 7.
Page  674: Table 119. DMAMUX2: assignment of multiplexer inputs to resources
Page  674: DMA request                               DMA request
Page  674: 1            dmamux2_req_gen0            17               adc3_dma
Page  674: 2            dmamux2_req_gen1            18                Reserved
Page  674: 3            dmamux2_req_gen2            19                Reserved
Page  674: 4            dmamux2_req_gen3            20                Reserved
Page  674: 5            dmamux2_req_gen4            21                Reserved
Page  674: 6            dmamux2_req_gen5            22                Reserved
Page  674: 7            dmamux2_req_gen6            23                Reserved
Page  674: 8            dmamux2_req_gen7            24                Reserved
Page  674: 9              lpuart1_rx_dma            25                Reserved
Page  674: 10             lpuart1_tx_dma            26                Reserved
Page  674: 11              spi6_rx_dma              27                Reserved
Page  674: 12              spi6_tx_dma              28                Reserved
Page  674: 13              i2c4_rx_dma              29                Reserved
Page  674: 14              i2c4_tx_dma              30                Reserved
Page  674: 15              sai4_a_dma               31                Reserved
Page  674: 16              sai4_b_dma               32                Reserved
Page  675: RM0433                                                   DMA request multiplexer (DMAMUX)
Page  675: Table 120. DMAMUX2: assignment of trigger inputs to resources
Page  675: 0                dmamux2_evt0               16             spi6_wkup
Page  675: 1                dmamux2_evt1               17             Comp1_out
Page  675: 2                dmamux2_evt2               18             Comp2_out
Page  675: 3                dmamux2_evt3               19             RTC_wkup
Page  675: 4                dmamux2_evt4               20          Syscfg_exti0_mux
Page  675: 5                dmamux2_evt5               21          Syscfg_exti2_mux
Page  675: 6                dmamux2_evt6               22            I2c4_event_it
Page  675: 12                 lptim3_out               28            bdma_ch0_it
Page  675: 13                 Lptim4_ait               29            bdma_ch1_it
Page  675: Table 121. DMAMUX2: assignment of synchronization inputs to resources
Page  675: 0                dmamux2_evt0               16             Reserved
Page  675: 1                dmamux2_evt1               17             Reserved
Page  675: 2                dmamux2_evt2               18             Reserved
Page  675: 3                dmamux2_evt3               19             Reserved
Page  675: 4                dmamux2_evt4               20             Reserved
Page  675: 5                dmamux2_evt5               21             Reserved
Page  676: DMA request multiplexer (DMAMUX)                                                                                          RM0433
Page  676: 16.4              DMAMUX functional description
Page  676: 16.4.1            DMAMUX block diagram
Page  676: Figure 80 shows the DMAMUX block diagram.
Page  676: Figure 80. DMAMUX block diagram
Page  676: dmamux_hclk
Page  676: DMAMUX                                                     Request multiplexer
Page  676: DMAMUX_CmCR
Page  676: DMA requests                                                       eq
Page  676: DMAMUX_C0CR
Page  676: dmamux_req_inx                                                                         Channel Ctrl
Page  676: n+p+2                        m   DMA requests
Page  676: 1   to DMA controllers:
Page  676: Request generator                                                              dmamux_req_outx
Page  676: dmamux_req_genx
Page  676: DMAMUX_RGCnCR                                 n+2                         m
Page  676: DMA channels
Page  676: dmamux_evtx
Page  676: DMAMUX_RGC1CR
Page  676: DMAMUX_RGC0CR
Page  676: dmamux_trgx                dmamux_ovr_it                 dmamux_syncx
Page  676: DMAMUX features two main sub-blocks: the request line multiplexer and the request line
Page  676: •    DMAMUX request multiplexer sub-block inputs (dmamux_reqx) from peripherals
Page  676: (dmamux_req_inx) and from channels of the DMAMUX request generator sub-block
Page  676: (dmamux_req_genx)
Page  676: •    DMAMUX request outputs to channels of DMA controllers (dmamux_req_outx)
Page  676: •    Internal or external signals to DMA request trigger inputs (dmamux_trgx)
Page  676: •    Internal or external signals to synchronization inputs (dmamux_syncx)
Page  677: RM0433                                                         DMA request multiplexer (DMAMUX)
Page  677: 16.4.2   DMAMUX signals
Page  677: Table 122 lists the DMAMUX signals.
Page  677: Table 122. DMAMUX signals
Page  677: dmamux_hclk        DMAMUX AHB clock
Page  677: dmamux_req_inx       DMAMUX DMA request line inputs from peripherals
Page  677: dmamux_trgx        DMAMUX DMA request triggers inputs (to request generator sub-block)
Page  677: dmamux_req_genx      DMAMUX request generator sub-block channels outputs
Page  677: DMAMUX request multiplexer sub-block inputs (from peripheral
Page  677: dmamux_reqx
Page  677: dmamux_syncx        DMAMUX synchronization inputs (to request multiplexer sub-block)
Page  677: dmamux_req_outx      DMAMUX requests outputs (to DMA controllers)
Page  677: dmamux_evtx        DMAMUX events outputs
Page  677: dmamux_ovr_it       DMAMUX overrun interrupts
Page  677: 16.4.3   DMAMUX channels
Page  677: A DMAMUX channel is a DMAMUX request multiplexer channel that may include,
Page  677: depending on the selected input of the request multiplexer, an additional DMAMUX request
Page  677: A DMAMUX request multiplexer channel is connected and dedicated to one single channel
Page  677: of DMA controller(s).
Page  677: The following sequence should be followed to configure both a DMAMUX x channel and the
Page  677: related DMA channel y:
Page  677: 1.   Set and configure completely the DMA channel y, except enabling the channel y.
Page  677: 2.   Set and configure completely the related DMAMUX y channel.
Page  677: 3.   Last, activate the DMA channel y by setting the EN bit in the DMA y channel register.
Page  677: 16.4.4   DMAMUX request line multiplexer
Page  677: The DMAMUX request multiplexer with its multiple channels ensures the actual routing of
Page  677: DMA request/acknowledge control signals, named DMA request lines.
Page  677: Each DMA request line is connected in parallel to all the channels of the DMAMUX request
Page  677: A DMA request is sourced either from the peripherals or from the DMAMUX request
Page  677: The DMAMUX request line multiplexer channel x selects the DMA request line number as
Page  677: configured by the DMAREQ_ID field in the DMAMUX_CxCR register.
Page  678: DMA request multiplexer (DMAMUX)                                                                  RM0433
Page  678: Note:      The null value in the field DMAREQ_ID corresponds to no DMA request line selected. It is
Page  678: not allowed to configure a same non-null DMAREQ_ID to two different channels of the
Page  678: DMAMUX request line multiplexer.
Page  678: On top of the DMA request selection, the synchronization mode and/or the event generation
Page  678: Each DMAMUX request line multiplexer channel x can be individually synchronized by
Page  678: setting the synchronization enable (SE) bit in the DMAMUX_CxCR register.
Page  678: DMAMUX has multiple synchronization inputs. The synchronization inputs are connected in
Page  678: The synchronization input is selected via the SYNC_ID field in the DMAMUX_CxCR register
Page  678: When a channel is in this synchronization mode, the selected input DMA request line is
Page  678: DMAMUX_CxCR register.
Page  678: Additionally, there is a programmable DMA request counter, internally to the DMAMUX
Page  678: through the EGE bit (event generation enable) of the DMAMUX_CxCR register.
Page  678: selected input DMA request line is connected to the DMAMUX multiplexer channel x output.
Page  678: Note:      If a synchronization event occurs while there is no pending selected input DMA request line,
Page  678: DMAMUX multiplexer channel output until a synchronization event occurs again.
Page  678: From this point on, each time the connected DMAMUX request is served by the DMA
Page  678: controller (a served request is de-asserted), the DMAMUX request counter is decremented.
Page  678: At its underrun, the DMA request counter is automatically loaded with the value in NBREQ
Page  678: field of the DMAMUX_CxCR register and the input DMA request line is disconnected from
Page  678: Thus, the number of DMA requests transferred to the multiplexer channel x output following
Page  679: RM0433                                                                              DMA request multiplexer (DMAMUX)
Page  679: Figure 81. Synchronization mode of the DMAMUX request line multiplexer channel
Page  679: Selected DMA request line transferred to the output
Page  679: DMA requests served
Page  679: DMA request pending
Page  679: dmamux_reqx
Page  679: dmamux_syncx
Page  679: dmamux_req_outx
Page  679: DMA request counter              4                   3             2             1           0                4
Page  679: dmamux_evtx
Page  679: DMA request counter underrun
Page  679: DMA request counter auto-reload to NBREQ
Page  679: Input DMA request line connected to output
Page  679: Input DMA request line disconnected from output
Page  679: Example: DMAMUX_CCRx configured with: NBREQ=4, SE=1, EGE=1, SPOL=01 (rising edge)
Page  679: Figure 82. Event generation of the DMA request line multiplexer channel
Page  679: Selected DMA request line transferred to the output
Page  679: DMA request pending
Page  679: dmamux_reqx                                                                                              Not pending
Page  679: dmamux_req_outx
Page  679: DMA request counter                 3       2   1       0     3        2    1       0   3       2   1            0
Page  679: dmamux_evtx
Page  679: DMA request counter reaches zero
Page  679: DMA request counter auto-reloads with NBREQ value
Page  679: Example with: DMAMUX_CCRx configured with: NBREQ=3, SE=0, EGE=1
Page  679: AHB clock cycle, when its DMA request counter is automatically reloaded with the value of
Page  680: DMA request multiplexer (DMAMUX)                                                               RM0433
Page  680: Note:      If EGE is enabled and NBREQ = 0, an event is generated after each served DMA request.
Page  680: Upon writing into DMAMUX_CxCR register, the synchronization events are masked during
Page  680: If a new synchronization event occurs while the value of the DMA request counter is lower
Page  680: overrun flag bit SOFx is set in the DMAMUX_CSR status register.
Page  680: (DMAMUX_CxCR.SE = 0) at the completion of the use of the related channel of the DMA
Page  680: overrun due to the absence of a DMA acknowledge (that is, no served request) received
Page  680: from the DMA controller.
Page  680: bit CSOFx in the DMAMUX_CFR register.
Page  680: overrun interrupt enable bit SOIE is set in the DMAMUX_CxCR register.
Page  680: 16.4.5     DMAMUX request generator
Page  680: The DMAMUX request generator produces DMA requests following trigger events on its
Page  680: DMA request trigger inputs.
Page  680: The DMAMUX request generator has multiple channels. DMA request trigger inputs are
Page  680: The outputs of DMAMUX request generator channels are inputs to the DMAMUX request
Page  680: Each DMAMUX request generator channel x has an enable bit GE (generator enable) in the
Page  680: corresponding DMAMUX_RGxCR register.
Page  680: The DMA request trigger input for the DMAMUX request generator channel x is selected
Page  680: through the SIG_ID (trigger signal ID) field in the corresponding DMAMUX_RGxCR register.
Page  680: Trigger events on a DMA request trigger input can be rising edge, falling edge or either
Page  680: corresponding DMAMUX_RGxCR register.
Page  680: Upon the trigger event, the corresponding generator channel starts generating DMA
Page  680: requests on its output. Each time the DMAMUX generated request is served by the
Page  680: connected DMA controller (a served request is de-asserted), a built-in (inside the DMAMUX
Page  680: request generator) DMA request counter is decremented. At its underrun, the request
Page  680: generator channel stops generating DMA requests and the DMA request counter will be
Page  680: Thus, the number of DMA requests generated after the trigger event is GNBREQ+1.
Page  681: RM0433                                                              DMA request multiplexer (DMAMUX)
Page  681: Upon writing into DMAMUX_RGxCR register, the trigger events are masked during three
Page  681: If a new DMA request trigger event occurs while the value of the DMAMUX request
Page  681: DMAMUX_RGSR register.
Page  681: Note:         The request generator channel x shall be disabled (DMAMUX_RGxCR.GE = 0) at the
Page  681: completion of the usage of the related channel of the DMA controller. Else, upon a new
Page  681: (that is, no served request) received from the DMA.
Page  681: DMAMUX_RGCFR register.
Page  681: Setting the DMAMUX request trigger overrun flag generates an interrupt if the DMA request
Page  681: trigger event overrun interrupt enable bit OIE is set in the DMAMUX_RGxCR register.
Page  681: 16.5          DMAMUX interrupts
Page  681: •    a synchronization event overrun in each DMA request line multiplexer channel
Page  681: •    a trigger event overrun in each DMA request generator channel
Page  681: Table 123. DMAMUX interrupts
Page  681: DMAMUX request line multiplexer
Page  681: dmamuxovr_it
Page  681: DMAMUX request generator
Page  682: DMA request multiplexer (DMAMUX)                                                                                    RM0433
Page  682: 16.6            DMAMUX registers
Page  682: Refer to the table containing register boundary addresses for the DMAMUX1 and
Page  682: DMAMUX2 base address.
Page  682: DMAMUX registers may be accessed per (8-bit) byte, (16-bit) half-word, or (32-bit) word.
Page  682: 16.6.1          DMAMUX1 request line multiplexer channel x configuration register
Page  682: (DMAMUX1_CxCR)
Page  682: Res.    Res.     Res.   Res.   Res.   Res.     EGE     SOIE     Res.                      DMAREQ_ID[6:0]
Page  682: Selects the synchronization input (see Table 118: DMAMUX1: assignment of synchronization
Page  682: Bits 23:19 NBREQ[4:0]: Number of DMA requests minus 1 to forward
Page  682: Defines the number of DMA requests to forward to the DMA controller after a synchronization
Page  682: event, and/or the number of DMA requests before an output event is generated.
Page  683: RM0433                                                                           DMA request multiplexer (DMAMUX)
Page  683: Bits 6:0 DMAREQ_ID[6:0]: DMA request identification
Page  683: Selects the input DMA request. See the DMAMUX table about assignments of multiplexer
Page  683: 16.6.2          DMAMUX2 request line multiplexer channel x configuration register
Page  683: (DMAMUX2_CxCR)
Page  683: Res.    Res.     Res.   Res.   Res.      Res.   EGE       SOIE   Res.   Res.      Res.            DMAREQ_ID[4:0]
Page  683: Selects the synchronization input. (C.f. table: DMAMUX- assignments of synchronization
Page  683: Bits 23:19 NBREQ[4:0]: Number of DMA requests minus 1 to forward
Page  683: Defines the number of DMA requests to forward to the DMA controller after a synchronization
Page  683: event, and/or the number of DMA requests before an output event is generated.
Page  683: Bits 4:0 DMAREQ_ID[4:0]: DMA request identification
Page  683: Selects the input DMA request. C.f. the DMAMUX table about assignments of multiplexer
Page  684: DMA request multiplexer (DMAMUX)                                                                                                      RM0433
Page  684: 16.6.3            DMAMUX1 request line multiplexer interrupt channel status register
Page  684: (DMAMUX1_CSR)
Page  684: The flag is set when a synchronization event occurs on a DMA request line multiplexer
Page  684: channel x, while the DMA request counter value is lower than NBREQ.
Page  684: The flag is cleared by writing 1 to the corresponding CSOFx bit in DMAMUX_CFR register.
Page  684: For DMAMUX2_CFR bits 15:8 are reserved.
Page  684: 16.6.4            DMAMUX2 request line multiplexer interrupt channel status register
Page  684: (DMAMUX2_CSR)
Page  684: secure mode of the considered DMAMUX2 request line multiplexer channel x, depending on
Page  684: the secure control bit of the connected DMA controller channel y, and considering that the
Page  684: DMAMUX2 x channel output is connected to the y channel of the DMA (refer to the
Page  684: DMAMXUX2 mapping implementation section).
Page  684: to the privileged mode of the considered DMAMUX2 request line multiplexer channel x,
Page  684: depending on the privileged control bit of the connected DMA controller channel y, and
Page  684: considering that the DMAMUX2 x channel output is connected to the y channel of the DMA
Page  684: (refer to the DMAMXUX2 mapping implementation section).
Page  684: The flag is set when a synchronization event occurs on a DMA request line multiplexer
Page  684: channel x, while the DMA request counter value is lower than NBREQ.
Page  684: The flag is cleared by writing 1 to the corresponding CSOFx bit in DMAMUX2_CFR register.
Page  685: RM0433                                                                                                        DMA request multiplexer (DMAMUX)
Page  685: 16.6.5           DMAMUX1 request line multiplexer interrupt clear flag register
Page  685: (DMAMUX1_CFR)
Page  685: Writing 1 in each bit clears the corresponding overrun flag SOFx in the DMAMUX_CSR
Page  685: 16.6.6           DMAMUX2 request line multiplexer interrupt clear flag register
Page  685: (DMAMUX2_CFR)
Page  685: secure mode of the considered DMAMUX request line multiplexer channel x, depending on
Page  685: the secure control bit of the connected DMA controller channel y, and considering that the
Page  685: DMAMUX x channel output is connected to the y channel of the DMA (refer to the
Page  685: DMAMXUX mapping implementation section).
Page  685: the privileged mode of the considered DMAMUX request line multiplexer channel x,
Page  685: depending on the privileged control bit of the connected DMA controller channel y, and
Page  685: considering that the DMAMUX x channel output is connected to the y channel of the DMA
Page  685: (refer to the DMAMXUX mapping implementation section).
Page  685: Writing 1 in each bit clears the corresponding overrun flag SOFx in the DMAMUX2_CSR
Page  686: DMA request multiplexer (DMAMUX)                                                                                    RM0433
Page  686: 16.6.7           DMAMUX1 request generator channel x configuration register
Page  686: (DMAMUX1_RGxCR)
Page  686: Bits 23:19 GNBREQ[4:0]: Number of DMA requests to be generated (minus 1)
Page  686: Defines the number of DMA requests to be generated after a trigger event. The actual
Page  686: number of generated DMA requests is GNBREQ+1.
Page  686: Bits 18:17 GPOL[1:0]: DMA request generator trigger polarity
Page  686: Bit 16 GE: DMA request generator channel x enable
Page  686: 0: DMA request generator channel x disabled
Page  686: 1: DMA request generator channel x enabled
Page  686: Selects the DMA request trigger input used for the channel x of the DMA request generator
Page  686: 16.6.8           DMAMUX2 request generator channel x configuration register
Page  686: (DMAMUX2_RGxCR)
Page  686: of the considered DMAMUX request line multiplexer channel y it is assigned to, and
Page  686: considering that the DMAMUX request generator x channel output is selected by the y
Page  686: channel of the DMAMUX request line channel (see the DMAREQ_ID field of the
Page  686: DMAMUX2_CyCR register and the DMAMUX mapping implementation section).
Page  687: RM0433                                                                      DMA request multiplexer (DMAMUX)
Page  687: privileged mode of the considered DMAMUX request line multiplexer channel y it is
Page  687: assigned to, and considering that the DMAMUX request generator x channel output is
Page  687: selected by the y channel of the DMAMUX request line channel (see the DMAREQ_ID field
Page  687: of the DMAMUX2_CyCR register and the DMAMXUX mapping implementation section).
Page  687: First, set/update the number of DMA requests to be generated (bits GNBREQ[4:0]), enable
Page  687: Bits 23:19 GNBREQ[4:0]: Number of DMA requests to be generated (minus 1)
Page  687: Defines the number of DMA requests to be generated after a trigger event. The actual
Page  687: number of generated DMA requests is GNBREQ+1.
Page  687: Bits 18:17 GPOL[1:0]: DMA request generator trigger polarity
Page  687: Bit 16 GE: DMA request generator channel x enable
Page  687: 0: DMA request generator channel x disabled
Page  687: 1: DMA request generator channel x enabled
Page  687: Selects the DMA request trigger input used for the channel x of the DMA request generator
Page  688: DMA request multiplexer (DMAMUX)                                                                              RM0433
Page  688: 16.6.9           DMAMUX1 request generator interrupt status register
Page  688: (DMAMUX1_RGSR)
Page  688: The flag is set when a trigger event occurs on DMA request generator channel x, while the
Page  688: DMA request generator counter value is lower than GNBREQ.
Page  688: The flag is cleared by writing 1 to the corresponding COFx bit in the DMAMUX_RGCFR
Page  688: 16.6.10          DMAMUX2 request generator interrupt status register
Page  688: (DMAMUX2_RGSR)
Page  688: The flag is set when a trigger event occurs on DMA request generator channel x, while the
Page  688: DMA request generator counter value is lower than GNBREQ.
Page  688: The flag is cleared by writing 1 to the corresponding COFx bit in the DMAMUX2_RGCFR
Page  689: RM0433                                                                    DMA request multiplexer (DMAMUX)
Page  689: 16.6.11        DMAMUX1 request generator interrupt clear flag register
Page  689: (DMAMUX1_RGCFR)
Page  689: Writing 1 in each bit clears the corresponding overrun flag OFx in the DMAMUX_RGSR
Page  689: 16.6.12        DMAMUX2 request generator interrupt clear flag register
Page  689: (DMAMUX2_RGCFR)
Page  689: Writing 1 in each bit clears the corresponding overrun flag OFx in the DMAMUX2_RGSR
Page  690: DMA request multiplexer (DMAMUX)                                                                                                                                                                                                           RM0433
Page  690: 16.6.13         DMAMUX register map
Page  690: The following table summarizes the DMAMUX registers and reset values. Refer to the
Page  690: register boundary address table for the DMAMUX register base address.
Page  690: Table 124. DMAMUX register map and reset values
Page  690: DMAMUX_C0CR(1)(2)                                                                      NBREQ[4:0]                                                                                                               DMAREQ_ID[6:0]
Page  690: DMAMUX_C1CR(1)(2)
Page  690: NBREQ[4:0]                                                                                                               DMAREQ_ID[6:0]
Page  690: DMAMUX_C2CR(1)(2)
Page  690: NBREQ[4:0]                                                                                                               DMAREQ_ID[6:0]
Page  690: DMAMUX_C3CR(1)(2)                                                                      NBREQ[4:0]                                                                                                               DMAREQ_ID[6:0]
Page  690: DMAMUX_C4CR                                                                            NBREQ[4:0]                                                                                                               DMAREQ_ID[6:0]
Page  690: DMAMUX_C5CR(1)(2)
Page  690: NBREQ[4:0]                                                                                                               DMAREQ_ID[6:0]
Page  690: DMAMUX_C6CR(1)(2)                                                                      NBREQ[4:0]                                                                                                               DMAREQ_ID[6:0]
Page  690: DMAMUX_C7CR                                                                            NBREQ[4:0]                                                                                                               DMAREQ_ID[6:0]
Page  690: DMAMUX_C8CR                                                                            NBREQ[4:0]                                                                                                               DMAREQ_ID[6:0]
Page  690: DMAMUX_C9CR(3)                                                                         NBREQ[4:0]                                                                                                               DMAREQ_ID[6:0]
Page  690: DMAMUX_C10CR(3)
Page  690: NBREQ[4:0]                                                                                                               DMAREQ_ID[6:0]
Page  690: DMAMUX_C11CR                                                                           NBREQ[4:0]                                                                                                               DMAREQ_ID[6:0]
Page  690: DMAMUX_C12CR                                                                           NBREQ[4:0]                                                                                                               DMAREQ_ID[6:0]
Page  690: DMAMUX_C13CR(3)
Page  690: NBREQ[4:0]                                                                                                               DMAREQ_ID[6:0]
Page  690: DMAMUX_C14CR(3)
Page  690: NBREQ[4:0]                                                                                                               DMAREQ_ID[6:0]
Page  690: DMAMUX_C15CR                                                                           NBREQ[4:0]                                                                                                               DMAREQ_ID[6:0]
Page  691: DMAMUX_RG3CR
Page  691: DMAMUX_RG1CR
Page  691: DMAMUX_RGSR
Page  691: DMAMUX_RGSR
Page  691: DMAMUX_CFR(4)
Page  691: DMAMUX_CSR(4)
Page  691: DMAMUX_RGCFR
Page  691: DMAMUX_RGCFR
Page  691: DMAMUX_RG2CR(5)
Page  691: DMAMUX_RG0CR(5)
Page  691: 1. For DMAMUX2 bits 6:5 are reserved.
Page  691: 4. For DMAMUX2 bits 15:8 are reserved.
Page  691: 2. For DMAMUX2 bits 28:24 are for SYNC_ID[4:0]
Page  691: 5. Valid for DMAMUX1. For DMAMUX2 bits 4:0 are for SIG_ID[4:0].
Page  691: 3. Only applies to DMAMUX1. For DMAMUX2 the word is reserved.
Page  691: Table 124. DMAMUX register map and reset values (continued)
Page  691: DMA request multiplexer (DMAMUX)
Page  692: Chrom-Art Accelerator™ controller (DMA2D)                                                        RM0433
Page  692: 17         Chrom-Art Accelerator™ controller (DMA2D)
Page  692: 17.1       DMA2D introduction
Page  692: The Chrom-Art Accelerator™ (DMA2D) is a specialized DMA dedicated to image
Page  692: The DMA2D has its own dedicated memories for CLUTs (color look-up tables).
Page  692: 17.2       DMA2D main features
Page  692: The main DMA2D features are:
Page  693: RM0433                                              Chrom-Art Accelerator™ controller (DMA2D)
Page  693: •   Abort and suspend of DMA2D operations
Page  693: 17.3     DMA2D functional description
Page  693: The DMA2D controller performs direct memory transfer. As an AXI master, it can take the
Page  693: The DMA2D can operate in the following modes:
Page  693: The AHB slave port is used to program the DMA2D controller.
Page  693: The block diagram of the DMA2D is shown in Figure 83: DMA2D block diagram.
Page  694: Chrom-Art Accelerator™ controller (DMA2D)                                                                                 RM0433
Page  694: Figure 83. DMA2D block diagram
Page  694: dma2d_         FG                       32     α 8            X
Page  694: dma2d_
Page  694: dma2d_                                                                         Green                  32/24/16
Page  694: dma2d_                   BG PFC
Page  694: dma2d_                                                             α 32
Page  694: 17.4        DMA2D pins and internal signals
Page  694: Table 125 lists the DMA2D internal signals.
Page  694: Table 125. DMA2D internal input/output signals
Page  694: dma2d_aclk                       Input       32-bit AXI bus clock
Page  694: dma2d_gbl_it                    Output       DMA2D global interrupt
Page  694: dma2d_clut_trg                      Output       CLUT transfer complete (to MDMA)
Page  694: dma2d_tc_trg                    Output       Transfer complete (to MDMA)
Page  694: dma2d_tw_trg                    Output       Transfer watermark (to MDMA)
Page  695: RM0433                                                Chrom-Art Accelerator™ controller (DMA2D)
Page  695: 17.4.1   DMA2D control
Page  695: The DMA2D controller is configured through the DMA2D Control Register (DMA2D_CR)
Page  695: •    Enable/disable the DMA2D interrupt
Page  695: 17.4.2   DMA2D foreground and background FIFOs
Page  695: The DMA2D foreground (FG) FG FIFO and background (BG) FIFO fetch the input data to
Page  695: •    DMA2D foreground memory address register (DMA2D_FGMAR)
Page  695: •    DMA2D foreground offset register (DMA2D_FGOR)
Page  695: •    DMA2D background memory address register (DMA2D_BGMAR)
Page  695: •    DMA2D background offset register (DMA2D_BGBOR)
Page  695: •    DMA2D number of lines register (number of lines and pixel per lines) (DMA2D_NLR)
Page  695: When the DMA2D operates in register-to-memory mode, none of the FIFOs is activated.
Page  695: When the DMA2D operates in memory-to-memory mode (no pixel format conversion nor
Page  695: When the DMA2D operates in memory-to-memory operation with pixel format conversion
Page  695: 17.4.3   DMA2D foreground and background pixel format converter (PFC)
Page  695: DMA2D foreground pixel format converter (PFC) and background pixel format converter
Page  695: DMA2D_FGPFCCR and DMA2D_BGPFCCR, respectively.
Page  696: Chrom-Art Accelerator™ controller (DMA2D)                                                          RM0433
Page  696: to be used for the image generation is fixed and is defined in the DMA2D_FGCOLR for
Page  696: foreground pixels and in the DMA2D_BGCOLR register for background pixels.
Page  697: RM0433                                                        Chrom-Art Accelerator™ controller (DMA2D)
Page  697: AM[1:0] field of the DMA2D_FGPFCCR/DMA2D_BGPFCCR registers as shown in
Page  697: •     replaced by the ALPHA[7:0] value of DMA2D_FGPFCCR/DMA2D_BGPFCCR,
Page  697: DMA2D_FGPFCCR/DMA2D_BGPFCCR divided by 255.
Page  697: 01                                Replaced by value in DMA2D_xxPFCCR
Page  697: 10           Replaced by original value multiplied by the value in DMA2D_xxPFCCR / 255
Page  697: of the DMA2D_FGPFCCR/DMA2D_BGPFCCR registers. This applies also to the Alpha
Page  697: value stored in the DMA2D_FGPFCCR/DMA2D_BGPFCCR and in the CLUT.
Page  697: DMA2D_FGPFCCR/DMA2D_BGPFCCR registers. This applies also to the RGB order used
Page  697: in the CLUT and in the DMA2D_FGCOLR/DMA2D_BGCOLR registers.
Page  698: Chrom-Art Accelerator™ controller (DMA2D)                                                        RM0433
Page  698: 17.4.4     DMA2D foreground and background CLUT interface
Page  698: a)     Program the CLUT address into the DMA2D_FGCMAR register (foreground
Page  698: CLUT) or DMA2D_BGCMAR register (background CLUT)
Page  698: b)     Program the CLUT size in the CS[7:0] field of the DMA2D_FGPFCCR register
Page  698: (foreground CLUT) or DMA2D_BGPFCCR register (background CLUT).
Page  698: c)     Set the START bit of the DMA2D_FGPFCCR register (foreground CLUT) or
Page  698: DMA2D_BGPFCCR register (background CLUT) to start the transfer. During this
Page  698: DMA2D_CR.
Page  698: The application has to program the CLUT manually through the DMA2D AHB slave
Page  698: DMA2D_FGPFCCR register (foreground CLUT) or DMA2D_BGPFCCR register
Page  699: RM0433                                                 Chrom-Art Accelerator™ controller (DMA2D)
Page  699: 17.4.5   DMA2D blender
Page  699: The DMA2D blender blends the source pixels by pair to compute the resulting pixel.
Page  699: DMA2D operating mode defined in MODE[1:0] field of the DMA2D_CR register.
Page  699: 17.4.6   DMA2D output PFC
Page  699: defined in the CM[2:0] field of the DMA2D output pixel format converter configuration
Page  699: register (DMA2D_OPFCCR).
Page  699: of the DMA2D_OPFCCR registers. This applies also to the Alpha value used in the
Page  699: DMA2D_OCOLR.
Page  699: The R and B fields can also be swapped setting the RBS bit of the DMA2D_OPFCCR
Page  699: registers. This applies also to the RGB order used in the DMA2D_OCOLR.
Page  699: 17.4.7   DMA2D output FIFO
Page  700: Chrom-Art Accelerator™ controller (DMA2D)                                                             RM0433
Page  700: •      DMA2D output memory address register (DMA2D_OMAR)
Page  700: •      DMA2D output offset register (DMA2D_OOR)
Page  700: •      DMA2D number of lines register (number of lines and pixel per lines) (DMA2D_NLR)
Page  700: If the DMA2D operates in register-to-memory mode, the configured output rectangle is filled
Page  700: by the color specified in the DMA2D output color register (DMA2D_OCOLR) which contains
Page  700: DMA2D_OPFCCR register.
Page  700: 17.4.8       DMA2D output FIFO byte reordering
Page  700: parallel interface (F(S)MC) directly from the DMA2D.
Page  700: When the byte swapping is activated (SB field of the DMA2D_OPFCR is set), the number of
Page  700: pixel per line (PL field of the DMA2D_NLR) must be even and the output memory address
Page  700: (MA field of the DMA2D_OMAR) must be even, and the output line offset computed in bytes
Page  700: (resulting from LOM field of DMA2D_CR and LO field of DMA2D_OOR values) must be
Page  701: RM0433                                                                 Chrom-Art Accelerator™ controller (DMA2D)
Page  701: This mode is supported without byte reordering by the DMA2D.
Page  702: Chrom-Art Accelerator™ controller (DMA2D)                                                           RM0433
Page  702: 17.4.9       DMA2D AXI master port timer
Page  702: timer configuration register (DMA2D_AMPTCR).
Page  702: 17.4.10      DMA2D transactions
Page  702: DMA2D transactions consist of a sequence of a given number of data transfers. The
Page  702: Each DMA2D data transfer is composed of up to 4 steps:
Page  702: 1.     Data loading from the memory location pointed by the DMA2D_FGMAR register and
Page  702: pixel format conversion as defined in DMA2D_FGCR.
Page  702: 2.     Data loading from a memory location pointed by the DMA2D_BGMAR register and
Page  702: pixel format conversion as defined in DMA2D_BGCR.
Page  702: 4.     Pixel format conversion of the resulting pixels according to the DMA2D_OCR register
Page  702: DMA2D_OMAR register.
Page  702: 17.4.11      DMA2D configuration
Page  702: The DMA2D can operate in any of the four following modes selected through MODE[1:0]
Page  702: bits of the DMA2D_CR register:
Page  703: RM0433                                                 Chrom-Art Accelerator™ controller (DMA2D)
Page  703: The color format is set in the DMA2D_OPFCCR.
Page  703: The DMA2D does not perform any data fetching from any source. It just writes the color
Page  703: defined in the DMA2D_OCOLR register to the area located at the address pointed by the
Page  703: DMA2D_OMAR and defined in the DMA2D_NLR and DMA2D_OOR.
Page  703: In memory-to-memory mode, the DMA2D does not perform any graphical data
Page  703: from the source memory location defined in DMA2D_FGMAR to the destination memory
Page  703: location pointed by DMA2D_OMAR.
Page  703: The color mode programmed in the CM[3:0] bits of the DMA2D_FGPFCCR register defines
Page  703: The size of the area to be transferred is defined by the DMA2D_NLR and DMA2D_FGOR
Page  703: registers for the source, and by DMA2D_NLR and DMA2D_OOR registers for the
Page  703: In this mode, the DMA2D performs a pixel format conversion of the source data and stores
Page  703: The size of the areas to be transferred are defined by the DMA2D_NLR and DMA2D_FGOR
Page  703: registers for the source, and by DMA2D_NLR and DMA2D_OOR registers for the
Page  703: Data are fetched from the location defined in the DMA2D_FGMAR register and processed
Page  703: DMA2D_FGPFCCR register.
Page  703: 1.   Set the CLUT address into the DMA2D_FGCMAR.
Page  703: 2.   Set the CLUT size in the CS[7:0] bits of the DMA2D_FGPFCCR register.
Page  703: 3.   Set the CLUT format (24 or 32 bits) in the CCM bit of the DMA2D_FGPFCCR register.
Page  703: 4.   Start the CLUT loading by setting the START bit of the DMA2D_FGPFCCR register.
Page  703: Once the CLUT loading is complete, the CTCIF flag of the DMA2D_IFR register is raised,
Page  703: and an interrupt is generated if the CTCIE bit is set in DMA2D_CR. The automatic CLUT
Page  703: loading process can not work in parallel with classical DMA2D transfers.
Page  703: access to the CLUT is not possible when a DMA2D transfer is ongoing and uses the CLUT
Page  703: depending on the value programmed in the DMA2D_FGPFCCR register. If the original
Page  704: Chrom-Art Accelerator™ controller (DMA2D)                                                                      RM0433
Page  704: of the DMA2D_FGPFCCR register:
Page  704: DMA2D_FGPFCCR register.
Page  704: DMA2D_FGPFCCR register divided by 255.
Page  704: CM[2:0] field of the DMA2D_OPFCCR register. The output pixel format cannot be the
Page  704: DMA2D_OMAR.
Page  704: memory locations defined by DMA2D_FGMAR and DMA2D_BGMAR.
Page  704: DMA2D_OMAR.
Page  704: defined by DMA2D_BGMAR.
Page  704: The value of the foreground color is given by the DMA2D_FGCOLR register and the alpha
Page  704: fields of the DMA2D_FGPFCR.
Page  705: RM0433                                               Chrom-Art Accelerator™ controller (DMA2D)
Page  705: pointed by DMA2D_OMAR.
Page  705: defined by DMA2D_FGMAR.
Page  705: The value of the background color is given by the DMA2D_BGCOLR register and the alpha
Page  705: fields of the DMA2D_BGPFCR.
Page  705: pointed by DMA2D_OMAR.
Page  705: The DMA2D checks that the configuration is correct before any transfer. The configuration
Page  705: DMA2D_CR is set.
Page  705: •   Foreground CLUT automatic loading: MA bits of DMA2D_FGCMAR are not aligned
Page  705: with CCM of DMA2D_FGPFCCR.
Page  705: •   Background CLUT automatic loading: MA bits of DMA2D_BGCMAR are not aligned
Page  705: with CCM of DMA2D_BGPFCCR
Page  705: memory mode with blending and fixed color FG): MA bits of DMA2D_FGMAR are not
Page  705: aligned with CM of DMA2D_FGPFCCR
Page  705: memory mode with blending and fixed color FG): CM bits of DMA2D_FGPFCCR are
Page  705: memory mode with blending and fixed color FG): PL bits of DMA2D_NLR are odd while
Page  705: CM of DMA2D_FGPFCCR is A4 or L4
Page  705: memory mode with blending and fixed color FG): LO bits of DMA2D_FGOR are odd
Page  705: while CM of DMA2D_FGPFCCR is A4 or L4 and LOM bit of the DMA2D_CR is pixel
Page  706: Chrom-Art Accelerator™ controller (DMA2D)                                                  RM0433
Page  706: blending and fixed color FG): MA bits of DMA2D_BGMAR are not aligned with the CM
Page  706: of DMA2D_BGPFCCR
Page  706: bits of DMA2D_BGPFCCR are invalid
Page  706: bits of DMA2D_NLR odd while CM of DMA2D_BGPFCCR is A4 or L4
Page  706: bits of DMA2D_BGOR are odd while CM of DMA2D_BGPFCCR is A4 or L4 and LOM
Page  706: bit of the DMA2D_CR is pixel mode
Page  706: •   Memory transfer (except in memory to memory mode): MA bits of DMA2D_OMAR are
Page  706: not aligned with CM bits of DMA2D_OPFCCR.
Page  706: •   Memory transfer (except in memory to memory mode): CM bits of DMA2D_OPFCCR
Page  706: •   Memory transfer with byte swapping: PL bits of DMA2D_NLR are odd or MA bits of the
Page  706: DMA2D_OMAR are odd or LO in bytes (resulting from LOM bit of the DMA2D_CR and
Page  706: LO bits of DMA2D_OOR values) are odd while SB bit of DMA2D_OPFCCR is set
Page  706: •   Memory transfer: NL bits of DMA2D_NLR = 0
Page  706: •   Memory transfer: PL bits of DMA2D_NLR = 0
Page  706: •   Memory transfer: MODE bits of DMA2D_CR are invalid
Page  706: DMA2D_FGPFCCR.
Page  706: The DMA2D foreground plane can support 8x8 block based YCbCr as output by the JPEG
Page  707: RM0433                                                Chrom-Art Accelerator™ controller (DMA2D)
Page  707: DMA2D_FGPFCCR register.
Page  707: Once the DMA2D has started with the foreground configured in YCbCr color mode, the first
Page  707: DMA2D performs the loading of the Y MCU as for a classical color mode.
Page  707: 17.4.13   DMA2D transfer control (start, suspend, abort and completion)
Page  707: Once the DMA2D is configured, the transfer can be launched by setting the START bit of the
Page  707: DMA2D_CR register. Once the transfer is completed, the START bit is automatically reset
Page  707: and the TCIF flag of the DMA2D_ISR register is raised. An interrupt can be generated if the
Page  707: TCIE bit of the DMA2D_CR is set.
Page  707: The user application can suspend the DMA2D at any time by setting the SUSP bit of the
Page  707: DMA2D_CR register. The transaction can then be aborted by setting the ABORT bit of the
Page  707: DMA2D_CR register or can be restarted by resetting the SUSP bit of the DMA2D_CR
Page  707: of the DMA2D_CR register. In this case, the TCIF flag is not raised.
Page  707: in the DMA2D_FGPFCCR and DMA2D_BGPFCCR registers.
Page  707: The line number is defined in the LW[15:0] field of the DMA2D_LWR register.
Page  707: When the last pixel of this line has been transferred, the TWIF flag of the DMA2D_ISR
Page  707: register is raised and an interrupt is generated if the TWIE bit of the DMA2D_CR is set.
Page  707: •   AXI master port errors signaled by the TEIF flag of the DMA2D_ISR register.
Page  707: loading or a DMA2D transfer is ongoing) signaled by the CAEIF flag of the
Page  707: DMA2D_ISR register.
Page  707: Both flags are associated to their own interrupt enable flag in the DMA2D_CR register to
Page  707: This feature can be enabled by setting the EN bit in the DMA2D_AMTCR register.
Page  707: The dead time value is stored in the DT[7:0] field of the DMA2D_AMTCR register. This
Page  708: Chrom-Art Accelerator™ controller (DMA2D)                                                     RM0433
Page  708: The update of the dead time value while the DMA2D is running will be taken into account for
Page  708: 17.5       DMA2D interrupts
Page  708: Table 136. DMA2D interrupt requests
Page  709: RM0433                                                               Chrom-Art Accelerator™ controller (DMA2D)
Page  709: 17.6            DMA2D registers
Page  709: 17.6.1          DMA2D control register (DMA2D_CR)
Page  709: Bits 18:16 MODE[2:0]: DMA2D mode
Page  710: Chrom-Art Accelerator™ controller (DMA2D)                                                               RM0433
Page  710: This bit can be used to launch the DMA2D according to the parameters loaded in the
Page  710: bit in DMA2D_CR
Page  711: RM0433                                                               Chrom-Art Accelerator™ controller (DMA2D)
Page  711: 17.6.2          DMA2D Interrupt Status Register (DMA2D_ISR)
Page  711: This bit is set when the START bit of DMA2D_CR, DMA2DFGPFCCR or
Page  711: DMA2D_BGPFCCR is set and a wrong configuration has been programmed.
Page  711: This bit is set when the CLUT copy from a system memory area to the internal DMA2D
Page  711: copied from a system memory to the internal DMA2D.
Page  711: This bit is set when a DMA2D transfer operation is complete (data transfer only).
Page  711: This bit is set when an error occurs during a DMA transfer (data transfer or automatic
Page  712: Chrom-Art Accelerator™ controller (DMA2D)                                                                         RM0433
Page  712: 17.6.3          DMA2D interrupt flag clear register (DMA2D_IFCR)
Page  712: Programming this bit to 1 clears the CEIF flag in the DMA2D_ISR register
Page  712: Programming this bit to 1 clears the CTCIF flag in the DMA2D_ISR register
Page  712: Programming this bit to 1 clears the CAEIF flag in the DMA2D_ISR register
Page  712: Programming this bit to 1 clears the TWIF flag in the DMA2D_ISR register
Page  712: Programming this bit to 1 clears the TCIF flag in the DMA2D_ISR register
Page  712: Programming this bit to 1 clears the TEIF flag in the DMA2D_ISR register
Page  713: RM0433                                                              Chrom-Art Accelerator™ controller (DMA2D)
Page  713: 17.6.4          DMA2D foreground memory address register (DMA2D_FGMAR)
Page  713: 17.6.5          DMA2D foreground offset register (DMA2D_FGOR)
Page  714: Chrom-Art Accelerator™ controller (DMA2D)                                                                                              RM0433
Page  714: 17.6.6          DMA2D background memory address register (DMA2D_BGMAR)
Page  714: 17.6.7          DMA2D background offset register (DMA2D_BGOR)
Page  715: RM0433                                                               Chrom-Art Accelerator™ controller (DMA2D)
Page  715: 17.6.8        DMA2D foreground PFC control register (DMA2D_FGPFCCR)
Page  716: Chrom-Art Accelerator™ controller (DMA2D)                                                               RM0433
Page  716: DMA2D_CR
Page  717: RM0433                                                           Chrom-Art Accelerator™ controller (DMA2D)
Page  717: 17.6.9          DMA2D foreground color register (DMA2D_FGCOLR)
Page  718: Chrom-Art Accelerator™ controller (DMA2D)                                                                                  RM0433
Page  718: 17.6.10         DMA2D background PFC control register (DMA2D_BGPFCCR)
Page  719: RM0433                                                  Chrom-Art Accelerator™ controller (DMA2D)
Page  719: the DMA2D_CR
Page  720: Chrom-Art Accelerator™ controller (DMA2D)                                                                   RM0433
Page  720: 17.6.11         DMA2D background color register (DMA2D_BGCOLR)
Page  720: 17.6.12         DMA2D foreground CLUT memory address register
Page  720: (DMA2D_FGCMAR)
Page  721: RM0433                                                             Chrom-Art Accelerator™ controller (DMA2D)
Page  721: 17.6.13        DMA2D background CLUT memory address register
Page  721: (DMA2D_BGCMAR)
Page  721: 17.6.14        DMA2D output PFC control register (DMA2D_OPFCCR)
Page  722: Chrom-Art Accelerator™ controller (DMA2D)                                                                                RM0433
Page  722: 17.6.15          DMA2D output color register (DMA2D_OCOLR)
Page  723: RM0433                                                  Chrom-Art Accelerator™ controller (DMA2D)
Page  724: Chrom-Art Accelerator™ controller (DMA2D)                                                                    RM0433
Page  724: 17.6.16         DMA2D output memory address register (DMA2D_OMAR)
Page  724: 17.6.17         DMA2D output offset register (DMA2D_OOR)
Page  725: RM0433                                                             Chrom-Art Accelerator™ controller (DMA2D)
Page  725: 17.6.18        DMA2D number of line register (DMA2D_NLR)
Page  725: 17.6.19        DMA2D line watermark register (DMA2D_LWR)
Page  726: Chrom-Art Accelerator™ controller (DMA2D)                                                                     RM0433
Page  726: 17.6.20         DMA2D AXI master timer configuration register (DMA2D_AMTCR)
Page  727: RM0433                                                                                                                    Chrom-Art Accelerator™ controller (DMA2D)
Page  727: 17.6.21       DMA2D register map
Page  727: The following table summarizes the DMA2D registers. Refer to Section 2.3.2 on page 124
Page  727: for the DMA2D register base address.
Page  727: Table 137. DMA2D register map and reset values
Page  727: DMA2D_CR
Page  727: DMA2D_ISR
Page  727: DMA2D_IFCR
Page  727: DMA2D_FGMAR                                                                                                                      MA[31:0]
Page  727: DMA2D_FGOR                                                                                                                                                                                 LO[15:0]
Page  727: DMA2D_BGMAR                                                                                                                      MA[31:0]
Page  727: DMA2D_BGOR                                                                                                                                                                                 LO[15:0]
Page  727: DMA2D_FGPFCCR                   ALPHA[7:0]                                                                                                                    CS[7:0]                                                                      CM[3:0]
Page  727: DMA2D_FGCOLR                    APLHA[7:0]                                                   RED[7:0]                                                   GREEN[7:0]                                                   BLUE[7:0]
Page  727: DMA2D_BGPFCCR                   ALPHA[7:0]                                                                                                                    CS[7:0]                                                                      CM[3:0]
Page  727: DMA2D_BGCOLR                    APLHA[7:0]                                                   RED[7:0]                                                   GREEN[7:0]                                                   BLUE[7:0]
Page  727: DMA2D_FGCMAR                                                                                                                     MA[31:0]
Page  727: DMA2D_BGCMAR                                                                                                                     MA[31:0]
Page  727: DMA2D_OPFCCR                                                                                                                                                                                                                                 CM[2:0]
Page  728: Chrom-Art Accelerator™ controller (DMA2D)                                                                                                                                                                                                                                                                                                                                                           RM0433
Page  728: Table 137. DMA2D register map and reset values (continued)
Page  728: DMA2D_OCOLR
Page  728: DMA2D_OMAR                                                                                                                                                                                                                                                                     MA[31:0]
Page  728: DMA2D_OOR                                                                                                                                                                                                                                                                                                                                        LO[15:0]
Page  728: DMA2D_NLR                                                                                                                                              PL[13:0]                                                                                                                                                                                 NL[15:0]
Page  728: DMA2D_LWR                                                                                                                                                                                                                                                                                                                                       LW[15:0]
Page  728: DMA2D_AMTCR                                                                                                                                                                                                                                                                                                          DT[7:0]
Page  728: 0x0400-   DMA2D_FGCLUT                              APLHA[7:0][255:0]                                                                                                                                RED[7:0][255:0]                                                                                                GREEN[7:0][255:0]                                          BLUE[7:0][255:0]
Page  728: 0x0800-   DMA2D_BGCLUT                              APLHA[7:0][255:0]                                                                                                                                RED[7:0][255:0]                                                                                                GREEN[7:0][255:0]                                          BLUE[7:0][255:0]
Page  731: DMA1 Stream0
Page  731: dma1_it0        18           11           DMA_STR0                                      0x0000 006C
Page  731: DMA1 Stream1
Page  731: dma1_it1        19           12           DMA_STR1                                      0x0000 0070
Page  731: DMA1 Stream2
Page  731: dma1_it2        20           13           DMA_STR2                                      0x0000 0074
Page  731: DMA1 Stream3
Page  731: dma1_it3        21           14           DMA_STR3                                      0x0000 0078
Page  731: DMA1 Stream4
Page  731: dma1_it4        22           15           DMA_STR4                                      0x0000 007C
Page  731: DMA1 Stream5
Page  731: dma1_it5        23           16           DMA_STR5                                      0x0000 0080
Page  731: DMA1 Stream6
Page  731: dma1_it6        24           17           DMA_STR6                                      0x0000 0084
Page  733: DMA1 Stream7
Page  733: dma1_it7       54           47          DMA1_STR7                                      0x0000 00FC
Page  733: dma2_it0       63           56          DMA2_STR0       DMA2 Stream0 interrupt         0x0000 0120
Page  733: dma2_it1       64           57          DMA2_STR1       DMA2 Stream1 interrupt         0x0000 0124
Page  733: dma2_it2       65           58          DMA2_STR2       DMA2 Stream2 interrupt         0x0000 0128
Page  733: dma2_it3       66           59          DMA2_STR3       DMA2 Stream3 interrupt         0x0000 012C
Page  733: dma2_it4       67           60          DMA2_STR4       DMA2 Stream4 interrupt         0x0000 0130
Page  733: dma2_it5       75           68          DMA2_STR5       DMA2 Stream5 interrupt         0x0000 0150
Page  733: dma2_it6       76           69          DMA2_STR6       DMA2 Stream6 interrupt         0x0000 0154
Page  733: dma2_it7       77           70          DMA2_STR7       DMA2 Stream7 interrupt         0x0000 0158
Page  734: dma2d_gbl_it      97           90            DMA2D         DMA2D global interrupt       0x0000 01A8
Page  735: dmamux1_ovr_it     109         102          DMAMUX1_OV       DMAMUX1 overrun interrupt       0x0000 01D8
Page  735: mdma_it        129         122              MDMA         MDMA                            0x0000 0228
Page  735: dmamux2_ovr_it     135         128         DMAMUX2_OVR       DMAMUX2 overrun interrupt       0x0000 0240
Page  736: bdma_ch0_it        136         129          BDMA_CH0        BDMA channel 0 interrupt          0x0000 0244
Page  736: bdma_ch1_it        137         130          BDMA_CH1        BDMA channel 1 interrupt          0x0000 0248
Page  736: bdma_ch2_it        138         131          BDMA_CH2        BDMA channel 2 interrupt          0x0000 024C
Page  736: bdma_ch3_it        139         132          BDMA_CH3        BDMA channel 3 interrupt          0x0000 0250
Page  736: bdma_ch4_it        140         133          BDMA_CH4        BDMA channel 4 interrupt          0x0000 0254
Page  736: bdma_ch5_it        141         134          BDMA_CH5        BDMA channel 5 interrupt          0x0000 0258
Page  736: bdma_ch6_it        142         135          BDMA_CH6        BDMA channel 6 interrupt          0x0000 025C
Page  736: bdma_ch7_it        143         136          BDMA_CH7        BDMA channel 7 interrupt          0x0000 0260
Page  738: interrupt requests to the CPU NVIC and to the D3 domain DMAMUX2, and events to the
Page  738: and generate an interrupt to the D3 domain, i.e. the DMAMUX2
Page  746: Event(x)                                  d3_pendclear_in[0]   (DMA_ch6_evt)
Page  746: D3                                       d3_pendclear_in[1]   (DMA_ch7_evt)
Page  748: 66        BDMA CH0 interrupt                   Direct           CPU only              No(5)
Page  748: 67        BDMA CH1 interrupt                   Direct           CPU only              No(5)
Page  748: 68        BDMA CH2 interrupt                   Direct           CPU only              No(5)
Page  748: 69        BDMA CH3 interrupt                   Direct           CPU only              No(5)
Page  748: 70        BDMA CH4 interrupt                   Direct           CPU only              No(5)
Page  748: 71        BDMA CH5 interrupt                   Direct           CPU only              No(5)
Page  748: 72        BDMA CH6 interrupt                   Direct           CPU only              No(5)
Page  748: 73        BDMA CH7 interrupt                   Direct           CPU only              No(5)
Page  748: 74        DMAMUX2 interrupt                    Direct           CPU only              No(5)
Page  754: 00: DMA ch6 event selected as D3 domain pendclear source
Page  754: 01: DMA ch7 event selected as D3 domain pendclear source
Page  755: 00: DMA ch6 event selected as D3 domain pendclear source
Page  755: 01: DMA ch7 event selected as D3 domain pendclear source
Page  755: 00: DMA ch6 event selected as D3 domain pendclear source
Page  755: 01: DMA ch7 event selected as D3 domain pendclear source
Page  758: 00: DMA ch6 event selected as D3 domain pendclear source
Page  758: 01: DMA ch7 event selected as D3 domain pendclear source
Page  758: 00: DMA ch6 event selected as D3 domain pendclear source
Page  758: 01: DMA ch7 event selected as D3 domain pendclear source
Page  758: 00: DMA ch6 event selected as D3 domain pendclear source
Page  758: 01: DMA ch7 event selected as D3 domain pendclear source
Page  761: 00: DMA ch6 event selected as D3 domain pendclear source
Page  761: 01: DMA ch7 event selected as D3 domain pendclear source
Page  859: •   MDMA trigger generation for FIFO threshold and transfer complete
Page  861: quadspi_ft_trg         Digital output      QUADSPI FIFO threshold trigger for MDMA
Page  861: quadspi_tc_trg         Digital output      QUADSPI transfer complete trigger for MDMA
Page  862: DMA).
Page  863: Cortex or to a DMA.
Page  867: DMA).
Page  868: •   If it is a DMA, a DMA transfer error is generated and the corresponding DMA channel is
Page  870: FIFO level for either MDMA trigger generation or interrupt generation is programmed in the
Page  895: –   Data can be managed by GP-DMA for regular channel conversions with FIFO
Page  897: AHB            adc_dma
Page  898: adc_dma                    Output     ADC DMA requests
Page  923: When the DMA is used for exporting regular sequencer’s data in JAUTO mode, it is
Page  923: necessary to program it in circular mode (CIRC bit set in DMA_CCRx register). If the CIRC
Page  923: bit is reset (single-shot mode), the JAUTO sequence will be stopped upon DMA Transfer
Page  941: was not read (by the CPU or the DMA) before new converted data became available.
Page  941: Managing a sequence of conversion without using the DMA
Page  942: Managing conversions without using the DMA and without overrun
Page  942: Managing conversions using the DMA
Page  942: DMA for conversion of more than one channel. This avoids the loss of the data already
Page  942: When the DMA mode is enabled (DMNGT bit = 01 or 11 in the ADC_CFGR register in single
Page  942: ADC mode or MDMA different from 0b00 in dual ADC mode), a DMA request is generated
Page  942: Despite this, if an overrun occurs (OVSR=1) because the DMA could not serve the DMA
Page  942: transfer request in time, the ADC stops generating DMA requests and the data
Page  942: corresponding to the new conversion is not transferred by the DMA. Which means that all
Page  942: The DMA transfer requests are blocked until the software clears the OVSR bit.
Page  942: Two different DMA modes are proposed depending on the application use and are
Page  942: •    DMA one shot mode (DMNGT bit = 01).
Page  942: This mode is suitable when the DMA is programmed to transfer a fixed number of data.
Page  942: •    DMA circular mode (DMNGT bit = 11)
Page  942: This mode is suitable when programming the DMA in circular mode.
Page  942: DMA one shot mode (DMNGT=01)
Page  942: In this mode, the ADC generates a DMA transfer request each time a new conversion data
Page  942: is available and stops generating DMA requests once the DMA has reached the last DMA
Page  942: transfer (when DMA_EOT interrupt occurs - refer to DMA paragraph) even if a conversion
Page  942: When the DMA transfer is complete (all the transfers configured in the DMA controller have
Page  942: •    No new DMA request is issued to the DMA controller. This avoids generating an
Page  942: •    The DMA is stopped.
Page  943: DMA circular mode (DMNGT=11)
Page  943: In this mode, the ADC generates a DMA transfer request each time a new conversion data
Page  943: is available in the data register, even if the DMA has reached the last DMA transfer. This
Page  943: allows configuring the DMA in circular mode to handle a continuous analog input data
Page  943: DMA with FIFO
Page  943: The output data register has 8 stage FIFO. Two different DMA requests are generated
Page  943: available, “BREQ burst request” generated. DMA2 can be programmed either single
Page  943: line is selected by the DMA2. Please refer to the DMA2 chapter for further information.
Page  953: •    Data read via CPU or DMA with overrun detection
Page  956: in registers to save a DMA resource. This mode is available only with both regular and
Page  961: It is also possible to read the regular data using the DMA. Two methods are possible:
Page  961: •   Using two DMA channels (one for the master and one for the slave). In this case bits
Page  961: –    Configure the DMA master ADC channel to read ADC_DR from the master. DMA
Page  961: –    Configure the DMA slave ADC channel to read ADC_DR from the slave. DMA
Page  961: •    Configuring Dual ADC mode data format DAMDF[1:0] bits, which leaves one DMA
Page  961: –   A single DMA channel is used (the one of the master). Configure the DMA master
Page  961: –   A single DMA request is generated each time both master and slave EOC events
Page  961: –   both EOC flags are cleared when the DMA reads the ADCx_CCR register.
Page  961: will not generate a DMA request.
Page  962: It is possible to use the DMA to handle data in regular simultaneous mode combined with
Page  962: AUTDLY mode, assuming that multi-DMA mode is used: bits DAMDF must be set to 0b10 or
Page  963: recommended to use the MDMA mode.
Page  963: It is also possible to have the regular data transferred by DMA. In this case, individual DMA
Page  963: requests on each ADC cannot be used and it is mandatory to use the MDMA mode, as
Page  963: •   A single DMA channel is used (the one of the master). Configure the DMA master ADC
Page  963: •   A single DMA request is generated each time both master and slave EOC events have
Page  963: •   Both EOC flags are cleared when the DMA reads the ADCx_CCR register.
Page  969: DMA requests in dual ADC mode
Page  969: In all dual ADC modes, it is possible to use two DMA channels (one for the master, one for
Page  969: the slave) to transfer the data, like in single mode (refer to Figure 195: DMA Requests in
Page  969: Figure 195. DMA Requests in regular simultaneous mode when DAMDF=0b00
Page  969: DMA request from ADC Master
Page  969: DMA reads Master      DMA reads Mater
Page  969: DMA request from ADC Slave
Page  969: DMA reads Slave       DMA reads Slave
Page  969: In simultaneous regular and interleaved modes, it is also possible to save one DMA channel
Page  969: and transfer both data using a single DMA channel. For this DAMDF bits must be configured
Page  969: •   DAMDF=0b10, 32-bit format: A single DMA request is generated alternatively when
Page  969: Interleaved dual mode: a DMA request is generated each time a new 32-bit data is
Page  969: 1st DMA request: ADCx_CDR2[31:0] = MST_ADC_DR[31:0]
Page  969: 2nd DMA request: ADCx_CDR2[31:0] = SLV_ADC_DR[31:0]
Page  969: •   DAMDF=0b10, 16-bit format: A single DMA request is generated each time both
Page  970: Interleaved dual mode: a DMA request is generated each time 2 data items are
Page  970: 1st DMA request: ADCx_CDR[31:0] = SLV_ADC_DR[15:0] | MST_ADC_DR[15:0]
Page  970: 2nd DMA request: ADCx_CDR[31:0] = SLV_ADC_DR[15:0] |
Page  970: Figure 196. DMA requests in regular simultaneous mode when DAMDF=0b10
Page  970: DMA request from
Page  970: DMA request from
Page  970: Figure 197. DMA requests in interleaved mode when DAMDF=0b10
Page  970: DMA request from
Page  970: DMA request from
Page  971: the master and slave conversions so that a DMA request is generated and served for
Page  971: on each DMA request (two data items are available), two bytes representing two ADC
Page  971: bit. A new DMA request is issued when 4 new 8-bit values are available.
Page  971: Interleaved dual mode: a DMA request is generated each time 4 data items are
Page  971: 1st DMA request:
Page  971: 2nd DMA request:
Page  971: one of the ADCs, the DMA requests are no longer issued to ensure that all the data
Page  971: DMA one shot mode/ DMA circular mode when Multi ADC mode is selected
Page  971: ADCx_CCR register must also be configured to select between DMA one shot mode and
Page  971: circular mode, as explained in section Section : Managing conversions using the DMA.
Page  989: 01: DMA One Shot Mode selected
Page  989: 11: DMA Circular Mode selected
Page 1015: In MDMA=0b11 mode, bits 15:8 contains SLV_ADC_DR[7:0], bits 7:0 contains
Page 1019: DMACFG
Page 1020: configured in 8- or 12-bit mode and may be used in conjunction with the DMA controller. In
Page 1020: •   DMA capability for each channel including DMA underrun error detection
Page 1022: dac_ch1_dma
Page 1022: dac_ch2_dma
Page 1023: dac_ch1_dma        Bidirectional DAC channel 1 DMA request
Page 1023: dac_ch2_dma        Bidirectional DAC channel 2 DMA request
Page 1027: 25.4.8   DMA requests
Page 1027: Each DAC channel has a DMA capability. Two DMA channels are used to service DAC
Page 1027: channel DMA requests.
Page 1027: When an external trigger (but not a software trigger) occurs while the DMAENx bit is set, the
Page 1027: transfer is complete, and a DMA request is generated.
Page 1027: In dual mode, if both DMAENx bits are set, two DMA requests are generated. If only one
Page 1027: DMA request is needed, only the corresponding DMAENx bit should be set. In this way, the
Page 1027: application can manage both DAC channels in dual mode by using one DMA request and a
Page 1027: unique DMA channel.
Page 1027: As DAC_DHRx to DAC_DORx data transfer occurred before the DMA request, the very first
Page 1027: DMA underrun
Page 1027: The DAC DMA request is not queued so that if a second external trigger arrives before the
Page 1027: is issued and the DMA channelx underrun flag DMAUDRx in the DAC_SR register is set,
Page 1027: The software should clear the DMAUDRx flag by writing 1, clear the DMAEN bit of the used
Page 1027: DMA stream and re-initialize both DMA and DAC channelx to restart the transfer correctly.
Page 1027: The software should modify the DAC trigger conversion frequency or lighten the DMA
Page 1027: workload to avoid a new DMA underrun. Finally, the DAC conversion could be resumed by
Page 1027: enabling both DMA data transfer and conversion trigger.
Page 1027: For each DAC channelx, an interrupt is also generated if its corresponding DMAUDRIEx bit
Page 1039: Sleep                     No effect, DAC can be used with DMA
Page 1039: DMA underrun                      DMAUDRx                          DMAUDRIEx
Page 1040: DMAU    DMAE
Page 1040: DMAU    DMAE
Page 1040: Bit 29 DMAUDRIE2: DAC channel2 DMA underrun interrupt enable
Page 1040: 0: DAC channel2 DMA underrun interrupt disabled
Page 1040: 1: DAC channel2 DMA underrun interrupt enabled
Page 1040: Bit 28 DMAEN2: DAC channel2 DMA enable
Page 1040: 0: DAC channel2 DMA mode disabled
Page 1040: 1: DAC channel2 DMA mode enabled
Page 1042: Bit 13 DMAUDRIE1: DAC channel1 DMA Underrun Interrupt enable
Page 1042: 0: DAC channel1 DMA Underrun Interrupt disabled
Page 1042: 1: DAC channel1 DMA Underrun Interrupt enabled
Page 1042: Bit 12 DMAEN1: DAC channel1 DMA enable
Page 1042: 0: DAC channel1 DMA mode disabled
Page 1042: 1: DAC channel1 DMA mode enabled
Page 1049: CAL_      DMAU
Page 1049: CAL_    DMAU
Page 1050: Bit 29 DMAUDR2: DAC channel2 DMA underrun flag
Page 1050: 0: No DMA underrun error condition occurred for DAC channel2
Page 1050: 1: DMA underrun error condition occurred for DAC channel2 (the currently selected trigger is
Page 1050: driving DAC channel2 conversion at a frequency higher than the DMA service capability
Page 1050: Bit 13 DMAUDR1: DAC channel1 DMA underrun flag
Page 1050: 0: No DMA underrun error condition occurred for DAC channel1
Page 1050: 1: DMA underrun error condition occurred for DAC channel1 (the currently selected trigger is
Page 1050: driving DAC channel1 conversion at a frequency higher than the DMA service capability rate)
Page 1056: DMAUDR2                      Res.                              Res.                              Res.                                                               Res.                              Res.                             Res.                              Res.                              Res.                             Res.                              Res.                               Res.                   DMAUDRIE2           29
Page 1056: Res.                      Res.                              Res.                              Res.                                                               Res.                              Res.                             Res.                              Res.                              Res.                             Res.                              Res.                               Res.                    DMAEN2             28
Page 1056: DMAUDR1                      Res.                              Res.                                                                                                 Res.                              Res.                                                               Res.                              Res.                                                               Res.                               Res.                   DMAUDRIE1           13
Page 1056: Res.                      Res.                              Res.                                                                                                 Res.                              Res.                                                               Res.                              Res.                                                               Res.                               Res.                    DMAEN1             12
Page 1096: through DMA, thus reducing the software overhead.
Page 1097: –    internal sources: ADCs data or memory (CPU/DMA write) data streams
Page 1097: •   DMA may be used to read the conversion data
Page 1099: DMA, interrupt, break                             3) short circuit detection
Page 1100: DMA request      DMA request signal from each DFSDM_FLTx (x=0..3):
Page 1100: dfsdm_dma[3:0]
Page 1101: parallel internal data sources (ADCs or CPU/DMA wire from memory).
Page 1111: •    direct CPU/DMA writing.
Page 1111: data source: internal ADC(a) or direct write by CPU/DMA.
Page 1112: Input from memory (direct CPU/DMA write)
Page 1112: The direct data write into DFSDM_CHyDATINR register by CPU or DMA (DATMPX[1:0]=2)
Page 1112: Data can be written by CPU or DMA into DFSDM_CHyDATINR register:
Page 1112: 2.   DMA data write:
Page 1112: The DMA should be configured in memory-to-memory transfer mode to transfer data
Page 1112: address is the address of DFSDM_CHyDATINR register. Data are transferred at DMA
Page 1112: This DMA transfer is different from DMA used to read DFSDM conversion results. Both
Page 1112: DMA can be used at the same time - first DMA (configured as memory-to-memory
Page 1112: transfer) for input data writings and second DMA (configured as peripheral-to-memory
Page 1112: to empty data register after it has been filled by CPU/DMA. This mode is used together
Page 1112: with 16-bit CPU/DMA access to DFSDM_CHyDATINR register to load one sample per
Page 1112: register. This mode is used together with 32-bit CPU/DMA access to
Page 1120: where: f DATAIN_RATE ...input data rate from ADC or from CPU/DMA
Page 1123: register (by CPU or DMA) and were overwritten by a new injected conversion
Page 1123: register (by CPU or DMA) and were overwritten by a new regular conversion
Page 1125: 29.6            DFSDM DMA transfer
Page 1125: DMA transfer. A DMA transfer for injected conversions is enabled by setting bit JDMAEN=1
Page 1125: in DFSDM_FLTxCR1 register. A DMA transfer for regular conversions is enabled by setting
Page 1125: bit RDMAEN=1 in DFSDM_FLTxCR1 register.
Page 1125: Note:           With a DMA transfer, the interrupt flag is automatically cleared at the end of the injected or
Page 1125: regular conversion (JEOCF or REOCF bit in DFSDM_FLTxISR register) because DMA is
Page 1126: 2: Data to channel y are taken from internal DFSDM_CHyDATINR register by direct CPU/DMA write.
Page 1130: Data can be written by CPU/DMA (if DATMPX[1:0]=2) or directly by internal ADC (if
Page 1130: Data can be written by CPU/DMA (if DATMPX[1:0]=2) or directly by internal ADC (if
Page 1130: AWF                                                                  RDMA                  RCON    RSW
Page 1130: JDMA                          JSW
Page 1131: Bit 21 RDMAEN: DMA channel enabled to read data for the regular conversion
Page 1131: 0: The DMA channel is not enabled to read regular data
Page 1131: 1: The DMA channel is enabled to read regular data
Page 1132: Bit 5 JDMAEN: DMA channel enabled to read data for the injected channel group
Page 1132: 0: The DMA channel is not enabled to read injected data
Page 1132: 1: The DMA channel is enabled to read injected data
Page 1136: This bit is set by hardware. It is cleared when the software or DMA reads DFSDM_FLTxRDATAR.
Page 1136: This bit is set by hardware. It is cleared when the software or DMA reads DFSDM_FLTxJDATAR.
Page 1139: Note:           DMA may be used to read the data from this register. Half-word accesses may be used to
Page 1139: read this register if DMA is activated to read data from this register.
Page 1144: case of parallel data input (from internal ADC or from CPU/DMA write)
Page 1148: RDMAEN
Page 1148: JDMAEN
Page 1149: Res.                            Res.                     Res.                                                    RDMAEN               Res.                                                                                                               21
Page 1149: Res.                                                                                            Res.                     Res.                     Res.                           JDMAEN               Res.                                                           Res.                              Res.               5
Page 1150: RDMAEN
Page 1150: JDMAEN
Page 1151: RDMAEN
Page 1151: JDMAEN
Page 1154: general-purpose DMA channel. The image buffer is managed by the DMA, not by the
Page 1155: dcmi_dma                               DMA
Page 1155: dcmi_dma
Page 1156: dcmi_dma                Digital output     DCMI DMA request
Page 1156: 30.4.3      DMA interface
Page 1156: The DMA interface is active when the CAPTURE bit in the DCMI_CR register is set. A DMA
Page 1159: In order to correctly transfer images into the DMA/RAM buffer, data transfer is synchronized
Page 1159: Transfer can then be continuous, with successive frames transferred by DMA to successive
Page 1159: buffers or the same/circular buffer. To allow the DMA management of successive frames, a
Page 1162: correct transfer of data through the DMA.
Page 1163: since a DMA request is generated each time a complete 32-bit word has been constructed
Page 1163: DMA request is generated.
Page 1168: memory through the DMA. The buffer location and mode (linear or circular
Page 1168: buffer) is controlled through the system DMA.
Page 1168: start of frame and then transfers a single frame through the DMA. At the end of
Page 1169: The camera interface waits for the first start of frame, then a DMA request is
Page 1169: Note: The DMA controller and all DCMI configuration registers should be
Page 1172: 1: An interrupt is generated if the DMA was not able to transfer the last data
Page 1173: 1: An interrupt is generated if the DMA was not able to transfer the last data
Page 1178: requesting a DMA transfer. A 4-word deep FIFO is available to leave enough time for DMA
Page 1178: transfers and avoid DMA overrun conditions.
Page 1181: ltdc_li_it                   Digital output           LCD-TFT line interrupt trigger for MDMA
Page 1216: jpeg_ift_trg                    Digital output              JPEG input FIFO threshold for MDMA
Page 1216: jpeg_ifnf_trg                   Digital output              JPEG input FIFO not full for MDMA
Page 1216: jpeg_oft_trg                    Digital output              JPEG output FIFO threshold for MDMA
Page 1217: jpeg_ofne_trg          Digital output       JPEG output FIFO not empty for MDMA
Page 1217: jpeg_oec_trg           Digital output       JPEG end of conversion for MDMA
Page 1217: •    MDMA trigger
Page 1217: Interrupt or MDMA trigger generation for input FIFO
Page 1217: Input FIFO can be managed using interrupts or MDMA triggers through two flags according
Page 1217: The interrupt or MDMA trigger generation is independent of the START bit of the
Page 1217: interrupt request / MDMA trigger may be pending. The FIFO can be flushed by setting the
Page 1217: •    The MDMA channel must be stopped to prevent unwanted MDMA trigger.
Page 1218: Interrupt or MDMA trigger generation for output FIFO
Page 1218: The output FIFO can be managed using interrupts or MDMA triggers through two flags
Page 1218: •    The MDMA channel must be stopped to prevent unwanted MDMA trigger.
Page 1219: •    MDMA trigger
Page 1219: Interrupt or MDMA trigger generation for input FIFO
Page 1219: Input FIFO can be managed using interrupts or MDMA triggers through two flags according
Page 1219: The interrupt or MDMA trigger generation is independent of the START bit of the
Page 1219: interrupt request / MDMA trigger may be pending. The FIFO can be flushed by setting the
Page 1219: •    The MDMA channel must be stopped to prevent unwanted MDMA trigger.
Page 1219: Interrupt or MDMA trigger generation for output FIFO
Page 1219: Output FIFO can be managed using interrupts or MDMA triggers through two flags
Page 1220: •    The MDMA channel must be stopped to prevent unwanted MDMA trigger.
Page 1244: The CRYP is a 32-bit AHB peripheral. It supports DMA transfers for incoming and outgoing
Page 1244: data (two DMA channels are required). The peripheral also includes input and output FIFOs
Page 1245: –   Automatic data flow control supporting direct memory access (DMA) using two
Page 1246: Banked Registers (IRQ & DMA)
Page 1246: CRYP_DMACR
Page 1246: cryp_in_dma                     DMA
Page 1246: cryp_out_dma                   interface
Page 1247: cryp_in_dma                         IN FIFO DMA burst request/ acknowledge
Page 1247: digital       OUT FIFO DMA burst request/ acknowledge (with single
Page 1247: cryp_out_dma
Page 1257: Appending data using the DMA
Page 1257: 2.   Configure the DMA controller to transfer the input data from the memory and transfer
Page 1257: CRYP DMA interface. The DMA should be configured to set an interrupt on transfer
Page 1257: register, then enable the DMA IN and OUT requests by setting to 1 the DIEN and
Page 1257: DOEN bits in the CRYP_DMACR register.
Page 1257: 4.   All the transfers and processing are managed by the DMA and the cryptographic
Page 1257: processor. The DMA interrupt indicates that the processing is complete. Both FIFOs
Page 1257: Caution:   It is important that DMA controller empties the cryptographic processor output FIFO before
Page 1257: filling up the cryptographic processor input FIFO. To achieve this, the DMA controller should
Page 1265: 1.   If DMA is used, stop the DMA transfers to the IN FIFO by clearing to 0 the DIEN bit in
Page 1265: the CRYP_DMACR register.
Page 1265: 3.   If DMA is used stop the DMA transfers from the OUT FIFO by clearing to 0 the DOEN
Page 1265: bit in the CRYP_DMACR register.
Page 1265: 5.   If DMA is used, save the DMA controller status (such as the pointers to IN and OUT
Page 1265: 1.   If DMA is used, reconfigure the DMA controller to complete the rest of the FIFO IN and
Page 1265: 7.   If DMA is used, enable again DMA requests for the cryptographic processor, by setting
Page 1265: to 1 the DIEN and DOEN bits in the CRYP_DMACR register.
Page 1270: 1.   If DMA is used, stop the DMA transfers to the IN FIFO by clearing to 0 the DIEN bit in
Page 1270: the CRYP_DMACR register.
Page 1270: 3.   If DMA is used, stop the DMA transfers from the OUT FIFO by clearing to 0 the DOEN
Page 1270: bit in the CRYP_DMACR register.
Page 1270: 5.   If DMA is used, save the DMA controller status (such as pointers to IN and OUT data
Page 1270: 1.   If DMA is used, reconfigure the DMA controller to complete the rest of the FIFO IN and
Page 1270: 7.   If DMA is used, enable again the DMA requests from the cryptographic processor, by
Page 1270: setting DIEN and DOEN bits to 1 in the CRYP_DMACR register.
Page 1279: 1.   If DMA is used, stop DMA transfers to the IN FIFO by clearing to 0 the DIEN bit in the
Page 1279: CRYP_DMACR register.
Page 1279: 3.   If DMA is used, stop DMA transfers from the OUT FIFO by clearing to 0 the DOEN bit
Page 1279: in the CRYP_DMACR register.
Page 1279: 6.   If DMA is used, save the DMA controller status (pointers to IN and OUT data transfers,
Page 1279: 1.   If DMA is used, reconfigure the DMA controller to complete the rest of the FIFO IN and
Page 1279: 7.   If DMA is used, enable again cryptographic processor DMA requests by setting to 1 the
Page 1279: DIEN and DOEN bits in the CRYP_DMACR register.
Page 1279: Note:    In Header phase, DMA OUT FIFO transfer is not used.
Page 1286: 1.   If DMA is used, stop the DMA transfers to the IN FIFO by clearing to 0 the DIEN bit in
Page 1286: the CRYP_DMACR register.
Page 1286: 3.   If DMA is used, stop the DMA transfers from the OUT FIFO by clearing to 0 the DOEN
Page 1286: bit in the CRYP_DMACR register.
Page 1286: 6.   If DMA is used, save the DMA controller status (pointers for IN and OUT data transfers,
Page 1286: 1.   If DMA is used, reconfigure the DMA controller to complete the rest of the FIFO IN and
Page 1286: 7.   If DMA is used, enable again cryptographic processor DMA requests by setting to 1 the
Page 1286: DIEN and DOEN bits in the CRYP_DMACR register.
Page 1286: Note:       In Header phase DMA OUT FIFO transfer is not used.
Page 1293: 34.3.19   CRYP DMA interface
Page 1293: The cryptographic processor provides an interface to connect to the DMA (Direct Memory
Page 1293: Access) controller. The DMA operation is controlled through the CRYP DMA control register
Page 1293: (CRYP_DMACR).
Page 1293: Data input using DMA
Page 1293: DMA can be enabled for writing data into the cryptographic peripheral by setting the DIEN
Page 1293: bit in the CRYP_DMACR register. When this bit is set, the cryptographic processor initiates
Page 1293: a DMA request during the INPUT phase each time it requires a word to be written to the
Page 1293: cryptographic processor through the DMA controller.
Page 1293: memory-to-peripheral DMA transfers
Page 1293: DMA channel control
Page 1293: DMA FIFO size            CRYP FIFO_size /2 = 16 bytes
Page 1293: Data output using DMA
Page 1293: To enable the DMA for reading data from AES peripheral, set the DOEN bit in the
Page 1293: CRYP_DMACR register. When this bit is set, the cryptographic processor initiates a DMA
Page 1293: processor to memory through the DMA controller.
Page 1294: peripheral to memory DMA transfers
Page 1294: DMA channel control
Page 1294: DMA FIFO size            CRYP FIFO_size /2 = 16 bytes
Page 1294: DMA mode
Page 1294: When AES is used, the cryptographic processor manages two DMA transfer requests
Page 1294: through cryp_in_dma and cryp_out_dma internal input/output signals, which are
Page 1294: When DES is used, the cryptographic processor manages two DMA transfer requests
Page 1294: through cryp_in_dma and cryp_out_dma internal input/output signals, which are
Page 1294: All request signals are de-asserted if the cryptographic peripheral is disabled or the DMA
Page 1294: CRYP_DMACR register).
Page 1294: Caution:    It is important that DMA controller empties the cryptographic peripheral output FIFO before
Page 1294: filling up the CRYP input FIFO. To achieve it, the DMA controller should be configured so
Page 1295: For more detailed information on DMA operations, refer to Section 34.3.5: CRYP procedure
Page 1302: 34.6.5          CRYP DMA control register (CRYP_DMACR)
Page 1302: Bit 1 DOEN: DMA Output Enable
Page 1302: When this bit is set, DMA requests are automatically generated by the
Page 1302: 0: DMA for outgoing data transfer is disabled
Page 1302: 1: DMA for outgoing data transfer is enabled
Page 1302: Bit 0 DIEN: DMA Input Enable
Page 1302: When this bit is set, DMA requests are automatically generated by the
Page 1302: 0: DMA for incoming data transfer is disabled
Page 1302: 1: DMA for incoming data transfer is enabled
Page 1311: CRYP_DMACR
Page 1314: •    Automatic data flow control with support of direct memory access (DMA) using one
Page 1314: –    Hashing computation suspend/resume mechanism, including using DMA
Page 1315: DMA
Page 1315: hash_in_dma                          interface               Control Logic
Page 1315: hash_in_dma                           digital input/output      DMA burst request/ acknowledge
Page 1318: processor by the DMA or the CPU, the HASH automatically starts computing the message
Page 1318: DMAE to 1 if data are transferred via DMA.
Page 1318: transferred via DMA. Note that the processing of a block can start only once the last
Page 1318: b)   When data are filled by DMA as a single DMA transfer (MDMAT bit=”0”):
Page 1318: HASH_STR register must be written prior to enabling the DMA (see
Page 1318: c)   When data are filled using multiple DMA transfers (MDMAT bit=”1”) :
Page 1318: –    The partial digest computations are triggered as for single DMA transfers.
Page 1318: hardware). It allows the hash processor to receive a new DMA transfer as part of
Page 1319: set MDMAT bit to 0 before the last DMA transfer in order to trigger the final digest
Page 1319: computation as it is done for single DMA transfers (see description before).
Page 1319: Detailed padding sequences with DMA is enabled or disabled are described in
Page 1323: The procedures where the data flow is controlled by software or by DMA are described
Page 1324: When the DMA is not used to load the message into the hash processor, the context can be
Page 1324: Data loaded by DMA
Page 1324: When the DMA is used to load the message into the hash processor, it is not possible to
Page 1324: predict if a DMA transfer is ongoing. The user application must thus stop DMA transfers,
Page 1324: Before interrupting the current message digest calculation using DMA, the application
Page 1324: a)   Clear the DMAE bit to disable the DMA interface.
Page 1324: b)   Wait until the current DMA transfer is complete (wait for DMAS = 0 in the
Page 1324: c)   Disable the corresponding channel in the DMA controller.
Page 1324: To resume processing the interrupted message using DMA, the application must
Page 1324: a)   Reconfigure the DMA controller so that it proceeds with the transfer of the
Page 1324: DMAE bit.
Page 1325: 35.3.9    HASH DMA interface
Page 1325: The hash processor provides an interface to connect to the DMA controller. This DMA can
Page 1325: be used to write data to the HASH by setting the DMAE bit in the HASH_CR register. When
Page 1325: this bit is set, the HASH asserts the burst request signal to the DMA controller when there is
Page 1325: Before starting the DMA transfer, the software must program the number of valid bits in the
Page 1325: DMAS bit in HASH_SR register provides information on the DMA interface activity. This bit
Page 1325: is set with DMAE and cleared when DMAE is cleared to 0 and no DMA transfer is ongoing.
Page 1325: Note:     No interrupt is associated to DMAS bit.
Page 1327: Res.    Res.   MDMAT DINNE                  NBW[3:0]            ALGO[0] MODE     DATATYPE[1:0]   DMAE    INIT     Res.   Res.
Page 1327: Bit 13 MDMAT: Multiple DMA Transfers
Page 1327: This bit is set when hashing large files when multiple DMA transfers are needed.
Page 1327: 0: DCAL is automatically set at the end of a DMA transfer.
Page 1327: 1: DCAL is not automatically set at the end of a DMA transfer.
Page 1328: (DCAL written to 1 or DMA end of transfer).
Page 1328: If the DMA is not used
Page 1328: If the DMA is used
Page 1328: the DMA.
Page 1329: Bit 3 DMAE: DMA enable
Page 1329: 0: DMA transfers disabled
Page 1329: 1: DMA transfers enabled. A DMA request is sent as soon as the hash core is
Page 1329: Setting this bit to 0 while a DMA transfer is on-going is not aborting this current
Page 1329: transfer. Instead, the DMA interface of the HASH remains internally enabled until
Page 1329: Setting INIT bit to 1 does not clear DMAE bit.
Page 1330: DMA is not used (intermediate digest calculation),
Page 1330: •            automatically if the DMA is used.
Page 1330: •            automatically if the DMA is used and MDMAT bit is set to 0.
Page 1336: Res.    Res.    Res.   Res.      Res.   Res.    Res.    Res.   Res.    Res.   Res.    Res.   BUSY    DMAS    DCIS    DINIS
Page 1336: Bit 2 DMAS: DMA Status
Page 1336: This bit provides information on the DMA interface activity. It is set with DMAE
Page 1336: and cleared when DMAE=0 and no DMA transfer is ongoing. No interrupt is
Page 1336: 0: DMA interface is disabled (DMAE=0) and no transfer is ongoing
Page 1336: 1: DMA interface is enabled (DMAE=1) or a transfer is ongoing
Page 1338: .MDMAT
Page 1338: DMAE
Page 1338: DMAS
Page 1340: •   6 DMA requests with up to 14 sources, with a burst mode for multiple registers update
Page 1341: •    DMA controller for automatic accesses to/from the memories, including an HRTIM
Page 1342: 7     DMA burst                                                                                                                                 HRTIM_CHB1
Page 1342: hrtim_dma[6:1]                                                                                Events                10                        Run/Idle
Page 1344: hrtim_dma[6:1]                     DMA requests
Page 1347: Interrupt / DMA request
Page 1349: –      To trigger an IRQ or a DMA request
Page 1351: decreased. When it reaches zero, a REP interrupt or a DMA request is issued if enabled
Page 1354: DMA request when CPTxIE and CPTxDE bits are set in the HRTIM_TIMxDIER register.
Page 1355: Software                                    (IRQ & DMA)
Page 1364: Compare 4                                        Interrupt / DMA request
Page 1364: •        It has a limited set of interrupt / DMA requests: Compare 1..4, repetition, register
Page 1376: An interrupt or a DMA request can be generated in response to a Delayed Idle mode entry.
Page 1382: - Output set/reset interrupt or DMA requests
Page 1383: Master Timer    HRTIM_MCMP1R                                 Burst DMA event
Page 1383: HRTIM_MCMP3R                                 DMA event
Page 1383: HRTIM_TIMxCMP2R                              Burst DMA event
Page 1383: DMA event
Page 1383: 3.    Update done once Burst DMA is completed (see Section 36.3.21 for details). This is
Page 1383: enabled when BRSTDMA[1:0] = 01 in HRTIM_MCR. It is possible to have both
Page 1383: MREPU=1 and BRSTDMA=01.
Page 1383: 4.    Update done when the master counter rolls over following a Burst DMA completion.
Page 1383: This is enabled when BRSTDMA[1:0] = 10 in HRTIM_MCR.
Page 1383: An interrupt or a DMA request can be generated by the master update event.
Page 1384: •   Update done once a Burst DMA is completed. This is enabled when
Page 1384: •   Update done on the update event following a Burst DMA completion (the event can be
Page 1384: An interrupt or a DMA request can be generated by the Timx update event.
Page 1386: Burst DMA end               BRSTDMA[1:0] = 01        No        Must be done in TIMxCR (UPDGAT[3:0] = 0001)
Page 1386: BRSTDMA[1:0] = 10        Yes                               -
Page 1386: a Burst DMA end
Page 1386: Burst DMA end               UPDGAT[3:0] = 0001       No
Page 1388: Burst DMA end            UPDGAT[3:0] = 0001      Yes                     -
Page 1388: roll-over after a Burst DMA    BRSTDMA[1:0] = 10
Page 1392: •     Output set/reset interrupt or DMA requests
Page 1399: simple burst mode controller using the DMA and the HRTIM_CMP1CxR compound register,
Page 1399: by DMA (upon repetition event) two 32-bit data in continuous mode, organized as follows:
Page 1400: DMA                     DMA                                              DMA                     DMA
Page 1404: •      SETxy and RSTxy status flags, together with the corresponding interrupts and DMA
Page 1405: Interrupts and DMA requests
Page 1415: 36.3.21   DMA
Page 1415: Most of the events able to generate an interrupt can also generate a DMA request, even
Page 1415: both simultaneously. Each timer (master, TIMA...E) has its own DMA enable register.
Page 1415: The individual DMA requests are ORed into 6 channels as follows:
Page 1415: Note:     Before disabling a DMA channel (DMA enable bit reset in TIMxDIER), it is necessary to
Page 1415: disable first the DMA controller.
Page 1415: Table 315 is a summary of the events with their associated DMA enable bits.
Page 1415: Table 315. HRTIM DMA request summary
Page 1415: DMA      DMA enable
Page 1415: DMA Channel                             Event
Page 1415: hrtim_dma1
Page 1415: hrtim_dma2 (Timer A)       inactive to active)                        Yes       SETx2DE
Page 1415: hrtim_dma3 (Timer B)
Page 1415: hrtim_dma4 (Timer C)       Capture 1 and 2 events
Page 1415: hrtim_dma5 (Timer D)                                                  Yes       CPT2DE
Page 1415: hrtim_dma6 (Timer E)       Timing unit registers update               Yes       UPDDE
Page 1416: Burst DMA transfers
Page 1416: In addition to the standard DMA requests, the HRTIM features a DMA burst controller to
Page 1416: have multiple registers updated with a single DMA request. This allows to:
Page 1416: •    update multiple data registers with one DMA channel only,
Page 1416: The burst DMA feature is only available for one DMA channel, but any of the 6 channels can
Page 1416: be selected for burst DMA transfers.
Page 1416: The principle is to program which registers are to be written by DMA. The master timer and
Page 1416: TIMA..E have the burst DMA update register, where most of their control and data registers
Page 1416: mechanism allows to forward the DMA write accesses to the HRTIM registers automatically,
Page 1416: Figure 332. DMA burst overview
Page 1416: DMA burst controller
Page 1416: DMA burst            HRTIM_BDTCUPR
Page 1416: DMA requests                 registers
Page 1416: DMA controller
Page 1416: HRTIM_BDMADR
Page 1416: DMA unique
Page 1416: When the DMA trigger occurs, the HRTIM generates multiple 32-bit DMA requests and
Page 1416: the system is ready for another DMA trigger (see the flowchart on Figure 333).
Page 1416: The burst DMA mode is permanently enabled (there is no enable bit). A burst DMA
Page 1416: operation is started by the first write access into the HRTIM_BDMADR register.
Page 1417: It is only necessary to have the DMA controller pointing to the HRTIM_BDMADR register as
Page 1417: To re-initialize the burst DMA mode if it was interrupted during a transaction, it is necessary
Page 1417: Figure 333. Burst DMA operation flowchart
Page 1417: HRTIM_BDMADR
Page 1417: End of DMA burst
Page 1417: Several options are available once the DMA burst is completed, depending on the register
Page 1417: If the PREEN bit is reset (preload disabled), the value written by the DMA is immediately
Page 1417: DMA transaction pace.
Page 1417: 1.   The update is done independently from DMA burst transfers (UPDGAT[3:0] = 0000 in
Page 1417: HRTIM_TIMxCR and BRSTDMA[1:0] = 00 in HRTIM_MCR). In this case, and if it is
Page 1417: check that the DMA burst is completed before the update event takes place. On the
Page 1417: contrary, if the update event happens while the DMA transfer is on-going, only part of
Page 1417: 2.   The update is done when the DMA burst transfer is completed (UPDGAT[3:0] = 0000 in
Page 1417: HRTIM_TIMxCR and BRSTDMA[1:0] = 01 in HRTIM_MCR). This mode guarantees
Page 1418: 3.      The update is done on the update event following the DMA burst transfer completion
Page 1418: (UPDGAT[3:0] = 0010 in HRTIM_TIMxCR and BRSTDMA[1:0] = 10 in HRTIM_MCR).
Page 1418: Figure 334. Registers update following DMA burst transfer
Page 1418: DMA request on CMP1 event
Page 1418: starts DMA burst
Page 1418: DMA requests
Page 1418: DMA controller write
Page 1418: accesses to BDMADR
Page 1418: Option 1: update done at the end of the DMA burst
Page 1418: Option 2: update done at the end of the DMA burst
Page 1420: inputs. DMA triggers are disabled. The burst mode circuit is frozen: the triggers are ignored
Page 1426: BRSTDMA[1:0]    MREPU   Res.   PREEN   DACSYNC[1:0]    Res.   Res.   Res.   TECEN TDCEN TCCEN TBCEN TACEN MCEN
Page 1426: Bits 31:30 BRSTDMA[1:0]: Burst DMA Update
Page 1426: These bits define how the update occurs relatively to a burst DMA transaction.
Page 1426: 00: Update done independently from the DMA burst transfer completion
Page 1426: 01: Update done when the DMA burst transfer is completed
Page 1426: 10: Update done on master timer roll-over following a DMA burst transfer completion. This mode
Page 1426: (either due to roll-over or reset events). MREPU can be set only if BRSTDMA[1:0] = 00 or 01.
Page 1431: 36.5.4           HRTIM Master Timer DMA / Interrupt Enable Register
Page 1431: Bit 22 MUPDDE: Master Update DMA request Enable
Page 1431: This bit is set and cleared by software to enable/disable the Master update DMA requests.
Page 1431: 0: Master update DMA request disabled
Page 1431: 1: Master update DMA request enabled
Page 1431: Bit 21 SYNCDE: Sync Input DMA request Enable
Page 1431: This bit is set and cleared by software to enable/disable the Sync input DMA requests.
Page 1431: 0: Sync input DMA request disabled
Page 1431: 1: Sync input DMA request enabled
Page 1431: Bit 20 MREPDE: Master Repetition DMA request Enable
Page 1431: This bit is set and cleared by software to enable/disable the Master timer repetition DMA requests.
Page 1431: 0: Repetition DMA request disabled
Page 1431: 1: Repetition DMA request enabled
Page 1431: Bit 19 MCMP4DE: Master Compare 4 DMA request Enable
Page 1431: Bit 18 MCMP3DE: Master Compare 3 DMA request Enable
Page 1431: Bit 17 MCMP2DE: Master Compare 2 DMA request Enable
Page 1431: Bit 16 MCMP1DE: Master Compare 1 DMA request Enable
Page 1431: This bit is set and cleared by software to enable/disable the Master timer Compare 1 DMA requests.
Page 1431: 0: Compare 1 DMA request disabled
Page 1431: 1: Compare 1 DMA request enabled
Page 1437: These bits define how the update occurs relatively to the burst DMA transaction and the external
Page 1437: 0000: the update occurs independently from the DMA burst transfer
Page 1437: 0001: the update occurs when the DMA burst transfer is completed
Page 1437: 0010: the update occurs on the update event following the DMA burst transfer completion
Page 1437: concurrent update source (for instance RSTU and DMA burst).
Page 1444: 36.5.15          HRTIM Timerx DMA / Interrupt Enable Register
Page 1444: Bit 30 DLYPRTDE: Delayed Protection DMA request Enable
Page 1444: This bit is set and cleared by software to enable/disable DMA requests on delayed protection.
Page 1444: 0: Delayed protection DMA request disabled
Page 1444: 1: Delayed protection DMA request enabled
Page 1444: Bit 29 RSTDE: Reset/roll-over DMA request Enable
Page 1444: This bit is set and cleared by software to enable/disable DMA requests on timer x counter reset or
Page 1444: 0: Timer x counter reset/roll-over DMA request disabled
Page 1444: 1: Timer x counter reset/roll-over DMA request enabled
Page 1444: Bit 28 RSTx2DE: Output 2 Reset DMA request Enable
Page 1444: Bit 27 SETx2DE: Output 2 Set DMA request Enable
Page 1444: Bit 26 RSTx1DE: Output 1 Reset DMA request Enable
Page 1444: This bit is set and cleared by software to enable/disable Tx1 output reset DMA requests.
Page 1444: 0: Tx1 output reset DMA request disabled
Page 1444: 1: Tx1 output reset DMA request enabled
Page 1444: Bit 25 SETx1DE: Output 1 Set DMA request Enable
Page 1444: This bit is set and cleared by software to enable/disable Tx1 output set DMA requests.
Page 1444: 0: Tx1 output set DMA request disabled
Page 1444: 1: Tx1 output set DMA request enabled
Page 1444: Bit 24 CPT2DE: Capture 2 DMA request Enable
Page 1444: Bit 23 CPT1DE: Capture 1 DMA request Enable
Page 1444: This bit is set and cleared by software to enable/disable Capture 1 DMA requests.
Page 1444: 0: Capture 1 DMA request disabled
Page 1444: 1: Capture 1 DMA request enabled
Page 1444: Bit 22 UPDDE: Update DMA request Enable
Page 1444: This bit is set and cleared by software to enable/disable DMA requests on update event.
Page 1444: 0: Update DMA request disabled
Page 1444: 1: Update DMA request enabled
Page 1445: Bit 20 REPDE: Repetition DMA request Enable
Page 1445: This bit is set and cleared by software to enable/disable DMA requests on repetition event.
Page 1445: 0: Repetition DMA request disabled
Page 1445: 1: Repetition DMA request enabled
Page 1445: Bit 19 CMP4DE: Compare 4 DMA request Enable
Page 1445: Bit 18 CMP3DE: Compare 3 DMA request Enable
Page 1445: Bit 17 CMP2DE: Compare 2 DMA request Enable
Page 1445: Bit 16 CMP1DE: Compare 1 DMA request Enable
Page 1445: This bit is set and cleared by software to enable/disable the Compare 1 DMA requests.
Page 1445: 0: Compare 1 DMA request disabled
Page 1445: 1: Compare 1 DMA request enabled
Page 1502: 36.5.60         HRTIM Burst DMA Master timer update Register
Page 1502: Burst DMA.
Page 1502: 0: MCR register is not updated by Burst DMA accesses
Page 1502: 1: MCR register is updated by Burst DMA accesses
Page 1503: 36.5.61          HRTIM Burst DMA Timerx update Register (HRTIM_BDTxUPR)
Page 1504: Burst DMA.
Page 1504: 0: HRTIM_TIMxCR register is not updated by Burst DMA accesses
Page 1504: 1: HRTIM_TIMxCR register is updated by Burst DMA accesses
Page 1504: 36.5.62       HRTIM Burst DMA Data Register (HRTIM_BDMADR)
Page 1504: BDMADR[31:16]
Page 1504: BDMADR[15:0]
Page 1504: Bits 31:0 BDMADR[31:0]: Burst DMA Data register
Page 1505: BRSTDMA[1:0]
Page 1513: HRTIM_BDMADR
Page 1513: BDMADR[31:0]
Page 1514: •   Interrupt/DMA generation on the following events:
Page 1515: Interrupt & DMA output
Page 1518: setting the UIF flag (thus no interrupt or DMA request is sent). This is to avoid generating
Page 1522: DMA request is sent). This is to avoid generating both update and capture interrupts when
Page 1526: DMA request is sent). This is to avoid generating both update and capture interrupts when
Page 1539: a DMA request can be sent if they are enabled. If a capture occurs while the CCxIF flag was
Page 1539: TIMx_DIER register, and/or the DMA request by setting the CC1DE bit in the
Page 1539: •    A DMA request is generated depending on the CC1DE bit.
Page 1539: Note:    IC interrupt and/or DMA requests can be generated by software by setting the
Page 1541: performed and allows the flag to be set. Interrupt and DMA requests can be sent
Page 1541: •    Sends a DMA request if the corresponding enable bit is set (CCxDE bit in the
Page 1541: TIMx_DIER register, CCDS bit in the TIMx_CR2 register for the DMA request
Page 1553: interrupt is generated if the BIE bit in the TIMx_DIER register is set. A DMA request
Page 1558: generate an interrupt (if the COMIE bit is set in the TIMx_DIER register) or a DMA request
Page 1563: another timer). when available, it is also possible to read its value through a DMA request.
Page 1567: trigger flag is set (TIF bit in the TIMx_SR register) and an interrupt request, or a DMA
Page 1571: 37.3.28   DMA burst mode
Page 1571: The TIMx timers have the capability to generate multiple DMA requests upon a single event.
Page 1571: The DMA controller destination is unique and must point to the virtual register TIMx_DMAR.
Page 1571: On a given timer event, the timer launches a sequence of DMA requests (burst). Each write
Page 1571: into the TIMx_DMAR register is actually redirected to one of the timer registers.
Page 1571: The DBL[4:0] bits in the TIMx_DCR register set the DMA burst length. The timer recognizes
Page 1571: a burst transfer when a read or a write access is done to the TIMx_DMAR address), i.e. the
Page 1571: The DBA[4:0] bits in the TIMx_DCR registers define the DMA base address for DMA
Page 1571: transfers (when read/write access are done through the TIMx_DMAR address). DBA is
Page 1571: As an example, the timer DMA burst feature is used to update the contents of the CCRx
Page 1571: registers (x = 2, 3, 4) upon an update event, with the DMA transferring half words into the
Page 1572: 1.   Configure the corresponding DMA channel as follows:
Page 1572: –    DMA channel peripheral address is the DMAR register address
Page 1572: –    DMA channel memory address is the address of the buffer in the RAM containing
Page 1572: the data to be transferred by DMA into CCRx registers.
Page 1572: 3.   Enable the TIMx update DMA request (set the UDE bit in the DIER register).
Page 1572: 5.   Enable the DMA channel
Page 1572: data6. The data is transferred to the CCRx registers as follows: on the first update DMA
Page 1572: CCR4 and on the second update DMA request, data4 is transferred to CCR2, data5 is
Page 1574: 0: Any of the following events generate an update interrupt or DMA request if enabled.
Page 1574: 1: Only counter overflow/underflow generates an update interrupt or DMA request if
Page 1576: Bit 3 CCDS: Capture/compare DMA selection
Page 1576: 0: CCx DMA request sent when CCx event occurs
Page 1576: 1: CCx DMA requests sent when update event occurs
Page 1579: 37.4.4           TIMx DMA/interrupt enable register (TIMx_DIER)(x = 1, 8)
Page 1580: Bit 14 TDE: Trigger DMA request enable
Page 1580: 0: Trigger DMA request disabled
Page 1580: 1: Trigger DMA request enabled
Page 1580: Bit 13 COMDE: COM DMA request enable
Page 1580: 0: COM DMA request disabled
Page 1580: 1: COM DMA request enabled
Page 1580: Bit 12 CC4DE: Capture/Compare 4 DMA request enable
Page 1580: 0: CC4 DMA request disabled
Page 1580: 1: CC4 DMA request enabled
Page 1580: Bit 11 CC3DE: Capture/Compare 3 DMA request enable
Page 1580: 0: CC3 DMA request disabled
Page 1580: 1: CC3 DMA request enabled
Page 1580: Bit 10 CC2DE: Capture/Compare 2 DMA request enable
Page 1580: 0: CC2 DMA request disabled
Page 1580: 1: CC2 DMA request enabled
Page 1580: Bit 9 CC1DE: Capture/Compare 1 DMA request enable
Page 1580: 0: CC1 DMA request disabled
Page 1580: 1: CC1 DMA request enabled
Page 1580: Bit 8 UDE: Update DMA request enable
Page 1580: 0: Update DMA request disabled
Page 1580: 1: Update DMA request enabled
Page 1583: DMA transfer can occur if enabled.
Page 1583: 1: The TIF flag is set in TIMx_SR register. Related interrupt or DMA transfer can occur if
Page 1584: CC1IF flag is set, Corresponding interrupt or DMA request is sent if enabled.
Page 1584: the corresponding interrupt or DMA request is sent if enabled. The CC1OF flag is set if the
Page 1600: 37.4.19        TIMx DMA control register (TIMx_DCR)(x = 1, 8)
Page 1601: Bits 12:8 DBL[4:0]: DMA burst length
Page 1601: This 5-bit vector defines the length of DMA transfers (the timer recognizes a burst transfer
Page 1601: when a read or a write access is done to the TIMx_DMAR address), i.e. the number of
Page 1601: (TIMx_CR1 address) + DBA + (DMA index), where DMA index = DBL
Page 1601: According to the configuration of the DMA Data Size, several cases may occur:
Page 1601: – If you configure the DMA Data Size in half-words, 16-bit data will be transferred to each of
Page 1601: – If you configure the DMA Data Size in bytes, the data will also be transferred to 7 registers:
Page 1601: DMA.
Page 1601: Bits 4:0 DBA[4:0]: DMA base address
Page 1601: This 5-bits vector defines the base-address for DMA transfers (when read/write access are
Page 1601: done through the TIMx_DMAR address). DBA is defined as an offset starting from the
Page 1601: 37.4.20        TIMx DMA address for full transfer (TIMx_DMAR)(x = 1, 8)
Page 1601: DMAB[31:16]
Page 1601: DMAB[15:0]
Page 1602: Bits 31:0 DMAB[31:0]: DMA register for burst accesses
Page 1602: A read or write operation to the DMAR register accesses the register located at the address
Page 1602: (TIMx_CR1 address) + (DBA + DMA index) x 4
Page 1602: where TIMx_CR1 address is the address of the control register 1, DBA is the DMA base
Page 1602: address configured in TIMx_DCR register, DMA index is automatically controlled by the DMA
Page 1614: TIM1_DMAR
Page 1614: DMAB[15:0]
Page 1617: TIM8_DMAR
Page 1617: DMAB[15:0]
Page 1619: •   Interrupt/DMA generation on the following events:
Page 1620: Interrupt & DMA output
Page 1623: flag (thus no interrupt or DMA request is sent). This is to avoid generating both update and
Page 1626: DMA request is sent). This is to avoid generating both update and capture interrupts when
Page 1630: DMA request is sent). This is to avoid generating both update and capture interrupt when
Page 1639: a DMA request can be sent if they are enabled. If a capture occurs while the CCxIF flag was
Page 1639: TIMx_DIER register, and/or the DMA request by setting the CC1DE bit in the
Page 1639: •    A DMA request is generated depending on the CC1DE bit.
Page 1639: Note:    IC interrupt and/or DMA requests can be generated by software by setting the
Page 1641: performed and allows the flag to be set. Interrupt and DMA requests can be sent
Page 1641: •    Sends a DMA request if the corresponding enable bit is set (CCxDE bit in the
Page 1641: TIMx_DIER register, CCDS bit in the TIMx_CR2 register for the DMA request
Page 1641: 3.   Set the CCxIE and/or CCxDE bits if an interrupt and/or a DMA request is to be
Page 1653: another timer). when available, it is also possible to read its value through a DMA request
Page 1654: trigger flag is set (TIF bit in the TIMx_SR register) and an interrupt request, or a DMA
Page 1661: 38.3.20   DMA burst mode
Page 1661: The TIMx timers have the capability to generate multiple DMA requests upon a single event.
Page 1662: The DMA controller destination is unique and must point to the virtual register TIMx_DMAR.
Page 1662: On a given timer event, the timer launches a sequence of DMA requests (burst). Each write
Page 1662: into the TIMx_DMAR register is actually redirected to one of the timer registers.
Page 1662: The DBL[4:0] bits in the TIMx_DCR register set the DMA burst length. The timer recognizes
Page 1662: a burst transfer when a read or a write access is done to the TIMx_DMAR address), i.e. the
Page 1662: The DBA[4:0] bits in the TIMx_DCR registers define the DMA base address for DMA
Page 1662: transfers (when read/write access are done through the TIMx_DMAR address). DBA is
Page 1662: As an example, the timer DMA burst feature is used to update the contents of the CCRx
Page 1662: registers (x = 2, 3, 4) upon an update event, with the DMA transferring half words into the
Page 1662: 1.   Configure the corresponding DMA channel as follows:
Page 1662: –     DMA channel peripheral address is the DMAR register address
Page 1662: –     DMA channel memory address is the address of the buffer in the RAM containing
Page 1662: the data to be transferred by DMA into CCRx registers.
Page 1662: 3.   Enable the TIMx update DMA request (set the UDE bit in the DIER register).
Page 1662: 5.   Enable the DMA channel
Page 1662: and data6. The data is transferred to the CCRx registers as follows: on the first update DMA
Page 1662: CCR4 and on the second update DMA request, data4 is transferred to CCR2, data5 is
Page 1665: 0: Any of the following events generate an update interrupt or DMA request if enabled.
Page 1665: 1: Only counter overflow/underflow generates an update interrupt or DMA request if
Page 1666: Bit 3 CCDS: Capture/compare DMA selection
Page 1666: 0: CCx DMA request sent when CCx event occurs
Page 1666: 1: CCx DMA requests sent when update event occurs
Page 1670: 38.4.4         TIMx DMA/Interrupt enable register (TIMx_DIER)(x = 2 to 5)
Page 1670: Bit 14 TDE: Trigger DMA request enable
Page 1670: 0: Trigger DMA request disabled.
Page 1670: 1: Trigger DMA request enabled.
Page 1670: Bit 12 CC4DE: Capture/Compare 4 DMA request enable
Page 1670: 0: CC4 DMA request disabled.
Page 1670: 1: CC4 DMA request enabled.
Page 1670: Bit 11 CC3DE: Capture/Compare 3 DMA request enable
Page 1670: 0: CC3 DMA request disabled.
Page 1670: 1: CC3 DMA request enabled.
Page 1670: Bit 10 CC2DE: Capture/Compare 2 DMA request enable
Page 1670: 0: CC2 DMA request disabled.
Page 1670: 1: CC2 DMA request enabled.
Page 1670: Bit 9 CC1DE: Capture/Compare 1 DMA request enable
Page 1670: 0: CC1 DMA request disabled.
Page 1670: 1: CC1 DMA request enabled.
Page 1671: Bit 8 UDE: Update DMA request enable
Page 1671: 0: Update DMA request disabled.
Page 1671: 1: Update DMA request enabled.
Page 1673: 1: The TIF flag is set in TIMx_SR register. Related interrupt or DMA transfer can occur if
Page 1673: CC1IF flag is set, Corresponding interrupt or DMA request is sent if enabled.
Page 1673: the corresponding interrupt or DMA request is sent if enabled. The CC1OF flag is set if the
Page 1684: 38.4.17         TIMx DMA control register (TIMx_DCR)(x = 2 to 5)
Page 1684: Bits 12:8 DBL[4:0]: DMA burst length
Page 1684: This 5-bit vector defines the number of DMA transfers (the timer recognizes a burst transfer
Page 1684: when a read or a write access is done to the TIMx_DMAR address).
Page 1684: Bits 4:0 DBA[4:0]: DMA base address
Page 1684: This 5-bit vector defines the base-address for DMA transfers (when read/write access are
Page 1684: done through the TIMx_DMAR address). DBA is defined as an offset starting from the
Page 1684: 38.4.18         TIMx DMA address for full transfer (TIMx_DMAR)(x = 2 to 5)
Page 1684: DMAB[15:0]
Page 1684: Bits 15:0 DMAB[15:0]: DMA register for burst accesses
Page 1684: A read or write operation to the DMAR register accesses the register located at the address
Page 1684: (TIMx_CR1 address) + (DBA + DMA index) x 4
Page 1684: where TIMx_CR1 address is the address of the control register 1, DBA is the DMA base
Page 1684: address configured in TIMx_DCR register, DMA index is automatically controlled by the
Page 1684: DMA transfer, and ranges from 0 to DBL (DBL configured in TIMx_DCR).
Page 1692: TIMx_DMAR                                                                                                                                                                             DMAB[15:0]
Page 1696: Interrupt & DMA output                                                                                    MSv40931V1
Page 1706: a DMA request can be sent if they are enabled. If a capture occurs while the CCxIF flag was
Page 1746: •   Interrupt/DMA generation on the following events:
Page 1747: •   Interrupt/DMA generation on the following events:
Page 1748: Interrupt & DMA output                                                                                                                                   MSv40934V1
Page 1749: Interrupt & DMA output
Page 1752: setting the UIF flag (thus no interrupt or DMA request is sent). This is to avoid generating
Page 1762: a DMA request can be sent if they are enabled. If a capture occurs while the CCxIF flag was
Page 1762: TIMx_DIER register, and/or the DMA request by setting the CC1DE bit in the
Page 1762: •    A DMA request is generated depending on the CC1DE bit.
Page 1762: Note:       IC interrupt and/or DMA requests can be generated by software by setting the
Page 1764: performed and allows the flag to be set. Interrupt and DMA requests can be sent
Page 1764: •   Sends a DMA request if the corresponding enable bit is set (CCxDE bit in the
Page 1764: TIMx_DIER register, CCDS bit in the TIMx_CR2 register for the DMA request
Page 1772: generated if the BIE bit in the TIMx_DIER register is set. A DMA request can be sent if
Page 1778: trigger flag is set (TIF bit in the TIMx_SR register) and an interrupt request, or a DMA
Page 1780: 40.4.20     DMA burst mode
Page 1780: The TIMx timers have the capability to generate multiple DMA requests on a single event.
Page 1780: The DMA controller destination is unique and must point to the virtual register TIMx_DMAR.
Page 1780: On a given timer event, the timer launches a sequence of DMA requests (burst). Each write
Page 1780: into the TIMx_DMAR register is actually redirected to one of the timer registers.
Page 1781: The DBL[4:0] bits in the TIMx_DCR register set the DMA burst length. The timer recognizes
Page 1781: a burst transfer when a read or a write access is done to the TIMx_DMAR address), i.e. the
Page 1781: The DBA[4:0] bits in the TIMx_DCR registers define the DMA base address for DMA
Page 1781: transfers (when read/write access are done through the TIMx_DMAR address). DBA is
Page 1781: For example, the timer DMA burst feature could be used to update the contents of the CCRx
Page 1781: registers (x = 2, 3, 4) on an update event, with the DMA transferring half words into the
Page 1781: 1.   Configure the corresponding DMA channel as follows:
Page 1781: –     DMA channel peripheral address is the DMAR register address
Page 1781: –     DMA channel memory address is the address of the buffer in the RAM containing
Page 1781: the data to be transferred by DMA into the CCRx registers.
Page 1781: 3.   Enable the TIMx update DMA request (set the UDE bit in the DIER register).
Page 1781: 5.   Enable the DMA channel
Page 1781: and data6. The data is transferred to the CCRx registers as follows: on the first update DMA
Page 1781: CCR4 and on the second update DMA request, data4 is transferred to CCR2, data5 is
Page 1785: Bit 3 CCDS: Capture/compare DMA selection
Page 1785: 0: CCx DMA request sent when CCx event occurs
Page 1785: 1: CCx DMA requests sent when update event occurs
Page 1787: 40.5.4           TIM15 DMA/interrupt enable register (TIM15_DIER)
Page 1787: Bit 14 TDE: Trigger DMA request enable
Page 1787: 0: Trigger DMA request disabled
Page 1787: 1: Trigger DMA request enabled
Page 1787: Bit 13 COMDE: COM DMA request enable
Page 1787: 0: COM DMA request disabled
Page 1787: 1: COM DMA request enabled
Page 1788: Bit 10 CC2DE: Capture/Compare 2 DMA request enable
Page 1788: 0: CC2 DMA request disabled
Page 1788: 1: CC2 DMA request enabled
Page 1788: Bit 9 CC1DE: Capture/Compare 1 DMA request enable
Page 1788: 0: CC1 DMA request disabled
Page 1788: 1: CC1 DMA request enabled
Page 1788: Bit 8 UDE: Update DMA request enable
Page 1788: 0: Update DMA request disabled
Page 1788: 1: Update DMA request enabled
Page 1790: DMA transfer can occur if enabled.
Page 1790: 1: The TIF flag is set in TIMx_SR register. Related interrupt or DMA transfer can occur if
Page 1791: CC1IF flag is set, Corresponding interrupt or DMA request is sent if enabled.
Page 1791: the corresponding interrupt or DMA request is sent if enabled. The CC1OF flag is set if the
Page 1803: 40.5.16        TIM15 DMA control register (TIM15_DCR)
Page 1803: Bits 12:8 DBL[4:0]: DMA burst length
Page 1803: This 5-bit field defines the length of DMA transfers (the timer recognizes a burst transfer
Page 1803: when a read or a write access is done to the TIMx_DMAR address).
Page 1803: Bits 4:0 DBA[4:0]: DMA base address
Page 1803: This 5-bit field defines the base-address for DMA transfers (when read/write access are
Page 1803: done through the TIMx_DMAR address). DBA is defined as an offset starting from the
Page 1803: 40.5.17        TIM15 DMA address for full transfer (TIM15_DMAR)
Page 1803: DMAB[15:0]
Page 1803: Bits 15:0 DMAB[15:0]: DMA register for burst accesses
Page 1803: A read or write operation to the DMAR register accesses the register located at the address
Page 1803: (TIMx_CR1 address) + (DBA + DMA index) x 4
Page 1803: where TIMx_CR1 address is the address of the control register 1, DBA is the DMA base
Page 1803: address configured in TIMx_DCR register, DMA index is automatically controlled by the
Page 1803: DMA transfer, and ranges from 0 to DBL (DBL configured in TIMx_DCR).
Page 1807: TIM15_DMAR
Page 1807: DMAB[15:0]
Page 1808: 0: Any of the following events generate an update interrupt or DMA request if enabled.
Page 1808: 1: Only counter overflow/underflow generates an update interrupt or DMA request if
Page 1809: Bit 3 CCDS: Capture/compare DMA selection
Page 1809: 0: CCx DMA request sent when CCx event occurs
Page 1809: 1: CCx DMA requests sent when update event occurs
Page 1810: 40.6.3          TIMx DMA/interrupt enable register (TIMx_DIER)(x = 16, 17)
Page 1810: Bit 13 COMDE: COM DMA request enable
Page 1810: 0: COM DMA request disabled
Page 1810: 1: COM DMA request enabled
Page 1810: Bit 9 CC1DE: Capture/Compare 1 DMA request enable
Page 1810: 0: CC1 DMA request disabled
Page 1810: 1: CC1 DMA request enabled
Page 1810: Bit 8 UDE: Update DMA request enable
Page 1810: 0: Update DMA request disabled
Page 1810: 1: Update DMA request enabled
Page 1812: DMA transfer can occur if enabled.
Page 1812: CC1IF flag is set, Corresponding interrupt or DMA request is sent if enabled.
Page 1812: the corresponding interrupt or DMA request is sent if enabled. The CC1OF flag is set if the
Page 1822: 40.6.14        TIMx DMA control register (TIMx_DCR)(x = 16, 17)
Page 1823: Bits 12:8 DBL[4:0]: DMA burst length
Page 1823: This 5-bit field defines the length of DMA transfers (the timer recognizes a burst transfer
Page 1823: when a read or a write access is done to the TIMx_DMAR address), i.e. the number of
Page 1823: Bits 4:0 DBA[4:0]: DMA base address
Page 1823: This 5-bit field defines the base-address for DMA transfers (when read/write access are
Page 1823: done through the TIMx_DMAR address). DBA is defined as an offset starting from the
Page 1823: 40.6.15        TIMx DMA address for full transfer (TIMx_DMAR)(x = 16, 17)
Page 1823: DMAB[15:0]
Page 1823: Bits 15:0 DMAB[15:0]: DMA register for burst accesses
Page 1823: A read or write operation to the DMAR register accesses the register located at the address
Page 1823: (TIMx_CR1 address) + (DBA + DMA index) x 4
Page 1823: where TIMx_CR1 address is the address of the control register 1, DBA is the DMA base
Page 1823: address configured in TIMx_DCR register, DMA index is automatically controlled by the
Page 1823: DMA transfer, and ranges from 0 to DBL (DBL configured in TIMx_DCR).
Page 1829: TIMx_DMAR
Page 1829: DMAB[15:0]
Page 1830: •   Interrupt/DMA generation on the update event: counter overflow
Page 1830: Interrupt & DMA output
Page 1833: (so no interrupt or DMA request is sent).
Page 1838: 0: Any of the following events generates an update interrupt or DMA request if enabled.
Page 1838: 1: Only counter overflow/underflow generates an update interrupt or DMA request if
Page 1839: 41.4.3           TIM6/TIM7 DMA/Interrupt enable register (TIMx_DIER)
Page 1839: Bit 8 UDE: Update DMA request enable
Page 1839: 0: Update DMA request disabled.
Page 1839: 1: Update DMA request enabled.
Page 1935: DMA can be used to reduce CPU overload.
Page 1935: •    1-byte buffer with DMA capability
Page 1948: DMA in I2C_CR1
Page 1949: If a TXIS event is needed, (Transmit Interrupt or Transmit DMA request), the user must
Page 1958: Enable interrupts and/or DMA in I2C_CR1
Page 1983: 46.4.16   DMA requests
Page 1983: Transmission using DMA
Page 1983: DMA (Direct Memory Access) can be enabled for transmission by setting the TXDMAEN bit
Page 1983: in the I2C_CR1 register. Data is loaded from an SRAM area configured using the DMA
Page 1983: peripheral (see Section 14: Direct memory access controller (DMA) on page 615) to the
Page 1983: Only the data are transferred with DMA.
Page 1983: transferred with DMA). When all data are transferred using DMA, the DMA must be
Page 1983: –    With NOSTRETCH=0, when all data are transferred using DMA, the DMA must be
Page 1983: –    With NOSTRETCH=1, the DMA must be initialized before the address match
Page 1983: Note:     If DMA is used for transmission, the TXIE bit does not need to be enabled.
Page 1983: Reception using DMA
Page 1983: DMA (Direct Memory Access) can be enabled for reception by setting the RXDMAEN bit in
Page 1983: configured using the DMA peripheral (refer to Section 14: Direct memory access controller
Page 1983: (DMA) on page 615) whenever the RXNE bit is set. Only the data (including PEC) are
Page 1983: transferred with DMA.
Page 1983: START bit are programmed by software. When all data are transferred using DMA, the
Page 1984: DMA must be initialized before setting the START bit. The end of transfer is managed
Page 1984: •    In slave mode with NOSTRETCH=0, when all data are transferred using DMA, the
Page 1984: DMA must be initialized before the address match event, or in the ADDR interrupt
Page 1984: Note:       If DMA is used for reception, the RXIE bit does not need to be enabled.
Page 1986: RXDMA TXDMA               ANF                                                       STOP     NACK    ADDR
Page 1987: Bit 15 RXDMAEN: DMA reception requests enable
Page 1987: 0: DMA mode disabled for reception
Page 1987: 1: DMA mode enabled for reception
Page 1987: Bit 14 TXDMAEN: DMA transmission requests enable
Page 1987: 0: DMA mode disabled for transmission
Page 1987: 1: DMA mode enabled for transmission
Page 1998: TXIS event (interrupt if TXIE=1 or DMA request if TXDMAEN=1).
Page 2001: Res.                               Res.                             Res.                          BUSY                               TIMOUTEN                                                                 OA2EN                           OA1EN                           NACK                              RXDMAEN             15
Page 2001: Res.                               Res.                             Res.                           Res.                                 Res.                                                                   Res.                            Res.                            STOP                             TXDMAEN             14
Page 2003: High-speed data communications are possible by using the DMA (direct memory access)
Page 2004: •   Continuous communications using DMA
Page 2004: •   Received/transmitted bytes are buffered in reserved SRAM using centralized DMA.
Page 2005: Continuous communication using DMA                            X                 X                X
Page 2006: usart_tx_dma                            clock domain
Page 2006: DMA Interface
Page 2006: usart_rx_dma
Page 2012: 5.   Select DMA enable (DMAT) in USART_CR3 if multibuffer communication must take
Page 2012: place. Configure the DMA register as explained in Section 47.5.10: USART
Page 2016: 5.   Select DMA enable (DMAR) in USART_CR3 if multibuffer communication is to take
Page 2016: place. Configure the DMA register as explained in Section 47.5.10: USART
Page 2016: cleared when the DMA reads the Receive data Register.
Page 2016: empty. After every DMA request, a data is retrieved from the RXFIFO. A DMA
Page 2017: previous DMA request has not been serviced. When an overrun error occurs:
Page 2018: read to the USART_RDR register or by DMA.
Page 2027: flag is not set for this address byte and no interrupt or DMA request is issued when the
Page 2028: check the CR/LF in the DMA buffer.
Page 2038: enabled)/receive DMA request is not activated. According to the protocol specification,
Page 2039: Note:     The RXNE/RXFNE interrupt must be enabled even when using the USART in DMA mode to
Page 2039: read from the Smartcard in block mode. In parallel, the DMA must be enabled only after the
Page 2039: programmed to the BLEN field in the USART_RTOR register. When using DMA mode,
Page 2044: 47.5.19     Continuous communication using USART and DMA
Page 2044: The USART is capable of performing continuous communications using the DMA. The DMA
Page 2044: Note:       Refer to Section 47.4: USART implementation on page 2005 to determine if the DMA mode
Page 2044: is supported. If DMA is not supported, use the USART as explained in Section 47.5.6. To
Page 2044: Transmission using DMA
Page 2044: DMA mode can be enabled for transmission by setting DMAT bit in the USART_CR3
Page 2044: register. Data are loaded from an SRAM area configured using the DMA peripheral (refer to
Page 2044: Section 14: Direct memory access controller (DMA) and Section 11: Direct memory access
Page 2044: controller (DMA)) to the USART_TDR register whenever the TXE flag (TXFNF flag if FIFO
Page 2044: mode is enabled) is set. To map a DMA channel for USART transmission, use the following
Page 2044: 1.   Write the USART_TDR register address in the DMA control register to configure it as
Page 2044: 2.   Write the memory address in the DMA control register to configure it as the source of
Page 2044: 3.   Configure the total number of bytes to be transferred to the DMA control register.
Page 2044: 4.   Configure the channel priority in the DMA register
Page 2044: 5.   Configure DMA interrupt generation after half/ full transfer as required by the
Page 2044: 7.   Activate the channel in the DMA register.
Page 2044: When the number of data transfers programmed in the DMA Controller is reached, the DMA
Page 2044: controller generates an interrupt on the DMA channel interrupt vector.
Page 2044: In transmission mode, once the DMA has written all the data to be transmitted (the TCIF flag
Page 2044: is set in the DMA_ISR register), the TC flag can be monitored to make sure that the USART
Page 2045: Figure 587. Transmission using DMA
Page 2045: TXE flag                        cleared by DMA read            cleared by DMA read          Set by hardware
Page 2045: DMA request                                                                                 Ignored by the DMA because
Page 2045: DMA writes
Page 2045: DMA TCIF flag                                                  by
Page 2045: Software                                    The DMA
Page 2045: configures DMA DMA writes DMA writes DMA writes transfer is
Page 2045: enables USART                                   DMA_ISR)
Page 2045: Note:          When FIFO management is enabled, the DMA request is triggered by Transmit FIFO not full
Page 2045: Reception using DMA
Page 2045: DMA mode can be enabled for reception by setting the DMAR bit in USART_CR3 register.
Page 2045: Data are loaded from the USART_RDR register to an SRAM area configured using the DMA
Page 2045: peripheral (refer to Section 14: Direct memory access controller (DMA) and Section 11:
Page 2045: Direct memory access controller (DMA)) whenever a data byte is received. To map a DMA
Page 2045: 1.     Write the USART_RDR register address in the DMA control register to configure it as
Page 2045: 2.     Write the memory address in the DMA control register to configure it as the destination
Page 2045: 3.     Configure the total number of bytes to be transferred to the DMA control register.
Page 2045: 4.     Configure the channel priority in the DMA control register
Page 2045: 6.     Activate the channel in the DMA control register.
Page 2045: When the number of data transfers programmed in the DMA Controller is reached, the DMA
Page 2045: controller generates an interrupt on the DMA channel interrupt vector.
Page 2046: Figure 588. Reception using DMA
Page 2046: RXNE flag                                        cleared by DMA read
Page 2046: DMA request
Page 2046: DMA reads
Page 2046: DMA TCIF flag                                                                                 Set by hardware        by
Page 2046: Software configures the                                                                     The DMA transfer
Page 2046: DMA to receive 3 data       DMA reads F1                   DMA reads F2      DMA reads F3   is complete
Page 2046: the USART                                                                                   DMA_ISR)
Page 2046: Note:          When FIFO management is enabled, the DMA request is triggered by Receive FIFO not
Page 2050: When DMA is used for reception, it must be disabled before entering low-power mode and
Page 2058: The DMA requests are also reset when UE = 0 so the DMA channel must be disabled
Page 2062: DEP      DEM   DDRE                    CTSIE   CTSE      RTSE   DMAT   DMAR    SCEN   NACK            IRLP   IREN     EIE
Page 2064: Bit 13 DDRE: DMA Disable on Reception Error
Page 2064: 0: DMA is not disabled in case of reception error. The corresponding error flag is set but
Page 2064: RXNE is kept 0 preventing from overrun. As a consequence, the DMA request is not
Page 2064: asserted, so the erroneous data is not transferred (no DMA request), but next correct
Page 2064: 1: DMA is disabled following a reception error. The corresponding error flag is set, as well
Page 2064: as RXNE. The DMA request is masked until the error flag is cleared. This means that the
Page 2064: software must first disable the DMA request (DMAR = 0) or clear RXNE(RXFNE is case
Page 2065: Bit 7 DMAT: DMA enable transmitter
Page 2065: 1: DMA mode is enabled for transmission
Page 2065: 0: DMA mode is disabled for transmission
Page 2065: Bit 6 DMAR: DMA enable receiver
Page 2065: 1: DMA mode is enabled for reception
Page 2065: 0: DMA mode is disabled for reception
Page 2080: DMAR
Page 2080: DMAT
Page 2082: DMA (direct memory access) can be used for data transmission/reception.
Page 2083: •   Continuous communications using DMA
Page 2083: •   Received/transmitted bytes are buffered in reserved SRAM using centralized DMA.
Page 2084: lpuart_tx_dma                            clock domain
Page 2084: DMA Interface
Page 2084: lpuart_rx_dma
Page 2088: 5.    Select DMA enable (DMAT) in LPUART_CR3 if Multi buffer Communication is to take
Page 2088: place. Configure the DMA register as explained in Section 47.5.10: USART
Page 2091: 5.   Select DMA enable (DMAR) in LPUART_CR3 if multibuffer communication is to take
Page 2091: place. Configure the DMA register as explained in Section 47.5.10: USART
Page 2091: is cleared by the DMA read of the Receive Data Register.
Page 2091: empty. After every DMA request, a data is retrieved from the RXFIFO. DMA
Page 2092: previous DMA request has not been serviced. When an overrun error occurs:
Page 2093: the LPUART_RDR register or by DMA.
Page 2098: flag is not set for this address byte and no interrupt or DMA request is issued when the
Page 2100: 48.3.12     Continuous communication using DMA and LPUART
Page 2100: The LPUART is capable of performing continuous communication using the DMA. The DMA
Page 2100: Note:       Refer to Section 47.4: USART implementation on page 2005 to determine if the DMA mode
Page 2100: is supported. If DMA is not supported, use the LPUSRT as explained in Section 47.5.6. To
Page 2100: Transmission using DMA
Page 2100: DMA mode can be enabled for transmission by setting DMAT bit in the LPUART_CR3
Page 2100: register. Data are loaded from an SRAM area configured using the DMA peripheral (refer to
Page 2100: TXE flag (TXFNF flag if FIFO mode is enabled) is set. To map a DMA channel for LPUART
Page 2100: 1.   Write the LPUART_TDR register address in the DMA control register to configure it as
Page 2100: 2.   Write the memory address in the DMA control register to configure it as the source of
Page 2100: 3.   Configure the total number of bytes to be transferred to the DMA control register.
Page 2100: 4.   Configure the channel priority in the DMA register
Page 2100: 5.   Configure DMA interrupt generation after half/ full transfer as required by the
Page 2100: 7.   Activate the channel in the DMA register.
Page 2100: When the number of data transfers programmed in the DMA Controller is reached, the DMA
Page 2100: controller generates an interrupt on the DMA channel interrupt vector.
Page 2100: In transmission mode, once the DMA has written all the data to be transmitted (the TCIF flag
Page 2100: is set in the DMA_ISR register), the TC flag can be monitored to make sure that the
Page 2101: Figure 601. Transmission using DMA
Page 2101: TXE flag                        cleared by DMA read            cleared by DMA read          Set by hardware
Page 2101: DMA request                                                                                 Ignored by the DMA because
Page 2101: DMA writes
Page 2101: DMA TCIF flag                                                  by
Page 2101: Software                                    The DMA
Page 2101: configures DMA DMA writes DMA writes DMA writes transfer is
Page 2101: enables USART                                   DMA_ISR)
Page 2101: Note:          When FIFO management is enabled, the DMA request is triggered by Transmit FIFO not full
Page 2101: Reception using DMA
Page 2101: DMA mode can be enabled for reception by setting the DMAR bit in LPUART_CR3 register.
Page 2101: Data are loaded from the LPUART_RDR register to a SRAM area configured using the DMA
Page 2101: peripheral (refer to the Direct memory access controller (DMA) sections) whenever a data
Page 2101: byte is received. To map a DMA channel for LPUART reception, use the following
Page 2101: 1.     Write the LPUART_RDR register address in the DMA control register to configure it as
Page 2101: 2.     Write the memory address in the DMA control register to configure it as the destination
Page 2101: 3.     Configure the total number of bytes to be transferred to the DMA control register.
Page 2101: 4.     Configure the channel priority in the DMA control register
Page 2101: 6.     Activate the channel in the DMA control register.
Page 2101: When the number of data transfers programmed in the DMA Controller is reached, the DMA
Page 2101: controller generates an interrupt on the DMA channel interrupt vector.
Page 2102: Figure 602. Reception using DMA
Page 2102: RXNE flag                                         cleared by DMA read
Page 2102: DMA request
Page 2102: DMA reads
Page 2102: DMA TCIF flag                                                                                  Set by hardware         by
Page 2102: Software configures the                                                                      The DMA transfer
Page 2102: DMA to receive 3 data       DMA reads F1                    DMA reads F2      DMA reads F3   is complete
Page 2102: the USART                                                                                    DMA_ISR)
Page 2102: Note:          When FIFO management is enabled, the DMA request is triggered by Receive FIFO not
Page 2106: When DMA is used for reception, it must be disabled before entering low-power mode and
Page 2113: The DMA requests are also reset when UE = 0 so the DMA channel must be disabled
Page 2115: DEP     DEM     DDRE            Res.    CTSIE    CTSE    RTSE   DMAT   DMAR    Res.   Res.          Res.   Res.   EIE
Page 2117: Bit 13 DDRE: DMA Disable on Reception Error
Page 2117: 0: DMA is not disabled in case of reception error. The corresponding error flag is set but
Page 2117: RXNE is kept 0 preventing from overrun. As a consequence, the DMA request is not
Page 2117: asserted, so the erroneous data is not transferred (no DMA request), but next correct
Page 2117: 1: DMA is disabled following a reception error. The corresponding error flag is set, as well
Page 2117: as RXNE. The DMA request is masked until the error flag is cleared. This means that the
Page 2117: software must first disable the DMA request (DMAR = 0) or clear RXNE before clearing the
Page 2117: Bit 7 DMAT: DMA enable transmitter
Page 2117: 1: DMA mode is enabled for transmission
Page 2117: 0: DMA mode is disabled for transmission
Page 2118: Bit 6 DMAR: DMA enable receiver
Page 2118: 1: DMA mode is enabled for reception
Page 2118: 0: DMA mode is disabled for reception
Page 2127: Res.                         TXE/TXFNF                  Res.                                                                                             DMAT                                      Res.                                          TXEIE       7
Page 2127: TCCF                              TC                     Res.                                                                                             DMAR                                      Res.                                           TCIE       6
Page 2130: •    Two 16x or 8x 8-bit embedded Rx and TxFIFOs with DMA capability
Page 2131: spi_tx_dma
Page 2131: DMA Interface
Page 2131: spi_rx_dma
Page 2144: 11. Configure DMA streams dedicated for the SPI Tx and Rx in DMA registers if the DMA
Page 2144: streams are used (see chapter Communication using DMA).
Page 2145: For handling DMA, see Section 49.4.14: Communication using DMA (direct memory
Page 2145: short or the interrupt/DMA latency is too long. Each direction has its own FIFO called
Page 2145: reading SPI2S_RXDR by software or by DMA.
Page 2145: The RXP triggers an interrupt if the RXPIE bit is set or a/o a DMA request if RXDMAEN is
Page 2146: TxFIFO is filled by software a/o by DMA and space currently available for any next complete
Page 2146: The TXP triggers an interrupt if the TXPIE bit is set or a/o a DMA request if TXDMAEN is
Page 2147: The DXP triggers an interrupt if the DXPIE bit is set or a/o a DMA requests if TXDMAEN and
Page 2147: RXDMAEN are set. The DXPIE mask is cleared by hardware when the TXTF flag is set.
Page 2147: Another way to manage the data exchange is to use DMA (see Communication using DMA
Page 2148: time. It is preferable for the slave to use DMA, especially when data frames are short, FIFO
Page 2149: •    When transaction streams from DMA or FIFO are completed while the last data frame
Page 2151: 49.4.14         Communication using DMA (direct memory addressing)
Page 2151: required to avoid overrun, the SPI features a DMA capability, which implements a simple
Page 2151: A DMA access is requested when the TXDMAEN or RXDMAEN enable bits in the
Page 2151: •      In transmission, a series of DMA requests is triggered each time TXP is set to 1. The
Page 2151: DMA then performs series of writes to the SPI2S_TXDR register.
Page 2151: •      In reception, a series of DMA requests is triggered each time RXP is set to 1. The DMA
Page 2151: end of transaction and last data packet is incomplete then DMA request is activated
Page 2151: When the SPI is used only to receive data, it is possible to enable only the SPI Rx DMA
Page 2152: When the SPI is used only to transmit data, it is possible to enable only the SPI Tx DMA
Page 2152: In transmission mode, when the DMA or the user has written all the data to be transmitted
Page 2152: When starting communication using DMA, to prevent DMA channel management raising
Page 2152: 1.   Enable DMA Rx buffer in the RXDMAEN bit in the SPI_CFG1 register, if DMA Rx is
Page 2152: 2.   Enable DMA requests for Tx and Rx in DMA registers, if the DMA is used.
Page 2152: 3.   Enable DMA Tx buffer in the TXDMAEN bit in the SPI_CFG1 register, if DMA Tx is
Page 2152: 1.   Disable DMA request for Tx and Rx in the DMA registers, if the DMA issued.
Page 2152: 3.   Disable DMA Tx and Rx buffers by clearing the TXDMAEN and RXDMAEN bits in the
Page 2152: SPI_CFG1 register, if DMA Tx and/or DMA Rx are used.
Page 2152: Data packing with DMA
Page 2152: If the transfers are managed by DMA (TXDMAEN and RXDMAEN set in the SPI_CFG1
Page 2152: configured for SPI TX and the SPI RX DMA channel.
Page 2152: If the DMA channel PSIZE value is equal to 16-bit or 32-bit and SPI data size is less than or
Page 2152: equal to 8-bit, then packing mode is enabled. Similarly, If the DMA channel PSIZE value is
Page 2152: enabled.The DMA then automatically manages the write operations to the SPI2S_TXDR
Page 2152: of the DMA data size (16-bit or 32-bit) while the frame size is smaller, DMA completes the
Page 2152: To configure any DMA data access less than the configured data size is forbidden. One
Page 2153: DMA did not have enough time to read the previously received data (stored in the RxFIFO).
Page 2156: sampled after a CRC phase. This allows the use of DMA circular mode in order to transfer
Page 2158: up the TxFIFO either by DMA or by software. Note as well that for some product the
Page 2160: •    DMA capability for transmission and reception
Page 2161: Resources such as RxFIFO, TxFIFO, DMA and parts of interrupt signaling are shared with
Page 2162: TXDMAEN, RXDMAEN,
Page 2171: serial interface is still disabled, but the DMA and interrupt services are working,
Page 2176: It is possible to generate an interrupt or a DMA request according to a programmable FIFO
Page 2177: dma_req
Page 2177: dma_clr
Page 2178: dma_req
Page 2178: dma_clr
Page 2180: 49.9.15     DMA Interface
Page 2180: The I2S/PCM mode shares the same DMA requests lines than the SPI function. There is a
Page 2180: separated DMA channel for TX and RX paths. Each DMA channel can be enabled via
Page 2180: RXDMAEN and TXDMAEN bits of SPI_CFG1 register.
Page 2180: In receive mode, the DMA interface is working as follow:
Page 2180: 2.   If the RxFIFO contains at least FTHLV samples, then FTHLV DMA requests are
Page 2180: –    When the FTHLV DMA requests are completed, the hardware loops to step 1
Page 2180: 3.   If the RxFIFO contains less than FTHLV samples, no DMA request is generated, and
Page 2180: In transmit mode, the DMA interface is working as follow:
Page 2180: 2.   If the TxFIFO contains at least FTHLV empty locations, then FTHLV DMA requests are
Page 2180: –    When the FTHLV DMA requests are completed, the hardware loops to step 1
Page 2180: 3.   If the TxFIFO contains less than FTHLV empty locations, no DMA request is generated,
Page 2181: 9.   If the data transfer uses DMA:
Page 2181: –    Program the DMA peripheral,
Page 2181: –    Enable the DMA channel,
Page 2181: –    If the DMA transfer are enabled (TXDMAEN = 1), the SPI/I2S generates DMA
Page 2181: 3.   Stop DMA peripheral, bus clock...
Page 2182: 9.   If the data transfer uses DMA:
Page 2182: –    Program the DMA peripheral: two channels, one for RX and one for TX
Page 2182: –    Enable the DMA channels,
Page 2182: –    In the SPI/I2S block, enable the DMA by setting the TXDMAEN and RXDMAEN
Page 2182: by sending DMA requests
Page 2182: –    If the DMA transfer are enabled, the SPI/I2S generates DMA requests in order to
Page 2183: 7.   If the data transfer uses DMA:
Page 2183: –    Program the DMA peripheral: one RX channel
Page 2183: –    Enable the DMA channel,
Page 2183: –    In the SPI/I2S block, enable the DMA by setting the RXDMAEN bit to 1.
Page 2183: 2.   Stop DMA peripheral, bus clock...
Page 2187: DMA    DMA      Res.     UDRDET[1:0]   UDRCFG[1:0]            FTHLV[3:0]                         DSIZE[4:0]
Page 2188: Bit 15 TXDMAEN: Tx DMA stream enable
Page 2188: 0: Tx DMA disabled
Page 2188: 1: Tx DMA enabled
Page 2188: Bit 14 RXDMAEN: Rx DMA stream enable
Page 2188: 0: Rx-DMA disabled
Page 2188: 1: Rx-DMA enabled
Page 2195: for transmission by application software or DMA, that is when TSIZE number of data have
Page 2202: RXDMAEN
Page 2202: TXDMAEN
Page 2205: •   2-channel DMA interface.
Page 2206: sai_a_gbl_it sai_a_dma
Page 2206: sai_b_gbl_it sai_b_dma
Page 2206: DMA in order to leave the CPU free during the communication. Each audio block is
Page 2207: sai_a_dma,
Page 2207: Input/output Audio block A and B DMA acknowledges and requests.
Page 2207: sai_b_dma
Page 2208: 1.   Write into the SAI_xDR (by software or by DMA).
Page 2219: Like interrupt generation, the SAI can use the DMA if DMAEN bit in the SAI_xCR1 register is
Page 2221: Note:          Once the PDM interface and SAI_A are enabled, the first 2 TDMA frames received on
Page 2231: 1.   Disable the DMA stream (via the DMA peripheral) if the DMA is used.
Page 2231: new block (data for preamble B). If the DMA is used, the DMA source base address
Page 2231: 5.   Enable again the DMA stream (DMA peripheral) if the DMA used to manage data
Page 2239: 50.3.16   SAI DMA interface
Page 2239: DMA interface to read/write from/to the SAI_xDR register (to access the internal FIFO).
Page 2239: There is one DMA channel per audio sub-block supporting basic DMA request/acknowledge
Page 2239: To configure the audio sub-block for DMA transfer, set DMAEN bit in the SAI_xCR1 register.
Page 2239: The DMA request is managed directly by the FIFO controller depending on the FIFO
Page 2239: threshold level (for more details refer to Section 50.3.9: Internal FIFOs). DMA transfer
Page 2239: DMA request to load the FIFO with data written in the SAI_xDR register.
Page 2239: •   If the audio block is operates as a receiver, the DMA request is related to read
Page 2240: Follow the sequence below to configure the SAI interface in DMA mode:
Page 2240: 1.   Configure SAI and FIFO threshold levels to specify when the DMA request will be
Page 2240: 2.   Configure SAI DMA channel.
Page 2240: 3.   Enable the DMA.
Page 2240: Note:        Before configuring the SAI block, the SAI DMA channel must be disabled.
Page 2241: Res.       Res.     Res.      Res.      Res.      OSR                                    MCKDIV[5:0]                         NOMCK    Res.   DMAEN SAIEN
Page 2242: Bit 17 DMAEN: DMA enable
Page 2242: 0: DMA disabled
Page 2242: 1: DMA enabled
Page 2242: be configured before setting DMAEN to avoid a DMA request in receiver mode.
Page 2244: Res.    Res.   Res.   Res.   Res.   OSR                     MCKDIV[5:0]                  NOMCK   Res.   DMAEN SAIEN
Page 2245: Bit 17 DMAEN: DMA enable
Page 2245: 0: DMA disabled
Page 2245: 1: DMA enabled
Page 2245: be configured before setting DMAEN to avoid a DMA request in receiver mode.
Page 2248: received data lost). Before flushing, SAI DMA stream/interruption must be disabled
Page 2250: received data lost). Before flushing, SAI DMA stream/interruption must be disabled
Page 2269: Res.                          FLVL[2:0]                        Res.                                                            FSPOL                              Res.                             DMAEN                           Res.          17
Page 2271: •    Communication using DMA for audio samples
Page 2271: •    Communication using DMA for control and user channel information
Page 2271: This peripheral can be fully controlled via the APB1 bus, and can handle two DMA channels:
Page 2271: •    A DMA channel dedicated to the transfer of audio samples
Page 2271: •    A DMA channel dedicated to the transfer of IEC60958 channel status and user
Page 2271: Interrupt services are also available either as an alternative function to the DMA, or for
Page 2272: spdifrx_dat_dma
Page 2272: DMA interface                                                                                                                                   spdifrx_frame_sync
Page 2272: spdifrx_ctrl_dma                                              spdifrx_pclk
Page 2272: SPDIFRX DMA request (and acknowledge) for data
Page 2272: spdifrx_dat_dma              Digital input/output
Page 2272: SPDIFRX DMA request (and acknowledge) for
Page 2272: spdifrx_ctrl_dma             Digital input/output
Page 2281: and channel status can be read via interrupt of DMA. The audio samples are not
Page 2281: channel status and audio samples can be read via interrupt or DMA channels. When
Page 2282: to STATE_IDLE. If a DMA transfer is on-going, it will be properly completed.
Page 2282: to STATE_IDLE. If a DMA transfer is on-going, it will properly be completed.
Page 2283: The SPDIFRX offers the possibility to use either DMA (spdifrx_dat_dma and
Page 2283: spdifrx_ctrl_dma) or interrupts for transferring the audio samples into the memory. The
Page 2283: recommended option is DMA, refer to Section 51.3.11: DMA Interface for additional
Page 2284: them through SPDIFRX_CSR register, and use a dedicated DMA channel or interrupt to
Page 2285: via a dedicated DMA channel. This feature allows the SPDIFRX to acquire continuously the
Page 2285: 60958 block. Two fields are available to control this path: CBDMAEN and SPDIFRXEN.
Page 2285: they are packed and stored into SPDIFRX_CSR register. A DMA request is triggered if the
Page 2285: bit CBDMAEN is set to 1 (see Figure 676).
Page 2285: spdifrx_dat_dma
Page 2285: spdifrx_ctrl_dma
Page 2287: SPDIFRX_DMA_REQ
Page 2287: spdifrx_dat_dma
Page 2288: spdifrx_dat_dma
Page 2288: 51.3.11          DMA Interface
Page 2288: The SPDIFRX interface is able to perform communication using the DMA.
Page 2288: Note:            The user should refer to product specifications for availability of the DMA controller.
Page 2288: The SPDIFRX offers two independent DMA channels:
Page 2288: •         A DMA channel dedicated to the data transfer
Page 2288: •         A DMA channel dedicated to the channel status and user data transfer
Page 2289: The DMA mode for the data can be enabled for reception by setting the RXDMAEN bit in the
Page 2289: SPDIFRX interface sends a transfer request to the DMA. The DMA reads the data received
Page 2289: For the use of DMA for the control data refer to Section 51.3.8: Dedicated control flow.
Page 2290: CBDMAEN              rw                 rw                 rw
Page 2290: RXDMAEN              rw                 rw                 rw
Page 2290: Note:       Even if the hardware allows the writing of CBDMAEN and RXDMAEN “on-the-fly”, it is not
Page 2290: recommended to enable the DMA when the IP is already receiving data.
Page 2291: The data path and channel status & user information will both use a dedicated DMA
Page 2291: •   Configure the DMA transfer for both audio samples and IEC60958 channel status and
Page 2291: user information (DMA channel selection and activation, priority, number of data to
Page 2291: transfer, circular/no circular mode, DMA interrupts)
Page 2292: –    CBDMAEN = RXDMAEN = 1 (enable DMA channels)
Page 2292: Then the CPU will receive interrupts coming either from DMA or SPDIFRX.
Page 2292: completed. No action has to be performed in our case as the DMA is already
Page 2292: programmed. The software just needs to wait for DMA interrupt in order to read
Page 2293: 51.4.3          Handling of interrupts coming from DMA
Page 2293: If an interrupt is coming from the DMA channel used of the channel status (SPDIFRX_CSR):
Page 2293: the software to identify the bit 0 of the channel status. Note that if the DMA generates
Page 2293: If an interrupt is coming from the DMA channel used of the audio samples
Page 2293: CBDMAEN
Page 2293: RXDMAEN
Page 2294: Bit 10 CBDMAEN: Control buffer DMA enable for control flow(1)
Page 2294: 1: DMA mode is enabled for reception of channel status and used data information.
Page 2294: 0: DMA mode is disabled for reception of channel status and used data information.
Page 2294: When this bit is set, the DMA request is made whenever the CSRNE flag is set.
Page 2295: Bit 2 RXDMAEN: Receiver DMA enable for data flow(1)
Page 2295: 1: DMA mode is enabled for reception.
Page 2295: 0: DMA mode is disabled for reception.
Page 2295: When this bit is set, the DMA request is made whenever the RXNE flag is set.
Page 2305: CBDMAEN
Page 2305: RXDMAEN
Page 2307: •   Multi software buffer mode for efficient DMA implementation and multi frame buffering
Page 2308: swpmi_tx_dma            registers
Page 2308: swpmi_rx_dma
Page 2309: swpmi_tx_dma                      SWPMI DMA transmit request
Page 2309: swpmi_rx_dma                      SWPMI DMA receive request
Page 2312: The software buffer usage requires the use of a DMA channel to transfer data from the
Page 2312: This mode does not require the use of DMA. The SWP frame transmission handling is done
Page 2312: The No software buffer mode is selected by clearing TXDMA bit in the SWPMI_CR register.
Page 2313: TXE                                                             set by HW, cleared by SW or DMA
Page 2314: TXE                                                         set by HW, cleared by SW or DMA
Page 2314: DMA. The DMA will refill the 32-bit SWPMI_TDR register, and the software can poll the end
Page 2314: The Single software buffer mode is selected by setting TXDMA bit and clearing TXMODE bit
Page 2314: The DMA channel or stream must be configured in following mode (refer to DMA section):
Page 2314: 1.        Set TXDMA bit in the SWPMI_CR register,
Page 2314: 4.        Enable stream or channel in DMA module to start DMA transfer and frame
Page 2314: A DMA request is issued by SWPMI when TXE flag in SWPMI_ISR is set. The TXE flag is
Page 2314: cleared automatically when the DMA is writing to the SWPMI_TDR register.
Page 2315: 1.   Disable stream or channel in DMA module
Page 2315: 3.   Configure the total number of words to be transferred in DMA module
Page 2315: 4.   Enable stream or channel in DMA module to start next frame transmission
Page 2315: buffer update by software thanks to the DMA. The software can check the DMA counters at
Page 2315: The Multi software buffer mode must be used in combination with DMA in circular mode.
Page 2315: The Multi software buffer mode is selected by setting both TXDMA and TXMODE bits in
Page 2315: For example, in order to work with 4 transmission buffers, the user must configure the DMA
Page 2315: The DMA channel or stream must be configured in following mode (refer to DMA section):
Page 2315: 1.   Set TXDMA in the SWPMI_CR register
Page 2315: 4.   Enable stream or channel in DMA module to start DMA.
Page 2316: The Software can also read the DMA counter (number of data to transfer) in the DMA
Page 2316: and if the DMA counter equals 17, it means that two buffers are ready for updating in the
Page 2316: DMA module. The transmission will stop at the end of the buffer4 transmission.
Page 2316: TXDMA bit in the SWPMI_CR register will be cleared by hardware as soon as the number of
Page 2316: DMA2_CMAR2        D2    D1    D0     TFL
Page 2317: The software buffer usage requires the use of a DMA channel to transfer data from the
Page 2317: This mode does not require the use of DMA. The SWP frame reception handling is done by
Page 2317: The No software buffer mode is selected by resetting RXDMA bit in the SWPMI_CR
Page 2318: RXNE                      set by HW, cleared by SW or DMA
Page 2318: DMA. The DMA transfers received data from the 32-bit SWPMI_RDR register to the RAM
Page 2318: The Single software buffer mode is selected by setting RXDMA bit and clearing RXMODE
Page 2318: The DMA must be configured as follows:
Page 2318: The DMA channel or stream must be configured in following mode (refer to DMA section):
Page 2318: 1.       Set RXDMA bit in the SWPMI_CR register
Page 2318: 3.       Enable stream or channel in DMA module.
Page 2318: A DMA request is issued by SWPMI when RXNE flag is set in SWPMI_ISR. The RXNE flag
Page 2318: is cleared automatically when the DMA is reading the SWPMI_RDR register.
Page 2319: 1.         Disable stream or channel in DMA module
Page 2319: 4.         Enable stream or channel in DMA module
Page 2319: set by HW, cleared by DMA
Page 2319: DMA transfers data from        DMA transfers data from     DMA transfers data from    DMA transfers data from
Page 2319: a continuous reception, keeping a very low CPU load, using the DMA. The frame payloads
Page 2319: the DMA counters and status flags at any time to handle the received SWP frames in the
Page 2319: The Multi software buffer mode must be used in combination with the DMA in circular mode.
Page 2319: The Multi software buffer mode is selected by setting both RXDMA and RXMODE bits in
Page 2320: In order to work with n reception buffers in RAM, the DMA channel or stream must be
Page 2320: configured in following mode (refer to DMA section):
Page 2320: 1.   Set RXDMA in the SWPMI_CR register
Page 2320: 3.   Enable stream or channel in the DMA module.
Page 2320: in DMA2_CMAR1).
Page 2320: received in the second buffer (address set in DMA2_CMAR1 + 8), and so on (refer to
Page 2320: The software can also read the DMA counter (number of data to transfer) in the DMA
Page 2320: the RAM memory through DMA. For example, if the software works with 4 reception buffers,
Page 2321: and if the DMA counter equals 17, it means that two buffers are ready for reading in the
Page 2321: RXNE                   set by HW, cleared by DMA
Page 2321: DMA transfers data         DMA transfers data     DMA transfers data       DMA transfers data
Page 2321: DMA is used, TXDMA bit in the SWPMI_CR register is automatically cleared.
Page 2322: set by HW, cleared by SW or DMA
Page 2325: Res.    Res.     Res.   Res.          DEACT   Res.   Res.   Res.     Res.          LPBK              TXDMA RXDMA
Page 2325: TXDMA bit is set (refer to Table 428: Buffer modes selection for transmission/reception).
Page 2326: TXDMA bit is set (refer to Table 428: Buffer modes selection for transmission/reception).
Page 2326: Bit 1 TXDMA: Transmission DMA enable
Page 2326: This bit is used to enable the DMA mode in transmission
Page 2326: 0: DMA is disabled for transmission
Page 2326: 1: DMA is enabled for transmission
Page 2326: Note: TXDMA is automatically cleared if the payload size of the transmitted frame is given as
Page 2326: 0x00 (in the least significant byte of TDR for the first word of a frame). TXDMA is also
Page 2326: Bit 0 RXDMA: Reception DMA enable
Page 2326: This bit is used to enable the DMA mode in reception
Page 2326: 0: DMA is disabled for reception
Page 2326: 1: DMA is enabled for reception
Page 2326: RXDMA/TXDMA                            0                         1                                1
Page 2328: SWPMI_TDR has not been written in time by the software or the DMA. It is cleared by
Page 2328: SWPMI_RDR has not be read in time by the software or the DMA. It is cleared by software,
Page 2333: SWP_ CLASS                                                                                                          TXBEIE                        CTXBEF                        TXBEF                         Res.                                                     TXDMA           1
Page 2333: SWP_ TBYP                                                                                                           RXBFIE                        CRXBFF                        RXBFF                         Res.                                                     RXDMA           0
Page 2353: interrupt signals and IDMA control signals.
Page 2353: •      The internal DMA (IDMA) block with its AHB master interface.
Page 2354: master bus            IDMA                  path
Page 2354: sdmmc_dataend_trg          Digital output     SDMMC data end trigger for MDMA
Page 2357: •   Internal DMA (IDMA)
Page 2369: and when IDMAEN = 0 reset with FIFORST, and sets the DABORT flag.
Page 2369: FIFO is empty and when IDMAEN = 0 reset with FIFORST, and issues the DHOLD
Page 2370: moves to the Idle state when the FIFO is empty and when IDMAEN = 0 reset with
Page 2370: –    If the CPSM Abort signal is set, wait for the FIFO to be empty and when IDMAEN
Page 2370: is written to the data FIFO, wait for the FIFO to be empty and when IDMAEN = 0
Page 2370: FIFO is empty and when IDMAEN = 0 reset with FIFORST.
Page 2371: - When IDMA is enabled, the FIFO will be flushed, then the DPSM will move to the
Page 2371: - When IDMA is disabled generate the DBCKEND flag. wait for the FIFO to be
Page 2371: IDMAEN = 0 reset with FIFORST, then the DPSM moves to the Idle state and sets
Page 2376: Data FIFO access                                   IDMAEN
Page 2376: From IDMA via AHB master interface                            1
Page 2376: When IDMAEN = 1 the FIFO is fully handled by the IDMA.
Page 2376: When IDMAEN = 0 the FIFO is controlled by FW via the AHB slave interface. The transmit
Page 2376: In case of a data transfer error or transfer hold when IDMAEN = 0, FW shall stop writing to
Page 2377: When IDMAEN = 1 the FIFO is fully handled by the IDMA.
Page 2377: When IDMAEN = 0 the FIFO is controlled by FW via the AHB slave interface.When the data
Page 2377: In case of a data transfer hold when IDMAEN = 0, FW shall read the remaining data until the
Page 2377: In case of a data transfer error when IDMAEN = 0, FW shall stop reading the FIFO and flush
Page 2379: using the SDMMC IDMA.
Page 2379: SDMMC IDMA
Page 2379: Direct memory access (DMA) is used to provide high-speed transfer between the SDMMC
Page 2379: SDMMC internal DMA (IDMA) provides one channel to be used either for transmit or
Page 2379: The IDMA is enabled by the IDMAEN bit and supports burst transfers of 8 beats.
Page 2379: In addition the IDMA provides the following channel configurations selected by bit
Page 2379: IDMABMODE:
Page 2380: starting from the base address IDMABASE0. When the IDMA has finished transferring all
Page 2380: buffers, one located from base address IDMABASE0 and a second located from base
Page 2380: address IDMABASE1. This allows firmware to process one memory buffer while the IDMA is
Page 2380: IDMABSIZE. The buffer size shall be an integer multiple of the burst size. It is possible to
Page 2380: •   When IDMABACT bit is ‘0’ the IDMA hardware uses the IDMABASE0 to access
Page 2380: IDMABASE0 data will not be changed. Firmware is allowed to write IDMABASE1.
Page 2380: •   When IDMABACT bit is ‘1’ the IDMA hardware uses the IDMABASE1 to access
Page 2380: IDMABASE1 data will not be changed. Firmware is allowed to write IDMABASE0.
Page 2380: When the IDMA has finished transferring the data of one buffer the buffer transfer complete
Page 2380: flag (IDMABTC) is set and the IDMABACT bit toggles where after the IDMA continues
Page 2380: transferring data from the other buffer. When the IDMA has finished transferring all data and
Page 2380: The IDMABASEn address shall be word aligned.
Page 2380: IDMA transfer error management
Page 2380: An IDMA transfer error can occur:
Page 2380: On a IDMA transfer error subsequent IDMA transfers are disabled and an IDMATE flag is
Page 2380: set. Depending when the IDMA transfer error occurs, it will normally cause the generation of
Page 2380: The behavior of the IDMATE flag depend on when the IDMA transfer error occurs during the
Page 2380: •   An IDMA transfer error is detected before any SDMMC transfer error (TXUNDERR,
Page 2380: –    The IDMATE flag is set at the same time as the SDMMC transfer error flag.
Page 2380: •   An IDMA transfer error is detected during a STOP_TRANSNMISSION command:
Page 2380: –    The IDMATE flag is set at the same time as the DABORT flag.
Page 2380: •   An IDMA transfer error is detected at the end of the SDMMC transfer (HOLD, or
Page 2380: –    The IDMATE flag is set at the end of the SDMMC transfer.
Page 2381: The IDMATE will be generated on an other SDMMC transfer interrupt (TXUNDERR.
Page 2381: 54.4.7         MDMA request generation
Page 2381: The internal trigger line from the SDMMC allows passing direct request to MDMA controller
Page 2381: status register is set. The event is signaled to an MDMA request input through the
Page 2381: flags and, eventually, a new transfer start, through MDMA direct access to the SDMMC
Page 2381: The action to program in the MDMA according to the SDMMC requests is provided in the
Page 2381: Table 452. SDMMC connections to MDMA
Page 2381: Event occurrence      MDMA transfer
Page 2381: Trigger signal      Event signaled                                                   MDMA action
Page 2387: FIFO is empty (RXFIFOE flag is set), and when IDMAEN = 0 the FIFO shall be
Page 2387: 1.   Enable DHOLD flag (and DBCKEND flag when IDMAEN = 0)
Page 2387: 3.   When IDMAEN = 0: When receiving the DBCKEND flag the data transfer is stopped.
Page 2388: 3.    When IDMAEN = 1: The IDMA needs to be reprogrammed for the remaining bytes to
Page 2388: 4.    When IDMAEN = 0: Firmware shall start filling the FIFO with the remaining data.
Page 2391: 3.     When IDMAEN = 0, the FIFO need to be reset with FIFORST.
Page 2391: 4.     When IDMAEN = 1, hardware will take care of the FIFO.
Page 2391: a)   When writing data to the card. On the Abort signal hardware will stop the IDMA
Page 2391: IDMA to transfer the remaining data from the FIFO to RAM.
Page 2412: This bit can only be written by firmware when IDMAEN= 0 and DPSM is active (DPSMACT =
Page 2414: IDMA   IDMA    CK    VSW            ACK             BUSY    BUSY     RX      TX     RX       TX
Page 2414: Bit 28 IDMABTC: IDMA buffer transfer complete
Page 2414: Bit 27 IDMATE: IDMA transfer error
Page 2416: Note:          FIFO interrupt flags shall be masked in SDMMC_MASKR when using IDMA mode.
Page 2416: IDMA   IDMA          VSW            ACK    SDIO
Page 2417: Bit 28 IDMABTCC: IDMA buffer transfer complete clear bit
Page 2417: Set by software to clear the IDMABTC flag.
Page 2417: 0: IDMABTC not cleared
Page 2417: 1: IDMABTC cleared
Page 2417: Bit 27 IDMATEC: IDMA transfer error clear bit
Page 2417: Set by software to clear the IDMATE flag.
Page 2417: 0: IDMATE not cleared
Page 2417: 1: IDMATE cleared
Page 2419: IDMA                    VSW             ACK     SDIO
Page 2419: Bit 28 IDMABTCIE: IDMA buffer transfer complete interrupt enable
Page 2419: Set and cleared by software to enable/disable the interrupt generated when the IDMA has
Page 2419: 0: IDMA buffer transfer complete interrupt disabled
Page 2419: 1: IDMA buffer transfer complete interrupt enabled
Page 2422: 54.8.16        SDMMC DMA control register (SDMMC_IDMACTRLR)
Page 2422: IDMAB   IDMAB   IDMA
Page 2423: Bit 2 IDMABACT: Double buffer mode active buffer indication
Page 2423: IDMA is enabled this bit is toggled by hardware.
Page 2423: 0: When IDMA is enabled, uses buffer0 and firmware write access to IDMABASE0 is
Page 2423: 1: When IDMA is enabled, uses buffer1 and firmware write access to IDMABASE1 is
Page 2423: Bit 1 IDMABMODE: Buffer mode selection
Page 2423: Bit 0 IDMAEN: IDMA enable
Page 2423: 0: IDMA disabled
Page 2423: 1: IDMA enabled
Page 2423: 54.8.17         SDMMC IDMA buffer size register (SDMMC_IDMABSIZER)
Page 2423: The SDMMC_IDMABSIZER register contains the buffers size when in double buffer
Page 2423: Res.   Res.      Res.                         IDMABNDT[7:0]                        Res.    Res.   Res.    Res.   Res.
Page 2423: Bits 12:5 IDMABNDT[7:0]: Number of bytes per buffer
Page 2423: Example: IDMABNDT = 0x01: buffer size = 8 words = 32 bytes.
Page 2423: Example: IDMABNDT = 0x80: buffer size = 1024 words = 4 Kbyte
Page 2424: 54.8.18        SDMMC IDMA buffer 0 base address register
Page 2424: (SDMMC_IDMABASE0R)
Page 2424: The SDMMC_IDMABASE0R register contains the memory buffer base address in single
Page 2424: IDMABASE0[31:16]
Page 2424: IDMABASE0[15:0]
Page 2424: Bits 31:0 IDMABASE0[31:0]: Buffer 0 memory base address bits [31:2], shall be word aligned (bit [1:0]
Page 2424: is inactive (IDMABACT = ‘1’).
Page 2424: 54.8.19        SDMMC IDMA buffer 1 base address register
Page 2424: (SDMMC_IDMABASE1R)
Page 2424: The SDMMC_IDMABASE1R register contains the double buffer configuration second buffer
Page 2424: IDMABASE1[31:16]
Page 2424: IDMABASE1[15:0]
Page 2424: Bits 31:0 IDMABASE1[31:0]: Buffer 1 memory base address, shall be word aligned (bit [1:0] are always
Page 2424: 1 is inactive (IDMABACT = ‘0’).
Page 2426: IDMACTRLR
Page 2426: IDMABSIZER
Page 2426: IDMABASE1R
Page 2426: IDMABASE0R
Page 2426: Res.                                                                                                Res.                                Res.       Res.                        Res.                             IDMABTCIE                    IDMABTCC                    IDMABTC                     Res.                                  Res.         28
Page 2426: Res.                                                                                                Res.                                Res.       Res.                        Res.                                 Res.                      IDMATEC                     IDMATE                     Res.                                  Res.         27
Page 2426: IDMABASE1[31:0]
Page 2426: IDMABASE0[31:0]
Page 2426: IDMABNDT[7:0]
Page 2426: Res.                                                                                                Res.                            IDMABACT       Res.                                                         CTIMEOUTIE                   CTIMEOUTC                   CTIMEOUT                                                                        2
Page 2426: Res.                                                                                                Res.                            IDMABMODE Res.                                                              DCRCFAILIE                   DCRCFAILC                   DCRCFAIL                                                        DTDIR           1
Page 2426: Res.                                                                                                Res.                             IDMAEN        Res.                                                         CCRCFAILIE                   CCRCFAILC                   CCRCFAIL                                                         DTEN           0
Page 2520: 00: Idle state, wait for reception of debug messages, DMA request is cleared
Page 2520: 11: Debug messages A, B, C received, DMA request is set
Page 2564: •   OTG_HS embeds an internal DMA with shareholding support and software selectable
Page 2564: AHB burst type in DMA mode.
Page 2590: 0x534        Section 56.14.33: OTG host channel x DMA address register
Page 2590: OTG_HCDMAx
Page 2590: ....         (OTG_HCDMAx) (x = 0..15, where x = Channel number)
Page 2591: 0x934        Section 56.14.53: OTG device IN endpoint x DMA address register
Page 2591: OTG_DIEPDMAx
Page 2591: ...          (OTG_DIEPDMAx)
Page 2592: 0xB34          Section 56.14.59: OTG device OUT endpoint x DMA address register
Page 2592: OTG_DOEPDMAx
Page 2592: ...            (OTG_DOEPDMAx)
Page 2598: Res.   Res.     Res.   Res.   Res.   Res.   Res.                   Res.   DMAEN          HBSTLEN[3:0]
Page 2599: Bit 5 DMAEN: DMA enabled
Page 2599: 1: The core operates in DMA mode
Page 2603: AHB    DMAR
Page 2603: Bit 30 DMAREQ: DMA request signal enabled
Page 2603: This bit indicates that the DMA request is in progress. Used for debug.
Page 2606: This interrupt is valid only in DMA mode. This interrupt indicates that the core has stopped
Page 2634: This error is generated only in Internal DMA mode when an AHB error occurs during an AHB
Page 2634: read/write operation. The application can read the corresponding DMA channel address
Page 2636: 56.14.33 OTG host channel x DMA address register (OTG_HCDMAx)
Page 2636: DMAADDR[31:16]
Page 2636: DMAADDR[15:0]
Page 2636: Bits 31:0 DMAADDR[31:0]: DMA address
Page 2637: This field specifies the amount of time the Internal DMA engine must allocate for fetching
Page 2637: –    When any periodic endpoints are active, the internal DMA engine allocates
Page 2637: –    When no periodic endpoint is active, then the internal DMA engine services
Page 2637: –    After the specified time within a (micro) frame, the DMA switches to
Page 2646: This bit controls internal DMA arbiter parking for IN endpoints. When thresholding is enabled
Page 2654: This is generated only in internal DMA mode when there is an AHB error during an AHB
Page 2654: read/write. The application can read the corresponding endpoint DMA address register to
Page 2655: 56.14.53 OTG device IN endpoint x DMA address register (OTG_DIEPDMAx)
Page 2655: DMAADDR[31:16]
Page 2655: DMAADDR[15:0]
Page 2656: Bits 31:0 DMAADDR[31:0]: DMA Address
Page 2659: Applicable for control OUT endpoints in only in the Buffer DMA Mode. Set by the OTG_HS,
Page 2660: This is generated only in internal DMA mode when there is an AHB error during an AHB
Page 2660: read/write. The application can read the corresponding endpoint DMA address register to
Page 2662: 56.14.59 OTG device OUT endpoint x DMA address register (OTG_DOEPDMAx)
Page 2662: DMAADDR[31:16]
Page 2662: DMAADDR[15:0]
Page 2662: Bits 31:0 DMAADDR[31:0]: DMA Address
Page 2667: SRQIM                            SRQINT                        DMAREQ                            FDMOD                            Res.                             Res.                       Res.       30
Page 2667: NPTXFEM                           NPTXFE                        TXFFLSH                             Res.                         DMAEN                              Res.                    AVALOVAL       5
Page 2670: DMAADDR
Page 2670: 0x514       HCDMA0
Page 2670: DMAADDR
Page 2670: 0x534       HCDMA1
Page 2671: HCDMA11
Page 2671: HCDMA15
Page 2671: DMAADDR
Page 2671: DMAADDR
Page 2673: DIEPDMA
Page 2673: DMAADDR
Page 2675: DOEPDMA0
Page 2675: DMAADDR
Page 2676: DMAADDR
Page 2676: 0xB34   DOEPDMA1
Page 2676: DMAADDR
Page 2676: 0xC14   DOEPDMA8
Page 2679: 56.15.4   DMA mode
Page 2679: DMA address (OTG_HCDMAx register in host mode and
Page 2679: OTG_DIEPDMAx/OTG_DOEPDMAx register in peripheral mode) to access the data
Page 2679: 8.   Program the selected channels in the OTG_HCDMAx register(s) with the buffer start
Page 2679: address (DMA transactions only).
Page 2679: To disable a channel in DMA mode operation, the application does not need to check for
Page 2680: endpoint for the requested ping. In DMA mode operation, the application does not need to
Page 2701: •    Bulk and control OUT/SETUP transactions in DMA mode
Page 2701: For internal DMA mode, the OTG_HS host uses the programmed DMA address to
Page 2702: Figure 761. Normal bulk/control OUT/SETUP transactions - DMA
Page 2702: •      NAK and NYET handling with internal DMA:
Page 2703: •    Bulk and control IN transactions in DMA mode
Page 2704: Figure 762. Normal bulk/control IN transaction - DMA
Page 2704: •    Interrupt OUT transactions in DMA mode
Page 2705: Figure 763. Normal interrupt OUT transactions - DMA mode
Page 2705: •    Interrupt IN transactions in DMA mode
Page 2706: Figure 764. Normal interrupt IN transactions - DMA mode
Page 2706: •    Isochronous OUT transactions in DMA mode
Page 2707: Figure 765. Normal isochronous OUT transaction - DMA mode
Page 2707: •    Isochronous IN transactions in DMA mode
Page 2708: Figure 766. Normal isochronous IN transactions - DMA mode
Page 2708: •    Bulk and control OUT/SETUP split transactions in DMA mode
Page 2709: •    Bulk/control IN split transactions in DMA mode
Page 2709: •    Interrupt OUT split transactions in DMA mode
Page 2709: •    Interrupt IN split transactions in DMA mode
Page 2710: •    Isochronous OUT split transactions in DMA mode
Page 2710: •    Isochronous IN split transactions in DMA mode
Page 2711: 5.   For USB OTG_HS in DMA mode, the OTG_DOEPDMA0 register should have a valid
Page 2711: 3.   For USB OTG_HS in DMA mode, program the OTG_DOEPCTL0 register to enable
Page 2737: RM0433                         Ethernet (ETH): media access control (MAC) with DMA controller
Page 2737: (MAC) with DMA controller
Page 2737: Ethernet peripheral embeds a dedicated DMA for direct memory interface, a media access
Page 2738: Ethernet (ETH): media access control (MAC) with DMA controller                                  RM0433
Page 2739: RM0433                         Ethernet (ETH): media access control (MAC) with DMA controller
Page 2740: Ethernet (ETH): media access control (MAC) with DMA controller                                   RM0433
Page 2740: 57.2.2      DMA features
Page 2740: The DMA block exchanges data between the peripheral and the system memory. DMA
Page 2740: registers (see Section 57.11.2: Ethernet DMA registers) to control the DMA operations. The
Page 2740: DMA block supports the following features:
Page 2740: •   Separate DMA in Transmit path and receive paths
Page 2740: •   Optimization for packet-oriented DMA transfers with packet delimiters
Page 2740: •   Individual programmable burst length for Tx DMA and Rx DMA engines for optimal host
Page 2740: •   Tx DMA channel with TCP Segmentation Offload (TSO) feature enabled
Page 2741: RM0433                         Ethernet (ETH): media access control (MAC) with DMA controller
Page 2742: Ethernet (ETH): media access control (MAC) with DMA controller                                        RM0433
Page 2743: RM0433                                          Ethernet (ETH): media access control (MAC) with DMA controller
Page 2743: •    The direct memory access interface (DMA)
Page 2743: This is the logical DMA module with one physical channel for reception and 1 for
Page 2743: DMA                             MAC
Page 2743: DMA Arbitrer
Page 2743: DMA                             MAC                                        eth_rmii_ref_clk
Page 2743: DMA        MTL                 MAC
Page 2744: Ethernet (ETH): media access control (MAC) with DMA controller                                      RM0433
Page 2744: 57.4.1      DMA controller
Page 2744: The DMA has independent Transmit (Tx) and Receive (Rx) engines. The Tx engine
Page 2744: minimal application CPU intervention. The DMA is designed for packet-oriented data
Page 2744: DMA data structures
Page 2744: The DMA and the application communicate through the following two data structures:
Page 2744: The DMA transfers the data packets received by the MAC to the Rx buffer in system
Page 2744: descriptor list address register (ETH_DMACTXDLAR)) and Channel Rx descriptor list
Page 2744: address register (ETH_DMACRXDLAR)).
Page 2744: respective Tx/Rx, Channel Tx descriptor ring length register (ETH_DMACTXRLR) and
Page 2744: Channel Rx descriptor ring length register (ETH_DMACRXRLR)).
Page 2744: Once the DMA processes the last descriptor in the list, it automatically jumps back to the
Page 2744: data buffers. However, a single descriptor cannot span multiple packets. The DMA skips to
Page 2744: DMA arbitration
Page 2744: The DMA module incorporates an arbiter that performs the arbitration between the Tx and
Page 2744: arbitrations are supported and can be selected through DMA mode register
Page 2744: (ETH_DMAMR):
Page 2744: set by Bits [14:12] of ETH_DMAMR.
Page 2744: •    Fixed-priority arbitration: by default Rx DMA always gets priority over Tx DMA for data
Page 2744: access. Setting bit 11 of ETH_DMAMR register gives priority to the Tx DMA.
Page 2745: RM0433                          Ethernet (ETH): media access control (MAC) with DMA controller
Page 2745: DMA transmission in default mode
Page 2745: The Tx DMA engine in default mode proceeds as follows:
Page 2745: 3.   The DMA fetches the descriptor from the application memory.
Page 2745: 4.   If the DMA detects one of the following conditions, the transmission from that channel
Page 2745: is suspended, bit 2 and 16 of the corresponding DMA channel Status register are set,
Page 2745: 5.   If the acquired descriptor is flagged as owned by the DMA (TDES3[31] = 1), the DMA
Page 2745: 6.   The DMA fetches the Transmit data from the system memory and transfers the data to
Page 2745: 7.   If an Ethernet packet is stored over data buffers in multiple descriptors, the DMA closes
Page 2745: is disabled for this packet, the DMA does not alter TDES0 and TDES1 contents.
Page 2745: 9.   Bit 0 of Channel status register (ETH_DMACSR)) is set after completing transmission
Page 2745: DMA engine returns to step 3.
Page 2745: 10. In the Suspend state, the DMA tries to acquire the descriptor again (and thereby return
Page 2745: descriptor tail pointer register (ETH_DMACTXDTPR) when it receives a Transmit Poll
Page 2745: DMA by clearing Bit 0 of Transmit control register of corresponding DMA channel, the
Page 2745: DMA enters the Stop state.
Page 2746: Ethernet (ETH): media access control (MAC) with DMA controller                                              RM0433
Page 2746: Figure 776. DMA transmission flow (standard mode)
Page 2746: Start Tx DMA                  Start Tx DMA
Page 2746: Suspend Tx DMA
Page 2746: No        DMA Tx           Yes
Page 2746: DMA transmission in OSP (Operate on Second Packet) mode
Page 2746: In Run state, if bit 4 is set in the Channel transmit control register (ETH_DMACTXCR)), the
Page 2747: RM0433                         Ethernet (ETH): media access control (MAC) with DMA controller
Page 2747: In OSP mode, DMA transmission in the Run state operates as described in the following
Page 2747: 1.   The DMA executes steps 1 to 7 of the DMA transmission sequence in default mode
Page 2747: (see Section : DMA transmission in default mode).
Page 2747: 2.   The DMA fetches the next descriptor without closing previous packet last descriptor.
Page 2747: 3.   If the DMA owns the acquired descriptor, the DMA decodes the transmit buffer address
Page 2747: in this descriptor. If the DMA does not own the descriptor, the DMA goes into Suspend
Page 2747: 4.   The DMA fetches the Transmit packet from the system memory and transfers the
Page 2747: 5.   The DMA waits for the packet transmission status and timestamp of previous packet.
Page 2747: When the status is available, the DMA writes the timestamp to TDES0 and TDES1 if
Page 2747: such timestamp was captured (as indicated by a status bit). The DMA writes the status,
Page 2747: Timestamp feature is not enabled for the previous packet, the DMA does not alter the
Page 2747: 6.   The Transmit interrupt is set (if enabled). The DMA fetches the next descriptor and
Page 2747: an underflow error, the DMA goes into Suspend mode (step 7).
Page 2747: DMA performs the following operations:
Page 2747: a)   The DMA writes the timestamp (if enabled for the current packet) to TDES2 and
Page 2747: a)   The DMA writes the status to the corresponding TDES3.
Page 2747: a)   The DMA sets the relevant interrupts and returns to Suspend mode.
Page 2747: If no status is pending and the application stopped the DMA by clearing bit 0 of
Page 2747: Transmit Control Register of corresponding DMA channel, the DMA enters the Stop
Page 2747: 8.   The DMA can exit Suspend mode and enter the Run state (it goes either to step 1 or to
Page 2747: A description of the basic DMA transmission flow in OSP mode in given in Figure 778:
Page 2747: Receive DMA flow.
Page 2748: Ethernet (ETH): media access control (MAC) with DMA controller                                       RM0433
Page 2748: Figure 777. DMA transmission flow (OSP mode)
Page 2748: Start Tx DMA
Page 2748: Tx DMA queue
Page 2748: DMA Tx
Page 2748: Stop DMA
Page 2749: RM0433                          Ethernet (ETH): media access control (MAC) with DMA controller
Page 2749: DMA reception
Page 2749: In the Receive path, the DMA reads a packet from the MTL receive queue and writes it to
Page 2749: the packet data buffers of the corresponding DMA channel.
Page 2749: The reception sequence for Rx DMA engine is as follows (see also Figure 778: Receive
Page 2749: DMA flow):
Page 2749: pointer register of corresponding DMA channel.
Page 2749: 2.   When bit 0 of Channel receive control register (ETH_DMACRXCR)) is set, the DMA
Page 2749: enters the Run state. The DMA looks for free descriptors based on the Rx Current
Page 2749: the DMA channel enters the Suspend state and goes to step 11.
Page 2749: 3.   The DMA fetches the next available descriptor in the ring and decodes the receive data
Page 2749: packet, the DMA writes the timestamp (if available) to the RDES0 and RDES1 of
Page 2749: 5.   The DMA processes the incoming packets and stores them in the data buffers of
Page 2749: 6.   If the current packet transfer is not complete, the DMA closes the current descriptor as
Page 2749: 7.   The DMA retrieves the status of the Receive frame from the MTL and writes the status
Page 2749: 8.   The DMA writes the Frame Length to RDES3 and the VLAN tag to RDES0. The DMA
Page 2749: 9.   If IEEE 1588 timestamp feature is enabled, the DMA stores the timestamp (if
Page 2749: available). The DMA writes the context descriptor after the last descriptor for the
Page 2749: 10. If more descriptors are available in the Rx DMA descriptor ring, go to step 3, otherwise
Page 2749: 11. The Receive DMA exits the Suspend state when a Receive Poll demand is given and
Page 2750: Ethernet (ETH): media access control (MAC) with DMA controller                                              RM0433
Page 2750: Figure 778. Receive DMA flow
Page 2750: t Rx DMA          Start     Stop Rx DMA
Page 2750: Rx DMA stopped?
Page 2750: Supsend Rx DMA            No       Own bit set?
Page 2750: Rx DMA             Yes
Page 2751: RM0433                         Ethernet (ETH): media access control (MAC) with DMA controller
Page 2751: The application or internal DMA pushes the Ethernet packets read from the application
Page 2751: DMA. The Tx queue size is 2048 bytes.
Page 2751: queue. The status (fill level) of the queue is indicated to the application or to DMA when
Page 2751: received. The MTL also indicates the queue fill level so that the DMA can initiate
Page 2752: Ethernet (ETH): media access control (MAC) with DMA controller                                 RM0433
Page 2753: RM0433             Ethernet (ETH): media access control (MAC) with DMA controller
Page 2754: Ethernet (ETH): media access control (MAC) with DMA controller                                  RM0433
Page 2755: RM0433                         Ethernet (ETH): media access control (MAC) with DMA controller
Page 2756: Ethernet (ETH): media access control (MAC) with DMA controller                                        RM0433
Page 2757: RM0433                             Ethernet (ETH): media access control (MAC) with DMA controller
Page 2758: Ethernet (ETH): media access control (MAC) with DMA controller                                           RM0433
Page 2759: RM0433                         Ethernet (ETH): media access control (MAC) with DMA controller
Page 2760: Ethernet (ETH): media access control (MAC) with DMA controller                                       RM0433
Page 2761: RM0433                          Ethernet (ETH): media access control (MAC) with DMA controller
Page 2762: Ethernet (ETH): media access control (MAC) with DMA controller                                RM0433
Page 2763: RM0433                            Ethernet (ETH): media access control (MAC) with DMA controller
Page 2764: Ethernet (ETH): media access control (MAC) with DMA controller                                        RM0433
Page 2765: RM0433                         Ethernet (ETH): media access control (MAC) with DMA controller
Page 2766: Ethernet (ETH): media access control (MAC) with DMA controller                                    RM0433
Page 2767: RM0433                            Ethernet (ETH): media access control (MAC) with DMA controller
Page 2768: Ethernet (ETH): media access control (MAC) with DMA controller                                           RM0433
Page 2769: RM0433                          Ethernet (ETH): media access control (MAC) with DMA controller
Page 2769: The ordinary clock can be a grandmaster or a slave clock. It supports the following
Page 2770: Ethernet (ETH): media access control (MAC) with DMA controller                                  RM0433
Page 2771: RM0433                         Ethernet (ETH): media access control (MAC) with DMA controller
Page 2772: Ethernet (ETH): media access control (MAC) with DMA controller                                    RM0433
Page 2773: RM0433                          Ethernet (ETH): media access control (MAC) with DMA controller
Page 2774: Ethernet (ETH): media access control (MAC) with DMA controller                                   RM0433
Page 2775: RM0433                           Ethernet (ETH): media access control (MAC) with DMA controller
Page 2775: The DMA returns the timestamp to the software application inside the corresponding
Page 2776: Ethernet (ETH): media access control (MAC) with DMA controller                                    RM0433
Page 2777: RM0433                         Ethernet (ETH): media access control (MAC) with DMA controller
Page 2778: Ethernet (ETH): media access control (MAC) with DMA controller                                        RM0433
Page 2779: RM0433                        Ethernet (ETH): media access control (MAC) with DMA controller
Page 2779: The MAC supports the TCP segmentation offload (TSO) feature in which the DMA splits a
Page 2779: This feature is enabled by programming the TSE bit of corresponding ETH_DMACCR
Page 2779: register (see Channel control register (ETH_DMACCR)). It is only supported when the MAC
Page 2780: Ethernet (ETH): media access control (MAC) with DMA controller                                     RM0433
Page 2780: DMA Tx
Page 2780: ets segmented by the DMA. If the TSE bit of TDES3 is enabled, the CRC PAD Control
Page 2780: tion, the DMA uses the Maximum Segment Size (MSS) provided by the application through
Page 2780: context descriptor. The DMA segments only those packets which have payload size greater
Page 2780: ETH_DMACCR (see Channel control register (ETH_DMACCR)) or by providing a context
Page 2780: descriptor. The DMA uses the last programmed value of MSS or the last MSS value pro-
Page 2780: The header length plus MSS size plus programmed PBL value in ETH_DMACTXCR regis-
Page 2780: ter (see Channel transmit control register (ETH_DMACTXCR)) should be lesser than the Tx
Page 2781: RM0433                            Ethernet (ETH): media access control (MAC) with DMA controller
Page 2781: If the Double VLAN feature is selected, then the DMA passes both tags for all segments irre-
Page 2781: packet with two tags. The DMA behavior in this scenario is unpredictable.
Page 2781: While segmenting a TCP packet, the DMA automatically updates the TCP/IP header fields.
Page 2782: Ethernet (ETH): media access control (MAC) with DMA controller                                                  RM0433
Page 2782: the FD bit is set, the DMA reads the header from the header buffer to which the TDES0 is
Page 2782: When the application provides a context descriptor with a valid MSS value, the DMA
Page 2783: RM0433                             Ethernet (ETH): media access control (MAC) with DMA controller
Page 2783: last descriptors of a packet), the DMA does the following:
Page 2783: 1.     The DMA ignores the context and closes the descriptor.
Page 2783: 2.     The DMA indicates the error in descriptor status.
Page 2783: 3.     The DMA generates an interrupt if the CDEE bit is set in the Interrupt enable register
Page 2783: corresponding to a DMA channel (see Channel interrupt enable register
Page 2783: (ETH_DMACIER)).
Page 2783: corresponding to a DMA channel (see Channel status register (ETH_DMACSR)).
Page 2784: Ethernet (ETH): media access control (MAC) with DMA controller                                       RM0433
Page 2785: RM0433                          Ethernet (ETH): media access control (MAC) with DMA controller
Page 2786: Ethernet (ETH): media access control (MAC) with DMA controller                                     RM0433
Page 2787: RM0433                                Ethernet (ETH): media access control (MAC) with DMA controller
Page 2788: Ethernet (ETH): media access control (MAC) with DMA controller                                            RM0433
Page 2789: RM0433                                 Ethernet (ETH): media access control (MAC) with DMA controller
Page 2790: Ethernet (ETH): media access control (MAC) with DMA controller                                        RM0433
Page 2790: events are combined with the events in the DMA on the eth_sbd_intr_it signal. The MAC
Page 2791: RM0433                          Ethernet (ETH): media access control (MAC) with DMA controller
Page 2792: Ethernet (ETH): media access control (MAC) with DMA controller                                             RM0433
Page 2793: RM0433                          Ethernet (ETH): media access control (MAC) with DMA controller
Page 2794: Ethernet (ETH): media access control (MAC) with DMA controller                                   RM0433
Page 2795: RM0433                         Ethernet (ETH): media access control (MAC) with DMA controller
Page 2796: Ethernet (ETH): media access control (MAC) with DMA controller                                    RM0433
Page 2797: RM0433                         Ethernet (ETH): media access control (MAC) with DMA controller
Page 2798: Ethernet (ETH): media access control (MAC) with DMA controller                                        RM0433
Page 2799: RM0433                          Ethernet (ETH): media access control (MAC) with DMA controller
Page 2799: the MTL layers and DMA layers) are idle. The MAC transmitter will exit the LPI IDLE state
Page 2799: and clear the LPITXEN bit as soon as any of functions in the Tx path (DMA, MTL or MAC)
Page 2800: Ethernet (ETH): media access control (MAC) with DMA controller                                    RM0433
Page 2801: RM0433                         Ethernet (ETH): media access control (MAC) with DMA controller
Page 2802: Ethernet (ETH): media access control (MAC) with DMA controller                                     RM0433
Page 2802: 1.   Disable the Transmit DMA and wait for any previous packet transmissions to complete.
Page 2802: ETH_DMACSR register) is received.
Page 2802: 3.   Wait until the Receive DMA empties all the packets from the Rx FIFO to system
Page 2802: DMA (ETH_DMADSR) and MTL (ETH_MTLTXQDR and ETH_MTLRXQDR).
Page 2803: RM0433                          Ethernet (ETH): media access control (MAC) with DMA controller
Page 2803: quickly. When interrupt is asserted, the Interrupt status register (ETH_DMAISR) register is
Page 2803: only, and it contains bits corresponding to each DMA channel (TX & RX pair), the MTL, and
Page 2803: •    ETH_DMACSR: Channel Status (see Channel status register (ETH_DMACSR)))
Page 2803: 57.8.1   DMA interrupts
Page 2803: The ETH_DMACSR: Channel Status register (see Channel status register
Page 2803: (ETH_DMACSR)) captures all the interrupt events of that TxDMA and RxDMA channel. The
Page 2803: ETH_DMACIER: Channel Interrupt Enable register (see Channel interrupt enable register
Page 2803: (ETH_DMACIER)) contains the corresponding enable bits for each of the interrupt event.
Page 2803: There are two groups of interrupts in the DMA channel namely Normal and Abnormal
Page 2803: interrupts.They are indicated by Bits[15:14] of ETH_DMACSR register respectively. The
Page 2803: (ETH_DMAISR) for the cause of the interrupt and clear the source in the respective Status
Page 2803: (ETH_DMAISR) are cleared.
Page 2803: It is not preferable to generate interrupts for every packet transferred by DMA (RI and TI) for
Page 2804: Ethernet (ETH): media access control (MAC) with DMA controller                                          RM0433
Page 2804: In addition to above, an interrupt timer (ETH_DMACRXIWTR: Channel Rx Interrupt
Page 2804: the Rx DMA completes a transfer of a received packet to system memory without asserting
Page 2804: corresponding RIE is enabled in ETH_DMACIER register (see Channel interrupt enable
Page 2804: register (ETH_DMACIER)). The timer is stopped and cleared before it expires, if the RI is
Page 2804: is reflected in the Channel Status register (Channel status register (ETH_DMACSR)). The TI
Page 2804: bit is set whenever the Tx DMA channel closes the descriptor in which the IOC bit is set
Page 2804: (Interrupt On Completion - TDES2[31]). Similarly, the RI bit is set whenever the Rx DMA
Page 2804: interrupt enable register (ETH_DMACIER)).
Page 2804: (bit[17:16]) in the ETH_DMAMR register (DMA mode register (ETH_DMAMR)). Table 523
Page 2804: enabled in ETH_DMACIER register.
Page 2804: MTL interrupt events are combined with the events in the DMA to generate the interrupt
Page 2805: RM0433                          Ethernet (ETH): media access control (MAC) with DMA controller
Page 2805: MAC interrupt events are combined with the events in the DMA to generate the interrupt
Page 2806: Ethernet (ETH): media access control (MAC) with DMA controller                                    RM0433
Page 2806: This chapter provides the instructions for initializing the DMA or MAC registers in the proper
Page 2806: •    DMA initialization (see Section 57.9.1)
Page 2806: 57.9.1      DMA initialization
Page 2806: Complete the following steps to initialize the DMA:
Page 2806: 1.   Provide a software reset to reset all MAC internal registers and logic (bit 0 of DMA
Page 2806: mode register (ETH_DMAMR)).
Page 2806: 2.   Wait for the completion of the reset process (poll bit 0 of the DMA mode register
Page 2806: (ETH_DMAMR), which is cleared when the reset operation is completed).
Page 2806: (ETH_DMASBMR):
Page 2806: descriptors are owned by the DMA (set bit 31 of TDES3/RDES3 descriptor). For more
Page 2806: 5.   Program ETH_DMACTXRLR and ETH_DMACRXRLR registers (see Channel Tx
Page 2806: descriptor ring length register (ETH_DMACTXRLR) and Channel Rx descriptor ring
Page 2806: length register (ETH_DMACRXRLR)). The programmed ring length must be at least 4.
Page 2806: (ETH_DMACTXDLAR), Channel Rx descriptor list address register
Page 2806: (ETH_DMACRXDLAR)). In addition, program the transmit and receive tail pointer
Page 2806: registers that inform the DMA about the available descriptors (see Channel Tx
Page 2807: RM0433                            Ethernet (ETH): media access control (MAC) with DMA controller
Page 2807: descriptor tail pointer register (ETH_DMACTXDTPR) and Channel Rx descriptor tail
Page 2807: pointer register (ETH_DMACRXDTPR)).
Page 2807: 7.   Program ETH_DMACCR, ETH_DMACTXCR and ETH_DMACRXCR registers (see
Page 2807: Channel control register (ETH_DMACCR) and Channel transmit control register
Page 2807: (ETH_DMACTXCR)) to configure the parameters such as the maximum burst-length
Page 2807: (PBL) initiated by the DMA, descriptor skip lengths, OSP for TxDMA, RBSZ for
Page 2807: RxDMA.
Page 2807: 8.   Enable the interrupts by programming the ETH_DMACIER register (see Channel
Page 2807: interrupt enable register (ETH_DMACIER)).
Page 2807: 9.   Start the Receive and Transmit DMAs by setting SR (bit 0) of Channel receive control
Page 2807: register (ETH_DMACRXCR) and ST (bit 0) of the ETH_DMACTXCR (see Channel
Page 2807: transmit control register (ETH_DMACTXCR)).
Page 2807: The following MAC Initialization operations can be performed after DMA initialization. If the
Page 2807: MAC initialization is complete before the DMA is configured, enable the MAC receiver (last
Page 2807: step in the following sequence) only after the DMA is active. Otherwise, received frames fill
Page 2808: Ethernet (ETH): media access control (MAC) with DMA controller                                  RM0433
Page 2808: descriptors are owned by the DMA to resume the transmission and reception of data.
Page 2808: 3.   If the descriptors are not owned by the DMA (or no descriptor is available), the DMA
Page 2808: descriptors and writing the ETH_DMACTXDTPR (see Channel Tx descriptor tail
Page 2808: pointer register (ETH_DMACTXDTPR) and ETH_DMACRXDTPR (see Channel Rx
Page 2808: descriptor tail pointer register (ETH_DMACRXDTPR)).
Page 2808: pointer can be read in ETH_DMACCATXDR and ETH_DMACCARXDR registers (see
Page 2808: Channel current application transmit descriptor register (ETH_DMACCATXDR) and
Page 2808: Channel current application receive descriptor register (ETH_DMACCARXDR)).
Page 2808: receive buffer address pointer can be read in ETH_DMACCATXDR and
Page 2808: ETH_DMACCARXDR registers (see Channel current application transmit descriptor
Page 2808: register (ETH_DMACCATXDR) and Channel current application receive descriptor
Page 2808: register (ETH_DMACCARXDR)).
Page 2809: RM0433                          Ethernet (ETH): media access control (MAC) with DMA controller
Page 2809: 1.   Disable the Transmit DMA (if applicable) by clearing Bit 0 (ST) of ETH_DMACTXCR
Page 2809: register (see Channel transmit control register (ETH_DMACTXCR)).
Page 2809: 4.   Disable the Receive DMA (if applicable), after making sure that the data in the Rx FIFO
Page 2809: 6.   To restart the operation, first start the DMAs, and then enable the MAC Transmitter and
Page 2809: 1. Disable the Transmit DMA (if applicable) by clearing bit 0 (ST) of Channel control
Page 2809: register (ETH_DMACCR).
Page 2809: 7.   Restart the operation by starting the Tx DMA. Then enable the MAC Transmitter and
Page 2809: The Rx DMA does not need to be enabled: since the Receiver is disabled, there are no
Page 2810: Ethernet (ETH): media access control (MAC) with DMA controller                                     RM0433
Page 2811: RM0433                         Ethernet (ETH): media access control (MAC) with DMA controller
Page 2812: Ethernet (ETH): media access control (MAC) with DMA controller                                    RM0433
Page 2812: 14. When a packet transmission is scheduled (when the TxDMA exits IDLE state or when a
Page 2813: RM0433                         Ethernet (ETH): media access control (MAC) with DMA controller
Page 2814: Ethernet (ETH): media access control (MAC) with DMA controller                                     RM0433
Page 2814: 1.   Program TSE bit of the corresponding ETH_DMACTXCR register to enable TCP
Page 2814: packet segmentation in that DMA.
Page 2814: –    MSS of ETH_DMACCR
Page 2814: If MSS field is programmed in both ETH_DMACCR and in the context descriptor,
Page 2815: RM0433                          Ethernet (ETH): media access control (MAC) with DMA controller
Page 2815: In the Ethernet peripheral, the DMA transfers data based on a linked list of descriptors. The
Page 2815: The Ethernet peripheral supports the ring structure for DMA descriptors.
Page 2816: Ethernet (ETH): media access control (MAC) with DMA controller                                                                       RM0433
Page 2816: DSL field of the Channel control register (ETH_DMACCR)). The application needs to pro-
Page 2816: registers of a DMA channel:
Page 2816: •    Channel Tx descriptor ring length register (ETH_DMACTXRLR))
Page 2816: •    Channel Rx descriptor ring length register (ETH_DMACRXRLR))
Page 2816: The Channel Tx descriptor tail pointer register (ETH_DMACTXDTPR) or Channel Rx
Page 2816: descriptor tail pointer register (ETH_DMACRXDTPR) contains the pointer to the descriptor
Page 2816: current descriptor that the DMA can process. The descriptors up to one location less than
Page 2816: the one indicated by the descriptor tail pointer (N – 1) are owned by the DMA. The DMA
Page 2816: The DMA enters the Suspend state when this condition occurs. The application must per-
Page 2816: The DMA automatically wraps around the base address when the end of ring is reached, as
Page 2816: shown in Figure 797: DMA descriptor ring.
Page 2816: Figure 797. DMA descriptor ring
Page 2816: Last descriptor owned by the DMA
Page 2816: Descriptor owned by the DMA
Page 2816: For descriptors owned by the DMA, the OWN bit is set to 1.
Page 2816: (tail pointer) to Descriptor Base Address + 1. The DMA then processes the first descriptor
Page 2817: RM0433                                   Ethernet (ETH): media access control (MAC) with DMA controller
Page 2817: The Ethernet peripheral DMA requires at least one descriptor for a transmit packet. In addi-
Page 2818: Ethernet (ETH): media access control (MAC) with DMA controller                                                        RM0433
Page 2818: 31             IOC      This bit sets the TI bit in the Channel status register (ETH_DMACSR)) when
Page 2819: RM0433                                 Ethernet (ETH): media access control (MAC) with DMA controller
Page 2819: – 1: the DMA owns the descriptor.
Page 2819: The DMA clears this bit after it completes the transfer of data given in the
Page 2820: Ethernet (ETH): media access control (MAC) with DMA controller                                       RM0433
Page 2820: 18        TSE     When this bit is set, the DMA performs the TCP segmentation for a packet.
Page 2821: RM0433                                Ethernet (ETH): media access control (MAC) with DMA controller
Page 2821: The LD bit (TDES3[28]) is set in the descriptor where the DMA writes back the status and
Page 2822: Ethernet (ETH): media access control (MAC) with DMA controller                                                     RM0433
Page 2822: The DMA updates this field with least significant 32 bits of the timestamp captured
Page 2822: 31:0       TTSL for the corresponding Transmit packet. The DMA writes the timestamp only if TTSE
Page 2822: The DMA updates this field with the most significant 32 bits of the timestamp
Page 2822: 31:0       TTSH captured for corresponding Receive packet. The DMA writes the timestamp only if
Page 2822: When this bit is set, it indicates that the DMA owns the descriptor. The
Page 2822: DMA clears this bit when it completes the packet transmission. After the
Page 2823: RM0433                        Ethernet (ETH): media access control (MAC) with DMA controller
Page 2823: 28            LD       This bit is set 1 for last descriptor of a packet. The DMA writes the
Page 2823: 13            FF       This bit indicates that the DMA or MTL flushed the packet because of a
Page 2824: Ethernet (ETH): media access control (MAC) with DMA controller                                           RM0433
Page 2824: – The DMA encountered an empty Transmit Buffer while transmitting
Page 2825: RM0433                                  Ethernet (ETH): media access control (MAC) with DMA controller
Page 2825: descriptor with their corresponding Valid bits set, are stored internally by the DMA.
Page 2825: When the outer or inner VLAN tag is provided with the Valid bit set, the DMA always passes
Page 2825: stored by the DMA. The VLAN tag is inserted or replaced based on the control inputs
Page 2825: descriptor of each packet for which the DMA should use the inner VLAN Tag control input.
Page 2826: Ethernet (ETH): media access control (MAC) with DMA controller                                                             RM0433
Page 2826: 31:0     TTSL this descriptor word. The DMA uses this value as the low word for doing one-step
Page 2826: 31:0      TTSH             this descriptor. The DMA uses this value as the high word for doing one-step
Page 2827: RM0433                    Ethernet (ETH): media access control (MAC) with DMA controller
Page 2827: – 1: the DMA owns the descriptor.
Page 2827: The DMA clears this bit when either of the following conditions is true:
Page 2827: – The DMA completes the packet reception.
Page 2827: 27       OSTC      When this bit is set, the DMA performs a one-step timestamp correction
Page 2827: in the incorrect sequence and the DMA ignored it. The DMA sets this bit
Page 2828: Ethernet (ETH): media access control (MAC) with DMA controller                                       RM0433
Page 2829: RM0433                              Ethernet (ETH): media access control (MAC) with DMA controller
Page 2829: The DMA in the Ethernet peripheral attempts to read a descriptor only if the Tail pointer is
Page 2829: MAC; otherwise, the performance of the DMA is greatly impacted because of the unavail-
Page 2829: All received descriptors are prepared by the software and given to the DMA as “normal”
Page 2829: their content). The DMA reads this descriptor and, after transferring a received packet (or
Page 2829: part of it) to the buffers indicated by the descriptor, the Rx DMA closes the descriptor with
Page 2829: For such packets, the Rx DMA will write the extended status to the next descriptor (without
Page 2830: Ethernet (ETH): media access control (MAC) with DMA controller                                                 RM0433
Page 2830: transferring the start of packet, the DMA performs a write operation with
Page 2830: packet is stored, the DMA ignores the offset address and writes to the full
Page 2830: 31:0     BUF2AP The RxDMA uses the LS bits of the pointer address only while transferring the
Page 2830: the middle or last part of a packet is stored, the DMA ignores RDES2[1:0]=0
Page 2831: RM0433                         Ethernet (ETH): media access control (MAC) with DMA controller
Page 2831: When this bit is set, it indicates that the DMA owns the descriptor. When this bit
Page 2831: is reset, it indicates that the application owns the descriptor. The DMA clears
Page 2831: – The DMA completes the packet reception
Page 2831: 30       IOC      When this bit is set, an interrupt is issued to the application when the DMA
Page 2831: When this bit is set, it indicates to the DMA that the buffer 1 address specified in
Page 2831: 25     BUF2V      RDES0 is valid. The application must set this bit so that the DMA can use the
Page 2831: When set, this indicates to the DMA that the buffer 1 address specified in
Page 2831: points in RDES1, can be used by the DMA to write received packet data.
Page 2832: Ethernet (ETH): media access control (MAC) with DMA controller                                                 RM0433
Page 2833: RM0433                                  Ethernet (ETH): media access control (MAC) with DMA controller
Page 2834: Ethernet (ETH): media access control (MAC) with DMA controller                                                      RM0433
Page 2835: RM0433                    Ethernet (ETH): media access control (MAC) with DMA controller
Page 2836: Ethernet (ETH): media access control (MAC) with DMA controller                                                         RM0433
Page 2836: 1: The DMA owns the descriptor.
Page 2836: The DMA clears this bit when either of the following conditions is true:
Page 2836: – The DMA completes the packet reception
Page 2836: type descriptor. The DMA writes 0 to this bit for normal receive
Page 2837: RM0433                      Ethernet (ETH): media access control (MAC) with DMA controller
Page 2837: written by the DMA. This bit is valid only when the LD bit of RDES3 is
Page 2837: written by the DMA. This bit is valid only when the LD bit of RDES3 is
Page 2837: written by the DMA. This bit is valid only when the LD bit of RDES3 is
Page 2837: 21           OE       Note: This bit is set only when the DMA transfers a partial packet to
Page 2838: Ethernet (ETH): media access control (MAC) with DMA controller                                            RM0433
Page 2839: RM0433                              Ethernet (ETH): media access control (MAC) with DMA controller
Page 2839: DMA.
Page 2839: 31:0    RTSL The DMA updates this field with least significant 32 bits of the timestamp captured
Page 2840: Ethernet (ETH): media access control (MAC) with DMA controller                                               RM0433
Page 2840: 31:0   RTSH The DMA updates this field with most significant 32 bits of the timestamp captured
Page 2840: 1; The DMA owns the descriptor
Page 2840: The DMA clears this bit when either of the following conditions is true:
Page 2840: – The DMA completes the packet reception
Page 2840: descriptor. The DMA writes 1'b1 to this bit for context descriptor.
Page 2841: RM0433                                   Ethernet (ETH): media access control (MAC) with DMA controller
Page 2841: •        DMA registers (see Section 57.11.2: Ethernet DMA registers)
Page 2841: 57.11.2        Ethernet DMA registers
Page 2841: DMA mode register (ETH_DMAMR)
Page 2841: The DMA mode register establishes the bus operating modes for the DMA.
Page 2841: The behavior of the interrupt signal and of the RI/TI bits in the ETH_DMACSR register
Page 2841: These bits control the priority ratio in weighted round-robin arbitration between the Rx DMA
Page 2841: and Tx DMA. These bits are valid only when the DA bit is reset. The priority ratio is Rx:Tx or
Page 2842: Ethernet (ETH): media access control (MAC) with DMA controller                                                   RM0433
Page 2842: When set, this bit indicates that the Tx DMA has higher priority than the Rx DMA during
Page 2842: Bit 1 DA: DMA Tx or Rx Arbitration Scheme
Page 2842: When this bit is set, the MAC and the DMA controller reset the logic and all internal registers of
Page 2842: the DMA, MTL, and MAC. This bit is automatically cleared after the reset operation is complete
Page 2843: RM0433                                   Ethernet (ETH): media access control (MAC) with DMA controller
Page 2843: System bus mode register (ETH_DMASBMR)
Page 2844: Ethernet (ETH): media access control (MAC) with DMA controller                                                                                RM0433
Page 2844: Interrupt status register (ETH_DMAISR)
Page 2844: to determine the interrupt status of DMA channels, MTL queues, and the MAC.
Page 2844: Bit 0 DC0IS: DMA Channel Interrupt Status
Page 2844: This bit indicates an interrupt event in DMA Channel. To reset this bit to 0, the software must
Page 2844: read the corresponding register in DMA Channel to get the exact cause of the interrupt and
Page 2844: Debug status register (ETH_DMADSR)
Page 2844: The Debug status register gives the Receive and Transmit process status for DMA Channel
Page 2845: RM0433                                  Ethernet (ETH): media access control (MAC) with DMA controller
Page 2845: Bits 15:12 TPS0[3:0]: DMA Channel Transmit Process State
Page 2845: This field indicates the Tx DMA FSM state for Channel:
Page 2845: Bits 11:8 RPS0[3:0]: DMA Channel Receive Process State
Page 2845: This field indicates the Rx DMA FSM state for Channel:
Page 2845: Channel control register (ETH_DMACCR)
Page 2845: The DMA Channel Control register specifies the MSS value for segmentation, length to skip
Page 2846: Ethernet (ETH): media access control (MAC) with DMA controller                                                RM0433
Page 2846: When the DSL value is equal to zero, the DMA takes the descriptor table as contiguous.
Page 2846: When this bit is set, the PBL value programmed in Bits[21:16] in ETH_DMACTXCR is
Page 2846: multiplied eight times. Therefore, the DMA transfers the data in 8, 16, 32, 64, 128, and 256
Page 2846: packet. This field is valid only if the TSE bit of ETH_DMACTXCR register is set.
Page 2846: Channel transmit control register (ETH_DMACTXCR)
Page 2846: The DMA Channel Transmit Control register controls the Tx features such as PBL, TCP
Page 2847: RM0433                                Ethernet (ETH): media access control (MAC) with DMA controller
Page 2847: These bits indicate the maximum number of beats to be transferred in one DMA data transfer.
Page 2847: This is the maximum value that is used in a single block Read or Write. The DMA always
Page 2847: 1. Set the PBLx8 mode in ETH_DMACCR.
Page 2847: When this bit is set, the DMA performs the TCP segmentation for packets in Channel i. The
Page 2847: When this bit is set, it instructs the DMA to process the second packet of the Transmit data
Page 2847: When this bit is set, transmission is placed in the Running state. The DMA checks the
Page 2847: The DMA tries to acquire descriptor from either of the following positions:
Page 2847: ETH_DMACTXDLAR register.
Page 2847: If the DMA does not own the current descriptor, the transmission enters the Suspended state
Page 2847: and the TBU bit of the ETH_DMACSR is set. The Start Transmission command is effective
Page 2847: ETH_DMACTXDLAR register, the DMA behavior is unpredictable.
Page 2847: To change the list address, you need to program ETH_DMACTXDLAR register with a new
Page 2848: Ethernet (ETH): media access control (MAC) with DMA controller                                            RM0433
Page 2848: Channel receive control register (ETH_DMACRXCR)
Page 2848: The DMA Channel Receive Control register controls the Rx features such as PBL, buffer
Page 2848: Bit 31 RPF: DMA Rx Channel Packet Flush
Page 2848: When this bit is set to 1, the DMA will automatically flush the
Page 2848: packet from the Rx queues destined to DMA Rx Channel when the DMA Rx
Page 2848: destined to DMA Rx Channel after the DMA is stopped due to a system bus error.
Page 2848: These bits indicate the maximum number of beats to be transferred in one DMA data transfer.
Page 2848: This is the maximum value that is used in a single block Read or Write. The DMA always
Page 2848: 1. Set the PBLx8 mode in the ETH_DMACCR.
Page 2849: RM0433                                Ethernet (ETH): media access control (MAC) with DMA controller
Page 2849: DMA internally takes the LSB bits as all-zero. Therefore, these LSB bits are read-only
Page 2849: When this bit is set, the DMA tries to acquire the descriptor from the Receive list and
Page 2849: The DMA tries to acquire descriptor from either of the following positions:
Page 2849: –    The current position in the list: this is the address set by the ETH_DMACRXDLAR
Page 2849: If the DMA does not own the current descriptor, the reception is suspended and the RBU bit
Page 2849: of the ETH_DMACSR is set. The Start Receive command is effective only when the reception
Page 2849: is stopped. If the command is issued before setting the ETH_DMACRXDLAR register, the
Page 2849: DMA behavior is unpredictable.
Page 2849: When this bit is reset, the Rx DMA operation is stopped after the transfer of the current
Page 2850: Ethernet (ETH): media access control (MAC) with DMA controller                                                   RM0433
Page 2850: Channel Tx descriptor list address register (ETH_DMACTXDLAR)
Page 2850: Channel Tx Descriptor List Address register points the DMA to the start of Transmit
Page 2850: and must be word-aligned. The DMA internally converts it to bus width aligned address by
Page 2850: You can write to this register only when the Tx DMA has stopped, that is, the ST bit is set to
Page 2850: zero in ETH_DMACiTXCR register. When stopped, this register can be written with a new
Page 2850: descriptor list address. When you set the ST bit to 1, the DMA takes the newly-programmed
Page 2850: descriptor base address. If this register is not changed when the ST bit is set to 0, the DMA
Page 2850: DMA ignores the LSB bits (1:0, 2:0, or 3:0) for 32-bit bus width and internally takes these bits
Page 2851: RM0433                                 Ethernet (ETH): media access control (MAC) with DMA controller
Page 2851: Channel Rx descriptor list address register (ETH_DMACRXDLAR)
Page 2851: The Channel Rx Descriptor List Address register points the DMA to the start of Receive
Page 2851: the physical memory space of the application and must be word-aligned. The DMA internally
Page 2851: when Rx DMA has stopped, that is, SR bit is set to zero in ETH_DMACRXCR register.
Page 2851: When you set the SR bit to 1, the DMA takes the newly programmed descriptor base
Page 2851: This field contains the base address of the first descriptor in the Rx Descriptor list. The DMA
Page 2852: Ethernet (ETH): media access control (MAC) with DMA controller                                                RM0433
Page 2852: Channel Tx descriptor tail pointer register (ETH_DMACTXDTPR)
Page 2853: RM0433                                         Ethernet (ETH): media access control (MAC) with DMA controller
Page 2853: Channel Rx descriptor tail pointer register (ETH_DMACRXDTPR)
Page 2853: Channel Tx descriptor ring length register (ETH_DMACTXRLR)
Page 2854: Ethernet (ETH): media access control (MAC) with DMA controller                                                                         RM0433
Page 2854: Channel Rx descriptor ring length register (ETH_DMACRXRLR)
Page 2854: Channel interrupt enable register (ETH_DMACIER)
Page 2855: RM0433                                Ethernet (ETH): media access control (MAC) with DMA controller
Page 2855: interrupts in the ETH_DMACSR:
Page 2855: following interrupts in the ETH_DMACSR:
Page 2856: Ethernet (ETH): media access control (MAC) with DMA controller                                             RM0433
Page 2857: RM0433                                 Ethernet (ETH): media access control (MAC) with DMA controller
Page 2857: Figure 804. Generation of ETH_DMAISR flags
Page 2858: Ethernet (ETH): media access control (MAC) with DMA controller                                                    RM0433
Page 2858: Channel Rx interrupt watchdog timer register (ETH_DMACRXIWTR)
Page 2858: Interrupt (RI) from the DMA. When this register is written with a non-zero value, it enables
Page 2858: the watchdog timer for the RI bit of the ETH_DMACSR register.
Page 2858: The watchdog timer is triggered with the programmed value after the Rx DMA completes the
Page 2858: transfer of a packet for which the RI bit is not set in the ETH_DMACSR, because of the
Page 2858: (ETH_DMACCATXDR)
Page 2858: descriptor read by the DMA.
Page 2859: RM0433                               Ethernet (ETH): media access control (MAC) with DMA controller
Page 2859: The DMA updates this pointer during Tx operation. This pointer is cleared on reset.
Page 2859: Channel current application receive descriptor register (ETH_DMACCARXDR)
Page 2859: descriptor read by the DMA.
Page 2859: The DMA updates this pointer during Rx operation. This pointer is cleared on reset.
Page 2859: Channel current application transmit buffer register (ETH_DMACCATXBR)
Page 2859: buffer address read by the DMA.
Page 2859: The DMA updates this pointer during Tx operation. This pointer is cleared on reset.
Page 2859: Channel current application receive buffer register (ETH_DMACCARXBR)
Page 2860: Ethernet (ETH): media access control (MAC) with DMA controller                                                               RM0433
Page 2860: buffer address read by the DMA.
Page 2860: The DMA updates this pointer during Rx operation. This pointer is cleared on reset.
Page 2860: Channel status register (ETH_DMACSR)
Page 2860: polling to determine the status of the DMA.
Page 2861: RM0433                                 Ethernet (ETH): media access control (MAC) with DMA controller
Page 2861: Bits 21:19 REB[2:0]: Rx DMA Error Bits
Page 2861: 1: Error during data transfer by Rx DMA
Page 2861: 0: No Error during data transfer by Rx DMA
Page 2861: Bits 18:16 TEB[2:0]: Tx DMA Error Bits
Page 2861: 1: Error during data transfer by Tx DMA
Page 2861: 0: No Error during data transfer by Tx DMA
Page 2861: corresponding interrupt bits are enabled in the ETH_DMACIER register:
Page 2861: Only unmasked bits (interrupts for which interrupt enable is set in ETH_DMACIER register)
Page 2861: corresponding interrupt bits are enabled in the ETH_DMACIER register:
Page 2862: Ethernet (ETH): media access control (MAC) with DMA controller                                                 RM0433
Page 2862: This bit indicates that the DMA Tx engine received a context descriptor in the middle of a
Page 2862: packet (in an intermediate descriptor), and the DMA Tx engine ignored it.
Page 2862: the corresponding DMA channel engine disables all bus accesses.
Page 2862: This bit indicates that the DMA filled the first data buffer of the packet. The RI bit of this
Page 2862: DMA cannot acquire it. The Rx process is suspended. To resume processing Rx descriptors,
Page 2862: Receive Descriptor Tail Pointer register of a channel. This bit is set only when the DMA owns
Page 2862: DMA cannot acquire it. Transmission is suspended. The TPS0 field of the
Page 2862: DMA_Debug_Status0 register explains the Transmit Process state transitions.
Page 2863: RM0433                                  Ethernet (ETH): media access control (MAC) with DMA controller
Page 2863: Channel missed frame count register (ETH_DMACMFCR)
Page 2863: This register has the number of packet counter that got dropped by the DMA either due to
Page 2863: Bus Error or due to programing RPF field in ETH_DMACRXCR register.
Page 2863: This counter indicates the number of packet counters that are dropped by the DMA either
Page 2863: RPF field in ETH_DMACRXCR register. The counter gets cleared when this register is read.
Page 2864: Ethernet (ETH): media access control (MAC) with DMA controller                                                                                                                                                                          RM0433
Page 2864: Ethernet DMA register map and reset values
Page 2864: Table 548. ETH_DMA common register map and reset values
Page 2864: ETH_DMAMR
Page 2864: ETH_DMASBMR
Page 2864: ETH_DMAISR
Page 2864: ETH_DMADSR
Page 2864: Table 549. ETH_DMA_CH register map and reset values
Page 2864: ETH_DMACCR                                                                                      DSL                                                                                                MSS
Page 2864: 0x1104      DMACTXCR
Page 2864: 0x1108      DMACRXCR                                                                s s                                                             s                                                                                  s s s R
Page 2865: RM0433                           Ethernet (ETH): media access control (MAC) with DMA controller
Page 2865: Table 549. ETH_DMA_CH register map and reset values (continued)
Page 2865: 0x1114   DMACTXDLAR
Page 2865: 0x111C   DMACRXDLAR
Page 2865: 0x1120   DMACTXDTPR
Page 2865: 0x1128   DMACRXDTPR
Page 2865: 0x112C   DMACTXDRLR
Page 2865: 0x1130   DMACRXDRLR
Page 2865: ETH_DMACIER
Page 2865: 0x1138   DMACRXIWTR
Page 2865: 0x1144   DMACCATXDR
Page 2865: 0x0114C   DMACCARXDR
Page 2865: 0x1154   DMACCATXBR
Page 2865: 0x115C   DMACCARXBR
Page 2865: ETH_DMACSR
Page 2866: Ethernet (ETH): media access control (MAC) with DMA controller                                      RM0433
Page 2866: Table 549. ETH_DMA_CH register map and reset values (continued)
Page 2866: 0x116C     DMACMFCR
Page 2867: RM0433                                   Ethernet (ETH): media access control (MAC) with DMA controller
Page 2868: Ethernet (ETH): media access control (MAC) with DMA controller                                                                        RM0433
Page 2869: RM0433                                Ethernet (ETH): media access control (MAC) with DMA controller
Page 2870: Ethernet (ETH): media access control (MAC) with DMA controller                                                                                            RM0433
Page 2871: RM0433                                Ethernet (ETH): media access control (MAC) with DMA controller
Page 2872: Ethernet (ETH): media access control (MAC) with DMA controller                                                   RM0433
Page 2873: RM0433                                 Ethernet (ETH): media access control (MAC) with DMA controller
Page 2874: Ethernet (ETH): media access control (MAC) with DMA controller                                                 RM0433
Page 2874: or DMA. If the RSF bit is set and the Rx queue overflows when a partial packet is written, the
Page 2874: the application or DMA.
Page 2874: The received packet is transferred to the application or DMA when the packet size within the
Page 2875: RM0433                                 Ethernet (ETH): media access control (MAC) with DMA controller
Page 2875: This counter is incremented by 1 when the DMA discards the packet because of buffer
Page 2876: Ethernet (ETH): media access control (MAC) with DMA controller                                                                     RM0433
Page 2877: Ethernet (ETH): media access control (MAC) with DMA controller
Page 2878: Ethernet (ETH): media access control (MAC) with DMA controller                                            RM0433
Page 2879: RM0433                                     Ethernet (ETH): media access control (MAC) with DMA controller
Page 2880: Ethernet (ETH): media access control (MAC) with DMA controller                                               RM0433
Page 2881: RM0433                                Ethernet (ETH): media access control (MAC) with DMA controller
Page 2882: Ethernet (ETH): media access control (MAC) with DMA controller                                              RM0433
Page 2883: RM0433                              Ethernet (ETH): media access control (MAC) with DMA controller
Page 2884: Ethernet (ETH): media access control (MAC) with DMA controller                                              RM0433
Page 2885: RM0433                              Ethernet (ETH): media access control (MAC) with DMA controller
Page 2886: Ethernet (ETH): media access control (MAC) with DMA controller                                                RM0433
Page 2887: RM0433                                     Ethernet (ETH): media access control (MAC) with DMA controller
Page 2888: Ethernet (ETH): media access control (MAC) with DMA controller                                                  RM0433
Page 2889: RM0433                           Ethernet (ETH): media access control (MAC) with DMA controller
Page 2890: Ethernet (ETH): media access control (MAC) with DMA controller                                                          RM0433
Page 2891: RM0433                                   Ethernet (ETH): media access control (MAC) with DMA controller
Page 2892: Ethernet (ETH): media access control (MAC) with DMA controller                                             RM0433
Page 2893: RM0433                                                  Ethernet (ETH): media access control (MAC) with DMA controller
Page 2894: Ethernet (ETH): media access control (MAC) with DMA controller                                                RM0433
Page 2895: RM0433                                           Ethernet (ETH): media access control (MAC) with DMA controller
Page 2896: Ethernet (ETH): media access control (MAC) with DMA controller                                                        RM0433
Page 2897: RM0433                                      Ethernet (ETH): media access control (MAC) with DMA controller
Page 2898: Ethernet (ETH): media access control (MAC) with DMA controller                                                           RM0433
Page 2899: RM0433                                Ethernet (ETH): media access control (MAC) with DMA controller
Page 2900: Ethernet (ETH): media access control (MAC) with DMA controller                                                          RM0433
Page 2901: RM0433                                           Ethernet (ETH): media access control (MAC) with DMA controller
Page 2902: Ethernet (ETH): media access control (MAC) with DMA controller                                                 RM0433
Page 2903: RM0433                                           Ethernet (ETH): media access control (MAC) with DMA controller
Page 2904: Ethernet (ETH): media access control (MAC) with DMA controller                                                                RM0433
Page 2905: RM0433                                          Ethernet (ETH): media access control (MAC) with DMA controller
Page 2906: Ethernet (ETH): media access control (MAC) with DMA controller                                          RM0433
Page 2907: RM0433                                 Ethernet (ETH): media access control (MAC) with DMA controller
Page 2908: Ethernet (ETH): media access control (MAC) with DMA controller                                                   RM0433
Page 2909: RM0433                                            Ethernet (ETH): media access control (MAC) with DMA controller
Page 2910: Ethernet (ETH): media access control (MAC) with DMA controller                                               RM0433
Page 2911: RM0433                                      Ethernet (ETH): media access control (MAC) with DMA controller
Page 2912: Ethernet (ETH): media access control (MAC) with DMA controller                                                                  RM0433
Page 2913: RM0433                                      Ethernet (ETH): media access control (MAC) with DMA controller
Page 2914: Ethernet (ETH): media access control (MAC) with DMA controller                                                                                                 RM0433
Page 2915: RM0433                                 Ethernet (ETH): media access control (MAC) with DMA controller
Page 2915: Bit 19 DBGMEMA: DMA Debug Registers Enable
Page 2916: Ethernet (ETH): media access control (MAC) with DMA controller                                           RM0433
Page 2917: RM0433                                                Ethernet (ETH): media access control (MAC) with DMA controller
Page 2917: Bits 21:18 TXCHCNT[3:0]: Number of DMA Transmit Channels
Page 2917: This field indicates the number of DMA Transmit channels:
Page 2917: 0000: 1 DMA Tx Channel
Page 2917: 0001: 2 DMA Tx Channels
Page 2917: 0111: 8 DMA Tx
Page 2918: Ethernet (ETH): media access control (MAC) with DMA controller                                                            RM0433
Page 2918: Bits 15:12 RXCHCNT[3:0]: Number of DMA Receive Channels
Page 2918: This field indicates the number of DMA Receive channels:
Page 2918: 0000: 1 DMA Rx Channel
Page 2918: 0001: 2 DMA Rx Channels
Page 2918: 0111: 8 DMA Rx
Page 2919: RM0433                                Ethernet (ETH): media access control (MAC) with DMA controller
Page 2920: Ethernet (ETH): media access control (MAC) with DMA controller                                             RM0433
Page 2921: RM0433                                  Ethernet (ETH): media access control (MAC) with DMA controller
Page 2922: Ethernet (ETH): media access control (MAC) with DMA controller                                                             RM0433
Page 2923: RM0433                                 Ethernet (ETH): media access control (MAC) with DMA controller
Page 2924: Ethernet (ETH): media access control (MAC) with DMA controller                                                 RM0433
Page 2925: RM0433                                    Ethernet (ETH): media access control (MAC) with DMA controller
Page 2926: Ethernet (ETH): media access control (MAC) with DMA controller                                                                                          RM0433
Page 2927: RM0433                                                Ethernet (ETH): media access control (MAC) with DMA controller
Page 2928: Ethernet (ETH): media access control (MAC) with DMA controller                                           RM0433
Page 2929: RM0433                                     Ethernet (ETH): media access control (MAC) with DMA controller
Page 2930: Ethernet (ETH): media access control (MAC) with DMA controller                                                                                      RM0433
Page 2931: RM0433                                 Ethernet (ETH): media access control (MAC) with DMA controller
Page 2932: Ethernet (ETH): media access control (MAC) with DMA controller                                                RM0433
Page 2933: RM0433                                Ethernet (ETH): media access control (MAC) with DMA controller
Page 2934: Ethernet (ETH): media access control (MAC) with DMA controller                                           RM0433
Page 2935: RM0433                                     Ethernet (ETH): media access control (MAC) with DMA controller
Page 2936: Ethernet (ETH): media access control (MAC) with DMA controller                                               RM0433
Page 2937: RM0433                                  Ethernet (ETH): media access control (MAC) with DMA controller
Page 2938: Ethernet (ETH): media access control (MAC) with DMA controller                                               RM0433
Page 2939: RM0433                                 Ethernet (ETH): media access control (MAC) with DMA controller
Page 2940: Ethernet (ETH): media access control (MAC) with DMA controller                                                                       RM0433
Page 2941: RM0433                                Ethernet (ETH): media access control (MAC) with DMA controller
Page 2942: Ethernet (ETH): media access control (MAC) with DMA controller                                             RM0433
Page 2943: RM0433                                  Ethernet (ETH): media access control (MAC) with DMA controller
Page 2944: Ethernet (ETH): media access control (MAC) with DMA controller                                                RM0433
Page 2945: RM0433                                                       Ethernet (ETH): media access control (MAC) with DMA controller
Page 2946: Ethernet (ETH): media access control (MAC) with DMA controller                                            RM0433
Page 2947: RM0433                             Ethernet (ETH): media access control (MAC) with DMA controller
Page 2948: Ethernet (ETH): media access control (MAC) with DMA controller                                                               RM0433
Page 2949: RM0433                               Ethernet (ETH): media access control (MAC) with DMA controller
Page 2950: Ethernet (ETH): media access control (MAC) with DMA controller                                                  RM0433
Page 2951: RM0433                                 Ethernet (ETH): media access control (MAC) with DMA controller
Page 2952: Ethernet (ETH): media access control (MAC) with DMA controller                                                                                   RM0433
Page 2953: RM0433                                 Ethernet (ETH): media access control (MAC) with DMA controller
Page 2954: Ethernet (ETH): media access control (MAC) with DMA controller                                                 RM0433
Page 2955: RM0433                                    Ethernet (ETH): media access control (MAC) with DMA controller
Page 2956: Ethernet (ETH): media access control (MAC) with DMA controller                                              RM0433
Page 2957: RM0433                                 Ethernet (ETH): media access control (MAC) with DMA controller
Page 2958: Ethernet (ETH): media access control (MAC) with DMA controller                                                RM0433
Page 2959: RM0433                                Ethernet (ETH): media access control (MAC) with DMA controller
Page 2960: Ethernet (ETH): media access control (MAC) with DMA controller                                                                                                 RM0433
Page 2961: RM0433                              Ethernet (ETH): media access control (MAC) with DMA controller
Page 2962: Ethernet (ETH): media access control (MAC) with DMA controller                                                                                                RM0433
Page 2963: RM0433                             Ethernet (ETH): media access control (MAC) with DMA controller
Page 2964: Ethernet (ETH): media access control (MAC) with DMA controller                                                RM0433
Page 2965: RM0433                                Ethernet (ETH): media access control (MAC) with DMA controller
Page 2966: Ethernet (ETH): media access control (MAC) with DMA controller                                                                              RM0433
Page 2967: RM0433                                     Ethernet (ETH): media access control (MAC) with DMA controller
Page 2968: Ethernet (ETH): media access control (MAC) with DMA controller                                                                   RM0433
Page 2969: RM0433                                              Ethernet (ETH): media access control (MAC) with DMA controller
Page 2970: Ethernet (ETH): media access control (MAC) with DMA controller
Page 2971: RM0433                                                       Ethernet (ETH): media access control (MAC) with DMA controller
Page 2972: Ethernet (ETH): media access control (MAC) with DMA controller                                    RM0433
Page 2973: RM0433                             Ethernet (ETH): media access control (MAC) with DMA controller
Page 2974: Ethernet (ETH): media access control (MAC) with DMA controller                                                    RM0433
Page 2975: RM0433                                      Ethernet (ETH): media access control (MAC) with DMA controller
Page 2976: Ethernet (ETH): media access control (MAC) with DMA controller                                                      RM0433
Page 2977: RM0433                              Ethernet (ETH): media access control (MAC) with DMA controller
Page 2998: by DMA. This powerful feature allows built-in test software to monitor code execution in
Page 3069: This mode allows the trace to be transferred by DMA into the system memory, or to a
Page 3217: In Table 92: DMAMUX1, DMA1 and DMA2 connections, renamed
Page 3217: dac1_dma and dac2_dma into dac_ch1_dma and dac_ch2_dma,
Page 3217: Section 17: DMA request multiplexer (DMAMUX)
Page 3217: Updated resources in Table 110: DMAMUX1: assignment of
Page 3217: multiplexer inputs to resources to Table 112: DMAMUX1:
Page 3217: Replaced DMA1 by BDMA for events 66 to 73 in Table 133: EXTI
Page 3218: register map and reset values, changed DMAEN bit to reserved for
Page 3220: Suppressed DMA feature.
Page 3222: – Added Section 55.4.7: MDMA request generation
Page 3223: Section 14: MDMA controller (MDMA)
Page 3223: Removed iterator in MDMA_CxISR and MDMA_CxIFCR bit names.
Page 3226: Section 2.1.6: Bus master peripherals: updated MDMA controller,
Page 3226: DMA1/2 controllers and BDMA controller.
Page 3227: Added DSI signals in Table 95: MDMA.
Page 3227: Updated EXTI connection in Table 97: DMAMUX2 and BDMA
Page 3227: dmamux1_req_inx numbering changed to start from
Page 3227: dmamux1_req_in1 instead of dmamux1_req_in0 in Table 96:
Page 3227: DMAMUX1, DMA1 and DMA2 connections and Table 97:
Page 3227: DMAMUX2 and BDMA connections
Page 3227: Section 15: Basic direct memory access controller (BDMA)
Page 3228: Section 16: DMA request multiplexer (DMAMUX)
Page 3228: Updated Section 16.2: DMAMUX main features.
Page 3228: Updated all tables from Table 115: DMAMUX1 and DMAMUX2
Page 3228: instantiation to Table 121: DMAMUX2: assignment of
Page 3228: Updated Section 16.4.5: DMAMUX request generator,
Page 3228: Section 16.6.1: DMAMUX1 request line multiplexer channel x
Page 3228: configuration register (DMAMUX1_CxCR), Section 16.6.2:
Page 3228: DMAMUX2 request line multiplexer channel x configuration register
Page 3228: (DMAMUX2_CxCR), Section 16.6.7: DMAMUX1 request generator
Page 3228: channel x configuration register (DMAMUX1_RGxCR) and
Page 3228: Section 16.6.8: DMAMUX2 request generator channel x
Page 3228: configuration register (DMAMUX2_RGxCR).
Page 3228: Removed Section 12.6.13: DMAMUX illegal access flag register
Page 3228: (DMAMUX_IAFR), Section 12.6.14: DMAMUX illegal access flag
Page 3228: clear status register (DMAMUX_IAFCR) and Section 12.6.15:
Page 3228: DMAMUX illegal access interrupt enable register
Page 3228: (DMAMUX_IAIER).
Page 3228: 15-Jun-2018               Section 17: Chrom-Art Accelerator™ controller (DMA2D)
Page 3228: Added Section 17.4.8: DMA2D output FIFO byte reordering.
Page 3228: Updated Section 17.6.1: DMA2D control register (DMA2D_CR):
Page 3228: Updated Section 17.6.5: DMA2D foreground offset register
Page 3228: (DMA2D_FGOR) LO[15:0] bit description. Updated Section 17.6.7:
Page 3228: DMA2D background offset register (DMA2D_BGOR) LO[15:0] bit
Page 3228: description. Updated Section 17.6.9: DMA2D foreground color
Page 3228: register (DMA2D_FGCOLR). Updated Section 17.6.11: DMA2D
Page 3228: background color register (DMA2D_BGCOLR). Updated
Page 3228: Section 17.6.14: DMA2D output PFC control register
Page 3228: (DMA2D_OPFCCR) adding SB bit 6 description. Updated
Page 3228: Section 17.6.17: DMA2D output offset register (DMA2D_OOR)
Page 3228: Added identification registers: DMA2D_VERR, DMA2D_IPIDR,
Page 3228: DMA2D_SIDR.
Page 3232: DMA controller
Page 3233: Section 57: Ethernet (ETH): media access control (MAC) with DMA
Page 3234: ADC_CR . . . . . . . . . . . . . . . . . . . . . . . . . . . .981    BDMA_CCRx . . . . . . . . . . . . . . . . . . . . . . . . 662
Page 3234: ADC_DIFSEL . . . . . . . . . . . . . . . . . . . . . . . .1007       BDMA_CM0ARx . . . . . . . . . . . . . . . . . . . . . . 667
Page 3234: ADC_DR . . . . . . . . . . . . . . . . . . . . . . . . . . .1000     BDMA_CM1ARx . . . . . . . . . . . . . . . . . . . . . . 668
Page 3234: ADC_HTR1 . . . . . . . . . . . . . . . . . . . . . . . . . .995      BDMA_CNDTRx . . . . . . . . . . . . . . . . . . . . . . 666
Page 3234: ADC_HTR2 . . . . . . . . . . . . . . . . . . . . . . . . .1006       BDMA_CPARx . . . . . . . . . . . . . . . . . . . . . . . 666
Page 3234: ADC_IER . . . . . . . . . . . . . . . . . . . . . . . . . . . .979   BDMA_IFCR . . . . . . . . . . . . . . . . . . . . . . . . . 661
Page 3234: ADC_ISR . . . . . . . . . . . . . . . . . . . . . . . . . . . .977   BDMA_ISR . . . . . . . . . . . . . . . . . . . . . . . . . . 658
Page 3234: AXI_INIx_FN_MOD2 . . . . . . . . . . . . . . . . . . .113            CRYP_DMACR . . . . . . . . . . . . . . . . . . . . . . 1302
Page 3236: DFSDM_FLTxAWLTR . . . . . . . . . . . . . . . . .1140                DMAMUX2_CSR . . . . . . . . . . . . . . . . . . . . . . 684
Page 3236: DFSDM_FLTxAWSR . . . . . . . . . . . . . . . . . .1141               DMAMUX2_CxCR . . . . . . . . . . . . . . . . . . . . . 683
Page 3236: DFSDM_FLTxCNVTIMR . . . . . . . . . . . . . . .1143                  DMAMUX2_RGCFR . . . . . . . . . . . . . . . . . . . 689
Page 3236: DFSDM_FLTxCR1 . . . . . . . . . . . . . . . . . . . .1130            DMAMUX2_RGSR . . . . . . . . . . . . . . . . . . . . 688
Page 3236: DFSDM_FLTxCR2 . . . . . . . . . . . . . . . . . . . .1133            DMAMUX2_RGxCR . . . . . . . . . . . . . . . . . . . 686
Page 3236: DMA_HIFCR . . . . . . . . . . . . . . . . . . . . . . . . .637
Page 3236: DMA_HISR . . . . . . . . . . . . . . . . . . . . . . . . . . .636
Page 3236: DMA_LIFCR . . . . . . . . . . . . . . . . . . . . . . . . . .637
Page 3236: DMA_LISR . . . . . . . . . . . . . . . . . . . . . . . . . . .635    ETF_AUTHSTAT . . . . . . . . . . . . . . . . . . . . . 3083
Page 3236: DMA_SxCR . . . . . . . . . . . . . . . . . . . . . . . . . .638      ETF_BUFWM . . . . . . . . . . . . . . . . . . . . . . . 3077
Page 3236: DMA_SxFCR . . . . . . . . . . . . . . . . . . . . . . . . .643       ETF_CBUFLVL . . . . . . . . . . . . . . . . . . . . . . 3076
Page 3236: DMA_SxM0AR . . . . . . . . . . . . . . . . . . . . . . . .642        ETF_CIDR0 . . . . . . . . . . . . . . . . . . . . . . . . . 3086
Page 3236: DMA_SxM1AR . . . . . . . . . . . . . . . . . . . . . . . .642        ETF_CIDR1 . . . . . . . . . . . . . . . . . . . . . . . . . 3087
Page 3236: DMA_SxNDTR . . . . . . . . . . . . . . . . . . . . . . . .641        ETF_CIDR2 . . . . . . . . . . . . . . . . . . . . . . . . . 3087
Page 3236: DMA_SxPAR . . . . . . . . . . . . . . . . . . . . . . . . .642       ETF_CIDR3 . . . . . . . . . . . . . . . . . . . . . . . . . 3087
Page 3236: DMA2D_AMTCR . . . . . . . . . . . . . . . . . . . . . .726           ETF_CLAIMCLR . . . . . . . . . . . . . . . . . . . . . 3081
Page 3236: DMA2D_BGCMAR . . . . . . . . . . . . . . . . . . . . .721            ETF_CLAIMSET . . . . . . . . . . . . . . . . . . . . . 3081
Page 3236: DMA2D_BGCOLR . . . . . . . . . . . . . . . . . . . . .720            ETF_CTL . . . . . . . . . . . . . . . . . . . . . . . . . . . 3074
Page 3236: DMA2D_BGMAR . . . . . . . . . . . . . . . . . . . . . .714           ETF_DEVID . . . . . . . . . . . . . . . . . . . . . . . . . 3083
Page 3236: DMA2D_BGOR . . . . . . . . . . . . . . . . . . . . . . .714          ETF_DEVTYPE . . . . . . . . . . . . . . . . . . . . . . 3084
Page 3236: DMA2D_BGPFCCR . . . . . . . . . . . . . . . . . . . .718             ETF_FFCR . . . . . . . . . . . . . . . . . . . . . . . . . 3078
Page 3236: DMA2D_CR . . . . . . . . . . . . . . . . . . . . . . . . . .709      ETF_FFSR . . . . . . . . . . . . . . . . . . . . . . . . . 3077
Page 3236: DMA2D_FGCMAR . . . . . . . . . . . . . . . . . . . . .720            ETF_LAR . . . . . . . . . . . . . . . . . . . . . . . . . . . 3082
Page 3236: DMA2D_FGCOLR . . . . . . . . . . . . . . . . . . . . .717            ETF_LBUFLVL . . . . . . . . . . . . . . . . . . . . . . 3076
Page 3236: DMA2D_FGMAR . . . . . . . . . . . . . . . . . . . . . .713           ETF_LSR . . . . . . . . . . . . . . . . . . . . . . . . . . . 3082
Page 3236: DMA2D_FGOR . . . . . . . . . . . . . . . . . . . . . . .713          ETF_MODE . . . . . . . . . . . . . . . . . . . . . . . . . 3075
Page 3236: DMA2D_FGPFCCR . . . . . . . . . . . . . . . . . . . .715             ETF_PIDR0 . . . . . . . . . . . . . . . . . . . . . . . . . 3085
Page 3236: DMA2D_IFCR . . . . . . . . . . . . . . . . . . . . . . . .712        ETF_PIDR1 . . . . . . . . . . . . . . . . . . . . . . . . . 3085
Page 3236: DMA2D_ISR . . . . . . . . . . . . . . . . . . . . . . . . . .711     ETF_PIDR2 . . . . . . . . . . . . . . . . . . . . . . . . . 3085
Page 3236: DMA2D_LWR . . . . . . . . . . . . . . . . . . . . . . . . .725       ETF_PIDR3 . . . . . . . . . . . . . . . . . . . . . . . . . 3086
Page 3236: DMA2D_NLR . . . . . . . . . . . . . . . . . . . . . . . . .725       ETF_PIDR4 . . . . . . . . . . . . . . . . . . . . . . . . . 3084
Page 3236: DMA2D_OCOLR . . . . . . . . . . . . . . . . . . . . . .722           ETF_PSCR . . . . . . . . . . . . . . . . . . . . . . . . . 3080
Page 3236: DMA2D_OMAR . . . . . . . . . . . . . . . . . . . . . . .724          ETF_RRD . . . . . . . . . . . . . . . . . . . . . . . . . . 3072
Page 3236: DMA2D_OOR . . . . . . . . . . . . . . . . . . . . . . . .724         ETF_RRP . . . . . . . . . . . . . . . . . . . . . . . . . . 3072
Page 3236: DMA2D_OPFCCR . . . . . . . . . . . . . . . . . . . . .721            ETF_RSZ . . . . . . . . . . . . . . . . . . . . . . . . . . 3070
Page 3236: DMAMUX1_CFR . . . . . . . . . . . . . . . . . . . . . .685           ETF_RWD . . . . . . . . . . . . . . . . . . . . . . . . . . 3075
Page 3236: DMAMUX1_CSR . . . . . . . . . . . . . . . . . . . . . .684           ETF_RWP . . . . . . . . . . . . . . . . . . . . . . . . . . 3073
Page 3236: DMAMUX1_CxCR . . . . . . . . . . . . . . . . . . . . .682            ETF_STS . . . . . . . . . . . . . . . . . . . . . . . . . . . 3071
Page 3236: DMAMUX1_RGCFR . . . . . . . . . . . . . . . . . . .689               ETF_TRG . . . . . . . . . . . . . . . . . . . . . . . . . . 3073
Page 3236: DMAMUX1_RGSR . . . . . . . . . . . . . . . . . . . . .688            ETH_DMACCARxBR . . . . . . . . . . . . . . . . . 2859
Page 3236: DMAMUX1_RGxCR . . . . . . . . . . . . . . . . . . . .686             ETH_DMACCARxDR . . . . . . . . . . . . . . . . . 2859
Page 3236: DMAMUX2_CFR . . . . . . . . . . . . . . . . . . . . . .685           ETH_DMACCATxBR . . . . . . . . . . . . . . . . . . 2859
Page 3237: ETH_DMACCATxDR . . . . . . . . . . . . . . . . . .2858          ETH_MACMDIOAR . . . . . . . . . . . . . . . . . . . 2918
Page 3237: ETH_DMACCR . . . . . . . . . . . . . . . . . . . . . .2845      ETH_MACMDIODR . . . . . . . . . . . . . . . . . . . 2921
Page 3237: ETH_DMACIER . . . . . . . . . . . . . . . . . . . . . .2854     ETH_MACPCSR . . . . . . . . . . . . . . . . . . . . . 2905
Page 3237: ETH_DMACMFCR . . . . . . . . . . . . . . . . . . . .2863        ETH_MACPFR . . . . . . . . . . . . . . . . . . . . . . 2887
Page 3237: ETH_DMACRxCR . . . . . . . . . . . . . . . . . . . .2848        ETH_MACPOCR . . . . . . . . . . . . . . . . . . . . . 2966
Page 3237: ETH_DMACRxDLAR . . . . . . . . . . . . . . . . . .2851          ETH_MACPPSCR . . . . . . . . . . . . . . . 2960, 2962
Page 3237: ETH_DMACRxDTPR . . . . . . . . . . . . . . . . . .2853          ETH_MACPPSIR . . . . . . . . . . . . . . . . . . . . 2964
Page 3237: ETH_DMACRxIWTR . . . . . . . . . . . . . . . . . .2858          ETH_MACPPSTTNR . . . . . . . . . . . . . . . . . 2964
Page 3237: ETH_DMACRxRLR . . . . . . . . . . . . . . . . . . .2854         ETH_MACPPSTTSR . . . . . . . . . . . . . . . . . . 2963
Page 3237: ETH_DMACSR . . . . . . . . . . . . . . . . . . . . . .2860      ETH_MACPPSWR . . . . . . . . . . . . . . . . . . . 2965
Page 3237: ETH_DMACTxCR . . . . . . . . . . . . . . . . . . . .2846        ETH_MACQ0TxFCR . . . . . . . . . . . . . . . . . . 2898
Page 3237: ETH_DMACTxDLAR . . . . . . . . . . . . . . . . . .2850          ETH_MACRWKPFR . . . . . . . . . . . . . . . . . . 2907
Page 3237: ETH_DMACTxDTPR . . . . . . . . . . . . . . . . . .2852          ETH_MACRxFCR . . . . . . . . . . . . . . . . . . . . 2900
Page 3237: ETH_DMACTxRLR . . . . . . . . . . . . . . . . . . .2853         ETH_MACRxTxSR . . . . . . . . . . . . . . . . . . . 2903
Page 3237: ETH_DMADSR . . . . . . . . . . . . . . . . . . . . . .2844      ETH_MACSPI0R . . . . . . . . . . . . . . . . . . . . . 2966
Page 3237: ETH_DMAISR . . . . . . . . . . . . . . . . . . . . . . .2844    ETH_MACSPI1R . . . . . . . . . . . . . . . . . . . . . 2967
Page 3237: ETH_DMAMR . . . . . . . . . . . . . . . . . . . . . . .2841     ETH_MACSPI2R . . . . . . . . . . . . . . . . . . . . . 2967
Page 3237: ETH_DMASBMR . . . . . . . . . . . . . . . . . . . . .2843       ETH_MACSSIR . . . . . . . . . . . . . . . . . . . . . . 2948
Page 3239: HRTIM_BDMADR . . . . . . . . . . . . . . . . . . . .1504
Page 3242: M7_PPBROM_MEMTYPE . . . . . . . . . . . . . .3146                   OTG_DIEPDMAx . . . . . . . . . . . . . . . . . . . . 2655
Page 3242: MDIOS_DINRx . . . . . . . . . . . . . . . . . . . . . . .2347       OTG_DOEPDMAx . . . . . . . . . . . . . . . . . . . . 2662
Page 3242: MDMA_CxBNDTR . . . . . . . . . . . . . . . . . . . . .605           OTG_DSTS . . . . . . . . . . . . . . . . . . . . . . . . . 2640
Page 3242: MDMA_CxBRUR . . . . . . . . . . . . . . . . . . . . . .609          OTG_DTHRCTL . . . . . . . . . . . . . . . . . . . . . 2646
Page 3242: MDMA_CxCR . . . . . . . . . . . . . . . . . . . . . . . . .600      OTG_DTXFSTSx . . . . . . . . . . . . . . . . . . . . 2656
Page 3242: MDMA_CxDAR . . . . . . . . . . . . . . . . . . . . . . .607         OTG_DVBUSDIS . . . . . . . . . . . . . . . . . . . . 2645
Page 3242: MDMA_CxESR . . . . . . . . . . . . . . . . . . . . . . .598         OTG_DVBUSPULSE . . . . . . . . . . . . . . . . . 2645
Page 3242: MDMA_CxIFCR . . . . . . . . . . . . . . . . . . . . . . .597        OTG_GAHBCFG . . . . . . . . . . . . . . . . . . . . . 2598
Page 3242: MDMA_CxISR . . . . . . . . . . . . . . . . . . . . . . . .596       OTG_GCCFG . . . . . . . . . . . . . . . . . . . . . . . 2618
Page 3242: MDMA_CxLAR . . . . . . . . . . . . . . . . . . . . . . . .610       OTG_GINTMSK . . . . . . . . . . . . . . . . . . . . . 2609
Page 3242: MDMA_CxMAR . . . . . . . . . . . . . . . . . . . . . . .612         OTG_GINTSTS . . . . . . . . . . . . . . . . . . . . . . 2605
Page 3242: MDMA_CxMDR . . . . . . . . . . . . . . . . . . . . . . .612         OTG_GLPMCFG . . . . . . . . . . . . . . . . . . . . . 2620
Page 3242: MDMA_CxSAR . . . . . . . . . . . . . . . . . . . . . . .607         OTG_GOTGCTL . . . . . . . . . . . . . . . . . . . . . 2593
Page 3242: MDMA_CxTBR . . . . . . . . . . . . . . . . . . . . . . . .611       OTG_GOTGINT . . . . . . . . . . . . . . . . . . . . . 2596
Page 3242: MDMA_CxTCR . . . . . . . . . . . . . . . . . . . . . . .602         OTG_GRSTCTL . . . . . . . . . . . . . . . . . . . . . 2603
Page 3242: MDMA_GISR0 . . . . . . . . . . . . . . . . . . . . . . . .595       OTG_GRXFSIZ . . . . . . . . . . . . . . . . . . . . . . 2616
Page 3242: OTG_HCDMAx . . . . . . . . . . . . . . . . . . . . . . 2636
Page 3244: SDMMC_IDMABASE0R . . . . . . . . . . . . . . .2424
Page 3244: SDMMC_IDMABASE1R . . . . . . . . . . . . . . .2424
Page 3244: SDMMC_IDMABSIZER . . . . . . . . . . . . . . . .2423
Page 3244: SDMMC_IDMACTRLR . . . . . . . . . . . . . . . . .2422
Page 3245: SYSCFG_UR2 . . . . . . . . . . . . . . . . . . . . . . . .538      TIM15_DMAR . . . . . . . . . . . . . . . . . . . . . . . 1803
Page 3246: TIMx_DMAR . . . . . . . . . . . . . . 1601, 1684, 1823             TX_SINGLE_COLLISION_GOOD_PACKETS . .
