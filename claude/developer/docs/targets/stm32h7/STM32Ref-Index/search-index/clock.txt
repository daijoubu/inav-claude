Keyword: clock
Occurrences: 5157
================================================================================

Page    2: 2.1.7       Clocks to functional blocks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104
Page    3: 3.3.14     FLASH reset and clocks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 157
Page    6: 5.7.1       Slowing down system clocks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 273
Page    6: 5.7.2       Controlling peripheral clocks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 273
Page    7: 7        Reset and Clock Control (RCC) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 306
Page    7: 7.5     RCC clock block functional description . . . . . . . . . . . . . . . . . . . . . . . . . 317
Page    7: 7.5.1       Clock naming convention . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 319
Page    8: 7.5.3       Clock Security System (CSS) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 324
Page    8: 7.5.4       Clock output generation (MCO1/MCO2) . . . . . . . . . . . . . . . . . . . . . . . 325
Page    8: 7.5.6       System clock (sys_ck) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 330
Page    8: 7.5.7       Handling clock generators in Stop and Standby mode . . . . . . . . . . . . 332
Page    8: 7.5.8       Kernel clock selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 334
Page    8: 7.5.9       General clock concept overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 346
Page    8: 7.5.11      Peripheral clock gating control . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 352
Page    8: 7.5.12      CPU and bus matrix clock gating control . . . . . . . . . . . . . . . . . . . . . . . 357
Page    8: 7.7.3       RCC Internal Clock Source Calibration Register (RCC_ICSCR) . . . . . 365
Page    8: 7.7.4       RCC Clock Recovery RC Register (RCC_CRRCR) . . . . . . . . . . . . . . 366
Page    8: 7.7.5       RCC Clock Configuration Register (RCC_CFGR) . . . . . . . . . . . . . . . . 367
Page    8: 7.7.6       RCC Domain 1 Clock Configuration Register (RCC_D1CFGR) . . . . . 370
Page    8: 7.7.7       RCC Domain 2 Clock Configuration Register (RCC_D2CFGR) . . . . . 372
Page    8: 7.7.8       RCC Domain 3 Clock Configuration Register (RCC_D3CFGR) . . . . . 373
Page    8: 7.7.9       RCC PLLs Clock Source Selection Register (RCC_PLLCKSELR) . . . 374
Page    8: 7.7.17      RCC Domain 1 Kernel Clock Configuration Register
Page    8: 7.7.18      RCC Domain 2 Kernel Clock Configuration Register
Page    8: 7.7.19      RCC Domain 2 Kernel Clock Configuration Register
Page    8: 7.7.20      RCC Domain 3 Kernel Clock Configuration Register
Page    8: 7.7.21      RCC Clock Source Interrupt Enable Register (RCC_CIER) . . . . . . . . 397
Page    9: 7.7.22     RCC Clock Source Interrupt Flag Register (RCC_CIFR) . . . . . . . . . . 399
Page    9: 7.7.23     RCC Clock Source Interrupt Clear Register (RCC_CICR) . . . . . . . . . 401
Page    9: 7.7.25     RCC Clock Control and Status Register (RCC_CSR) . . . . . . . . . . . . . 405
Page    9: 7.7.38     RCC AHB3 Clock Register (RCC_AHB3ENR) . . . . . . . . . . . . . . . . . . 428
Page    9: 7.7.39     RCC AHB1 Clock Register (RCC_AHB1ENR) . . . . . . . . . . . . . . . . . . 430
Page    9: 7.7.40     RCC AHB2 Clock Register (RCC_AHB2ENR) . . . . . . . . . . . . . . . . . . 432
Page    9: 7.7.41     RCC AHB4 Clock Register (RCC_AHB4ENR) . . . . . . . . . . . . . . . . . . 434
Page    9: 7.7.42     RCC APB3 Clock Register (RCC_APB3ENR) . . . . . . . . . . . . . . . . . . . 437
Page    9: 7.7.43     RCC APB1 Clock Register (RCC_APB1LENR) . . . . . . . . . . . . . . . . . . 438
Page    9: 7.7.44     RCC APB1 Clock Register (RCC_APB1HENR) . . . . . . . . . . . . . . . . . 442
Page    9: 7.7.45     RCC APB2 Clock Register (RCC_APB2ENR) . . . . . . . . . . . . . . . . . . . 444
Page    9: 7.7.46     RCC APB4 Clock Register (RCC_APB4ENR) . . . . . . . . . . . . . . . . . . . 447
Page    9: 7.7.47     RCC AHB3 Sleep Clock Register (RCC_AHB3LPENR) . . . . . . . . . . . 450
Page    9: 7.7.48     RCC AHB1 Sleep Clock Register (RCC_AHB1LPENR) . . . . . . . . . . . 452
Page    9: 7.7.49     RCC AHB2 Sleep Clock Register (RCC_AHB2LPENR) . . . . . . . . . . . 454
Page    9: 7.7.50     RCC AHB4 Sleep Clock Register (RCC_AHB4LPENR) . . . . . . . . . . . 456
Page    9: 7.7.51     RCC APB3 Sleep Clock Register (RCC_APB3LPENR) . . . . . . . . . . . 459
Page    9: 7.7.52     RCC APB1 Low Sleep Clock Register (RCC_APB1LLPENR) . . . . . . 460
Page    9: 7.7.53     RCC APB1 High Sleep Clock Register (RCC_APB1HLPENR) . . . . . . 464
Page    9: 7.7.54     RCC APB2 Sleep Clock Register (RCC_APB2LPENR) . . . . . . . . . . . 466
Page    9: 7.7.55     RCC APB4 Sleep Clock Register (RCC_APB4LPENR) . . . . . . . . . . . 469
Page    9: 8        Clock recovery system (CRS) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 482
Page   21: 22.3.8      QUADSPI Free running clock mode . . . . . . . . . . . . . . . . . . . . . . . . . . 869
Page   22: 23.3.5      Output clock phase configuration procedure . . . . . . . . . . . . . . . . . . . . 891
Page   22: 24.3.3      Clocks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 899
Page   26: 27.3.3      COMP reset and clocks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1064
Page   27: 28.3.1      OPAMP reset and clocks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1078
Page   28: 29.4.3      DFSDM reset and clocks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1101
Page   29: 30.3    DCMI clocks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .1154
Page   30: 31.3.4      LTDC reset and clocks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1182
Page   32: 33.3.6      RNG clocking . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1236
Page   35: 36.3.3       Clocks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1344
Page   38: 37.3.5      Clock selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1532
Page   39: 38.3.3      Clock selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1633
Page   41: 39.3.3      Clock selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1702
Page   42: 40.4.4      Clock selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1757
Page   44: 41.3.4     Clock source . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1836
Page   45: 42.4.4      LPTIM reset and clocks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1849
Page   47: 45       Real-time clock (RTC) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1889
Page   47: 45.3.4      Clock and prescalers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1895
Page   47: 45.3.5      Real-time clock and calendar . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1896
Page   47: 45.3.12 RTC reference clock detection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1901
Page   47: 45.3.16 Calibration clock output . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1906
Page   48: 46.4.2      I2C clock requirements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1938
Page   49: 47.5.8      Tolerance of the USART receiver to clock deviation . . . . . . . . . . . . . 2023
Page   50: 48.3.8      Tolerance of the LPUART receiver to clock deviation . . . . . . . . . . . . 2096
Page   52: 49.9.9      Clock generator . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2173
Page   53: 50.3.8       SAI clock generator . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2215
Page   54: 51.3.4      SPDIFRX tolerance to clock deviation . . . . . . . . . . . . . . . . . . . . . . . . 2279
Page   54: 51.3.10 Clocking strategy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2288
Page   57: 54.4.8     AHB and SDMMC_CK clock relation . . . . . . . . . . . . . . . . . . . . . . . . . 2381
Page   57: 54.8.2     SDMMC clock control register (SDMMC_CLKCR) . . . . . . . . . . . . . . 2405
Page   58: 55.3.5       Clock calibration on CAN . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2455
Page   58: and external clock synchronization . . . . . . . . . . . . . . . . . . . . . . . . . . 2471
Page   60: 55.5.1      Clock calibration unit core release register (FCCAN_CCU_CREL) . . 2556
Page   60: 55.5.5      Clock calibration unit interrupt register (FCCAN_CCU_IR) . . . . . . . . 2559
Page   60: 55.5.6      Clock calibration unit interrupt enable register (FCCAN_CCU_IE) . . 2560
Page   64: 56.14.62 OTG power and clock gating control register (OTG_PCGCCTL) . . . 2666
Page   67: 59.3.3      Debug infrastructure powering, clocking and reset . . . . . . . . . . . . . . 3001
Page   69: Table 52.    Ratio between clock timer and pclk . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 331
Page   69: Table 55.    Kernel clock distribution overview. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 335
Page   69: Table 57.    Peripheral clock enabling for D1 and D2 peripherals . . . . . . . . . . . . . . . . . . . . . . . . . . . . 354
Page   69: Table 58.    Peripheral clock enabling for D3 peripherals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 355
Page   73: Table 261.   Clock domain for each register . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1183
Page   73: Table 284.   Processing time (in clock cycle) for ECB, CBC and CTR per 128-bit block . . . . . . . . . . 1297
Page   73: Table 285.   Processing time (in clock cycle) for GCM and CCM per 128-bit block . . . . . . . . . . . . . . 1297
Page   73: Table 290.   Processing time (in clock cycle) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1326
Page   74: Table 310.   Burst mode clock sources from general purpose timer. . . . . . . . . . . . . . . . . . . . . . . . . . 1394
Page   74: Table 312.   Sampling rate and filter length vs FLTFxF[3:0] and clock setting . . . . . . . . . . . . . . . . . . 1403
Page   75: Table 374.   I2C-SMBUS specification clock timings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1957
Page   76: Table 410.   Clock generator programming examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2217
Page   76: Table 453.   AHB and SDMMC_CK clock frequency relation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2381
Page   77: Table 497.   Power and clock gating control and status registers . . . . . . . . . . . . . . . . . . . . . . . . . . . 2593
Page   78: Table 510.   Ordinary clock: PTP messages for snapshot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2769
Page   78: Table 511.   End-to-end transparent clock: PTP messages for snapshot . . . . . . . . . . . . . . . . . . . . . 2770
Page   78: Table 512.   Peer-to-peer transparent clock: PTP messages for snapshot . . . . . . . . . . . . . . . . . . . . 2771
Page   78: Table 520.   MCD clock selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2792
Page   80: Figure 41.   Top-level clock tree. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 318
Page   80: Figure 42.   HSE/LSE clock source . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 319
Page   81: Figure 45.   Core and bus clock generation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 331
Page   81: Figure 46.   Kernel clock distribution for SAIs and DFSDM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 337
Page   81: Figure 47.   Kernel clock distribution for SPIs and SPI/I2S . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 338
Page   81: Figure 48.   Kernel clock distribution for I2Cs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 339
Page   81: Figure 49.   Kernel clock distribution for UARTs, USARTs and LPUART1 . . . . . . . . . . . . . . . . . . . . . 339
Page   81: Figure 50.   Kernel clock distribution for LTDC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 340
Page   81: Figure 51.   Kernel clock distribution for SDMMC, QUADSPI and FMC . . . . . . . . . . . . . . . . . . . . . . . 340
Page   81: Figure 52.   Kernel clock distribution for USB (2) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 341
Page   81: Figure 53.   Kernel clock distribution for Ethernet . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 342
Page   81: Figure 54.   Kernel clock distribution For ADCs, SWPMI, RNG and FDCAN (2) . . . . . . . . . . . . . . . . . 343
Page   81: Figure 55.   Kernel clock distribution for LPTIMs and HDMI-CEC (2) . . . . . . . . . . . . . . . . . . . . . . . . . . 344
Page   81: Figure 57.   Kernel Clock switching . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 350
Page   81: Figure 58.   Peripheral kernel clock enable logic details . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 353
Page   81: Figure 59.   Bus clock enable logic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 358
Page   82: Figure 132. ADC clock scheme . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 900
Page   84: Figure 226. Clock absence timing diagram for SPI . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1106
Page   84: Figure 227. Clock absence timing diagram for Manchester coding . . . . . . . . . . . . . . . . . . . . . . . . . . 1107
Page   87: Figure 346. Counter timing diagram, internal clock divided by 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1519
Page   87: Figure 347. Counter timing diagram, internal clock divided by 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1519
Page   87: Figure 348. Counter timing diagram, internal clock divided by 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1520
Page   87: Figure 349. Counter timing diagram, internal clock divided by N. . . . . . . . . . . . . . . . . . . . . . . . . . . . 1520
Page   87: Figure 352. Counter timing diagram, internal clock divided by 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1523
Page   87: Figure 353. Counter timing diagram, internal clock divided by 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1523
Page   87: Figure 354. Counter timing diagram, internal clock divided by 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1524
Page   87: Figure 355. Counter timing diagram, internal clock divided by N. . . . . . . . . . . . . . . . . . . . . . . . . . . . 1524
Page   87: Figure 357. Counter timing diagram, internal clock divided by 1, TIMx_ARR = 0x6 . . . . . . . . . . . . . 1526
Page   87: Figure 358. Counter timing diagram, internal clock divided by 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1527
Page   87: Figure 359. Counter timing diagram, internal clock divided by 4, TIMx_ARR=0x36 . . . . . . . . . . . . . 1527
Page   87: Figure 360. Counter timing diagram, internal clock divided by N. . . . . . . . . . . . . . . . . . . . . . . . . . . . 1528
Page   87: Figure 366. Control circuit in normal mode, internal clock divided by 1 . . . . . . . . . . . . . . . . . . . . . . . 1532
Page   87: Figure 367. TI2 external clock connection example. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1533
Page   87: Figure 368. Control circuit in external clock mode 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1534
Page   87: Figure 370. Control circuit in external clock mode 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1535
Page   88: Figure 402. Control circuit in external clock mode 2 + trigger mode . . . . . . . . . . . . . . . . . . . . . . . . . 1570
Page   88: Figure 406. Counter timing diagram, internal clock divided by 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1623
Page   88: Figure 407. Counter timing diagram, internal clock divided by 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1624
Page   88: Figure 408. Counter timing diagram, internal clock divided by 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1624
Page   88: Figure 409. Counter timing diagram, internal clock divided by N. . . . . . . . . . . . . . . . . . . . . . . . . . . . 1625
Page   88: Figure 412. Counter timing diagram, internal clock divided by 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1627
Page   88: Figure 413. Counter timing diagram, internal clock divided by 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1627
Page   88: Figure 414. Counter timing diagram, internal clock divided by 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1628
Page   88: Figure 415. Counter timing diagram, internal clock divided by N. . . . . . . . . . . . . . . . . . . . . . . . . . . . 1628
Page   88: Figure 417. Counter timing diagram, internal clock divided by 1, TIMx_ARR=0x6 . . . . . . . . . . . . . . 1630
Page   88: Figure 418. Counter timing diagram, internal clock divided by 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1631
Page   88: Figure 419. Counter timing diagram, internal clock divided by 4, TIMx_ARR=0x36 . . . . . . . . . . . . . 1631
Page   88: Figure 420. Counter timing diagram, internal clock divided by N. . . . . . . . . . . . . . . . . . . . . . . . . . . . 1632
Page   88: Figure 423. Control circuit in normal mode, internal clock divided by 1 . . . . . . . . . . . . . . . . . . . . . . . 1634
Page   88: Figure 424. TI2 external clock connection example. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1634
Page   88: Figure 425. Control circuit in external clock mode 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1635
Page   88: Figure 427. Control circuit in external clock mode 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1636
Page   88: Figure 445. Control circuit in external clock mode 2 + trigger mode . . . . . . . . . . . . . . . . . . . . . . . . . 1657
Page   89: Figure 456. Counter timing diagram, internal clock divided by 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1699
Page   89: Figure 457. Counter timing diagram, internal clock divided by 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1700
Page   89: Figure 458. Counter timing diagram, internal clock divided by 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1700
Page   89: Figure 459. Counter timing diagram, internal clock divided by N. . . . . . . . . . . . . . . . . . . . . . . . . . . . 1701
Page   89: Figure 462. Control circuit in normal mode, internal clock divided by 1 . . . . . . . . . . . . . . . . . . . . . . . 1703
Page   89: Figure 463. TI2 external clock connection example. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1703
Page   89: Figure 464. Control circuit in external clock mode 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1704
Page   89: Figure 482. Counter timing diagram, internal clock divided by 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1753
Page   89: Figure 483. Counter timing diagram, internal clock divided by 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1753
Page   89: Figure 484. Counter timing diagram, internal clock divided by 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1754
Page   89: Figure 485. Counter timing diagram, internal clock divided by N. . . . . . . . . . . . . . . . . . . . . . . . . . . . 1754
Page   89: Figure 489. Control circuit in normal mode, internal clock divided by 1 . . . . . . . . . . . . . . . . . . . . . . . 1758
Page   89: Figure 490. TI2 external clock connection example. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1758
Page   89: Figure 491. Control circuit in external clock mode 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1759
Page   90: Figure 514. Counter timing diagram, internal clock divided by 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1833
Page   90: Figure 515. Counter timing diagram, internal clock divided by 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1834
Page   90: Figure 516. Counter timing diagram, internal clock divided by 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1834
Page   90: Figure 517. Counter timing diagram, internal clock divided by N. . . . . . . . . . . . . . . . . . . . . . . . . . . . 1835
Page   90: Figure 520. Control circuit in normal mode, internal clock divided by 1 . . . . . . . . . . . . . . . . . . . . . . . 1837
Page   91: Figure 549. Master clock generation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1956
Page   91: Figure 572. usart_ker_ck clock divider block diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2018
Page   91: Figure 580. USART data clock timing diagram in synchronous master mode
Page   91: Figure 581. USART data clock timing diagram in synchronous master mode
Page   91: Figure 582. USART data clock timing diagram in synchronous slave mode
Page   92: Figure 598. lpuart_ker_ck clock divider block diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2093
Page   92: Figure 618. Data clock timing diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2143
Page   92: Figure 636. I2S clock generator architecture . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2173
Page   93: Figure 648. Audio block clock generator overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2215
Page   94: Figure 706. DDR mode data packet clocking . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2367
Page   94: Figure 707. DDR mode CRC status / boot acknowledgment clocking. . . . . . . . . . . . . . . . . . . . . . . . 2367
Page   94: Figure 715. Clock stop with SDMMC_CK for DS, HS, SDR12, SDR25. . . . . . . . . . . . . . . . . . . . . . . 2388
Page   94: Figure 716. Clock stop with SDMMC_CK for DDR50, SDR50, SDR104 . . . . . . . . . . . . . . . . . . . . . . 2388
Page   95: Figure 783. Propagation delay calculation in clocks supporting
Page   96: Figure 817. Clock domains of debug infrastructure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3002
Page  101: Cortex-M7 at CPU clock speed, with zero wait states.
Page  101: synchronous interfacing, which allows the APB peripherals to operate with clocks
Page  104: 2.1.7      Clocks to functional blocks
Page  104: Upon reset, clocks to blocks such as peripherals and some memories are disabled (except
Page  104: for the SRAM, DTCM, ITCM and Flash memory). To operate a block with no clock upon
Page  104: reset, the software must first enable its clock through RCC_AHBxENR or RCC_APBxENR
Page  130: words (64-bit units). These memories can be addressed at maximum system clock
Page  135: D1 domain bus clock (embedded Flash memory AXI
Page  135: interface clock)
Page  143: The embedded Flash memory clock must be enabled and running before reading data from
Page  143: embedded Flash memory AXI interface clock frequency (sys_ck) and the internal voltage
Page  143: programming delay parameter (WRHIGHFREQ), the embedded Flash memory clock
Page  144: AXI Interface clock frequency vs VCORE range
Page  144: 0 WS (1 FLASH clock
Page  144: 1 WS (2 FLASH clock
Page  144: 2 WS (3 FLASH clock                 01           ]90 MHz ; 135 MHz]       ]110 MHz ; 165 MHz] ]140 MHz ; 185 MHz]
Page  144: 3 WS (4 FLASH clock
Page  144: 4 WS (5 FLASH clock
Page  144: 1. Refer to the Reset and clock control section RCC section for the maximum product FACLK frequency.
Page  144: to accommodate AXI interface clock frequencies with a safety margin (see Table 12).
Page  144: To increase the embedded Flash memory clock source frequency:
Page  144: 3.    Modify the embedded Flash memory clock source and/or the AXI bus clock prescaler in
Page  144: the RCC_CFGR register of the reset and clock controller (RCC).
Page  144: 4.    Check that the new embedded Flash memory clock source and/or the new AXI bus
Page  144: clock prescaler value are taken in account by reading back the embedded Flash
Page  144: memory clock source status and/or the AXI bus prescaler value in the RCC_CFGR
Page  144: register of the reset and clock controller (RCC).
Page  144: To decrease the embedded Flash memory clock source frequency:
Page  144: 1.    Modify the embedded Flash memory clock source and/or the AXI bus clock prescaler in
Page  144: the RCC_CFGR register of reset and clock controller (RCC).
Page  144: 2.    Check that the embedded Flash memory new clock source and/or the new AXI bus
Page  144: clock prescaler value are taken into account by reading back the embedded Flash
Page  144: memory clock source status and/or the AXI interface prescaler value in the
Page  144: RCC_CFGR register of reset and clock controller (RCC).
Page  148: Program operation timing constraints depend of the embedded Flash memory clock
Page  148: memory clock frequency.
Page  157: 3.3.14   FLASH reset and clocks
Page  157: reset and clock control (RCC). The main effects of this reset are the following:
Page  157: and clock control (RCC). When the reset falls, all option byte registers are reset. When the
Page  157: Clock management
Page  157: The embedded Flash memory uses the microcontroller system clock (sys_ck), here the AXI
Page  157: interface clock.
Page  157: Depending on the device clock and internal supply voltage, specific read and write latency
Page  175: DStop or                                                Clock gated or
Page  175: 1. D3 domain must always be in DStandby mode. When all clocks are stopped and the CPU is in CStop, the
Page  175: procedure to switch the embedded Flash memory into various power mode (run, clock
Page  175: As explain in Table 21, if the embedded Flash memory informs the reset and clock controller
Page  239: (clock frequency) and the voltage scaling.
Page  242: pwr_d1_wkup                    D1 domain bus matrix clock wakeup request
Page  242: pwr_d2_wkup                    D2 domain bus matrix clock wakeup request
Page  242: pwr_d3_wkup                    D3 domain bus matrix clock wakeup request
Page  248: scaling allows optimizing the power consumption when the system is clocked below the
Page  250: For more detail on RTC and backup RAM access, refer to Section 7: Reset and Clock
Page  257: Section 45: Real-time clock (RTC))
Page  258: Section 45: Real-time clock (RTC)).
Page  259: •   DRun/Run/Run* (power ON, clock ON)
Page  259: •   DStop/Stop (power ON, clock OFF)
Page  259: •   DStandby/Standby (Power OFF, clock OFF).
Page  259: in accordance with the system clock frequency. To do this, configure the VOS bits to
Page  260: The operating modes allow controlling the clock distribution to the different system blocks
Page  260: domains depending on its peripheral allocation (see Section 7.5.11: Peripheral clock gating
Page  260: clocked.
Page  260: The CPU clocks is stalled and the CPU subsystem allocated peripheral(s) clock
Page  260: CPU and CPU subsystem peripheral(s) clocks are stalled.
Page  260: The domain bus matrix is clocked. The CPU subsystem operates in CRun or
Page  260: The domain bus matrix clock is stalled.
Page  260: The domain bus matrix is clocked.
Page  261: The domain bus matrix clock is stalled.
Page  261: The system clock and D3 domain bus matrix clock are running:
Page  261: The system clock and D3 domain bus matrix clock is stalled:
Page  261: •   Lowering the system performance by slowing down the system clocks and reducing the
Page  261: •   Gating the clocks to the APBx and AHBx peripherals when they are not used, through
Page  266: clock system reset.
Page  266: contents retained, clock system reset
Page  266: contents retained, clock system reset
Page  266: contents retained, clock system reset
Page  267: 2.   The system performance is first increased to a medium-speed clock from the PLL with
Page  267: increase the clock frequency by enabling the PLL.
Page  267: c)   Once the PLL is locked, switch the system clock.
Page  267: 3.   The system performance is then increased to high-speed clock from the PLL with
Page  267: increase the clock frequency.
Page  267: 4.   The system performance is then reduced to a medium-speed clock with voltage scaling
Page  267: 5.   The next step is to reduce the system performance to HSI clock with voltage scaling
Page  267: a)   Switch the clock to HSI.
Page  267: 6.   The system performance can then be increased to high-speed clock from the PLL. To
Page  267: increase the clock frequency by enabling the PLL.
Page  267: c)   Once the PLL is locked, switch the system clock.
Page  267: When the system performance (clock frequency) is changed, VOS shall be set accordingly.
Page  268: DStop mode. D2 system clock is stopped. The system still provides the high-
Page  268: performance system clock, hence the voltage scaling shall stay at VOS1 level.
Page  268: mode and the system enters Stop mode. The system clock is stopped and the
Page  268: supply level to be reached before enabling the HSI clock. Once the HSI clock is stable,
Page  268: the system clock and the D1 system clock are enabled.
Page  268: 5.   The CPU subsystem allocates a peripheral in the D2 domain. The D2 system clock is
Page  268: clock frequency can be increased by enabling the PLL.
Page  268: c)      Once the PLL is locked, the system clock can be switched.
Page  269: Run from PLL             Clock Stopped                       RUN from HSI            Run from PLL
Page  269: DStandby mode.The D2 domain bus matrix clock is stopped and the power is switched
Page  269: and the system enters Standby mode. The system clock is stopped and the voltage
Page  269: Once the HSI clock is stable, the system clock and D1 subsystem clock are enabled.
Page  270: c)      Once the PLL is locked, the system clock can be switched.
Page  271: DStandby mode. The D2 domain bus matrix clock is stopped and its power switched
Page  271: mode. The D1 domain bus matrix clock is stopped and its power switched off. At the
Page  271: same time the system enters Stop mode. The system clock is stopped and the
Page  271: and waits for the requested supply level to be reached before enabling the HSI clock.
Page  271: Once the HSI clock is stable, the system clock is enabled. The system is running in D3
Page  271: Stop mode. The system clock is stopped and the voltage scaling is lowered to the
Page  271: the HSI clock is stable, the system clock and the D1 subsystem clock are enabled. The
Page  272: RUN from PLL            Clock stopped                           Clock stopped
Page  273: •    Slowing down system clocks (see Section 7.5.6: System clock (sys_ck))
Page  273: •    Controlling individual peripheral clocks (see Section 7.5.11: Peripheral clock gating
Page  273: –    CSleep (CPU clock stopped)
Page  273: –    CStop (CPU subsystem clock stopped)
Page  273: –    DStop (Domain bus matrix clock stopped)
Page  273: –    Stop (System clock stopped)
Page  273: 5.7.1    Slowing down system clocks
Page  273: In Run mode, the speed of the system clock ck_sys can be reduced. For more details refer
Page  273: to Section 7.5.6: System clock (sys_ck).
Page  273: 5.7.2    Controlling peripheral clocks
Page  273: To reduce power consumption in CSleep mode, the individual peripheral clocks can be
Page  273: For the peripherals still receiving a clock in CSleep mode, their clock can be slowed down
Page  275: The CSleep mode applies only to the CPU subsystem. In CSleep mode, the CPU clock is
Page  275: stopped. The CPU subsystem peripheral clocks operate according to the values of
Page  276: The CStop mode applies only to the CPU subsystem. In CStop mode, the CPU clock is
Page  276: stopped. Most CPU subsystem peripheral clocks are stopped too and only the CPU
Page  276: In CStop mode, the CPU subsystem peripherals that have a kernel clock request can still
Page  276: request their kernel clock. For the peripheral that have a PERxAMEN bit, this bit shall be set
Page  276: to be able to request the kernel clock.
Page  277: domain bus matrix clock is stopped.
Page  277: In DStop mode domain peripherals using the LSI or LSE clock and peripherals having a
Page  277: kernel clock request are still able to operate.
Page  277: When exiting from DStop mode, the CPU subsystem clocks, domain(s) bus matrix clocks
Page  277: •      When the system did not enter Stop mode, the CPU subsystem clocks, domain(s) bus
Page  277: matrix clocks and voltage scaling values are the same as when entering DStop mode.
Page  277: •      When the system has entered Stop mode, the CPU subsystem clocks, domain(s) bus
Page  277: matrix clocks and voltage scaling are reset.
Page  278: register (PWR_CPUCR) for any domain request Stop. In Stop mode, the system clock
Page  278: including a PLL and the D3 domain bus matrix clocks are stopped. When HSI or CSI is
Page  278: In Stop mode, the domain peripherals that use the LSI or LSE clock, and the peripherals
Page  278: that have a kernel clock request to select HSI or CSI as source, are still able to operate.
Page  278: •   Real-time clock (RTC)
Page  278: This is configured via the LSION bit in the RCC Clock Control and Status Register
Page  279: •     Peripherals capable of running on the LSI or LSE clock.
Page  279: •     Peripherals having a kernel clock request.
Page  279: •     This is configured via the HSIKERON and CSIKERON bits in the RCC Clock Control
Page  279: To allow peripherals having a kernel clock request to operate in Stop mode, the system must
Page  279: When exiting from Stop mode, the system clock, D3 domain bus matrix clocks and voltage
Page  281: the state of the CPU subsystem clocks, domain(s) bus matrix clocks and voltage scaling
Page  281: •     When the system did not enter Stop mode, the CPU subsystem clocks, domain(s) bus
Page  281: matrix clocks and voltage scaling are the same as when entering DStandby mode.
Page  281: •     When the system has entered Stop or Standby mode, the CPU subsystem clocks,
Page  281: domain(s) bus matrix clocks and voltage scaling are reset.
Page  281: 1.    First check that the domain bus matrix clock is available. The domain bus matrix clock
Page  281: –     When RCC DnCKRDY = 0, the domain bus matrix clock is stalled.
Page  281: –     If RCC DnCKRDY = 1, the domain bus matrix clock is enabled.
Page  282: •   Real-time clock (RTC)
Page  283: •            RTC_AF1 pin if configured for tamper, time stamp, RTC Alarm out, or RTC clock
Page  287: VOS level or ck_sys clock frequency. No limitation applies to the upper bytes.
Page  296: Some peripherals can generate interrupt events, even if their bus interface clock is not
Page  296: The RCC block controls the clock generation in accordance with the system operating
Page  297: •   The RCC also warns the PWR block when a domain clock is activated/deactivated.
Page  297: In this case, the PWR controller waits until the domain clock has been gated, before
Page  297: are forwarded back to the D3 domain after system clock re-synchronization. These events
Page  298: Refer to Section 7: Reset and Clock Control (RCC) and Section 5: Power control (PWR)for
Page  299: LPUART1 can use its own APB clock as kernel clock. Since the system will not enter Stop
Page  299: mode before LPUART1 has completed data transfer, PLLx can be used to provide clocks to
Page  302: In the use-case described herein, the capability of the LPUART1 to request the kernel clock
Page  303: clock is gated. LPTIM4 still operates since it uses ck_lsi clock.
Page  304: with the HSI clock. The CPU must restore the proper clock configuration during the
Page  304: System Clock
Page  304: More power efficient implementations are also possible. As an example the system clock
Page  304: this case, the LPUART1 must use ck_hsi or ck_csi as kernel clock when the system
Page  304: implementation is possible because the LPUART1 can request the kernel clock as long as
Page  306: Reset and Clock Control (RCC)                                                                      RM0433
Page  306: 7          Reset and Clock Control (RCC)
Page  306: The RCC block manages the clock and reset generation for the whole microcontroller.
Page  306: Clock generation block
Page  306: •   Generation and dispatching of clocks for the complete device
Page  306: •   Smart clock gating to reduce power dissipation
Page  306: •   Buffered clock outputs for external devices
Page  306: –    Dedicated interrupt lines for clock security management
Page  306: •   Clock generation handling in Stop and Standby mode
Page  307: RM0433                                                                                                                                            Reset and Clock Control (RCC)
Page  307: Reset                         rcc_c_rst               Clock Manager
Page  307: System Clock
Page  307: En         Clock
Page  307: Clock
Page  307: csi_ck                                                                        clock                          ETH_MII_TX_CLK
Page  308: Reset and Clock Control (RCC)                                                                                   RM0433
Page  308: MCO1                 O         Output clock 1 for external devices
Page  308: MCO2                 O         Output clock 2 for external devices
Page  308: I2S_CKIN               I         External kernel clock input for digital audio interfaces: SPI/I2S, SAI, and DFSDM
Page  308: ETH_MII_TX_CLK            I         External TX clock provided by the Ethernet MII interface
Page  308: ETH_MII_RX_CLK            I         External RX clock provided by the Ethernet MII interface
Page  308: ETH_RMII_REF_CLK            I         External reference clock provided by the Ethernet RMII interface
Page  308: USB_PHY1               I         USB clock input provided by the external USB PHY (OTG_HS_ULPI_CK)
Page  308: rcc_hsecss_it          O          HSE clock security failure interrupt
Page  308: rcc_lsecss_it          O          LSE clock security failure interrupt
Page  308: Event indicating that a HSE clock security failure is detected. This signal is
Page  308: clocks a domain when this domain exits from DStop
Page  309: RM0433                                                                         Reset and Clock Control (RCC)
Page  309: kernel clock.
Page  309: rcc_perx_ker_ck            O     Kernel clock signals generated by the RCC, for some peripherals.
Page  309: rcc_perx_bus_ck            O     Bus interface clock signals generated by the RCC for peripherals.
Page  309: Clocks for APB (rcc_apb_ck), AHB (rcc_ahb_ck) and AXI (rcc_axi_ck) bridges
Page  309: Clock for the CPU, generated by the RCC.
Page  310: Reset and Clock Control (RCC)                                                                       RM0433
Page  311: RM0433                                                               Reset and Clock Control (RCC)
Page  312: Reset and Clock Control (RCC)                                                                RM0433
Page  313: RM0433                                                                                                           Reset and Clock Control (RCC)
Page  314: Reset and Clock Control (RCC)                                                                  RM0433
Page  315: RM0433                                                                  Reset and Clock Control (RCC)
Page  316: Reset and Clock Control (RCC)                                                                                                                RM0433
Page  317: RM0433                                                               Reset and Clock Control (RCC)
Page  317: 7.5      RCC clock block functional description
Page  317: The RCC provides a wide choice of clock generators:
Page  317: •    HSI (High-speed internal oscillator) clock: ~ 8, 16, 32 or 64 MHz
Page  317: •    HSE (High-speed external oscillator) clock: 4 to 48 MHz
Page  317: •    LSE (Low-speed external oscillator) clock: 32 kHz
Page  317: •    LSI (Low-speed internal oscillator) clock: ~ 32 kHz
Page  317: •    CSI (Low-power internal oscillator) clock: ~4 MHz
Page  317: •    HSI48 (High-speed 48 MHz internal oscillator) clock: ~48 MHz
Page  317: It offers a high flexibility for the application to select the appropriate clock for CPU and
Page  317: peripherals, in particular for peripherals that require a specific clock such as Ethernet, USB
Page  317: To optimize the power consumption, each clock source can be switched ON or OFF
Page  317: As shown in the Figure 41, the RCC offers 2 clock outputs (MCO1 and MCO2), with a great
Page  317: flexibility on the clock selection and frequency adjustment.
Page  317: The SCGU block (System Clock Generation Unit) contains several prescalers used to
Page  317: configure the CPU and bus matrix clock frequencies.
Page  317: The PKSU block (Peripheral Kernel clock Selection Unit) provides several dynamic switches
Page  317: allowing a large choice of kernel clock distribution to peripherals.
Page  317: The PKEU (Peripheral Kernel clock Enable Unit) and SCEU (System Clock Enable Unit)
Page  317: blocks perform the peripheral kernel clock gating, and the bus interface/cores/bus matrix
Page  317: clock gating, respectively.
Page  318: Reset and Clock Control (RCC)                                                                                                                                                                                                                   RM0433
Page  318: Figure 41. Top-level clock tree
Page  318: SCGU (System Clock
Page  318: SCEU (System Clock
Page  318: Clock                                                               pll1_p_ck    3
Page  318: PKSU (Peripheral Kernel clock Selection)
Page  318: PKEU (Peripheral Clock Enabling)
Page  319: RM0433                                                                        Reset and Clock Control (RCC)
Page  319: 7.5.1    Clock naming convention
Page  319: The RCC provides clocks to the complete circuit. To avoid misunderstanding, the following
Page  319: •   Peripheral clocks
Page  319: The peripheral clocks are the clocks provided by the RCC to the peripherals. Two kinds
Page  319: of clock are available:
Page  319: –      The bus interface clocks
Page  319: –      The kernel clocks
Page  319: A peripheral receives from the RCC a bus interface clock in order to access its
Page  319: registers, and thus control the peripheral operation. This clock is generally the AHB,
Page  319: APB or AXI clock depending on which bus the peripheral is connected to. Some
Page  319: peripherals only need a bus interface clock (e.g. RNG, TIMx).
Page  319: Some peripherals also require a dedicated clock to handle the interface function. This
Page  319: clock is named “kernel clock”. As an example, peripherals such as SAI have to
Page  319: generate specific and accurate master clock frequencies, which require dedicated
Page  319: kernel clock frequencies. Another advantage of decoupling the bus interface clock from
Page  319: the specific interface needs, is that the bus clock can be changed without
Page  319: •   CPU clocks
Page  319: The CPU clock is the clock provided to the CPU. It is derived from the system clock
Page  319: •   Bus matrix clocks
Page  319: The bus matrix clocks are the clocks provided to the different bridges (APB, AHB or
Page  319: AXI). These clocks are derived from the system clock (sys_ck).
Page  319: The HSE block can generate a clock from two possible sources:
Page  319: •   External clock source
Page  319: Figure 42. HSE/LSE clock source
Page  319: External clock configuration                  Crystal/ceramic resonators configuration
Page  319: External clock
Page  320: Reset and Clock Control (RCC)                                                                        RM0433
Page  320: External clock source (HSE bypass)
Page  320: In this mode, an external clock source must be provided to OSC_IN pin. This mode is
Page  320: (RCC_CR) to ‘1’. The external clock source (square, sinus or triangle) with ~50% duty cycle
Page  320: The HSE can be used when the product requires a very accurate high-speed clock.
Page  320: HSE oscillator is stable or not. At startup, the hse_ck clock is not released until this bit is set
Page  320: by hardware. An interrupt can be generated if enabled in the RCC Clock Source Interrupt
Page  320: •    The HSE is used directly (via software mux) as system clock
Page  320: •    The HSE is selected as reference clock for PLL1, with PLL1 enabled and selected to
Page  320: provide the system clock (via software mux).
Page  320: mode (refer to Section 7.5.7: Handling clock generators in Stop and Standby mode for
Page  320: In addition, the HSE clock can be driven to the MCO1 and MCO2 outputs and used as clock
Page  320: The LSE block can generate a clock from two possible sources:
Page  320: •    External user clock
Page  320: External clock source (LSE bypass)
Page  320: In this mode, an external clock source must be provided to OSC32_IN pin. The input clock
Page  320: clock signal (square, sinus or triangle) with ~50% duty cycle has to drive the OSC32_IN pin
Page  321: RM0433                                                                Reset and Clock Control (RCC)
Page  321: The LSE clock is generated from a 32.768 kHz crystal or ceramic resonator. It has the
Page  321: advantage to provide a low-power highly accurate clock source to the real-time clock (RTC)
Page  321: for clock/calendar or other timing functions.
Page  321: whether the LSE crystal is stable or not. At startup, the LSE crystal output clock signal is not
Page  321: RCC Clock Source Interrupt Enable Register (RCC_CIER).
Page  321: In addition, the LSE clock can be driven to the MCO1 output and used as clock source for
Page  321: The HSI block provides the default clock to the product.
Page  321: The HSI is a high-speed internal RC oscillator which can be used directly as system clock,
Page  321: peripheral clock, or as PLL input. A predivider allows the application to select an HSI output
Page  321: •    Low-cost clock source since no external crystal is required
Page  321: •    The HSI is used directly (via software mux) as system clock
Page  321: •    The HSI is selected as reference clock for PLL1, with PLL1 enabled and selected to
Page  321: provide the system clock (via software mux).
Page  321: Note that the HSIDIV cannot be changed if the HSI is selected as reference clock for at least
Page  321: directly as system clock.
Page  321: The HSIRDY flag indicates if the HSI is stable or not. At startup, the HSI output clock is not
Page  321: The HSI clock can also be used as a backup source (auxiliary clock) if the HSE fails (refer to
Page  321: please refer to Section 7.5.7: Handling clock generators in Stop and Standby mode for
Page  321: In addition, the HSI clock can be driven to the MCO1 output and used as clock source for
Page  322: Reset and Clock Control (RCC)                                                                      RM0433
Page  322: Care must be taken when the HSI is used as kernel clock for communication peripherals,
Page  322: •    the time interval between the moment where the peripheral generates a kernel clock
Page  322: request and the moment where the clock is really available,
Page  322: Note:      HSICAL[11:0] and HSITRIM[5:0] bits are located in the RCC Internal Clock Source
Page  322: The CSI is a low-power RC oscillator which can be used directly as system clock, peripheral
Page  322: clock, or PLL input.
Page  322: •    Low-cost clock source since no external crystal is required
Page  322: The CSI provides a clock frequency of about 4 MHz, while the HSI is able to provide a clock
Page  322: whether the CSI is stable or not. At startup, the CSI output clock is not released until this bit
Page  322: •    The CSI is used directly (via software mux) as system clock
Page  322: •    The CSI is selected as reference clock for PLL1, with PLL1 enabled and selected to
Page  322: provide the system clock (via software mux).
Page  322: Handling clock generators in Stop and Standby mode for additional information).
Page  322: In addition, the CSI clock can be driven to the MCO2 output and used as clock source for
Page  323: RM0433                                                                Reset and Clock Control (RCC)
Page  323: as kernel clock for communication peripherals: the application has to take into account the
Page  323: •    the time interval between the moment where the peripheral generates a kernel clock
Page  323: request and the moment where the clock is really available,
Page  323: Note:    CSICAL[7:0] and CSITRIM[4:0] bits are located into the RCC Internal Clock Source
Page  323: The HSI48 is an RC oscillator that delivers a 48 MHz clock that can be used directly as
Page  323: kernel clock for some peripherals.
Page  323: The HSI48 oscillator mainly aims at providing a high precision clock to the USB peripheral
Page  323: by means of a special Clock Recovery System (CRS) circuitry, which could use the USB
Page  323: For more details on how to configure and use the CRS, please refer to Section 8: Clock
Page  323: HSI48 output clock is not released until this bit is set by hardware.
Page  323: The HSI48 clock can also be driven to the MCO1 multiplexer and used as clock source for
Page  324: Reset and Clock Control (RCC)                                                                      RM0433
Page  324: The LSI acts as a low-power clock source that can be kept running when the system is in
Page  324: (AWU). The clock frequency is around 32 kHz. For more details, refer to the electrical
Page  324: Section 7.5.7: Handling clock generators in Stop and Standby mode for additional
Page  324: At LSI startup, the clock is not provided until the hardware sets the LSIRDY bit. An interrupt
Page  324: can be generated if enabled in the RCC Clock Source Interrupt Enable Register
Page  324: In addition, the LSI clock can be driven to the MCO2 output and used as a clock source for
Page  324: Note:      Bits LSION and LSIRDY are located into the RCC Clock Control and Status Register
Page  324: 7.5.3      Clock Security System (CSS)
Page  324: The clock security system can be enabled by software via the HSECSSON bit. The
Page  324: If a failure is detected on the HSE clock, the system automatically switches to the HSI in
Page  324: order to provide a safe clock. The HSE is then automatically disabled, a clock failure event
Page  324: was used as clock source for PLLs when the failure occurred, the PLLs are also disabled.
Page  324: If an HSE clock failure occurs when the CSS is enabled, the CSS generates an interrupt
Page  324: which causes the automatic generation of an NMI. The HSECSSF flag in RCC Clock Source
Page  324: HSECSSC bit in the RCC Clock Source Interrupt Clear Register (RCC_CICR).
Page  325: RM0433                                                               Reset and Clock Control (RCC)
Page  325: A clock security system on the LSE oscillator can be enabled by software by programming
Page  325: ready (LSERDY set by hardware), and after the RTC clock has been selected through the
Page  325: If an LSE failure is detected, the LSE clock is no more delivered to the RTC but the value of
Page  325: the defective LSE (clear LSEON bit), and can change the RTC clock source (no clock or LSI
Page  325: 7.5.4    Clock output generation (MCO1/MCO2)
Page  325: Two micro-controller clock output (MCO) pins, MCO1 and MCO2, are available. A clock
Page  325: source can be selected for each output.The selected clock can be divided thanks to
Page  325: and MCO2[2:0] located in the RCC Clock Configuration Register (RCC_CFGR).
Page  325: The clock provided to the MCOs outputs must not exceed the maximum pin speed (refer to
Page  326: Reset and Clock Control (RCC)                                                                                                       RM0433
Page  326: •       A main PLL, PLL1, which is generally used to provide clocks to the CPU and to some
Page  326: •       Two dedicated PLLs, PLL2 and PLL3, which are used to generate the kernel clock for
Page  327: RM0433                                                              Reset and Clock Control (RCC)
Page  327: The frequency of the reference clock provided to the PLLs (refx_ck) must range from 1 to
Page  327: Clock Source Selection Register (RCC_PLLCKSELR) in order to match this condition. In
Page  327: clock is lower or equal to 2 MHz, then VCOL must be selected, otherwise VCOH must be
Page  327: system clock. There are other hardware protections on the clock generators (refer to
Page  328: Reset and Clock Control (RCC)                                                                    RM0433
Page  328: •    An HSE failure occurs when HSE or PLL (clocked by HSE) are used as system clock.
Page  329: RM0433                                                                               Reset and Clock Control (RCC)
Page  329: Select clock source (RCC_CKSELR)                 Select clock source (RCC_CKSELR)
Page  330: Reset and Clock Control (RCC)                                                                    RM0433
Page  330: 7.5.6      System clock (sys_ck)
Page  330: System clock selection
Page  330: After a system reset, the HSI is selected as system clock and all PLLs are switched OFF.
Page  330: When a clock source is used for the system clock, it is not possible for the software to
Page  330: Of course, the system clock can be stopped by the hardware when the System enters Stop
Page  330: When the system is running, the user application can select the system clock (sys_ck)
Page  330: This function is controlled by programming the RCC Clock Configuration Register
Page  330: (RCC_CFGR). A switch from one clock source to another occurs only if the target clock
Page  330: source is ready (clock stable after startup delay or PLL locked). If a clock source that is not
Page  330: yet ready is selected, the switch occurs when the clock source is ready.
Page  330: The SWS status bits in the RCC Clock Configuration Register (RCC_CFGR) indicate which
Page  330: clock is currently used as system clock. The other status bits in the RCC_CR register
Page  330: indicate which clock(s) is (are) ready.
Page  330: System clock generation
Page  330: Figure 45 shows a simplified view of the clock distribution for the CPU and busses. All the
Page  330: The D1CPRE divider can be used to adjust the CPU clock. However this also impacts the
Page  330: clock frequency of all bus matrix and HRTIM.
Page  330: In the same way, HPRE divider can be used to adjust the clock for D1 domain bus matrix,
Page  330: but this also impacts the clock frequency of bus matrix of D2 and D3 domains.
Page  331: RM0433                                                                                                     Reset and Clock Control (RCC)
Page  331: Figure 45. Core and bus clock generation
Page  331: System Clock Generation (SCGU)                                                                            D1 DOMAIN
Page  331: CPU Clocks
Page  331: ÷8                                                               CPU Systick clock
Page  331: D1CPRE (1)          HPRE (1)                                                                                           AXI peripheral clocks
Page  331: sys_ck            ÷ 1,2,4,8,…,512     ÷ 1,2,4,8,…,512                                                                                         AHB3 peripheral clocks
Page  331: ÷ 1,2,4,8,16         rcc_pclk3                                     APB3 peripheral clocks
Page  331: SCEU (System Clock Enabling)
Page  331: rcc_hclk[2:1]                                      AHB1&2 peripheral clocks
Page  331: rcc_pclk1                                     APB1 peripheral clocks
Page  331: Timers prescaler clock
Page  331: rcc_pclk2                                     APB2 peripheral clocks
Page  331: Timers prescaler clock
Page  331: sys_d1cpre_ck                                                                                            HRTIM prescaler clock
Page  331: AHB4 peripheral clocks
Page  331: ÷ 1,2,4,8,16                                                       APB4 peripheral clocks
Page  331: This block also provides the clock for the timers (rcc_timx_ker_ck and rcc_timy_ker_ck).
Page  331: The frequency of the timers clock depends on the APB prescaler corresponding to the bus
Page  331: clock frequency.
Page  331: Table 52. Ratio between clock timer and pclk
Page  331: 0xx                 0         →       Frcc_hclk1                Frcc_hclk1              The timer clock is equal to the bus clock.
Page  331: 101                 0         →     Frcc_hclk1 / 2           Frcc_hclk1 / 4             The timer clock is twice as fast as the bus
Page  331: 110                 0         →     Frcc_hclk1 / 4           Frcc_hclk1 / 8             clock.
Page  332: Reset and Clock Control (RCC)                                                                                  RM0433
Page  332: Table 52. Ratio between clock timer and pclk (continued)
Page  332: 0xx           1       →      Frcc_hclk1          Frcc_hclk1         The timer clock is equal to the bus clock.
Page  332: The timer clock is twice as fast as the bus
Page  332: clock.
Page  332: The timer clock is 4 times faster than the bus
Page  332: clock.
Page  332: 1. D2PPRE1 and D2PPRE2 belong to RCC Domain 2 Clock Configuration Register (RCC_D2CFGR).
Page  332: 2. TIMPRE belongs to RCC Clock Configuration Register (RCC_CFGR).
Page  332: 7.5.7         Handling clock generators in Stop and Standby mode
Page  332: When the whole system enters Stop mode, all the clocks (system and kernel clocks) are
Page  332: stopped as well as the following clock sources:
Page  332: the oscillator used as system clock. The STOPKERWUCK bit selects the oscillator used as
Page  332: kernel clock for peripherals. The STOPKERWUCK bit is useful if after a system Stop a
Page  332: peripheral needs a kernel clock generated by an oscillator different from the one used for
Page  332: the system clock.
Page  332: All these bits belong to the RCC Clock Configuration Register (RCC_CFGR). Table 53 gives
Page  332: Activated             Distributed clocks when System
Page  332: mode                System Clock        Kernel Clock
Page  333: RM0433                                                                                Reset and Clock Control (RCC)
Page  333: •    When a dedicated peripheral requests the kernel clock:
Page  333: In this case the peripheral will receive the HSI or CSI according to the kernel clock
Page  333: gated. In that way, the clock will be available immediately when the system exits Stop
Page  333: mode or when a peripheral requests the kernel clock (see Table 54 for details).
Page  333: kernel clock, the RCC registers are reset to their initial values except for the RCC_RSR (or
Page  333: Note as well that the HSI and CSI outputs provide two clock paths (see Figure 41):
Page  333: •    one path for the system clock (hsi_ck or csi_ck)
Page  333: •    one path for the peripheral kernel clock (hsi_ker_ck or csi_ker_ck).
Page  333: When a peripheral requests the kernel clock in system Stop mode, only the path providing
Page  333: Caution:   It is not guaranteed that the CPU will get automatically the same clock frequencies when
Page  333: clock settings remain unchanged. If the D3 domain goes to CStop while the CPU is also in
Page  334: Reset and Clock Control (RCC)                                                                 RM0433
Page  334: 7.5.8      Kernel clock selection
Page  334: Some peripherals are designed to work with two different clock domains that operate
Page  334: •   a clock domain synchronous with the register and bus interface (ckg_bus_perx clock)
Page  334: •   and a clock domain generally synchronous with the peripheral (kernel clock).
Page  334: The benefit of having peripherals supporting these two clock domains is that the user
Page  334: application has more freedom to choose optimized clock frequency for the CPU, bus matrix
Page  334: disturbed if its APB clock is changed on-the-fly.
Page  334: Table 55 shows the kernel clock that the RCC can deliver to the peripherals. Each row of
Page  334: starting from number 4 represents the clock sources. Column 3 gives the maximum allowed
Page  335: RM0433                                                                                                                                                              Reset and Clock Control (RCC)
Page  335: Table 55. Kernel clock distribution overview
Page  335: Clock Sources
Page  335: bus clocks (1)
Page  335: Clock mux      allowed
Page  336: Reset and Clock Control (RCC)                                                                                                                                                                                                                       RM0433
Page  336: Table 55. Kernel clock distribution overview (continued)
Page  336: Clock Sources
Page  336: bus clocks (1)
Page  336: Clock mux      allowed
Page  336: 1. The bus clocks are the bus interface clocks to which the peripherals are connected, it can be APB, AHB or AXI clocks.
Page  336: 2. The per_ck clock could be hse_ck, hsi_ker_ck or csi_ker_ck according to CKPERSEL selection.
Page  336: 3. Clock CSI divided by 122.
Page  336: 5. Clock HSE divided by RTCPRE.
Page  336: Figure 46 to Figure 55 provide a more detailed description of kernel clock distribution. To
Page  336: simplify the drawings, the bus interface clocks (pclk, hclk) are not represented, even if they
Page  336: are gated with enable signals. Refer to Section 7.5.11: Peripheral clock gating control for
Page  336: To reduce the amount of switches, some peripherals share the same kernel clock source.
Page  336: As shown in Figure 46, the kernel clock of the SAIs or SPI(I2S)s can be generated by:
Page  336: •      I2S_CKIN when an external clock reference need to be used.
Page  336: Note:          The SPDIFRX does not require a specific frequency, but only a kernel clock frequency high
Page  336: DFSDM1 can use the same clock as SAI1A. This is useful when DFSDM1 is used for audio
Page  336: To improve the flexibility, SAI4 can use different clock for each sub-block.
Page  336: The SPI/I2S1, 2, and 3 share the same kernel clock source (see Figure 47).
Page  337: RM0433                                                                                                Reset and Clock Control (RCC)
Page  337: Figure 46. Kernel clock distribution for SAIs and DFSDM
Page  337: 2. This figure does not show the connection of the bus interface clock to the peripherals. For details on each enable cell,
Page  337: please refer to Section 7.5.11: Peripheral clock gating control.
Page  337: Peripherals such as SPIs, I2Cs, UARTs do not need a specific kernel clock frequency but a
Page  337: clock fast enough to generate the correct baud rate, or the required bit clock on the serial
Page  338: Reset and Clock Control (RCC)                                                                                             RM0433
Page  338: Note:           UARTs also need the LSE clock when high baud rates are not required.
Page  338: Figure 47. Kernel clock distribution for SPIs and SPI/I2S
Page  338: 2. This figure does not show the connection of the bus interface clock to the peripheral. For details on each enable cell, please
Page  338: refer to Section 7.5.11: Peripheral clock gating control.
Page  339: RM0433                                                                                                            Reset and Clock Control (RCC)
Page  339: Figure 48. Kernel clock distribution for I2Cs
Page  339: 2. This figure does not show the connection of the bus interface clock to the peripheral, for details on each enable cell, please
Page  339: refer to Section 7.5.11: Peripheral clock gating control.
Page  339: Figure 49. Kernel clock distribution for UARTs, USARTs and LPUART1
Page  339: 2. This figure does not show the connection of the bus interface clock to the peripheral, for details on each enable cell, please
Page  339: refer to Section 7.5.11: Peripheral clock gating control.
Page  340: Reset and Clock Control (RCC)                                                                                                     RM0433
Page  340: Figure 50. Kernel clock distribution for LTDC
Page  340: 2. This figure does not show the connection of the bus interface clock to the peripheral. For details on each enable cell, please
Page  340: refer to Section 7.5.11: Peripheral clock gating control.
Page  340: The FMC, QUADSPI and SDMMC1/2 can also use a clock different from the bus interface
Page  340: clock for more flexibility.
Page  340: Figure 51. Kernel clock distribution for SDMMC, QUADSPI and FMC
Page  340: 2. This figure does not show the connection of the bus interface clock to the peripheral. For details on each enable cell, please
Page  340: refer to Section 7.5.11: Peripheral clock gating control.
Page  341: RM0433                                                                                                 Reset and Clock Control (RCC)
Page  341: Figure 52 shows the clock distribution for the USB blocks. The USB1ULPI block receives its
Page  341: clock from the external PHY.
Page  341: The USBxOTG blocks receive the clock for USB communications which can be selected
Page  341: Figure 52. Kernel clock distribution for USB (2)
Page  341: 2. This figure does not show the connection of the bus interface clock to the peripheral. For details on each enable cell, please
Page  341: refer to Section 7.5.11: Peripheral clock gating control.
Page  342: Reset and Clock Control (RCC)                                                                                                  RM0433
Page  342: The Ethernet transmit and receive clocks shall be provided from an external Ethernet PHY.
Page  342: The clock selection for the RX and TX path is controlled via the SYSCFG block.
Page  342: Figure 53. Kernel clock distribution for Ethernet
Page  342: 2. This figure does not show the connection of the bus interface clock to the peripheral. For details on each enable cell, please
Page  342: refer to Section 7.5.11: Peripheral clock gating control.
Page  343: RM0433                                                                                              Reset and Clock Control (RCC)
Page  343: Figure 54. Kernel clock distribution For ADCs, SWPMI, RNG and FDCAN (2)
Page  343: 2. This figure does not show the connection of the bus interface clock to the peripheral. For details on each enable cell, please
Page  343: refer to Section 7.5.11: Peripheral clock gating control.
Page  344: Reset and Clock Control (RCC)                                                                                             RM0433
Page  344: Figure 55. Kernel clock distribution for LPTIMs and HDMI-CEC (2)
Page  344: 2. This figure does not show the connection of the bus interface clock to the peripheral. For details on each enable cell, please
Page  344: refer to Section 7.5.11: Peripheral clock gating control.
Page  344: RTC/AWU clock
Page  344: The rtc_ck clock source can be:
Page  344: •        or the lsi_ck clock
Page  344: The source clock is selected by programming the RTCSEL[1:0] bits in the RCC Backup
Page  344: Domain Control Register (RCC_BDCR) and the RTCPRE[5:0] bits in the RCC Clock
Page  344: If the LSE is selected as RTC clock, the RTC will work normally even if the backup or the
Page  345: RM0433                                                                Reset and Clock Control (RCC)
Page  345: The LSE clock is in the Backup domain, whereas the other oscillators are not. As a
Page  345: •   If LSE is selected as RTC clock, the RTC continues working even if the VDD supply is
Page  345: •   If LSI is selected as the RTC clock, the AWU state is not guaranteed if the VDD supply
Page  345: •   If the HSE clock is used as RTC clock, the RTC state is not guaranteed if the VDD
Page  345: The rtc_ck clock is enabled through RTCEN bit located in the RCC Backup Domain Control
Page  345: The RTC bus interface clock (APB clock) is enabled through RTCAPBEN and
Page  345: Note:      To read the RTC calendar register when the APB clock frequency is less than seven times
Page  345: the RTC clock frequency (FAPB < 7 x FRTCLCK), the software must read the calendar time
Page  345: Watchdog clocks
Page  345: The RCC provides the clock for the four watchdog blocks available on the circuit. The
Page  345: are connected to the APB clock.
Page  345: is forced ON and cannot be disabled. After the LSI oscillator setup delay, the clock is
Page  345: Clock frequency measurement using TIMx
Page  345: Most of the clock source generator frequencies can be measured by means of the input
Page  345: clock source either directly or via PLL1. The number of system clock counts between
Page  345: consecutive edges of the LSE signal gives a measurement of the internal clock period.
Page  345: can determine the internal clock frequency with the same resolution, and trim the
Page  345: the precision is therefore tightly linked to the ratio between the two clock sources. The
Page  345: purpose (see RCC Internal Clock Source Calibration Register (RCC_ICSCR)). When
Page  346: Reset and Clock Control (RCC)                                                                      RM0433
Page  346: the HSI or CSI are used via the PLLx, the system clock can also be fine-tuned by using
Page  346: deviation. By measuring it versus the HSI clock source, it is possible to determine its
Page  346: accurate RTC time base timeouts (when LSI is used as the RTC clock source) and/or
Page  346: 7.5.9      General clock concept overview
Page  346: The RCC handles the distribution of the CPU, bus interface and peripheral clocks for the
Page  346: Section 7.5.1: Clock naming convention for details on clock definitions).
Page  346: bus interface clock. Prior to use a peripheral, the CPU has to enable it (by setting PERxEN
Page  346: The peripheral allocation is used by the RCC to automatically control the clock gating
Page  347: RM0433                                                                                                       Reset and Clock Control (RCC)
Page  347: kernel clocks of all the peripherals of the CPU_SS as well as the CPU clock. The PLLs, if
Page  348: Reset and Clock Control (RCC)                                                                    RM0433
Page  348: The Autonomous mode allows to deliver the peripheral clocks to peripherals located in D3,
Page  348: receives its peripheral clocks according to D3 domain state, if the CPU is in CStop mode:
Page  348: receive their peripheral clocks,
Page  348: •    If the D3 domain is in DStop mode, no peripheral clock is provided.
Page  348: kernel clock on their own, without waking-up the CPU. For example, if the system is
Page  348: peripheral detects a START bit, it will generate a “kernel clock request”. This request
Page  348: enables the HSI or CSI, and a kernel clock is provided only to the requester (in our example
Page  348: clock request” until a new START condition is detected.
Page  349: RM0433                                                                Reset and Clock Control (RCC)
Page  349: The BKPRAM has a dedicated enable in order to gate the bus interface clock. The CPU
Page  349: Note:    The memory interface clocks (Flash and RAM interfaces) can be stopped by software during
Page  349: Refer to Peripheral clock gating control and CPU and bus matrix clock gating control
Page  349: sections for details on clock enabling.
Page  349: –      When the D1 domain is in DRun mode, it means that its bus matrix is clocked, and
Page  349: –      When the D2 domain is in DRun mode, it means that its bus matrix is clocked, and
Page  349: clocked, and the CPU is in CStop mode.
Page  349: clocked. This situation happens when:
Page  350: Reset and Clock Control (RCC)                                                                                  RM0433
Page  350: The CPU can allocate a peripheral and hence control its kernel and bus interface clock.
Page  350: The CPU can control the peripheral clocks gating when it is in CSleep mode via the
Page  350: and bus interface clocks to the peripherals. However they are also used to link peripherals
Page  350: clocks and bus matrix clocks according to CPU states. The PWR block also uses this
Page  350: Clock switches and gating
Page  350: •      Clock switching delays
Page  350: The input selected by the kernel clock switches can be changed dynamically without
Page  350: the new input can only be performed if a clock is present on both inputs. If it not the
Page  350: case, no clock will be provided to the peripheral. To recover from this situation, the user
Page  350: has to provide a valid clock to both inputs.
Page  350: During the transition from one input to another, the kernel clock provided to the
Page  350: peripheral will be gated, in the worst case, during 2 clock cycles of the previously
Page  350: selected clock and 2 clock cycles of the new selected clock. As shown in Figure 57,
Page  350: both input clocks shall be present during transition time.
Page  350: Figure 57. Kernel Clock switching
Page  350: Kernel clock                                                             ...
Page  350: PERx                                        In this area ck_in0 clock can be
Page  351: RM0433                                                               Reset and Clock Control (RCC)
Page  351: •   Clock enabling delays
Page  351: In the same way, the clock gating logic synchronizes the enable command (coming
Page  351: generally from a kernel clock request or PERxEN bits) with the selected clock, in order
Page  351: –    A maximum delay of two periods of the enabled clock may occur between the
Page  351: enable command and the first rising edge of the clock. The enable command can
Page  351: clock request asserted by a peripheral.
Page  351: –    A maximum delay of 1.5 periods of the disabled clock may occur between the
Page  351: disable command and the last falling edge of the clock. The disable command can
Page  351: clock request released by a peripheral.
Page  351: Note:    Both the kernel clock and the bus interface clock are affected by this re-synchronization
Page  351: In addition, the clock enabling delay may strongly increase if the application is enabling
Page  351: PWR before enabling the clocks of the D2 domain. To handle properly this situation the
Page  351: a)   Enable the peripheral clocks (i.e. allocate the peripheral) by writing the
Page  351: operation will take at least 2 clock cycles, which is equal to the max delay of the
Page  351: Note:    When the bus interface clock is not active, read or write accesses to the peripheral registers
Page  352: Reset and Clock Control (RCC)                                                                    RM0433
Page  352: 7.5.11     Peripheral clock gating control
Page  352: As mentioned previously, each peripheral requires a bus interface clock, named
Page  352: rcc_perx_bus_ck (for peripheral ‘x’). This clock can be an APB, AHB or AXI clock,
Page  352: The clocks used as bus interface for peripherals located in D1 domain, could be rcc_aclk,
Page  352: sake, these clocks are named rcc_bus_d1_ck.
Page  352: Some peripherals (SAI, UART...) also require a dedicated clock for their communication
Page  352: interface. This clock is generally asynchronous with respect to the bus interface clock. It is
Page  352: named kernel clock (perx_ker_ckreq). Both clocks can be gated according to several
Page  352: As shown in Figure 58, enabling the kernel and bus interface clocks of each peripheral
Page  352: •    The kernel clock request (perx_ker_ckreq) of the peripheral itself, when the feature is
Page  353: RM0433                                                                                   Reset and Clock Control (RCC)
Page  353: Figure 58. Peripheral kernel clock enable logic details
Page  353: (System              rcc_bus_d2_ck                 (System Clock Enabling Unit)
Page  353: clock generation)                                                                                                     rcc_perx_bus_ck
Page  353: (Peripheral Kernel Clock Enabling)
Page  353: clock Selection)                                             rcc_perx_ker_d3_en
Page  354: Reset and Clock Control (RCC)                                                                                                                                        RM0433
Page  354: Table 57 gives a detailed description of the enabling logic of the peripheral clocks for
Page  354: Table 57. Peripheral clock enabling for D1 and D2 peripherals
Page  354: 0         X              X              X                X             0                   0                No clock provided to the peripheral, because PERxEN=‘0’
Page  354: Kernel and bus interface clocks are provided to the peripheral,
Page  354: No clock provided to the peripheral, because the CPU is in
Page  354: Kernel and bus interface clocks are provided to the peripheral,
Page  354: No clock provided to the peripheral because the PERxLPEN
Page  354: no lse_ck                                                                               No clock provided to the peripheral because CPU is in CStop
Page  354: Kernel clock is provided to the peripheral because PERxEN =
Page  354: The bus interface clock is no provided as the CPU is in CStop
Page  354: Kernel clock is provided to the peripheral because
Page  354: The bus interface clock is no provided as the CPU is in CStop
Page  354: hsi_ker_ck or                                                                            No clock provided to the peripheral because CPU is in CStop,
Page  354: csi_ker_ck                                                                              and no kernel clock request pending
Page  354: 1. For RNG block, the kernel clock is not delivered if the CPU to which it is allocated is in CStop mode, even if the clock
Page  355: RM0433                                                                                                                                            Reset and Clock Control (RCC)
Page  355: As a summary, we can state that the kernel clock is provided to the peripherals located on
Page  355: the peripheral generates a kernel clock request, and the selected clock is hsi_ker_ck
Page  355: the kernel source clock of the peripheral is lse_ck or lsi_ck.
Page  355: The bus interface clock will be provided to the peripherals only when conditions 1 or 2 are
Page  355: Table 58 gives a detailed description of the enabling logic of the kernel clock for all
Page  355: Table 58. Peripheral clock enabling for D3 peripherals
Page  355: No clock provided to the peripheral, as
Page  355: Kernel and bus interface clocks are provided to
Page  355: No clock provided to the peripheral, because
Page  355: CSleep                                                             Kernel and bus interface clocks are provided to
Page  355: the kernel clock gating depends on D3 state
Page  355: No clock provided to the peripheral because
Page  355: The kernel and bus interface clocks are
Page  355: not lse_ck                                                                                           No clock provided to the peripheral, because
Page  356: Reset and Clock Control (RCC)                                                                                                                                               RM0433
Page  356: Table 58. Peripheral clock enabling for D3 peripherals (continued)
Page  356: csi_ker_ck                                                                                         No clock provided to the peripheral, because
Page  356: Kernel clock is provided to the peripheral
Page  356: PERxAMEN=‘1’, and the selected clock is
Page  356: csi_ker_ck                                                                                         The bus interface clock is not provided as D3 is
Page  356: Kernel clock is provided to the peripheral
Page  356: lsi_ck                                                                                        The bus interface clock is not provided as D3 is
Page  356: As a summary, we can state that the kernel clock is provided to the peripherals of D3 if the
Page  356: mode with PERxAMEN = ‘1’, and the peripheral is generating a kernel clock request
Page  356: and the kernel clock source is hsi_ker_ck or csi_ker_ck.
Page  356: mode with PERxAMEN = ‘1’, and the kernel clock source of the peripheral is lse_ck or
Page  356: The bus interface clock will be provided to the peripherals only when condition 1, 2 or 3 is
Page  357: RM0433                                                              Reset and Clock Control (RCC)
Page  357: receive a kernel clock according to D3 state, and not according to the mode of the CPU.
Page  357: Only I2C, U(S)ART and LPUART peripherals are able to request the kernel clock. This
Page  357: 7.5.12   CPU and bus matrix clock gating control
Page  357: For each domain it is possible to control the activation/deactivation of the CPU clock and
Page  357: bus matrix clock.
Page  357: For information about convention naming, refer to Section 7.5.11: Peripheral clock gating
Page  357: The clocks of the CPU, AHB and AXI bridges and APB busses are enabled according to the
Page  357: •   The CPU clock rcc_c_ck is enabled when the CPU is in CRun mode.
Page  357: •   The AXI bridge clock is enabled when the CPU is in CRun mode.
Page  357: •   The D2 domain AHB bridges clocks are enabled when:
Page  357: –    If the CPU is in CSleep with at least an APB bus having its clock enabled.
Page  357: •   The D3 domain AHB bridge clock is enabled when:
Page  357: As shown in the Figure 59, the enabling of the core and bus clock of each domain depends
Page  358: Reset and Clock Control (RCC)                                                                                                     RM0433
Page  358: Figure 59. Bus clock enable logic
Page  358: clock generation)
Page  358: rcc_bus_dx represents the clocks for the bus matrix and the peripheral bus interface for domain x
Page  359: RM0433                                                                                     Reset and Clock Control (RCC)
Page  359: •     rcc_hsecss_it: an interrupt line dedicated to the failure detection of the HSE Clock
Page  359: •     rcc_lsecss_it: an interrupt line dedicated to the failure detection of the LSE Clock
Page  359: The interrupt enable is controlled via RCC Clock Source Interrupt Enable Register
Page  359: The interrupt flags can be checked via RCC Clock Source Interrupt Flag Register
Page  359: (RCC_CIFR), and those flags can be cleared via RCC Clock Source Interrupt Clear
Page  359: LSECSSF         LSE Clock security system failure              LSECSSFIE                Set LSECSSC to ‘1’    rcc_lsecss_it
Page  359: HSECSSF         HSE Clock security system failure              -                        Set HSECSSC to ‘1’    rcc_hsecss_it
Page  360: Reset and Clock Control (RCC)                                                                     RM0433
Page  361: RM0433                                                                                                          Reset and Clock Control (RCC)
Page  361: Bit 29 PLL3RDY: PLL3 clock ready flag
Page  361: Bit 27 PLL2RDY: PLL2 clock ready flag
Page  361: Bit 25 PLL1RDY: PLL1 clock ready flag
Page  361: this bit to ‘0’, if the PLL1 output is used as the system clock.
Page  362: Reset and Clock Control (RCC)                                                                             RM0433
Page  362: Bit 19 HSECSSON: HSE Clock Security System enable
Page  362: Set by software to enable Clock Security System on HSE.
Page  362: When HSECSSON is set, the clock detector is enabled by hardware when the HSE is ready and
Page  362: 0: Clock Security System on HSE OFF (Clock detector OFF) (default after reset)
Page  362: 1: Clock Security System on HSE ON (Clock detector ON if the HSE oscillator is
Page  362: Bit 18 HSEBYP: HSE clock bypass
Page  362: Set and cleared by software to bypass the oscillator with an external clock. The external
Page  362: clock must be enabled with the HSEON bit, to be used by the device.
Page  362: 1: HSE oscillator bypassed with an external clock
Page  362: Bit 17 HSERDY: HSE clock ready flag
Page  362: 0: HSE clock is not ready (default after reset)
Page  362: 1: HSE clock is ready
Page  362: Bit 16 HSEON: HSE clock enable
Page  362: This bit cannot be cleared if the HSE is used directly (via SW mux) as system clock or if the HSE is
Page  362: selected as reference clock for PLL1 with PLL1 enabled (PLL1ON bit set to ‘1’).
Page  362: Bit 15 D2CKRDY: D2 domain clocks ready flag
Page  362: Set by hardware to indicate that the D2 domain clocks are available.
Page  362: 0: D2 domain clocks are not available (default after reset)
Page  362: 1: D2 domain clocks are available
Page  362: Bit 14 D1CKRDY: D1 domain clocks ready flag
Page  362: Set by hardware to indicate that the D1 domain clocks (CPU, bus and peripheral) are available.
Page  362: 0: D1 domain clocks are not available (default after reset)
Page  362: 1: D1 domain clocks are available
Page  362: Bit 13 HSI48RDY: HSI48 clock ready flag
Page  362: 0: HSI48 clock is not ready (default after reset)
Page  362: 1: HSI48 clock is ready
Page  362: Bit 12 HSI48ON: HSI48 clock enable
Page  363: RM0433                                                                          Reset and Clock Control (RCC)
Page  363: Bit 9 CSIKERON: CSI clock enable in Stop mode
Page  363: available as kernel clock for some peripherals. This bit has no effect on the value of CSION.
Page  363: Bit 8 CSIRDY: CSI clock ready flag
Page  363: 0: CSI clock is not ready (default after reset)
Page  363: 1: CSI clock is ready
Page  363: Bit 7 CSION: CSI clock enable
Page  363: Set and reset by software to enable/disable CSI clock for system and/or peripheral.
Page  363: This bit cannot be cleared if the CSI is used directly (via SW mux) as system clock or if the CSI is
Page  363: selected as reference clock for PLL1 with PLL1 enabled (PLL1ON bit set to ‘1’).
Page  363: 1: hsi(_ker)_ck clock frequency reflects the new HSIDIV value
Page  363: Bits 4:3 HSIDIV[1:0]: HSI clock divider
Page  363: These bits allow selecting a division ratio in order to configure the wanted HSI clock frequency. The
Page  363: HSIDIV cannot be changed if the HSI is selected as reference clock for at least one enabled PLL
Page  364: Reset and Clock Control (RCC)                                                                            RM0433
Page  364: Bit 2 HSIRDY: HSI clock ready flag
Page  364: 0: HSI clock is not ready (default after reset)
Page  364: 1: HSI clock is ready
Page  364: Bit 1 HSIKERON: High Speed Internal clock enable in Stop mode
Page  364: available as kernel clock for peripherals. This bit has no effect on the value of HSION.
Page  364: Bit 0 HSION: High Speed Internal clock enable
Page  364: failure of the HSE which is used as the system clock source.
Page  364: This bit cannot be cleared if the HSI is used directly (via SW mux) as system clock or if the HSI is
Page  364: selected as reference clock for PLL1 with PLL1 enabled (PLL1ON bit set to ‘1’).
Page  365: RM0433                                                                              Reset and Clock Control (RCC)
Page  365: 7.7.3          RCC Internal Clock Source Calibration Register (RCC_ICSCR)
Page  365: Bits 30:26 CSITRIM[4:0]: CSI clock trimming
Page  365: Bits 25:18 CSICAL[7:0]: CSI clock calibration
Page  365: Bits 17:12 HSITRIM[5:0]: HSI clock trimming
Page  365: Bits 11:0 HSICAL[11:0]: HSI clock calibration
Page  366: Reset and Clock Control (RCC)                                                                                    RM0433
Page  366: 7.7.4             RCC Clock Recovery RC Register (RCC_CRRCR)
Page  366: Bits 9:0 HSI48CAL[9:0]: Internal RC 48 MHz clock calibration
Page  367: RM0433                                                                                             Reset and Clock Control (RCC)
Page  367: 7.7.5                   RCC Clock Configuration Register (RCC_CFGR)
Page  367: Bits 31:29 MCO2[2:0]: Micro-controller clock output 2
Page  367: Set and cleared by software. Clock source selection may generate glitches on MCO2.
Page  367: 000: System clock selected (sys_ck) (default after reset)
Page  367: 001: PLL2 oscillator clock selected (pll2_p_ck)
Page  367: 010: HSE clock selected (hse_ck)
Page  367: 011: PLL1 clock selected (pll1_p_ck)
Page  367: 100: CSI clock selected (csi_ck)
Page  367: 101:LSI clock selected (lsi_ck)
Page  367: Bits 24:22 MCO1[2:0]: Micro-controller clock output 1
Page  367: Set and cleared by software. Clock source selection may generate glitches on MCO1.
Page  367: 000: HSI clock selected (hsi_ck) (default after reset)
Page  367: 001: LSE oscillator clock selected (lse_ck)
Page  367: 010: HSE clock selected (hse_ck)
Page  367: 011: PLL1 clock selected (pll1_q_ck)
Page  367: 100: HSI48 clock selected (hsi48_ck)
Page  368: Reset and Clock Control (RCC)                                                                               RM0433
Page  368: Bit 15 TIMPRE: Timers clocks prescaler selection
Page  368: This bit is set and reset by software to control the clock frequency of all the timers connected to
Page  368: 0: The Timers kernel clock is equal to rcc_hclk1 if D2PPREx is corresponding to division by 1 or 2,
Page  368: 1: The Timers kernel clock is equal to rcc_hclk1 if D2PPREx is corresponding to division by 1, 2 or
Page  368: Please refer to Table 52: Ratio between clock timer and pclk
Page  368: Bit 14 HRTIMSEL: High Resolution Timer clock prescaler selection
Page  368: This bit is set and reset by software to control the clock frequency of high resolution the timer
Page  368: 0: The HRTIM prescaler clock source is the same as other timers. (default after reset)
Page  368: 1: The HRTIM prescaler clock source is the CPU clock (rcc_c_ck).
Page  368: Bits 13:8 RTCPRE[5:0]: HSE division factor for RTC clock
Page  368: Set and cleared by software to divide the HSE to generate a clock for RTC.
Page  368: Caution: The software has to set these bits correctly to ensure that the clock supplied to the RTC is
Page  368: lower than 1 MHz. These bits must be configured if needed before selecting the RTC clock source.
Page  368: 000000: no clock (default after reset)
Page  368: 000001: no clock
Page  368: Bit 7 STOPKERWUCK: Kernel clock selection after a wake up from system Stop
Page  368: Set and reset by software to select the Kernel wakeup clock from system Stop.
Page  368: 0: The HSI is selected as wake up clock from system Stop (default after reset)
Page  368: 1: The CSI is selected as wake up clock from system Stop
Page  368: See Section 7.5.7: Handling clock generators in Stop and Standby mode for details.
Page  369: RM0433                                                                       Reset and Clock Control (RCC)
Page  369: Bit 6 STOPWUCK: System clock selection after a wake up from system Stop
Page  369: Set and reset by software to select the system wakeup clock from system Stop.
Page  369: The selected clock is also used as emergency clock for the Clock Security System on HSE.
Page  369: 0: The HSI is selected as wake up clock from system Stop (default after reset)
Page  369: 1: The CSI is selected as wake up clock from system Stop
Page  369: See Section 7.5.7: Handling clock generators in Stop and Standby mode for details.
Page  369: Caution: STOPWUCK must not be modified when the Clock Security System is enabled (by
Page  369: HSECSSON bit) and the system clock is HSE (SWS=”10”) or a switch on HSE is requested
Page  369: Bits 5:3 SWS[2:0]: System clock switch status
Page  369: Set and reset by hardware to indicate which clock source is used as system clock.
Page  369: 000: HSI used as system clock (hsi_ck) (default after reset)
Page  369: 001: CSI used as system clock (csi_ck)
Page  369: 010: HSE used as system clock (hse_ck)
Page  369: 011: PLL1 used as system clock (pll1_p_ck)
Page  369: Bits 2:0 SW[2:0]: System clock switch
Page  369: Set and reset by software to select system clock source (sys_ck).
Page  369: as system clock.
Page  369: 000: HSI selected as system clock (hsi_ck) (default after reset)
Page  369: 001: CSI selected as system clock (csi_ck)
Page  369: 010: HSE selected as system clock (hse_ck)
Page  369: 011: PLL1 selected as system clock (pll1_p_ck)
Page  370: Reset and Clock Control (RCC)                                                                                               RM0433
Page  370: 7.7.6           RCC Domain 1 Clock Configuration Register (RCC_D1CFGR)
Page  370: Set and reset by software to control D1 domain CPU clock division factor.
Page  370: Changing this division ratio has an impact on the frequency of the CPU clock, and all bus matrix
Page  370: clocks.
Page  370: The clocks are divided by the new prescaler factor. This factor ranges from 1 to 16 periods of the
Page  370: slowest APB clock among rcc_pclk[4:1] after D1CPRE update. The application can check if the
Page  371: RM0433                                                                      Reset and Clock Control (RCC)
Page  371: The clock is divided by the new prescaler factor from 1 to 16 cycles of rcc_hclk3 after D1PPRE
Page  371: division ratio has an impact on the frequency of all bus matrix clocks.
Page  371: Note: The clocks are divided by the new prescaler factor from1 to 16 periods of the slowest APB
Page  371: clock among rcc_pclk[4:1] after HPRE update.
Page  371: Depending on the clock source frequency and the voltage range, the software application
Page  372: Reset and Clock Control (RCC)                                                                                       RM0433
Page  372: 7.7.7             RCC Domain 2 Clock Configuration Register (RCC_D2CFGR)
Page  372: Set and reset by software to control D2 domain APB2 clock division factor.
Page  372: The clock is divided by the new prescaler factor from 1 to 16 cycles of rcc_hclk1 after D2PPRE2
Page  372: Set and reset by software to control D2 domain APB1 clock division factor.
Page  372: The clock is divided by the new prescaler factor from 1 to 16 cycles of rcc_hclk1 after D2PPRE1
Page  373: RM0433                                                                               Reset and Clock Control (RCC)
Page  373: 7.7.8            RCC Domain 3 Clock Configuration Register (RCC_D3CFGR)
Page  373: Set and reset by software to control D3 domain APB4 clock division factor.
Page  373: The clock is divided by the new prescaler factor from 1 to 16 cycles of rcc_hclk4 after D3PPRE
Page  374: Reset and Clock Control (RCC)                                                                             RM0433
Page  374: 7.7.9           RCC PLLs Clock Source Selection Register (RCC_PLLCKSELR)
Page  375: RM0433                                                                    Reset and Clock Control (RCC)
Page  375: Bits 1:0 PLLSRC[1:0]: DIVMx and PLLs clock source selection
Page  375: Set and reset by software to select the PLL clock source.
Page  375: 00: HSI selected as PLL clock (hsi_ck) (default after reset)
Page  375: 01: CSI selected as PLL clock (csi_ck)
Page  375: 10: HSE selected as PLL clock (hse_ck)
Page  375: 11: No clock send to DIVMx divider and PLLs
Page  376: Reset and Clock Control (RCC)                                                                                                                                            RM0433
Page  377: RM0433                                                                         Reset and Clock Control (RCC)
Page  377: 00: The PLL3 input (ref3_ck) clock range frequency is between 1 and 2 MHz (default after reset)
Page  377: 01: The PLL3 input (ref3_ck) clock range frequency is between 2 and 4 MHz
Page  377: 10: The PLL3 input (ref3_ck) clock range frequency is between 4 and 8 MHz
Page  377: 11: The PLL3 input (ref3_ck) clock range frequency is between 8 and 16 MHz
Page  378: Reset and Clock Control (RCC)                                                                              RM0433
Page  378: 00: The PLL2 input (ref2_ck) clock range frequency is between 1 and 2 MHz (default after reset)
Page  378: 01: The PLL2 input (ref2_ck) clock range frequency is between 2 and 4 MHz
Page  378: 10: The PLL2 input (ref2_ck) clock range frequency is between 4 and 8 MHz
Page  378: 11: The PLL2 input (ref2_ck) clock range frequency is between 8 and 16 MHz
Page  378: 00: The PLL1 input (ref1_ck) clock range frequency is between 1 and 2 MHz (default after reset)
Page  378: 01: The PLL1 input (ref1_ck) clock range frequency is between 2 and 4 MHz
Page  378: 10: The PLL1 input (ref1_ck) clock range frequency is between 4 and 8 MHz
Page  378: 11: The PLL1 input (ref1_ck) clock range frequency is between 8 and 16 MHz
Page  379: RM0433                                                                        Reset and Clock Control (RCC)
Page  379: Set and reset by software to control the frequency of the pll1_r_ck clock.
Page  380: Reset and Clock Control (RCC)                                                                        RM0433
Page  380: Set and reset by software to control the frequency of the pll1_q_ck clock.
Page  380: Set and reset by software to control the frequency of the pll1_p_ck clock.
Page  381: RM0433                                                                                  Reset and Clock Control (RCC)
Page  382: Reset and Clock Control (RCC)                                                                                 RM0433
Page  382: Set and reset by software to control the frequency of the pll2_r_ck clock.
Page  383: RM0433                                                                      Reset and Clock Control (RCC)
Page  383: Set and reset by software to control the frequency of the pll2_q_ck clock.
Page  383: Set and reset by software to control the frequency of the pll2_p_ck clock.
Page  384: Reset and Clock Control (RCC)                                                                                   RM0433
Page  385: RM0433                                                                        Reset and Clock Control (RCC)
Page  385: Set and reset by software to control the frequency of the pll3_r_ck clock.
Page  386: Reset and Clock Control (RCC)                                                                          RM0433
Page  386: Set and reset by software to control the frequency of the pll3_q_ck clock.
Page  386: Set and reset by software to control the frequency of the pll3_p_ck clock.
Page  387: RM0433                                                                                  Reset and Clock Control (RCC)
Page  388: Reset and Clock Control (RCC)                                                                                              RM0433
Page  388: 7.7.17             RCC Domain 1 Kernel Clock Configuration Register
Page  388: 1. Changing the clock source on-the-fly is allowed and will not generate any timing violation. However the user has to make
Page  388: use that both the previous and the new clock sources are present during the switching, and during the whole transition
Page  388: time. Please refer to Section : Clock switches and gating.
Page  388: Bits 29:28 CKPERSEL[1:0]: per_ck clock source selection
Page  388: 00: hsi_ker_ck clock selected as per_ck clock (default after reset)
Page  388: 01: csi_ker_ck clock selected as per_ck clock
Page  388: 10: hse_ck clock selected as per_ck clock
Page  388: 11: reserved, the per_ck clock is disabled
Page  388: Bit 16 SDMMCSEL: SDMMC kernel clock source selection
Page  388: 0: pll1_q_ck clock is selected as kernel peripheral clock (default after reset)
Page  388: 1: pll2_r_ck clock is selected as kernel peripheral clock
Page  388: Bits 5:4 QSPISEL[1:0]: QUADSPI kernel clock source selection
Page  388: 00: rcc_hclk3 clock selected as kernel peripheral clock (default after reset)
Page  388: 01: pll1_q_ck clock selected as kernel peripheral clock
Page  388: 10: pll2_r_ck clock selected as kernel peripheral clock
Page  388: 11: per_ck clock selected as kernel peripheral clock
Page  388: Bits 1:0 FMCSEL[1:0]: FMC kernel clock source selection
Page  388: 00: rcc_hclk3 clock selected as kernel peripheral clock (default after reset)
Page  388: 01: pll1_q_ck clock selected as kernel peripheral clock
Page  388: 10: pll2_r_ck clock selected as kernel peripheral clock
Page  388: 11: per_ck clock selected as kernel peripheral clock
Page  389: RM0433                                                                                                             Reset and Clock Control (RCC)
Page  389: 7.7.18                 RCC Domain 2 Kernel Clock Configuration Register
Page  389: 1. Changing the clock source on-the-fly is allowed and will not generate any timing violation. However the user has to make
Page  389: sure that both the previous and the new clock sources are present during the switching, and for the whole transition time.
Page  389: Please refer to Section : Clock switches and gating.
Page  389: Bit 31 SWPSEL: SWPMI kernel clock source selection
Page  389: 0: pclk is selected as SWPMI kernel clock (default after reset)
Page  389: 1: hsi_ker_ck clock is selected as SWPMI kernel clock
Page  389: Bits 29:28 FDCANSEL: FDCAN kernel clock source selection
Page  389: 00: hse_ck clock is selected as FDCAN kernel clock (default after reset)
Page  389: 01: pll1_q_ck clock is selected as FDCAN kernel clock
Page  389: 10: pll2_q_ck clock is selected as FDCAN kernel clock
Page  389: 11: reserved, the kernel clock is disabled
Page  389: Bit 24 DFSDM1SEL: DFSDM1 kernel Clk clock source selection
Page  389: Note: the DFSDM1 Aclk Clock Source Selection is done by SAI1SEL.
Page  389: 0: rcc_pclk2 is selected as DFSDM1 Clk kernel clock (default after reset)
Page  389: 1: sys_ck clock is selected as DFSDM1 Clk kernel clock
Page  389: Bits 21:20 SPDIFSEL[1:0]: SPDIFRX kernel clock source selection
Page  389: 00: pll1_q_ck clock selected as SPDIFRX kernel clock (default after reset)
Page  389: 01: pll2_r_ck clock selected as SPDIFRX kernel clock
Page  389: 10: pll3_r_ck clock selected as SPDIFRX kernel clock
Page  389: 11: hsi_ker_ck clock selected as SPDIFRX kernel clock
Page  390: Reset and Clock Control (RCC)                                                                                RM0433
Page  390: Bits 18:16 SPI45SEL[2:0]: SPI4 and 5 kernel clock source selection
Page  390: 000: APB clock is selected as kernel clock (default after reset)
Page  390: 001: pll2_q_ck clock is selected as kernel clock
Page  390: 010: pll3_q_ck clock is selected as kernel clock
Page  390: 011: hsi_ker_ck clock is selected as kernel clock
Page  390: 100: csi_ker_ck clock is selected as kernel clock
Page  390: 101: hse_ck clock is selected as kernel clock
Page  390: others: reserved, the kernel clock is disabled
Page  390: Bits 14:12 SPI123SEL[2:0]: SPI/I2S1,2 and 3 kernel clock source selection
Page  390: Caution: If the selected clock is the external clock and this clock is stopped, it will not be possible to
Page  390: switch to another clock. Refer to Section : Clock switches and gating for additional
Page  390: 000: pll1_q_ck clock selected as SPI/I2S1,2 and 3 kernel clock (default after reset)
Page  390: 001: pll2_p_ck clock selected as SPI/I2S1,2 and 3 kernel clock
Page  390: 010: pll3_p_ck clock selected as SPI/I2S1,2 and 3 kernel clock
Page  390: 011: I2S_CKIN clock selected as SPI/I2S1,2 and 3 kernel clock
Page  390: 100: per_ck clock selected as SPI/I2S1,2 and 3 kernel clock
Page  390: others: reserved, the kernel clock is disabled
Page  390: Note: I2S_CKIN is an external clock taken from a pin.
Page  391: RM0433                                                                        Reset and Clock Control (RCC)
Page  391: Bits 8:6 SAI23SEL[2:0]: SAI2 and SAI3 kernel clock source selection
Page  391: Caution: If the selected clock is the external clock and this clock is stopped, it will not be possible to
Page  391: switch to another clock. Refer to Section : Clock switches and gating for additional
Page  391: 000: pll1_q_ck clock selected as SAI2 and SAI3 kernel clock (default after reset)
Page  391: 001: pll2_p_ck clock selected as SAI2 and SAI3 kernel clock
Page  391: 010: pll3_p_ck clock selected as SAI2 and SAI3 kernel clock
Page  391: 011: I2S_CKIN clock selected as SAI2 and SAI3 kernel clock
Page  391: 100: per_ck clock selected as SAI2 and SAI3 kernel clock
Page  391: others: reserved, the kernel clock is disabled
Page  391: Note: I2S_CKIN is an external clock taken from a pin.
Page  391: Bits 2:0 SAI1SEL[2:0]: SAI1 and DFSDM1 kernel Aclk clock source selection
Page  391: Caution: If the selected clock is the external clock and this clock is stopped, it will not be possible to
Page  391: switch to another clock. Refer to Section : Clock switches and gating for additional
Page  391: Note: DFSDM1 Clock Source Selection is done by DFSDM1SEL.
Page  391: 000: pll1_q_ck clock selected as SAI1 and DFSDM1 Aclk kernel clock (default after reset)
Page  391: 001: pll2_p_ck clock selected as SAI1 and DFSDM1 Aclk kernel clock
Page  391: 010: pll3_p_ck clock selected as SAI1 and DFSDM1 Aclk kernel clock
Page  391: 011: I2S_CKIN clock selected as SAI1 and DFSDM1 Aclk kernel clock
Page  391: 100: per_ck clock selected as SAI1 and DFSDM1 Aclk kernel clock
Page  391: others: reserved, the kernel clock is disabled
Page  391: Note: I2S_CKIN is an external clock taken from a pin.
Page  392: Reset and Clock Control (RCC)                                                                                                    RM0433
Page  392: 7.7.19           RCC Domain 2 Kernel Clock Configuration Register
Page  392: 1. Changing the clock source on-the-fly is allowed and will not generate any timing violation. However the user has to make
Page  392: sure that both the previous and the new clock sources are present during the switching, and for the whole transition time.
Page  392: Please refer to Section : Clock switches and gating.
Page  392: Bits 30:28 LPTIM1SEL[2:0]: LPTIM1 kernel clock source selection
Page  392: 000: rcc_pclk1 clock selected as kernel peripheral clock (default after reset)
Page  392: 001: pll2_p_ck clock selected as kernel peripheral clock
Page  392: 010: pll3_r_ck clock selected as kernel peripheral clock
Page  392: 011: lse_ck clock selected as kernel peripheral clock
Page  392: 100: lsi_ck clock selected as kernel peripheral clock
Page  392: 101: per_ck clock selected as kernel peripheral clock
Page  392: others: reserved, the kernel clock is disabled
Page  392: Bits 23:22 CECSEL[1:0]: HDMI-CEC kernel clock source selection
Page  392: 00: lse_ck clock is selected as kernel clock (default after reset)
Page  392: 01: lsi_ck clock is selected as kernel clock
Page  392: 10: csi_ker_ck divided by 122 is selected as kernel clock
Page  392: 11: reserved, the kernel clock is disabled
Page  392: Bits 21:20 USBSEL[1:0]: USBOTG 1 and 2 kernel clock source selection
Page  392: 00: Disable the kernel clock (default after reset)
Page  392: 01: pll1_q_ck clock is selected as kernel clock
Page  392: 10: pll3_q_ck clock is selected as kernel clock
Page  392: 11: hsi48_ck clock is selected as kernel clock
Page  392: Bits 13:12 I2C123SEL[1:0]: I2C1,2,3 kernel clock source selection
Page  392: 00: rcc_pclk1 clock is selected as kernel clock (default after reset)
Page  392: 01: pll3_r_ck clock is selected as kernel clock
Page  392: 10: hsi_ker_ck clock is selected as kernel clock
Page  392: 11: csi_ker_ck clock is selected as kernel clock
Page  393: RM0433                                                                        Reset and Clock Control (RCC)
Page  393: Bits 9:8 RNGSEL[1:0]: RNG kernel clock source selection
Page  393: 00: hsi8_ck clock is selected as kernel clock (default after reset)
Page  393: 01: pll1_q_ck clock is selected as kernel clock
Page  393: 10: lse_ck clock is selected as kernel clock
Page  393: 11: lsi_ck clock is selected as kernel clock
Page  393: Bits 5:3 USART16SEL[2:0]: USART1 and 6 kernel clock source selection
Page  393: 000: rcc_pclk2 clock is selected as kernel clock (default after reset)
Page  393: 001: pll2_q_ck clock is selected as kernel clock
Page  393: 010: pll3_q_ck clock is selected as kernel clock
Page  393: 011: hsi_ker_ck clock is selected as kernel clock
Page  393: 100: csi_ker_ck clock is selected as kernel clock
Page  393: 101: lse_ck clock is selected as kernel clock
Page  393: others: reserved, the kernel clock is disabled
Page  393: Bits 2:0 USART234578SEL[2:0]: USART2/3, UART4,5, 7/8 (APB1) kernel clock source selection
Page  393: 000: rcc_pclk1 clock is selected as kernel clock (default after reset)
Page  393: 001: pll2_q_ck clock is selected as kernel clock
Page  393: 010: pll3_q_ck clock is selected as kernel clock
Page  393: 011: hsi_ker_ck clock is selected as kernel clock
Page  393: 100: csi_ker_ck clock is selected as kernel clock
Page  393: 101: lse_ck clock is selected as kernel clock
Page  393: others: reserved, the kernel clock is disabled
Page  394: Reset and Clock Control (RCC)                                                                                                 RM0433
Page  394: 7.7.20            RCC Domain 3 Kernel Clock Configuration Register
Page  394: 1. Changing the clock source on-the-fly is allowed, and will not generate any timing violation. However the user has to make
Page  394: sure that both the previous and the new clock sources are present during the switching, and for the whole transition time.
Page  394: Please refer to Section : Clock switches and gating.
Page  394: Bits 30:28      SPI6SEL[2:0]: SPI6 kernel clock source selection
Page  394: 000: rcc_pclk4 clock selected as kernel peripheral clock (default after reset)
Page  394: 001: pll2_q_ck clock selected as kernel peripheral clock
Page  394: 010: pll3_q_ck clock selected as kernel peripheral clock
Page  394: 011: hsi_ker_ck clock selected as kernel peripheral clock
Page  394: 100: csi_ker_ck clock selected as kernel peripheral clock
Page  394: 101: hse_ck clock selected as kernel peripheral clock
Page  394: others: reserved, the kernel clock is disabled
Page  394: Bits 26:24      SAI4BSEL[2:0]: Sub-Block B of SAI4 kernel clock source selection
Page  394: Caution: If the selected clock is the external clock and this clock is stopped, it will not be possible to
Page  394: switch to another clock. Refer to Section : Clock switches and gating for additional
Page  394: 000: pll1_q_ck clock selected as kernel peripheral clock (default after reset)
Page  394: 001: pll2_p_ck clock selected as kernel peripheral clock
Page  394: 010: pll3_p_ck clock selected as kernel peripheral clock
Page  394: 011: I2S_CKIN clock selected as kernel peripheral clock
Page  394: 100: per_ck clock selected as kernel peripheral clock
Page  394: others: reserved, the kernel clock is disabled
Page  394: Note: I2S_CKIN is an external clock taken from a pin.
Page  395: RM0433                                                                           Reset and Clock Control (RCC)
Page  395: Bits 23:21   SAI4ASEL[2:0]: Sub-Block A of SAI4 kernel clock source selection
Page  395: Caution: If the selected clock is the external clock and this clock is stopped, it will not be possible to
Page  395: switch to another clock. Refer to Section : Clock switches and gating for additional
Page  395: 000: pll1_q_ck clock selected as kernel peripheral clock (default after reset)
Page  395: 001: pll2_p_ck clock selected as kernel peripheral clock
Page  395: 010: pll3_p_ck clock selected as kernel peripheral clock
Page  395: 011: I2S_CKIN clock selected as kernel peripheral clock
Page  395: 100: per_ck clock selected as kernel peripheral clock
Page  395: others: reserved, the kernel clock is disabled
Page  395: Note: I2S_CKIN is an external clock taken from a pin.
Page  395: Bits 17:16   ADCSEL[1:0]: SAR ADC kernel clock source selection
Page  395: 00: pll2_p_ck clock selected as kernel peripheral clock (default after reset)
Page  395: 01: pll3_r_ck clock selected as kernel peripheral clock
Page  395: 10: per_ck clock selected as kernel peripheral clock
Page  395: others: reserved, the kernel clock is disabled
Page  395: Bits 15:13   LPTIM345SEL[2:0]: LPTIM3,4,5 kernel clock source selection
Page  395: 000: rcc_pclk4 clock selected as kernel peripheral clock (default after reset)
Page  395: 001: pll2_p_ck clock selected as kernel peripheral clock
Page  395: 010: pll3_r_ck clock selected as kernel peripheral clock
Page  395: 011: lse_ck clock selected as kernel peripheral clock
Page  395: 100: lsi_ck clock selected as kernel peripheral clock
Page  395: 101: per_ck clock selected as kernel peripheral clock
Page  395: others: reserved, the kernel clock is disabled
Page  395: Bits 12:10   LPTIM2SEL[2:0]: LPTIM2 kernel clock source selection
Page  395: 000: rcc_pclk4 clock selected as kernel peripheral clock (default after reset)
Page  395: 001: pll2_p_ck clock selected as kernel peripheral clock
Page  395: 010: pll3_r_ck clock selected as kernel peripheral clock
Page  395: 011: lse_ck clock selected as kernel peripheral clock
Page  395: 100: lsi_ck clock selected as kernel peripheral clock
Page  395: 101: per_ck clock selected as kernel peripheral clock
Page  395: others: reserved, the kernel clock is disabled
Page  396: Reset and Clock Control (RCC)                                                                          RM0433
Page  396: Bits 9:8   I2C4SEL[1:0]: I2C4 kernel clock source selection
Page  396: 00: rcc_pclk4 clock selected as kernel peripheral clock (default after reset)
Page  396: 01: pll3_r_ck clock selected as kernel peripheral clock
Page  396: 10: hsi_ker_ck clock selected as kernel peripheral clock
Page  396: 11: csi_ker_ck clock selected as kernel peripheral clock
Page  396: Bits 2:0   LPUART1SEL[2:0]: LPUART1 kernel clock source selection
Page  396: 000: rcc_pclk_d3 clock is selected as kernel peripheral clock (default after reset)
Page  396: 001: pll2_q_ck clock is selected as kernel peripheral clock
Page  396: 010: pll3_q_ck clock is selected as kernel peripheral clock
Page  396: 011: hsi_ker_ck clock is selected as kernel peripheral clock
Page  396: 100: csi_ker_ck clock is selected as kernel peripheral clock
Page  396: 101: lse_ck clock is selected as kernel peripheral clock
Page  396: others: reserved, the kernel clock is disabled
Page  397: RM0433                                                                                                       Reset and Clock Control (RCC)
Page  397: 7.7.21          RCC Clock Source Interrupt Enable Register (RCC_CIER)
Page  397: Bit 9 LSECSSIE: LSE clock security system Interrupt Enable
Page  397: Set and reset by software to enable/disable interrupt caused by the Clock Security System on
Page  398: Reset and Clock Control (RCC)                                                                             RM0433
Page  399: RM0433                                                                                                    Reset and Clock Control (RCC)
Page  399: 7.7.22          RCC Clock Source Interrupt Flag Register (RCC_CIFR)
Page  399: Bit 10 HSECSSF: HSE clock security system Interrupt Flag
Page  399: Set by hardware in case of HSE clock failure.
Page  399: 0: No clock security interrupt caused by HSE clock failure (default after reset)
Page  399: 1: Clock security interrupt caused by HSE clock failure
Page  399: Bit 9 LSECSSF: LSE clock security system Interrupt Flag
Page  399: 0: No clock ready interrupt caused by PLL3 lock (default after reset)
Page  399: 1: Clock ready interrupt caused by PLL3 lock
Page  399: 0: No clock ready interrupt caused by PLL2 lock (default after reset)
Page  399: 1: Clock ready interrupt caused by PLL2 lock
Page  399: 0: No clock ready interrupt caused by PLL1 lock (default after reset)
Page  399: 1: Clock ready interrupt caused by PLL1 lock
Page  399: Set by hardware when the HSI48 clock becomes stable and HSI48RDYIE is set.
Page  399: 0: No clock ready interrupt caused by the HSI48 oscillator (default after reset)
Page  399: 1: Clock ready interrupt caused by the HSI48 oscillator
Page  400: Reset and Clock Control (RCC)                                                          RM0433
Page  400: Set by hardware when the CSI clock becomes stable and CSIRDYIE is set.
Page  400: 0: No clock ready interrupt caused by the CSI (default after reset)
Page  400: 1: Clock ready interrupt caused by the CSI
Page  400: Set by hardware when the HSE clock becomes stable and HSERDYIE is set.
Page  400: 0: No clock ready interrupt caused by the HSE (default after reset)
Page  400: 1: Clock ready interrupt caused by the HSE
Page  400: Set by hardware when the HSI clock becomes stable and HSIRDYIE is set.
Page  400: 0: No clock ready interrupt caused by the HSI (default after reset)
Page  400: 1: Clock ready interrupt caused by the HSI
Page  400: Set by hardware when the LSE clock becomes stable and LSERDYIE is set.
Page  400: 0: No clock ready interrupt caused by the LSE (default after reset)
Page  400: 1: Clock ready interrupt caused by the LSE
Page  400: Set by hardware when the LSI clock becomes stable and LSIRDYIE is set.
Page  400: 0: No clock ready interrupt caused by the LSI (default after reset)
Page  400: 1: Clock ready interrupt caused by the LSI
Page  401: RM0433                                                                                                         Reset and Clock Control (RCC)
Page  401: 7.7.23          RCC Clock Source Interrupt Clear Register (RCC_CICR)
Page  401: Bit 10 HSECSSC: HSE clock security system Interrupt Clear
Page  401: Bit 9 LSECSSC: LSE clock security system Interrupt Clear
Page  402: Reset and Clock Control (RCC)                                  RM0433
Page  403: RM0433                                                                                          Reset and Clock Control (RCC)
Page  403: Bit 15 RTCEN: RTC clock enable
Page  403: 0: rtc_ck clock is disabled (default after backup domain reset)
Page  403: 1: rtc_ck clock enabled
Page  403: Bits 9:8 RTCSEL[1:0]:RTC clock source selection
Page  403: Set by software to select the clock source for the RTC. These bits can be written only one time
Page  403: If HSE is selected as RTC clock: this clock is lost when the system is in Stop mode or in case of a
Page  403: 00: No clock (default after backup domain reset)
Page  403: 01: LSE clock used as RTC clock
Page  403: 10: LSI clock used as RTC clock
Page  403: 11: HSE clock divided by RTCPRE value is used as RTC clock
Page  404: Reset and Clock Control (RCC)                                                                           RM0433
Page  404: Bit 6 LSECSSD: LSE clock security system failure detection
Page  404: Set by hardware to indicate when a failure has been detected by the Clock Security System on the
Page  404: Bit 5 LSECSSON: LSE clock security system enable
Page  404: Set by software to enable the Clock Security System on 32 kHz oscillator.
Page  404: 0: Clock Security System on 32 kHz oscillator OFF (default after backup domain reset)
Page  404: 1: Clock Security System on 32 kHz oscillator ON
Page  404: clock to fall down after LSEON has been set to ‘0’.
Page  405: RM0433                                                                             Reset and Clock Control (RCC)
Page  405: 7.7.25          RCC Clock Control and Status Register (RCC_CSR)
Page  405: This bit needs 3 cycles of lsi_ck clock to fall down after LSION has been set to ‘0’.
Page  405: This bit can be set even when LSION is not enabled if there is a request for LSI clock by the Clock
Page  405: 0: LSI clock is not ready (default after reset)
Page  405: 1: LSI clock is ready
Page  406: Reset and Clock Control (RCC)                                                                                                   RM0433
Page  407: RM0433                                                            Reset and Clock Control (RCC)
Page  408: Reset and Clock Control (RCC)                                                                                                          RM0433
Page  409: RM0433                                                           Reset and Clock Control (RCC)
Page  410: Reset and Clock Control (RCC)                                                                                              RM0433
Page  411: RM0433                                                                                                      Reset and Clock Control (RCC)
Page  412: Reset and Clock Control (RCC)                                           RM0433
Page  413: RM0433                                                                             Reset and Clock Control (RCC)
Page  414: Reset and Clock Control (RCC)                                                                                                                                            RM0433
Page  415: RM0433                                                                    Reset and Clock Control (RCC)
Page  416: Reset and Clock Control (RCC)                                            RM0433
Page  417: RM0433                                                                                      Reset and Clock Control (RCC)
Page  417: Bit 1 CRSRST: Clock Recovery System reset
Page  418: Reset and Clock Control (RCC)                                                                                                                      RM0433
Page  419: RM0433                                                                   Reset and Clock Control (RCC)
Page  420: Reset and Clock Control (RCC)                                                                                                                               RM0433
Page  421: RM0433                                                                  Reset and Clock Control (RCC)
Page  422: Reset and Clock Control (RCC)                                                                               RM0433
Page  423: RM0433                                                                                                                                  Reset and Clock Control (RCC)
Page  423: The Autonomous mode allows providing the peripheral clocks to peripherals located in D3,
Page  423: bit enabled, it receives its peripheral clocks according to D3 domain state, if the CPU is in
Page  423: 0: SRAM4 clock is disabled when the CPU is in CStop (default after reset)
Page  423: 1: SRAM4 peripheral bus clock enabled when D3 domain is in DRun.
Page  423: Refer to Section 7.5.11: Peripheral clock gating control for additional information
Page  423: 0: Backup RAM clock is disabled when the CPU is in CStop (default after reset)
Page  423: 1: Backup RAM clock enabling is controlled by D3 domain state.
Page  423: Refer to Section 7.5.11: Peripheral clock gating control for additional information
Page  423: 0: ADC3 peripheral clocks are disabled when the CPU is in CStop (default after reset)
Page  423: 1: ADC3 peripheral clocks enabled when D3 domain is in DRun.
Page  423: Refer to Section 7.5.11: Peripheral clock gating control for additional information
Page  423: 0: SAI4 peripheral clocks are disabled when the CPU is in CStop (default after reset)
Page  423: 1: SAI4 peripheral clocks enabled when D3 domain is in DRun.
Page  423: Refer to Section 7.5.11: Peripheral clock gating control for additional information
Page  424: Reset and Clock Control (RCC)                                                                              RM0433
Page  424: 0: CRC peripheral clocks are disabled when the CPU is in CStop (default after reset)
Page  424: 1: CRC peripheral clocks enabled when D3 domain is in DRun.
Page  424: Refer to Section 7.5.11: Peripheral clock gating control for additional information
Page  424: 0: RTC peripheral clocks are disabled when the CPU is in CStop (default after reset)
Page  424: 1: RTC peripheral clocks enabled when D3 domain is in DRun.
Page  424: Refer to Section 7.5.11: Peripheral clock gating control for additional information
Page  424: 0: VREF peripheral clocks are disabled when the CPU is in CStop (default after reset)
Page  424: 1: VREF peripheral clocks enabled when D3 domain is in DRun.
Page  424: Refer to Section 7.5.11: Peripheral clock gating control for additional information
Page  424: 0: COMP12 peripheral clocks are disabled when the CPU is in CStop (default after reset)
Page  424: 1: COMP12 peripheral clocks enabled when D3 domain is in DRun.
Page  424: Refer to Section 7.5.11: Peripheral clock gating control for additional information
Page  424: 0: LPTIM5 peripheral clocks are disabled when the CPU is in CStop (default after reset)
Page  424: 1: LPTIM5 peripheral clocks enabled when D3 domain is in DRun.
Page  424: Refer to Section 7.5.11: Peripheral clock gating control for additional information
Page  424: 0: LPTIM4 peripheral clocks are disabled when the CPU is in CStop (default after reset)
Page  424: 1: LPTIM4 peripheral clocks enabled when D3 domain is in DRun.
Page  424: Refer to Section 7.5.11: Peripheral clock gating control for additional information
Page  424: 0: LPTIM3 peripheral clocks are disabled when the CPU is in CStop (default after reset)
Page  424: 1: LPTIM3 peripheral clocks enabled when D3 domain is in DRun.
Page  424: Refer to Section 7.5.11: Peripheral clock gating control for additional information
Page  424: 0: LPTIM2 peripheral clocks are disabled when the CPU is in CStop (default after reset)
Page  424: 1: LPTIM2 peripheral clocks enabled when D3 domain is in DRun.
Page  424: Refer to Section 7.5.11: Peripheral clock gating control for additional information
Page  424: 0: I2C4 peripheral clocks are disabled when the CPU is in CStop (default after reset)
Page  424: 1: I2C4 peripheral clocks enabled when D3 domain is in DRun.
Page  424: Refer to Section 7.5.11: Peripheral clock gating control for additional information
Page  425: RM0433                                                                       Reset and Clock Control (RCC)
Page  425: 0: SPI6 peripheral clocks are disabled when the CPU is in CStop (default after reset)
Page  425: 1: SPI6 peripheral clocks enabled when D3 domain is in DRun.
Page  425: Refer to Section 7.5.11: Peripheral clock gating control for additional information
Page  425: 0: LPUART1 peripheral clocks are disabled when the CPU is in CStop (default after reset)
Page  425: 1: LPUART1 peripheral clocks enabled when D3 domain is in DRun.
Page  425: Refer to Section 7.5.11: Peripheral clock gating control for additional information
Page  425: 0: BDMA and DMAMUX peripheral clocks are disabled when the CPU is in CStop (default after
Page  425: 1: BDMA and DMAMUX peripheral clocks enabled when D3 domain is in DRun.
Page  425: Refer to Section 7.5.11: Peripheral clock gating control for additional information
Page  426: Reset and Clock Control (RCC)                                                                                                                                 RM0433
Page  427: RM0433                                                                                 Reset and Clock Control (RCC)
Page  428: Reset and Clock Control (RCC)                                                                                                   RM0433
Page  428: 7.7.38              RCC AHB3 Clock Register (RCC_AHB3ENR)
Page  428: Bit 16 SDMMC1EN: SDMMC1 and SDMMC1 Delay Clock Enable
Page  428: 0: SDMMC1 and SDMMC1 Delay clock disabled (default after reset)
Page  428: 1: SDMMC1 and SDMMC1 Delay clock enabled
Page  428: Bit 14 QSPIEN: QUADSPI and QUADSPI Delay Clock Enable
Page  428: 0: QUADSPI and QUADSPI Delay clock disabled (default after reset)
Page  428: 1: QUADSPI and QUADSPI Delay clock enabled
Page  428: Bit 12 FMCEN: FMC Peripheral Clocks Enable
Page  428: 0: FMC peripheral clocks disabled (default after reset)
Page  428: 1: FMC peripheral clocks enabled
Page  428: The peripheral clocks of the FMC are: the kernel clock selected by FMCSEL and provided to
Page  428: fmc_ker_ck input, and the rcc_hclk3 bus interface clock.
Page  428: Bit 5 JPGDECEN: JPGDEC Peripheral Clock Enable
Page  428: 0: JPGDEC peripheral clock disabled (default after reset)
Page  428: 1: JPGDEC peripheral clock enabled
Page  429: RM0433                                                                 Reset and Clock Control (RCC)
Page  429: Bit 4 DMA2DEN: DMA2D Peripheral Clock Enable
Page  429: 0: DMA2D peripheral clock disabled (default after reset)
Page  429: 1: DMA2D peripheral clock enabled
Page  429: Bit 0 MDMAEN: MDMA Peripheral Clock Enable
Page  429: 0: MDMA peripheral clock disabled (default after reset)
Page  429: 1: MDMA peripheral clock enabled
Page  430: Reset and Clock Control (RCC)                                                                                                                              RM0433
Page  430: 7.7.39                RCC AHB1 Clock Register (RCC_AHB1ENR)
Page  430: Bit 27 USB2OTGHSEN: USB2OTG (OTG_HS2) Peripheral Clocks Enable
Page  430: 0: USB2OTG peripheral clocks disabled (default after reset)
Page  430: 1: USB2OTG peripheral clocks enabled
Page  430: The peripheral clocks of the USB2OTG are: the kernel clock selected by USBSEL and the
Page  430: rcc_hclk1 bus interface clock.
Page  430: Bit 26 USB1OTGHSULPIEN: USB_PHY1 Clocks Enable
Page  430: 0: USB1ULPI PHY clocks disabled (default after reset)
Page  430: 1: USB1ULPI PHY clocks enabled
Page  430: Bit 25 USB1OTGHSEN: USB1OTG (OTG_HS1) Peripheral Clocks Enable
Page  430: 0: USB1OTG peripheral clocks disabled (default after reset)
Page  430: 1: USB1OTG peripheral clocks enabled
Page  430: The peripheral clocks of the USB1OTG are: the kernel clock selected by USBSEL and the
Page  430: rcc_hclk1 bus interface clock.
Page  430: Bit 17 ETH1RXEN: Ethernet Reception Clock Enable
Page  430: 0: Ethernet Reception clock disabled (default after reset)
Page  430: 1: Ethernet Reception clock enabled
Page  431: RM0433                                                                      Reset and Clock Control (RCC)
Page  431: Bit 16 ETH1TXEN: Ethernet Transmission Clock Enable
Page  431: 0: Ethernet Transmission clock disabled (default after reset)
Page  431: 1: Ethernet Transmission clock enabled
Page  431: Bit 15 ETH1MACEN: Ethernet MAC bus interface Clock Enable
Page  431: 0: Ethernet MAC bus interface clock disabled (default after reset)
Page  431: 1: Ethernet MAC bus interface clock enabled
Page  431: Bit 5 ADC12EN: ADC1/2 Peripheral Clocks Enable
Page  431: 0: ADC1 and 2 peripheral clocks disabled (default after reset)
Page  431: 1: ADC1 and 2 peripheral clocks enabled
Page  431: The peripheral clocks of the ADC1 and 2 are: the kernel clock selected by ADCSEL and provided to
Page  431: adc_ker_ck input, and the rcc_hclk1 bus interface clock.
Page  431: Bit 1 DMA2EN: DMA2 Clock Enable
Page  431: 0: DMA2 clock disabled (default after reset)
Page  431: 1: DMA2 clock enabled
Page  431: Bit 0 DMA1EN: DMA1 Clock Enable
Page  431: 0: DMA1 clock disabled (default after reset)
Page  431: 1: DMA1 clock enabled
Page  432: Reset and Clock Control (RCC)                                                                                                            RM0433
Page  432: 7.7.40                    RCC AHB2 Clock Register (RCC_AHB2ENR)
Page  432: 0: SRAM3 interface clock is disabled. (default after reset)
Page  432: 1: SRAM3 interface clock is enabled.
Page  432: 0: SRAM2 interface clock is disabled. (default after reset)
Page  432: 1: SRAM2 interface clock is enabled.
Page  432: 0: SRAM1 interface clock is disabled. (default after reset)
Page  432: 1: SRAM1 interface clock is enabled.
Page  432: Bit 9 SDMMC2EN: SDMMC2 and SDMMC2 delay clock enable
Page  432: 0: SDMMC2 and SDMMC2 Delay clock disabled (default after reset)
Page  432: 1: SDMMC2 and SDMMC2 Delay clock enabled
Page  433: RM0433                                                                  Reset and Clock Control (RCC)
Page  433: Bit 6 RNGEN: RNG peripheral clocks enable
Page  433: 0: RNG peripheral clocks disabled (default after reset)
Page  433: 1: RNG peripheral clocks enabled:
Page  433: The peripheral clocks of the RNG are: the kernel clock selected by RNGSEL and provided to
Page  433: rng_ker_ck input, and the rcc_hclk2 bus interface clock.
Page  433: Bit 5 HASHEN: HASH peripheral clock enable
Page  433: 0: HASH peripheral clock disabled (default after reset)
Page  433: 1: HASH peripheral clock enabled
Page  433: Bit 4 CRYPTEN: CRYPT peripheral clock enable
Page  433: 0: CRYPT peripheral clock disabled (default after reset)
Page  433: 1: CRYPT peripheral clock enabled
Page  433: Bit 0 DCMIEN: DCMI peripheral clock enable
Page  433: 0: DCMI peripheral clock disabled (default after reset)
Page  433: 1: DCMI peripheral clock enabled
Page  434: Reset and Clock Control (RCC)                                                                                                                           RM0433
Page  434: 7.7.41          RCC AHB4 Clock Register (RCC_AHB4ENR)
Page  434: Bit 28 BKPRAMEN: Backup RAM Clock Enable
Page  434: 0: Backup RAM clock disabled (default after reset)
Page  434: 1: Backup RAM clock enabled
Page  434: Bit 25 HSEMEN: HSEM peripheral clock enable
Page  434: 0: HSEM peripheral clock disabled (default after reset)
Page  434: 1: HSEM peripheral clock enabled
Page  434: Bit 24 ADC3EN: ADC3 Peripheral Clocks Enable
Page  434: 0: ADC3 peripheral clocks disabled (default after reset)
Page  434: 1: ADC3 peripheral clocks enabled
Page  434: The peripheral clocks of the ADC3 are: the kernel clock selected by ADCSEL and provided to
Page  434: adc_ker_ck input, and the rcc_hclk4 bus interface clock.
Page  434: Bit 21 BDMAEN: BDMA and DMAMUX2 Clock Enable
Page  434: 0: BDMA and DMAMUX2 clock disabled (default after reset)
Page  434: 1: BDMA and DMAMUX2 clock enabled
Page  435: RM0433                                                                   Reset and Clock Control (RCC)
Page  435: Bit 19 CRCEN: CRC peripheral clock enable
Page  435: 0: CRC peripheral clock disabled (default after reset)
Page  435: 1: CRC peripheral clock enabled
Page  435: Bit 10 GPIOKEN: GPIOK peripheral clock enable
Page  435: 0: GPIOK peripheral clock disabled (default after reset)
Page  435: 1: GPIOK peripheral clock enabled
Page  435: Bit 9 GPIOJEN: GPIOJ peripheral clock enable
Page  435: 0: GPIOJ peripheral clock disabled (default after reset)
Page  435: 1: GPIOJ peripheral clock enabled
Page  435: Bit 8 GPIOIEN: GPIOI peripheral clock enable
Page  435: 0: GPIOI peripheral clock disabled (default after reset)
Page  435: 1: GPIOI peripheral clock enabled
Page  435: Bit 7 GPIOHEN: GPIOH peripheral clock enable
Page  435: 0: GPIOH peripheral clock disabled (default after reset)
Page  435: 1: GPIOH peripheral clock enabled
Page  435: Bit 6 GPIOGEN: GPIOG peripheral clock enable
Page  435: 0: GPIOG peripheral clock disabled (default after reset)
Page  435: 1: GPIOG peripheral clock enabled
Page  435: Bit 5 GPIOFEN: GPIOF peripheral clock enable
Page  435: 0: GPIOF peripheral clock disabled (default after reset)
Page  435: 1: GPIOF peripheral clock enabled
Page  435: Bit 4 GPIOEEN: GPIOE peripheral clock enable
Page  435: 0: GPIOE peripheral clock disabled (default after reset)
Page  435: 1: GPIOE peripheral clock enabled
Page  435: Bit 3 GPIODEN: GPIOD peripheral clock enable
Page  435: 0: GPIOD peripheral clock disabled (default after reset)
Page  435: 1: GPIOD peripheral clock enabled
Page  436: Reset and Clock Control (RCC)                                            RM0433
Page  436: Bit 2 GPIOCEN: GPIOC peripheral clock enable
Page  436: 0: GPIOC peripheral clock disabled (default after reset)
Page  436: 1: GPIOC peripheral clock enabled
Page  436: Bit 1 GPIOBEN: GPIOB peripheral clock enable
Page  436: 0: GPIOB peripheral clock disabled (default after reset)
Page  436: 1: GPIOB peripheral clock enabled
Page  436: Bit 0 GPIOAEN: GPIOA peripheral clock enable
Page  436: 0: GPIOA peripheral clock disabled (default after reset)
Page  436: 1: GPIOA peripheral clock enabled
Page  437: RM0433                                                                                     Reset and Clock Control (RCC)
Page  437: 7.7.42            RCC APB3 Clock Register (RCC_APB3ENR)
Page  437: Bit 6 WWDG1EN: WWDG1 Clock Enable
Page  437: 0: WWDG1 peripheral clock disable (default after reset)
Page  437: 1: WWDG1 peripheral clock enabled
Page  437: Bit 3 LTDCEN: LTDC peripheral clock enable
Page  437: Provides the pixel clock (ltdc_ker_ck) to the LTDC block.
Page  437: 0: LTDC peripheral clock disabled (default after reset)
Page  437: 1: LTDC peripheral clock provided to the LTDC block
Page  438: Reset and Clock Control (RCC)                                                                                                                                     RM0433
Page  438: 7.7.43                  RCC APB1 Clock Register (RCC_APB1LENR)
Page  438: Bit 31 UART8EN: UART8 Peripheral Clocks Enable
Page  438: 0: UART8 peripheral clocks disable (default after reset)
Page  438: 1: UART8 peripheral clocks enabled
Page  438: The peripheral clocks of the UART8 are: the kernel clock selected by USART234578SEL and
Page  438: provided to usart_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  438: Bit 30 UART7EN: UART7 Peripheral Clocks Enable
Page  438: 0: UART7 peripheral clocks disable (default after reset)
Page  438: 1: UART7 peripheral clocks enabled
Page  438: The peripheral clocks of the UART7 are: the kernel clock selected by USART234578SEL and
Page  438: provided to usart_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  438: Bit 29 DAC12EN: DAC1 and 2 peripheral clock enable
Page  438: 0: DAC1 and 2 peripheral clock disable (default after reset)
Page  438: 1: DAC1 and 2 peripheral clock enabled
Page  438: Bit 27 HDMICECEN: HDMI-CEC peripheral clock enable
Page  438: 0: HDMI-CEC peripheral clock disable (default after reset)
Page  438: 1: HDMI-CEC peripheral clock enabled
Page  438: The peripheral clocks of the HDMI-CEC are: the kernel clock selected by CECSEL and provided to
Page  438: cec_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  439: RM0433                                                                    Reset and Clock Control (RCC)
Page  439: Bit 23 I2C3EN: I2C3 Peripheral Clocks Enable
Page  439: 0: I2C3 peripheral clocks disable (default after reset)
Page  439: 1: I2C3 peripheral clocks enabled
Page  439: The peripheral clocks of the I2C3 are: the kernel clock selected by I2C123SEL and provided to
Page  439: i2c_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  439: Bit 22 I2C2EN: I2C2 Peripheral Clocks Enable
Page  439: 0: I2C2 peripheral clocks disable (default after reset)
Page  439: 1: I2C2 peripheral clocks enabled
Page  439: The peripheral clocks of the I2C2 are: the kernel clock selected by I2C123SEL and provided to
Page  439: i2c_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  439: Bit 21 I2C1EN: I2C1 Peripheral Clocks Enable
Page  439: 0: I2C1 peripheral clocks disable (default after reset)
Page  439: 1: I2C1 peripheral clocks enabled
Page  439: The peripheral clocks of the I2C1 are: the kernel clock selected by I2C123SEL and provided to
Page  439: i2c_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  439: Bit 20 UART5EN: UART5 Peripheral Clocks Enable
Page  439: 0: UART5 peripheral clocks disable (default after reset)
Page  439: 1: UART5 peripheral clocks enabled
Page  439: The peripheral clocks of the UART5 are: the kernel clock selected by USART234578SEL and
Page  439: provided to uart_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  439: Bit 19 UART4EN: UART4 Peripheral Clocks Enable
Page  439: 0: UART4 peripheral clocks disable (default after reset)
Page  439: 1: UART4 peripheral clocks enabled
Page  439: The peripheral clocks of the UART4 are: the kernel clock selected by USART234578SEL and
Page  439: provided to uart_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  439: Bit 18 USART3EN: USART3 Peripheral Clocks Enable
Page  439: 0: USART3 peripheral clocks disable (default after reset)
Page  439: 1: USART3 peripheral clocks enabled
Page  439: The peripheral clocks of the USART3 are: the kernel clock selected by USART234578SEL and
Page  439: provided to usart_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  439: Bit 17 USART2EN: USART2 Peripheral Clocks Enable
Page  439: 0: USART2 peripheral clocks disable (default after reset)
Page  439: 1: USART2 peripheral clocks enabled
Page  439: The peripheral clocks of the USART2 are: the kernel clock selected by USART234578SEL and
Page  439: provided to usart_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  439: Bit 16 SPDIFRXEN: SPDIFRX Peripheral Clocks Enable
Page  439: 0: SPDIFRX peripheral clocks disable (default after reset)
Page  439: 1: SPDIFRX peripheral clocks enabled
Page  439: The peripheral clocks of the SPDIFRX are: the kernel clock selected by SPDIFSEL and provided to
Page  439: spdifrx_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  440: Reset and Clock Control (RCC)                                                                        RM0433
Page  440: Bit 15 SPI3EN: SPI3 Peripheral Clocks Enable
Page  440: 0: SPI3 peripheral clocks disable (default after reset)
Page  440: 1: SPI3 peripheral clocks enabled
Page  440: The peripheral clocks of the SPI3 are: the kernel clock selected by I2S123SRC and provided to
Page  440: spi_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  440: Bit 14 SPI2EN: SPI2 Peripheral Clocks Enable
Page  440: 0: SPI2 peripheral clocks disable (default after reset)
Page  440: 1: SPI2 peripheral clocks enabled
Page  440: The peripheral clocks of the SPI2 are: the kernel clock selected by I2S123SRC and provided to
Page  440: spi_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  440: Bit 9 LPTIM1EN: LPTIM1 Peripheral Clocks Enable
Page  440: 0: LPTIM1 peripheral clocks disable (default after reset)
Page  440: 1: LPTIM1 peripheral clocks enabled
Page  440: The peripheral clocks of the LPTIM1 are: the kernel clock selected by LPTIM1SEL and provided to
Page  440: lptim_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  440: Bit 8 TIM14EN: TIM14 peripheral clock enable
Page  440: 0: TIM14 peripheral clock disable (default after reset)
Page  440: 1: TIM14 peripheral clock enabled
Page  440: Bit 7 TIM13EN: TIM13 peripheral clock enable
Page  440: 0: TIM13 peripheral clock disable (default after reset)
Page  440: 1: TIM13 peripheral clock enabled
Page  440: Bit 6 TIM12EN: TIM12 peripheral clock enable
Page  440: 0: TIM12 peripheral clock disable (default after reset)
Page  440: 1: TIM12 peripheral clock enabled
Page  440: Bit 5 TIM7EN: TIM7 peripheral clock enable
Page  440: 0: TIM7 peripheral clock disable (default after reset)
Page  440: 1: TIM7 peripheral clock enabled
Page  440: Bit 4 TIM6EN: TIM6 peripheral clock enable
Page  440: 0: TIM6 peripheral clock disable (default after reset)
Page  440: 1: TIM6 peripheral clock enabled
Page  440: Bit 3 TIM5EN: TIM5 peripheral clock enable
Page  440: 0: TIM5 peripheral clock disable (default after reset)
Page  440: 1: TIM5 peripheral clock enabled
Page  441: RM0433                                                                Reset and Clock Control (RCC)
Page  441: Bit 2 TIM4EN: TIM4 peripheral clock enable
Page  441: 0: TIM4 peripheral clock disable (default after reset)
Page  441: 1: TIM4 peripheral clock enabled
Page  441: Bit 1 TIM3EN: TIM3 peripheral clock enable
Page  441: 0: TIM3 peripheral clock disable (default after reset)
Page  441: 1: TIM3 peripheral clock enabled
Page  441: Bit 0 TIM2EN: TIM2 peripheral clock enable
Page  441: 0: TIM2 peripheral clock disable (default after reset)
Page  441: 1: TIM2 peripheral clock enabled
Page  442: Reset and Clock Control (RCC)                                                                                                   RM0433
Page  442: 7.7.44            RCC APB1 Clock Register (RCC_APB1HENR)
Page  442: Bit 8 FDCANEN: FDCAN Peripheral Clocks Enable
Page  442: 0: FDCAN peripheral clocks disable (default after reset)
Page  442: 1: FDCAN peripheral clocks enabled:
Page  442: The peripheral clocks of the FDCAN are: the kernel clock selected by FDCANSEL and provided to
Page  442: fdcan_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  442: Bit 5 MDIOSEN: MDIOS peripheral clock enable
Page  442: 0: MDIOS peripheral clock disable (default after reset)
Page  442: 1: MDIOS peripheral clock enabled
Page  442: Bit 4 OPAMPEN: OPAMP peripheral clock enable
Page  442: 0: OPAMP peripheral clock disable (default after reset)
Page  442: 1: OPAMP peripheral clock enabled
Page  443: RM0433                                                                 Reset and Clock Control (RCC)
Page  443: Bit 2 SWPEN: SWPMI Peripheral Clocks Enable
Page  443: 0: SWPMI peripheral clocks disable (default after reset)
Page  443: 1: SWPMI peripheral clocks enabled:
Page  443: The peripheral clocks of the SWPMI are: the kernel clock selected by SWPSEL and provided to
Page  443: swpmi_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  443: Bit 1 CRSEN: Clock Recovery System peripheral clock enable
Page  443: 0: CRS peripheral clock disable (default after reset)
Page  443: 1: CRS peripheral clock enabled
Page  444: Reset and Clock Control (RCC)                                                                                                                   RM0433
Page  444: 7.7.45          RCC APB2 Clock Register (RCC_APB2ENR)
Page  444: Bit 29 HRTIMEN: HRTIM peripheral clock enable
Page  444: 0: HRTIM peripheral clock disabled (default after reset)
Page  444: 1: HRTIM peripheral clock enabled
Page  444: Bit 28 DFSDM1EN: DFSDM1 Peripheral Clocks Enable
Page  444: 0: DFSDM1 peripheral clocks disabled (default after reset)
Page  444: 1: DFSDM1 peripheral clocks enabled
Page  444: DFSDM1 peripheral clocks are: the kernel clocks selected by SAI1SEL and DFSDM1SEL and
Page  444: provided to Aclk and clk inputs respectively, and the rcc_pclk2 bus interface clock.
Page  444: Bit 24 SAI3EN: SAI3 Peripheral Clocks Enable
Page  444: 0: SAI3 peripheral clocks disabled (default after reset)
Page  444: 1: SAI3 peripheral clocks enabled
Page  444: The peripheral clocks of the SAI3 are: the kernel clock selected by SAI23SEL and provided to
Page  444: sai_a_ker_ck and sai_b_ker_ck inputs, and the rcc_pclk2 bus interface clock.
Page  444: Bit 23 SAI2EN: SAI2 Peripheral Clocks Enable
Page  444: 0: SAI2 peripheral clocks disabled (default after reset)
Page  444: 1: SAI2 peripheral clocks enabled
Page  444: The peripheral clocks of the SAI2 are: the kernel clock selected by SAI23SEL and provided to
Page  444: sai_a_ker_ck and sai_b_ker_ck inputs, and the rcc_pclk2 bus interface clock.
Page  445: RM0433                                                                     Reset and Clock Control (RCC)
Page  445: Bit 22 SAI1EN: SAI1 Peripheral Clocks Enable
Page  445: 0: SAI1 peripheral clocks disabled (default after reset)
Page  445: 1: SAI1 peripheral clocks enabled:
Page  445: The peripheral clocks of the SAI1 are: the kernel clock selected by SAI1SEL and provided to
Page  445: sai_a_ker_ck and sai_b_ker_ck inputs, and the rcc_pclk2 bus interface clock.
Page  445: Bit 20 SPI5EN: SPI5 Peripheral Clocks Enable
Page  445: 0: SPI5 peripheral clocks disabled (default after reset)
Page  445: 1: SPI5 peripheral clocks enabled:
Page  445: The peripheral clocks of the SPI5 are: the kernel clock selected by SPI45SEL and provided to
Page  445: spi_ker_ck input, and the rcc_pclk2 bus interface clock.
Page  445: Bit 18 TIM17EN: TIM17 peripheral clock enable
Page  445: 0: TIM17 peripheral clock disabled (default after reset)
Page  445: 1: TIM17 peripheral clock enabled
Page  445: Bit 17 TIM16EN: TIM16 peripheral clock enable
Page  445: 0: TIM16 peripheral clock disabled (default after reset)
Page  445: 1: TIM16 peripheral clock enabled
Page  445: Bit 16 TIM15EN: TIM15 peripheral clock enable
Page  445: 0: TIM15 peripheral clock disabled (default after reset)
Page  445: 1: TIM15 peripheral clock enabled
Page  445: Bit 13 SPI4EN: SPI4 Peripheral Clocks Enable
Page  445: 0: SPI4 peripheral clocks disabled (default after reset)
Page  445: 1: SPI4 peripheral clocks enabled:
Page  445: The peripheral clocks of the SPI4 are: the kernel clock selected by SPI45SEL and provided to
Page  445: spi_ker_ck input, and the rcc_pclk2 bus interface clock.
Page  445: Bit 12 SPI1EN: SPI1 Peripheral Clocks Enable
Page  445: 0: SPI1 peripheral clocks disabled (default after reset)
Page  445: 1: SPI1 peripheral clocks enabled:
Page  445: The peripheral clocks of the SPI1 are: the kernel clock selected by I2S123SRC and provided to
Page  445: spi_ker_ck input, and the rcc_pclk2 bus interface clock.
Page  445: Bit 5 USART6EN: USART6 Peripheral Clocks Enable
Page  445: 0: USART6 peripheral clocks disabled (default after reset)
Page  445: 1: USART6 peripheral clocks enabled:
Page  445: The peripheral clocks of the USART6 are: the kernel clock selected by USART16SEL and provided
Page  445: to usart_ker_ck input, and the rcc_pclk2 bus interface clock.
Page  446: Reset and Clock Control (RCC)                                                                     RM0433
Page  446: Bit 4 USART1EN: USART1 Peripheral Clocks Enable
Page  446: 0: USART1 peripheral clocks disabled (default after reset)
Page  446: 1: USART1 peripheral clocks enabled:
Page  446: The peripheral clocks of the USART1 are: the kernel clock selected by USART16SEL and provided
Page  446: to usart_ker_ck input, and the rcc_pclk2 bus interface clock.
Page  446: Bit 1 TIM8EN: TIM8 peripheral clock enable
Page  446: 0: TIM8 peripheral clock disabled (default after reset)
Page  446: 1: TIM8 peripheral clock enabled
Page  446: Bit 0 TIM1EN: TIM1 peripheral clock enable
Page  446: 0: TIM1 peripheral clock disabled (default after reset)
Page  446: 1: TIM1 peripheral clock enabled
Page  447: RM0433                                                                                                           Reset and Clock Control (RCC)
Page  447: 7.7.46                 RCC APB4 Clock Register (RCC_APB4ENR)
Page  447: Bit 21 SAI4EN: SAI4 Peripheral Clocks Enable
Page  447: 0: SAI4 peripheral clocks disabled (default after reset)
Page  447: 1: SAI4 peripheral clocks enabled
Page  447: The peripheral clocks of the SAI4 are: the kernel clocks selected by SAI4ASEL and SAI4BSEL, and
Page  447: clock.
Page  447: Bit 16 RTCAPBEN: RTC APB Clock Enable
Page  447: 0: The register clock interface of the RTC (APB) is disabled
Page  447: 1: The register clock interface of the RTC (APB) is enabled (default after reset)
Page  447: Bit 15 VREFEN: VREF peripheral clock enable
Page  447: 0: VREF peripheral clock disabled (default after reset)
Page  447: 1: VREF peripheral clock enabled
Page  447: Bit 14 COMP12EN: COMP1/2 peripheral clock enable
Page  447: 0: COMP1/2 peripheral clock disabled (default after reset)
Page  447: 1: COMP1/2 peripheral clock enabled
Page  448: Reset and Clock Control (RCC)                                                                          RM0433
Page  448: Bit 12 LPTIM5EN: LPTIM5 Peripheral Clocks Enable
Page  448: 0: LPTIM5 peripheral clocks disabled (default after reset)
Page  448: 1: LPTIM5 peripheral clocks enabled
Page  448: The peripheral clocks of the LPTIM5 are: the kernel clock selected by LPTIM345SEL and provided
Page  448: to lptim_ker_ck input, and the rcc_pclk4 bus interface clock.
Page  448: Bit 11 LPTIM4EN: LPTIM4 Peripheral Clocks Enable
Page  448: 0: LPTIM4 peripheral clocks disabled (default after reset)
Page  448: 1: LPTIM4 peripheral clocks enabled
Page  448: The peripheral clocks of the LPTIM4 are: the kernel clock selected by LPTIM345SEL and provided
Page  448: to lptim_ker_ck input, and the rcc_pclk4 bus interface clock.
Page  448: Bit 10 LPTIM3EN: LPTIM3 Peripheral Clocks Enable
Page  448: 0: LPTIM3 peripheral clocks disabled (default after reset)
Page  448: 1: LPTIM3 peripheral clocks enabled
Page  448: The peripheral clocks of the LPTIM3 are: the kernel clock selected by LPTIM345SEL and provided
Page  448: to lptim_ker_ck input, and the rcc_pclk4 bus interface clock.
Page  448: Bit 9 LPTIM2EN: LPTIM2 Peripheral Clocks Enable
Page  448: 0: LPTIM2 peripheral clocks disabled (default after reset)
Page  448: 1: LPTIM2 peripheral clocks enabled
Page  448: The peripheral clocks of the LPTIM2 are: the kernel clock selected by LPTIM2SEL and provided to
Page  448: lptim_ker_ck input, and the rcc_pclk4 bus interface clock.
Page  448: Bit 7 I2C4EN: I2C4 Peripheral Clocks Enable
Page  448: 0: I2C4 peripheral clocks disabled (default after reset)
Page  448: 1: I2C4 peripheral clocks enabled
Page  448: The peripheral clocks of the I2C4 are: the kernel clock selected by I2C4SEL and provided to
Page  448: i2c_ker_ck input, and the rcc_pclk4 bus interface clock.
Page  448: Bit 5 SPI6EN: SPI6 Peripheral Clocks Enable
Page  448: 0: SPI6 peripheral clocks disabled (default after reset)
Page  448: 1: SPI6 peripheral clocks enabled
Page  448: The peripheral clocks of the SPI6 are: the kernel clock selected by SPI6SEL and provided to
Page  448: spi_ker_ck input, and the rcc_pclk4 bus interface clock.
Page  448: Bit 3 LPUART1EN: LPUART1 Peripheral Clocks Enable
Page  448: 0: LPUART1 peripheral clocks disabled (default after reset)
Page  448: 1: LPUART1 peripheral clocks enabled
Page  448: The peripheral clocks of the LPUART1 are: the kernel clock selected by LPUART1SEL and
Page  448: provided to lpuart_ker_ck input, and the rcc_pclk4 bus interface clock.
Page  449: RM0433                                                                  Reset and Clock Control (RCC)
Page  449: Bit 1 SYSCFGEN: SYSCFG peripheral clock enable
Page  449: 0: SYSCFG peripheral clock disabled (default after reset)
Page  449: 1: SYSCFG peripheral clock enabled
Page  450: Reset and Clock Control (RCC)                                                                                                                            RM0433
Page  450: 7.7.47                       RCC AHB3 Sleep Clock Register (RCC_AHB3LPENR)
Page  450: Bit 31 AXISRAMLPEN: AXISRAM Block Clock Enable During CSleep mode
Page  450: 0: AXISRAM interface clock disabled during CSleep mode
Page  450: 1: AXISRAM interface clock enabled during CSleep mode (default after reset)
Page  450: Bit 30 ITCMLPEN: D1ITCM Block Clock Enable During CSleep mode
Page  450: 0: D1 ITCM interface clock disabled during CSleep mode
Page  450: 1: D1 ITCM interface clock enabled during CSleep mode (default after reset)
Page  450: Bit 29 DTCM2LPEN: D1 DTCM2 Block Clock Enable During CSleep mode
Page  450: 0: D1 DTCM2 interface clock disabled during CSleep mode
Page  450: 1: D1 DTCM2 interface clock enabled during CSleep mode (default after reset)
Page  450: Bit 28 D1DTCM1LPEN: D1DTCM1 Block Clock Enable During CSleep mode
Page  450: 0: D1DTCM1 interface clock disabled during CSleep mode
Page  450: 1: D1DTCM1 interface clock enabled during CSleep mode (default after reset)
Page  450: Bit 16 SDMMC1LPEN: SDMMC1 and SDMMC1 Delay Clock Enable During CSleep Mode
Page  450: 0: SDMMC1 and SDMMC1 Delay clock disabled during CSleep mode
Page  450: 1: SDMMC1 and SDMMC1 Delay clock enabled during CSleep mode (default after reset)
Page  451: RM0433                                                                      Reset and Clock Control (RCC)
Page  451: Bit 14 QSPILPEN: QUADSPI and QUADSPI Delay Clock Enable During CSleep Mode
Page  451: 0: QUADSPI and QUADSPI Delay clock disabled during CSleep mode
Page  451: 1: QUADSPI and QUADSPI Delay clock enabled during CSleep mode (default after reset)
Page  451: Bit 12 FMCLPEN: FMC Peripheral Clocks Enable During CSleep Mode
Page  451: 0: FMC peripheral clocks disabled during CSleep mode
Page  451: 1: FMC peripheral clocks enabled during CSleep mode (default after reset):
Page  451: The peripheral clocks of the FMC are: the kernel clock selected by FMCSEL and provided to
Page  451: fmc_ker_ck input, and the rcc_hclk3 bus interface clock.
Page  451: Bit 8 FLASHLPEN: Flash interface Clock Enable During CSleep Mode
Page  451: 0: Flash interface clock disabled during CSleep mode
Page  451: 1: Flash interface clock enabled during CSleep mode (default after reset)
Page  451: Bit 5 JPGDECLPEN: JPGDEC Clock Enable During CSleep Mode
Page  451: 0: JPGDEC peripheral clock disabled during CSleep mode
Page  451: 1: JPGDEC peripheral clock enabled during CSleep mode (default after reset)
Page  451: Bit 4 DMA2DLPEN: DMA2D Clock Enable During CSleep Mode
Page  451: 0: DMA2D peripheral clock disabled during CSleep mode
Page  451: 1: DMA2D peripheral clock enabled during CSleep mode (default after reset)
Page  451: Bit 0 MDMALPEN: MDMA Clock Enable During CSleep Mode
Page  451: 0: MDMA peripheral clock disabled during CSleep mode
Page  451: 1: MDMA peripheral clock enabled during CSleep mode (default after reset)
Page  452: Reset and Clock Control (RCC)                                                                                                                                       RM0433
Page  452: 7.7.48                  RCC AHB1 Sleep Clock Register (RCC_AHB1LPENR)
Page  452: Bit 27 USB2OTGHSLPEN: USB2OTG (OTG_US2) peripheral clock enable during CSleep mode
Page  452: 0: USB2OTG peripheral clocks disabled during CSleep mode
Page  452: 1: USB2OTG peripheral clocks enabled during CSleep mode (default after reset)
Page  452: The peripheral clocks of the USB2OTG are: the kernel clock selected by USBSEL and the
Page  452: rcc_hclk1 bus interface clock.
Page  452: Bit 26 USB1OTGHSULPILPEN: USB_PHY1 clock enable during CSleep mode
Page  452: 0: USB_PHY1 peripheral clock disabled during CSleep mode
Page  452: 1: USB_PHY1 peripheral clock enabled during CSleep mode (default after reset)
Page  452: Bit 25 USB1OTGHSLPEN: USB1OTG (OTG_HS1) peripheral clock enable during CSleep mode
Page  452: 0: USB1OTG peripheral clock disabled during CSleep mode
Page  452: 1: USB1OTG peripheral clock enabled during CSleep mode (default after reset)
Page  452: The peripheral clocks of the USB1OTG are: the kernel clock selected by USBSEL and the
Page  452: rcc_hclk1 bus interface clock.
Page  452: Bit 17 ETH1RXLPEN: Ethernet Reception Clock Enable During CSleep Mode
Page  452: 0: Ethernet Reception clock disabled during CSleep mode
Page  452: 1: Ethernet Reception clock enabled during CSleep mode (default after reset)
Page  453: RM0433                                                                   Reset and Clock Control (RCC)
Page  453: Bit 16 ETH1TXLPEN: Ethernet Transmission Clock Enable During CSleep Mode
Page  453: 0: Ethernet Transmission clock disabled during CSleep mode
Page  453: 1: Ethernet Transmission clock enabled during CSleep mode (default after reset)
Page  453: Bit 15 ETH1MACLPEN: Ethernet MAC bus interface Clock Enable During CSleep Mode
Page  453: 0: Ethernet MAC bus interface clock disabled during CSleep mode
Page  453: 1: Ethernet MAC bus interface clock enabled during CSleep mode (default after reset)
Page  453: Bit 5 ADC12LPEN: ADC1/2 Peripheral Clocks Enable During CSleep Mode
Page  453: 0: ADC1/2 peripheral clocks disabled during CSleep mode
Page  453: 1: ADC1/2 peripheral clocks enabled during CSleep mode (default after reset)
Page  453: The peripheral clocks of the ADC1 and 2 are: the kernel clock selected by ADCSEL and provided to
Page  453: adc_ker_ck input, and the rcc_hclk1 bus interface clock.
Page  453: Bit 1 DMA2LPEN: DMA2 Clock Enable During CSleep Mode
Page  453: 0: DMA2 clock disabled during CSleep mode
Page  453: 1: DMA2 clock enabled during CSleep mode (default after reset)
Page  453: Bit 0 DMA1LPEN: DMA1 Clock Enable During CSleep Mode
Page  453: 0: DMA1 clock disabled during CSleep mode
Page  453: 1: DMA1 clock enabled during CSleep mode (default after reset)
Page  454: Reset and Clock Control (RCC)                                                                                                                          RM0433
Page  454: 7.7.49                        RCC AHB2 Sleep Clock Register (RCC_AHB2LPENR)
Page  454: Bit 31 SRAM3LPEN: SRAM3 Clock Enable During CSleep Mode
Page  454: 0: SRAM3 clock disabled during CSleep mode
Page  454: 1: SRAM3 clock enabled during CSleep mode (default after reset)
Page  454: Bit 30 SRAM2LPEN: SRAM2 Clock Enable During CSleep Mode
Page  454: 0: SRAM2 clock disabled during CSleep mode
Page  454: 1: SRAM2 clock enabled during CSleep mode (default after reset)
Page  454: Bit 29 SRAM1LPEN: SRAM1 Clock Enable During CSleep Mode
Page  454: 0: SRAM1 clock disabled during CSleep mode
Page  454: 1: SRAM1 clock enabled during CSleep mode (default after reset)
Page  454: Bit 9 SDMMC2LPEN: SDMMC2 and SDMMC2 Delay Clock Enable During CSleep Mode
Page  454: 0: SDMMC2 and SDMMC2 Delay clock disabled during CSleep mode
Page  454: 1: SDMMC2 and SDMMC2 Delay clock enabled during CSleep mode (default after reset)
Page  454: Bit 6 RNGLPEN: RNG peripheral clock enable during CSleep mode
Page  454: 0: RNG peripheral clocks disabled during CSleep mode
Page  454: 1: RNG peripheral clock enabled during CSleep mode (default after reset)
Page  454: The peripheral clocks of the RNG are: the kernel clock selected by RNGSEL and provided to
Page  454: rng_ker_ck input, and the rcc_hclk2 bus interface clock.
Page  455: RM0433                                                                   Reset and Clock Control (RCC)
Page  455: Bit 5 HASHLPEN: HASH peripheral clock enable during CSleep mode
Page  455: 0: HASH peripheral clock disabled during CSleep mode
Page  455: 1: HASH peripheral clock enabled during CSleep mode (default after reset)
Page  455: Bit 4 CRYPTLPEN: CRYPT peripheral clock enable during CSleep mode
Page  455: 0: CRYPT peripheral clock disabled during CSleep mode
Page  455: 1: CRYPT peripheral clock enabled during CSleep mode (default after reset)
Page  455: Bit 0 DCMILPEN: DCMI peripheral clock enable during CSleep mode
Page  455: 0: DCMI peripheral clock disabled during CSleep mode
Page  455: 1: DCMI peripheral clock enabled during CSleep mode (default after reset)
Page  456: Reset and Clock Control (RCC)                                                                                                                                                       RM0433
Page  456: 7.7.50          RCC AHB4 Sleep Clock Register (RCC_AHB4LPENR)
Page  456: Bit 29 SRAM4LPEN: SRAM4 Clock Enable During CSleep Mode
Page  456: 0: SRAM4 clock disabled during CSleep mode
Page  456: 1: SRAM4 clock enabled during CSleep mode (default after reset)
Page  456: Bit 28 BKPRAMLPEN: Backup RAM Clock Enable During CSleep Mode
Page  456: 0: Backup RAM clock disabled during CSleep mode
Page  456: 1: Backup RAM clock enabled during CSleep mode (default after reset)
Page  456: Bit 24 ADC3LPEN: ADC3 Peripheral Clocks Enable During CSleep Mode
Page  456: 0: ADC3 peripheral clocks disabled during CSleep mode
Page  456: 1: ADC3 peripheral clocks enabled during CSleep mode (default after reset)
Page  456: The peripheral clocks of the ADC3 are: the kernel clock selected by ADCSEL and provided to
Page  456: adc_ker_ck input, and the rcc_hclk4 bus interface clock.
Page  456: Bit 21 BDMALPEN: BDMA Clock Enable During CSleep Mode
Page  456: 0: BDMA clock disabled during CSleep mode
Page  456: 1: BDMA clock enabled during CSleep mode (default after reset)
Page  457: RM0433                                                                     Reset and Clock Control (RCC)
Page  457: Bit 19 CRCLPEN: CRC peripheral clock enable during CSleep mode
Page  457: 0: CRC peripheral clock disabled during CSleep mode
Page  457: 1: CRC peripheral clock enabled during CSleep mode (default after reset)
Page  457: Bit 10 GPIOKLPEN: GPIOK peripheral clock enable during CSleep mode
Page  457: 0: GPIOK peripheral clock disabled during CSleep mode
Page  457: 1: GPIOK peripheral clock enabled during CSleep mode (default after reset)
Page  457: Bit 9 GPIOJLPEN: GPIOJ peripheral clock enable during CSleep mode
Page  457: 0: GPIOJ peripheral clock disabled during CSleep mode
Page  457: 1: GPIOJ peripheral clock enabled during CSleep mode (default after reset)
Page  457: Bit 8 GPIOILPEN: GPIOI peripheral clock enable during CSleep mode
Page  457: 0: GPIOI peripheral clock disabled during CSleep mode
Page  457: 1: GPIOI peripheral clock enabled during CSleep mode (default after reset)
Page  457: Bit 7 GPIOHLPEN: GPIOH peripheral clock enable during CSleep mode
Page  457: 0: GPIOH peripheral clock disabled during CSleep mode
Page  457: 1: GPIOH peripheral clock enabled during CSleep mode (default after reset)
Page  457: Bit 6 GPIOGLPEN: GPIOG peripheral clock enable during CSleep mode
Page  457: 0: GPIOG peripheral clock disabled during CSleep mode
Page  457: 1: GPIOG peripheral clock enabled during CSleep mode (default after reset)
Page  457: Bit 5 GPIOFLPEN: GPIOF peripheral clock enable during CSleep mode
Page  457: 0: GPIOF peripheral clock disabled during CSleep mode
Page  457: 1: GPIOF peripheral clock enabled during CSleep mode (default after reset)
Page  457: Bit 4 GPIOELPEN: GPIOE peripheral clock enable during CSleep mode
Page  457: 0: GPIOE peripheral clock disabled during CSleep mode
Page  457: 1: GPIOE peripheral clock enabled during CSleep mode (default after reset)
Page  457: Bit 3 GPIODLPEN: GPIOD peripheral clock enable during CSleep mode
Page  457: 0: GPIOD peripheral clock disabled during CSleep mode
Page  457: 1: GPIOD peripheral clock enabled during CSleep mode (default after reset)
Page  458: Reset and Clock Control (RCC)                                                              RM0433
Page  458: Bit 2 GPIOCLPEN: GPIOC peripheral clock enable during CSleep mode
Page  458: 0: GPIOC peripheral clock disabled during CSleep mode
Page  458: 1: GPIOC peripheral clock enabled during CSleep mode (default after reset)
Page  458: Bit 1 GPIOBLPEN: GPIOB peripheral clock enable during CSleep mode
Page  458: 0: GPIOB peripheral clock disabled during CSleep mode
Page  458: 1: GPIOB peripheral clock enabled during CSleep mode (default after reset)
Page  458: Bit 0 GPIOALPEN: GPIOA peripheral clock enable during CSleep mode
Page  458: 0: GPIOA peripheral clock disabled during CSleep mode
Page  458: 1: GPIOA peripheral clock enabled during CSleep mode (default after reset)
Page  459: RM0433                                                                                       Reset and Clock Control (RCC)
Page  459: 7.7.51            RCC APB3 Sleep Clock Register (RCC_APB3LPENR)
Page  459: Bit 6 WWDG1LPEN: WWDG1 Clock Enable During CSleep Mode
Page  459: 0: WWDG1 clock disable during CSleep mode
Page  459: 1: WWDG1 clock enabled during CSleep mode (default after reset)
Page  459: Bit 3 LTDCLPEN: LTDC peripheral clock enable during CSleep mode
Page  459: Provides the pixel clock (ltdc_ker_ck) to the LTDC block.
Page  459: 0: LTDC clock disabled during CSleep mode
Page  459: 1: LTDC clock provided to the LTDC during CSleep mode (default after reset)
Page  460: Reset and Clock Control (RCC)                                                                                                                                                             RM0433
Page  460: 7.7.52                      RCC APB1 Low Sleep Clock Register (RCC_APB1LLPENR)
Page  460: Bit 31 UART8LPEN: UART8 Peripheral Clocks Enable During CSleep Mode
Page  460: 0: UART8 peripheral clocks disabled during CSleep mode
Page  460: 1: UART8 peripheral clocks enabled during CSleep mode (default after reset):
Page  460: The peripheral clocks of the UART8 are: the kernel clock selected by USART234578SEL and
Page  460: provided to usart_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  460: Bit 30 UART7LPEN: UART7 Peripheral Clocks Enable During CSleep Mode
Page  460: 0: UART7 peripheral clocks disabled during CSleep mode
Page  460: 1: UART7 peripheral clocks enabled during CSleep mode (default after reset):
Page  460: The peripheral clocks of the UART7 are: the kernel clock selected by USART234578SEL and
Page  460: provided to usart_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  460: Bit 29 DAC12LPEN: DAC1/2 peripheral clock enable during CSleep mode
Page  460: 0: DAC1/2 peripheral clock disabled during CSleep mode
Page  460: 1: DAC1/2 peripheral clock enabled during CSleep mode (default after reset)
Page  460: Bit 27 CECLPEN: HDMI-CEC Peripheral Clocks Enable During CSleep Mode
Page  460: 0: HDMI-CEC peripheral clocks disabled during CSleep mode
Page  460: 1: HDMI-CEC peripheral clocks enabled during CSleep mode (default after reset)
Page  460: The peripheral clocks of the HDMI-CEC are: the kernel clock selected by CECSEL and provided to
Page  460: cec_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  461: RM0433                                                                    Reset and Clock Control (RCC)
Page  461: Bit 23 I2C3LPEN: I2C3 Peripheral Clocks Enable During CSleep Mode
Page  461: 0: I2C3 peripheral clocks disabled during CSleep mode
Page  461: 1: I2C3 peripheral clocks enabled during CSleep mode (default after reset):
Page  461: The peripheral clocks of the I2C3 are: the kernel clock selected by I2C123SEL and provided to
Page  461: i2c_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  461: Bit 22 I2C2LPEN: I2C2 Peripheral Clocks Enable During CSleep Mode
Page  461: 0: I2C2 peripheral clocks disabled during CSleep mode
Page  461: 1: I2C2 peripheral clocks enabled during CSleep mode (default after reset):
Page  461: The peripheral clocks of the I2C2 are: the kernel clock selected by I2C123SEL and provided to
Page  461: i2c_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  461: Bit 21 I2C1LPEN: I2C1 Peripheral Clocks Enable During CSleep Mode
Page  461: 0: I2C1 peripheral clocks disabled during CSleep mode
Page  461: 1: I2C1 peripheral clocks enabled during CSleep mode (default after reset):
Page  461: The peripheral clocks of the I2C1 are: the kernel clock selected by I2C123SEL and provided to
Page  461: i2c_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  461: Bit 20 UART5LPEN: UART5 Peripheral Clocks Enable During CSleep Mode
Page  461: 0: UART5 peripheral clocks disabled during CSleep mode
Page  461: 1: UART5 peripheral clocks enabled during CSleep mode (default after reset)
Page  461: The peripheral clocks of the UART5 are: the kernel clock selected by USART234578SEL and
Page  461: provided to uart_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  461: Bit 19 UART4LPEN: UART4 Peripheral Clocks Enable During CSleep Mode
Page  461: 0: UART4 peripheral clocks disabled during CSleep mode
Page  461: 1: UART4 peripheral clocks enabled during CSleep mode (default after reset)
Page  461: The peripheral clocks of the UART4 are: the kernel clock selected by USART234578SEL and
Page  461: provided to uart_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  461: Bit 18 USART3LPEN: USART3 Peripheral Clocks Enable During CSleep Mode
Page  461: 0: USART3 peripheral clocks disabled during CSleep mode
Page  461: 1: USART3 peripheral clocks enabled during CSleep mode (default after reset):
Page  461: The peripheral clocks of the USART3 are: the kernel clock selected by USART234578SEL and
Page  461: provided to usart_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  461: Bit 17 USART2LPEN: USART2 Peripheral Clocks Enable During CSleep Mode
Page  461: 0: USART2 peripheral clocks disabled during CSleep mode
Page  461: 1: USART2 peripheral clocks enabled during CSleep mode (default after reset)
Page  461: The peripheral clocks of the USART2 are: the kernel clock selected by USART234578SEL and
Page  461: provided to usart_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  461: Bit 16 SPDIFRXLPEN: SPDIFRX Peripheral Clocks Enable During CSleep Mode
Page  461: 0: SPDIFRX peripheral clocks disabled during CSleep mode
Page  461: 1: SPDIFRX peripheral clocks enabled during CSleep mode (default after reset)
Page  461: The peripheral clocks of the SPDIFRX are: the kernel clock selected by SPDIFSEL and provided to
Page  461: spdifrx_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  462: Reset and Clock Control (RCC)                                                                        RM0433
Page  462: Bit 15 SPI3LPEN: SPI3 Peripheral Clocks Enable During CSleep Mode
Page  462: 0: SPI3 peripheral clocks disabled during CSleep mode
Page  462: 1: SPI3 peripheral clocks enabled during CSleep mode (default after reset)
Page  462: The peripheral clocks of the SPI3 are: the kernel clock selected by I2S123SRC and provided to
Page  462: spi_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  462: Bit 14 SPI2LPEN: SPI2 Peripheral Clocks Enable During CSleep Mode
Page  462: 0: SPI2 peripheral clocks disabled during CSleep mode
Page  462: 1: SPI2 peripheral clocks enabled during CSleep mode (default after reset)
Page  462: The peripheral clocks of the SPI2 are: the kernel clock selected by I2S123SRC and provided to
Page  462: spi_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  462: Bit 9 LPTIM1LPEN: LPTIM1 Peripheral Clocks Enable During CSleep Mode
Page  462: 0: LPTIM1 peripheral clocks disabled during CSleep mode
Page  462: 1: LPTIM1 peripheral clocks enabled during CSleep mode (default after reset)
Page  462: The peripheral clocks of the LPTIM1 are: the kernel clock selected by LPTIM1SEL and provided to
Page  462: lptim_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  462: Bit 8 TIM14LPEN: TIM14 peripheral clock enable during CSleep mode
Page  462: 0: TIM14 peripheral clock disabled during CSleep mode
Page  462: 1: TIM14 peripheral clock enabled during CSleep mode (default after reset)
Page  462: Bit 7 TIM13LPEN: TIM13 peripheral clock enable during CSleep mode
Page  462: 0: TIM13 peripheral clock disabled during CSleep mode
Page  462: 1: TIM13 peripheral clock enabled during CSleep mode (default after reset)
Page  462: Bit 6 TIM12LPEN: TIM12 peripheral clock enable during CSleep mode
Page  462: 0: TIM12 peripheral clock disabled during CSleep mode
Page  462: 1: TIM12 peripheral clock enabled during CSleep mode (default after reset)
Page  462: Bit 5 TIM7LPEN: TIM7 peripheral clock enable during CSleep mode
Page  462: 0: TIM7 peripheral clock disabled during CSleep mode
Page  462: 1: TIM7 peripheral clock enabled during CSleep mode (default after reset)
Page  462: Bit 4 TIM6LPEN: TIM6 peripheral clock enable during CSleep mode
Page  462: 0: TIM6 peripheral clock disabled during CSleep mode
Page  462: 1: TIM6 peripheral clock enabled during CSleep mode (default after reset)
Page  462: Bit 3 TIM5LPEN: TIM5 peripheral clock enable during CSleep mode
Page  462: 0: TIM5 peripheral clock disabled during CSleep mode
Page  462: 1: TIM5 peripheral clock enabled during CSleep mode (default after reset)
Page  463: RM0433                                                                    Reset and Clock Control (RCC)
Page  463: Bit 2 TIM4LPEN: TIM4 peripheral clock enable during CSleep mode
Page  463: 0: TIM4 peripheral clock disabled during CSleep mode
Page  463: 1: TIM4 peripheral clock enabled during CSleep mode (default after reset)
Page  463: Bit 1 TIM3LPEN: TIM3 peripheral clock enable during CSleep mode
Page  463: 0: TIM3 peripheral clock disabled during CSleep mode
Page  463: 1: TIM3 peripheral clock enabled during CSleep mode (default after reset)
Page  463: Bit 0 TIM2LPEN: TIM2 peripheral clock enable during CSleep mode
Page  463: 0: TIM2 peripheral clock disabled during CSleep mode
Page  463: 1: TIM2 peripheral clock enabled during CSleep mode (default after reset)
Page  464: Reset and Clock Control (RCC)                                                                                                                 RM0433
Page  464: 7.7.53            RCC APB1 High Sleep Clock Register (RCC_APB1HLPENR)
Page  464: Bit 8 FDCANLPEN: FDCAN Peripheral Clocks Enable During CSleep Mode
Page  464: 0: FDCAN peripheral clocks disabled during CSleep mode
Page  464: 1: FDCAN peripheral clocks enabled during CSleep mode (default after reset)
Page  464: The peripheral clocks of the FDCAN are: the kernel clock selected by FDCANSEL and provided to
Page  464: fdcan_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  464: Bit 5 MDIOSLPEN: MDIOS peripheral clock enable during CSleep mode
Page  464: 0: MDIOS peripheral clock disabled during CSleep mode
Page  464: 1: MDIOS peripheral clock enabled during CSleep mode (default after reset)
Page  464: Bit 4 OPAMPLPEN: OPAMP peripheral clock enable during CSleep mode
Page  464: 0: OPAMP peripheral clock disabled during CSleep mode
Page  464: 1: OPAMP peripheral clock enabled during CSleep mode (default after reset)
Page  465: RM0433                                                                 Reset and Clock Control (RCC)
Page  465: Bit 2 SWPLPEN: SWPMI Peripheral Clocks Enable During CSleep Mode
Page  465: 0: SWPMI peripheral clocks disabled during CSleep mode
Page  465: 1: SWPMI peripheral clocks enabled during CSleep mode (default after reset)
Page  465: The peripheral clocks of the SWPMI are: the kernel clock selected by SWPSEL and provided to
Page  465: swpmi_ker_ck input, and the rcc_pclk1 bus interface clock.
Page  465: Bit 1 CRSLPEN: Clock Recovery System peripheral clock enable during CSleep mode
Page  465: 0: CRS peripheral clock disabled during CSleep mode
Page  465: 1: CRS peripheral clock enabled during CSleep mode (default after reset)
Page  466: Reset and Clock Control (RCC)                                                                                                                                        RM0433
Page  466: 7.7.54          RCC APB2 Sleep Clock Register (RCC_APB2LPENR)
Page  466: Bit 29 HRTIMLPEN: HRTIM peripheral clock enable during CSleep mode
Page  466: 0: HRTIM peripheral clock disabled during CSleep mode
Page  466: 1: HRTIM peripheral clock enabled during CSleep mode (default after reset)
Page  466: Bit 28 DFSDM1LPEN: DFSDM1 Peripheral Clocks Enable During CSleep Mode
Page  466: 0: DFSDM1 peripheral clocks disabled during CSleep mode
Page  466: 1: DFSDM1 peripheral clocks enabled during CSleep mode (default after reset)
Page  466: DFSDM1 peripheral clocks are: the kernel clocks selected by SAI1SEL and DFSDM1SEL and
Page  466: provided to Aclk and clk inputs respectively, and the rcc_pclk2 bus interface clock.
Page  466: Bit 24 SAI3LPEN: SAI3 Peripheral Clocks Enable During CSleep Mode
Page  466: 0: SAI3 peripheral clocks disabled during CSleep mode
Page  466: 1: SAI3 peripheral clocks enabled during CSleep mode (default after reset)
Page  466: The peripheral clocks of the SAI3 are: the kernel clock selected by SAI23SEL and provided to
Page  466: sai_a_ker_ck and sai_b_ker_ck inputs, and the rcc_pclk2 bus interface clock.
Page  466: Bit 23 SAI2LPEN: SAI2 Peripheral Clocks Enable During CSleep Mode
Page  466: 0: SAI2 peripheral clocks disabled during CSleep mode
Page  466: 1: SAI2 peripheral clocks enabled during CSleep mode (default after reset)
Page  466: The peripheral clocks of the SAI2 are: the kernel clock selected by SAI23SEL and provided to
Page  466: sai_a_ker_ck and sai_b_ker_ck inputs, and the rcc_pclk2 bus interface clock.
Page  467: RM0433                                                                      Reset and Clock Control (RCC)
Page  467: Bit 22 SAI1LPEN: SAI1 Peripheral Clocks Enable During CSleep Mode
Page  467: 0: SAI1 peripheral clocks disabled during CSleep mode
Page  467: 1: SAI1 peripheral clocks enabled during CSleep mode (default after reset)
Page  467: The peripheral clocks of the SAI1 are: the kernel clock selected by SAI1SEL and provided to
Page  467: sai_a_ker_ck and sai_b_ker_ck inputs, and the rcc_pclk2 bus interface clock.
Page  467: Bit 20 SPI5LPEN: SPI5 Peripheral Clocks Enable During CSleep Mode
Page  467: 0: SPI5 peripheral clocks disabled during CSleep mode
Page  467: 1: SPI5 peripheral clocks enabled during CSleep mode (default after reset)
Page  467: The peripheral clocks of the SPI5 are: the kernel clock selected by SPI45SEL and provided to
Page  467: spi_ker_ck input, and the rcc_pclk2 bus interface clock.
Page  467: Bit 18 TIM17LPEN: TIM17 peripheral clock enable during CSleep mode
Page  467: 0: TIM17 peripheral clock disabled during CSleep mode
Page  467: 1: TIM17 peripheral clock enabled during CSleep mode (default after reset)
Page  467: Bit 17 TIM16LPEN: TIM16 peripheral clock enable during CSleep mode
Page  467: 0: TIM16 peripheral clock disabled during CSleep mode
Page  467: 1: TIM16 peripheral clock enabled during CSleep mode (default after reset)
Page  467: Bit 16 TIM15LPEN: TIM15 peripheral clock enable during CSleep mode
Page  467: 0: TIM15 peripheral clock disabled during CSleep mode
Page  467: 1: TIM15 peripheral clock enabled during CSleep mode (default after reset)
Page  467: Bit 13 SPI4LPEN: SPI4 Peripheral Clocks Enable During CSleep Mode
Page  467: 0: SPI4 peripheral clocks disabled during CSleep mode
Page  467: 1: SPI4 peripheral clocks enabled during CSleep mode (default after reset)
Page  467: The peripheral clocks of the SPI4 are: the kernel clock selected by SPI45SEL and provided to
Page  467: spi_ker_ck input, and the rcc_pclk2 bus interface clock.
Page  467: Bit 12 SPI1LPEN: SPI1 Peripheral Clocks Enable During CSleep Mode
Page  467: 0: SPI1 peripheral clocks disabled during CSleep mode
Page  467: 1: SPI1 peripheral clocks enabled during CSleep mode (default after reset)
Page  467: The peripheral clocks of the SPI1 are: the kernel clock selected by I2S123SRC and provided to
Page  467: spi_ker_ck input, and the rcc_pclk2 bus interface clock.
Page  467: Bit 5 USART6LPEN: USART6 Peripheral Clocks Enable During CSleep Mode
Page  467: 0: USART6 peripheral clocks disabled during CSleep mode
Page  467: 1: USART6 peripheral clocks enabled during CSleep mode (default after reset)
Page  467: The peripheral clocks of the USART6 are: the kernel clock selected by USART16SEL and provided
Page  467: to usart_ker_ck input, and the rcc_pclk2 bus interface clock.
Page  468: Reset and Clock Control (RCC)                                                                     RM0433
Page  468: Bit 4 USART1LPEN: USART1 Peripheral Clocks Enable During CSleep Mode
Page  468: 0: USART1 peripheral clocks disabled during CSleep mode
Page  468: 1: USART1 peripheral clocks enabled during CSleep mode (default after reset)
Page  468: The peripheral clocks of the USART1 are: the kernel clock selected by USART16SEL and provided
Page  468: to usart_ker_ck inputs, and the rcc_pclk2 bus interface clock.
Page  468: Bit 1 TIM8LPEN: TIM8 peripheral clock enable during CSleep mode
Page  468: 0: TIM8 peripheral clock disabled during CSleep mode
Page  468: 1: TIM8 peripheral clock enabled during CSleep mode (default after reset)
Page  468: Bit 0 TIM1LPEN: TIM1 peripheral clock enable during CSleep mode
Page  468: 0: TIM1 peripheral clock disabled during CSleep mode
Page  468: 1: TIM1 peripheral clock enabled during CSleep mode (default after reset)
Page  469: RM0433                                                                                                                            Reset and Clock Control (RCC)
Page  469: 7.7.55                     RCC APB4 Sleep Clock Register (RCC_APB4LPENR)
Page  469: Bit 21 SAI4LPEN: SAI4 Peripheral Clocks Enable During CSleep Mode
Page  469: 0: SAI4 peripheral clocks disabled during CSleep mode
Page  469: 1: SAI4 peripheral clocks enabled during CSleep mode (default after reset)
Page  469: The peripheral clocks of the SAI4 are: the kernel clocks selected by SAI4ASEL and SAI4BSEL, and
Page  469: clock.
Page  469: Bit 16 RTCAPBLPEN: RTC APB Clock Enable During CSleep Mode
Page  469: 0: The register clock interface of the RTC (APB) is disabled during CSleep mode
Page  469: 1: The register clock interface of the RTC (APB) is enabled during CSleep mode (default after reset)
Page  469: Bit 15 VREFLPEN: VREF peripheral clock enable during CSleep mode
Page  469: 0: VREF peripheral clock disabled during CSleep mode
Page  469: 1: VREF peripheral clock enabled during CSleep mode (default after reset)
Page  469: Bit 14 COMP12LPEN: COMP1/2 peripheral clock enable during CSleep mode
Page  469: 0: COMP1/2 peripheral clock disabled during CSleep mode
Page  469: 1: COMP1/2 peripheral clock enabled during CSleep mode (default after reset)
Page  470: Reset and Clock Control (RCC)                                                                          RM0433
Page  470: Bit 12 LPTIM5LPEN: LPTIM5 Peripheral Clocks Enable During CSleep Mode
Page  470: 0: LPTIM5 peripheral clocks disabled during CSleep mode
Page  470: 1: LPTIM5 peripheral clocks enabled during CSleep mode (default after reset)
Page  470: The peripheral clocks of the LPTIM5 are: the kernel clock selected by LPTIM345SEL and provided
Page  470: to lptim_ker_ck input, and the rcc_pclk4 bus interface clock.
Page  470: Bit 11 LPTIM4LPEN: LPTIM4 Peripheral Clocks Enable During CSleep Mode
Page  470: 0: LPTIM4 peripheral clocks disabled during CSleep mode
Page  470: 1: LPTIM4 peripheral clocks enabled during CSleep mode (default after reset)
Page  470: The peripheral clocks of the LPTIM4 are: the kernel clock selected by LPTIM345SEL and provided
Page  470: to lptim_ker_ck input, and the rcc_pclk4 bus interface clock.
Page  470: Bit 10 LPTIM3LPEN: LPTIM3 Peripheral Clocks Enable During CSleep Mode
Page  470: 0: LPTIM3 peripheral clocks disabled during CSleep mode
Page  470: 1: LPTIM3 peripheral clocks enabled during CSleep mode (default after reset)
Page  470: The peripheral clocks of the LPTIM3 are: the kernel clock selected by LPTIM345SEL and provided
Page  470: to lptim_ker_ck input, and the rcc_pclk4 bus interface clock.
Page  470: Bit 9 LPTIM2LPEN: LPTIM2 Peripheral Clocks Enable During CSleep Mode
Page  470: 0: LPTIM2 peripheral clocks disabled during CSleep mode
Page  470: 1: LPTIM2 peripheral clocks enabled during CSleep mode (default after reset)
Page  470: The peripheral clocks of the LPTIM5 are: the kernel clock selected by LPTIM2SEL and provided to
Page  470: lptim_ker_ck input, and the rcc_pclk4 bus interface clock.
Page  470: Bit 7 I2C4LPEN: I2C4 Peripheral Clocks Enable During CSleep Mode
Page  470: 0: I2C4 peripheral clocks disabled during CSleep mode
Page  470: 1: I2C4 peripheral clocks enabled during CSleep mode (default after reset)
Page  470: The peripheral clocks of the I2C4 are: the kernel clock selected by I2C4SEL and provided to
Page  470: i2c_ker_ck input, and the rcc_pclk4 bus interface clock.
Page  470: Bit 5 SPI6LPEN: SPI6 Peripheral Clocks Enable During CSleep Mode
Page  470: 0: SPI6 peripheral clocks disabled during CSleep mode
Page  470: 1: SPI6 peripheral clocks enabled during CSleep mode (default after reset)
Page  470: The peripheral clocks of the SPI6 are: the kernel clock selected by SPI6SEL and provided to
Page  470: spi_ker_ck input, and the rcc_pclk4 bus interface clock.
Page  470: Bit 3 LPUART1LPEN: LPUART1 Peripheral Clocks Enable During CSleep Mode
Page  470: 0: LPUART1 peripheral clocks disabled during CSleep mode
Page  470: 1: LPUART1 peripheral clocks enabled during CSleep mode (default after reset)
Page  470: The peripheral clocks of the LPUART1 are: the kernel clock selected by LPUART1SEL and
Page  470: provided to lpuart_ker_ck input, and the rcc_pclk4 bus interface clock.
Page  471: RM0433                                                                 Reset and Clock Control (RCC)
Page  471: Bit 1 SYSCFGLPEN: SYSCFG peripheral clock enable during CSleep mode
Page  471: 0: SYSCFG peripheral clock disabled during CSleep mode
Page  471: 1: SYSCFG peripheral clock enabled during CSleep mode (default after reset)
Page  472: Reset and Clock Control (RCC)
Page  473: Reset and Clock Control (RCC)
Page  474: Reset and Clock Control (RCC)
Page  475: Reset and Clock Control (RCC)
Page  476: Reset and Clock Control (RCC)
Page  477: Reset and Clock Control (RCC)
Page  478: Reset and Clock Control (RCC)
Page  479: Reset and Clock Control (RCC)
Page  480: Reset and Clock Control (RCC)
Page  481: Reset and Clock Control (RCC)
Page  482: Clock recovery system (CRS)                                                                    RM0433
Page  482: 8          Clock recovery system (CRS)
Page  482: The clock recovery system (CRS) is an advanced digital controller acting on the internal
Page  482: The CRS is ideally suited to provide a precise clock to the USB peripheral. In such case, the
Page  483: RM0433                                                                      Clock recovery system (CRS)
Page  483: crs_pclk     Digital input    AHB bus clock
Page  483: hsi48_ck     Digital input    HSI48 oscillator clock
Page  484: Clock recovery system (CRS)                                                                      RM0433
Page  484: be the signal from an external signal (SYNC), the LSE clock, the OTG HS1 SOF signal, or
Page  485: RM0433                                                         Clock recovery system (CRS)
Page  486: Clock recovery system (CRS)                                                                        RM0433
Page  487: RM0433                                                                     Clock recovery system (CRS)
Page  487: size, expressed as a number of HSI48 oscillator clock ticks. The following formula can be
Page  488: Clock recovery system (CRS)                                                                                        RM0433
Page  488: This bit enables the oscillator clock for the frequency error counter.
Page  489: RM0433                                                                               Clock recovery system (CRS)
Page  489: clock precision after waking up from Sleep mode, the LSE clock or the SYNC pin should be
Page  490: Clock recovery system (CRS)                                                                                      RM0433
Page  491: RM0433                                                                        Clock recovery system (CRS)
Page  492: Clock recovery system (CRS)                                                                                     RM0433
Page  493: RM0433                                                                                                                                                                Clock recovery system (CRS)
Page  495: hsem_hclk                Digital input       AHB clock
Page  508: •    Fast toggle capable of changing every two clock cycles
Page  511: clock cycle.
Page  514: clock cycle
Page  514: clock cycle
Page  515: clock cycle
Page  517: When the oscillator is configured in a user external clock mode, only the OSC_IN or
Page  517: OSC32_IN pin is reserved for clock input and the OSC_OUT or OSC32_OUT pin can still be
Page  551: The source output signal is sampled by the destination clock, leading to introduction of
Page  551: Both source and destination are synchronous (they run on the same clock), and the
Page  561: lptim3_ext_                                       If same kernel clock
Page  561: lptim3_ext_                                       If same kernel clock
Page  561: lptim3_ext_                                       If same kernel clock
Page  562: lptim4_ext_trg                                     If same kernel clock
Page  562: lptim4_ext_trg                                     If same kernel clock
Page  562: lptim4_ext_trg                                     If same kernel clock
Page  562: lptim5_ext_trg                                     If same kernel clock
Page  562: lptim5_ext_trg                                     If same kernel clock
Page  562: lptim5_ext_trg                                     If same kernel clock
Page  570: bus interface clock, they are referred to as xxx_wkup in Table 93. Some peripherals do
Page  570: interface clock is running. These interrupt signals are generally directly connected to
Page  573: 1. The source peripheral needs its bus clock in order to generate the event. This is either PCLK4 or HCLK4 in D3 domain,
Page  588: mdma_hclk                 Digital input   MDMA AHB clock
Page  617: dma_hclk                                 DMA AHB clock
Page  677: dmamux_hclk        DMAMUX AHB clock
Page  679: AHB clock cycle, when its DMA request counter is automatically reloaded with the value of
Page  680: more than two AHB clock cycles.
Page  680: three AHB clock cycles.
Page  681: than two AHB clock cycles.
Page  681: AHB clock cycles.
Page  694: dma2d_aclk                       Input       32-bit AXI bus clock
Page  702: This timer is clocked by the AXI clock and counts a dead time between two consecutive
Page  726: Dead time value in the AXI clock cycle inserted between two consecutive accesses on
Page  729: timebase of 1 ms based when the SysTick clock frequency is 1 MHz. To match the 1 ms
Page  729: •   The SysTick clock source is the 100 MHz CPU clock (HCLK):
Page  729: •   or the SysTick clock source is an external clock:
Page  729: For example, to achieve a timebase of 1 ms when the SysTick clock source is the 100 MHz
Page  730: The RCC Clock Security
Page  736: Clock Recovery System global
Page  742: reset by the clocked Delay and Rising edge detect pulse generator. This guarantees that the
Page  742: CPU clock is woken up before the Asynchronous edge detection circuit is reset.
Page  742: circuit is reset by the D3 domain clocked Delay and Rising edge detect pulse generator.
Page  742: This guarantees that the D3 domain clock is woken up before the Asynchronous edge
Page  742: Both = 0                D3 domain clock rising edge detect pulse generator
Page  742: At least one = 1                       CPU clock rising edge detect pulse generator
Page  744: 1. The CPU interrupt for asynchronous Direct Event inputs (peripheral Wakeup signals) is synchronized with the CPU clock.
Page  745: synchronized, respectively, with the CPU clock and the D3 domain clock. The synchronous Direct Event inputs (peripheral
Page  770: •   CRC computation done in 4 AHB clock cycles (HCLK) for the 32-bit data size
Page  771: crc_hclk             Digital input     AHB clock
Page  771: •   4 AHB clock cycles for 32-bit
Page  771: •   2 AHB clock cycles for 16-bit
Page  771: •   1 AHB clock cycles for 8-bit
Page  776: •   Programmable continuous clock output for asynchronous and synchronous accesses
Page  777: When the SDRAM controller is used, if the SDCLK Clock ratio or refresh rate has to be
Page  777: 5.   Then, send the Clock Configuration Enable command to exit Self-fresh mode.
Page  779: fmc_ker_ck             Digital input    FMC kernel clock
Page  779: fmc_hclk             Digital input    FMC interface clock
Page  779: The AHB clock (fmc_hclk) is the reference clock for the FMC register accesses.
Page  779: The kernel clock for the FMC controller is the asynchronous fmc_ker_ck clock (refer to
Page  779: Section 7: Reset and Clock Control (RCC) for fmc_ker_ck clock source selection).
Page  788: •      Programmable continuous clock (FMC_CLK) output.
Page  788: The FMC output Clock (FMC_CLK) is a sub-multiple of the fmc_ker_ck clock. It can be
Page  788: •      If the CCLKEN bit is reset, the FMC generates the clock (FMC_CLK) only during
Page  788: •      If the CCLKEN bit is set, the FMC generates a continuous clock during asynchronous
Page  788: and synchronous accesses. To generate the FMC_CLK continuous clock, Bank 1 must
Page  788: registers). Since the same clock is used for all synchronous memories, when a
Page  788: continuous output clock is generated and synchronous accesses are performed, the
Page  788: Address         Duration of the address                        FMC clock cycle
Page  788: Duration of the address hold     Asynchronous,   FMC clock cycle
Page  788: Duration of the data setup                      FMC clock cycle
Page  788: Duration of the bus         Asynchronous and FMC clock cycle
Page  788: Number of FMC clock cycles
Page  788: Clock divide                                                     FMC clock cycle
Page  788: memory clock cycle (CLK)
Page  788: Number of clock cycles to                        Memory clock
Page  789: CLK                           O               Clock (for synchronous access)
Page  789: CLK                O                         Clock (for synchronous access)
Page  790: CLK         O                   Clock (only for PSRAM synchronous access)
Page  790: CLK         O                         Clock (for synchronous access)
Page  792: •      All controller output signals change on the rising edge of the fmc_ker_ck clock.
Page  792: fmc_ker_ck clock. Whatever the CLKDIV value, all outputs change as follows:
Page  792: falling edge of FMC_CLK clock.
Page  792: edge of FMC_CLK clock.
Page  792: •      Signals are synchronized by the internal clock. This clock is not issued to the memory.
Page  810: Figure 108 and Figure 109 show the number of fmc_ker_ck clock cycles that are added to the
Page  812: The memory clock, FMC_CLK, is a sub-multiple of fmc_ker_ck. It depends on the value of
Page  812: meet this constraint, the FMC does not issue the clock to the memory during the first internal
Page  812: clock cycle of the synchronous access (before NADV assertion). This guarantees that the
Page  812: rising edge of the memory clock occurs in the middle of the NADV low pulse.
Page  812: register. The FMC does not include the clock cycle when NADV is low in the data latency
Page  812: •   NOR Flash latency = (DATLAT + 2) FMC_CLK clock cycles
Page  812: •   or NOR Flash latency = (DATLAT + 3) FMC_CLK clock cycles
Page  813: period, which corresponds to (DATLAT+2) FMC_CLK clock cycles.
Page  813: or on the next clock edge (bit WAITCFG = 0).
Page  813: During wait-state insertion via the NWAIT signal, the controller continues to send clock
Page  814: clock clock                                                            Data strobes
Page  816: 1 clock 1 clock
Page  819: Bit 20 CCLKEN: Continuous Clock Enable
Page  819: This bit enables the FMC_CLK clock output to external memory devices.
Page  819: transaction). The FMC_CLK clock ratio is specified by the programmed CLKDIV value in the
Page  819: The FMC_CLK clock is activated when the CCLKEN is set.
Page  819: the FMC_CLK continuous clock.
Page  819: If CCLKEN bit is set, the FMC_CLK clock ratio is specified by CLKDIV value in the
Page  819: connected to other banks than Bank 1 are clocked by the same clock (the CLKDIV value
Page  820: determines if NWAIT is asserted by the memory one clock cycle before the wait state or
Page  822: set), these bits define the number of memory clock cycles (+2) to issue to the memory before
Page  822: 0000: Data latency of 2 FMC_CLK clock cycles for first burst access
Page  822: 1111: Data latency of 17 FMC_CLK clock cycles for first burst access (default value after
Page  822: Bits 23:20 CLKDIV[3:0]: Clock divide ratio (for FMC_CLK signal)
Page  822: These bits define the period of FMC_CLK clock output signal, expressed in number of
Page  823: • There is a bus turnaround delay of 1 FMC clock cycle between:
Page  823: • There is a bus turnaround delay of 2 FMC clock cycle between:
Page  823: • There is a bus turnaround delay of 3 FMC clock cycle between:
Page  823: 0000: BUSTURN phase duration = 0 fmc_ker_ck clock cycle added
Page  823: 1111: BUSTURN phase duration = 15 x fmc_ker_ck clock cycles added (default value after
Page  823: 0000 0001: DATAST phase duration = 1 × fmc_ker_ck clock cycles
Page  823: 0000 0010: DATAST phase duration = 2 × fmc_ker_ck clock cycles
Page  823: 1111 1111: DATAST phase duration = 255 × fmc_ker_ck clock cycles (default value after
Page  823: 1 x fmc_ker_ck clock cycles.
Page  824: 0001: ADDHLD phase duration =1 × fmc_ker_ck clock cycle
Page  824: 0010: ADDHLD phase duration = 2 × fmc_ker_ck clock cycle
Page  824: 1111: ADDHLD phase duration = 15 × fmc_ker_ck clock cycles (default value after reset)
Page  824: memory clock period duration.
Page  824: 0000: ADDSET phase duration = 0 × fmc_ker_ck clock cycle
Page  824: 1111: ADDSET phase duration = 15 × fmc_ker_ck clock cycles (default value after reset)
Page  825: • There is a bus turnaround delay of 2 FMC clock cycle between:
Page  825: • There is a bus turnaround delay of 3 FMC clock cycle between:
Page  825: 0000: BUSTURN phase duration = 0 fmc_ker_ck clock cycle added
Page  825: 1111: BUSTURN phase duration = 15 fmc_ker_ck clock cycles added (default value after reset)
Page  826: 0000 0001: DATAST phase duration = 1 × fmc_ker_ck clock cycles
Page  826: 0000 0010: DATAST phase duration = 2 × fmc_ker_ck clock cycles
Page  826: 1111 1111: DATAST phase duration = 255 × fmc_ker_ck clock cycles (default value after reset)
Page  826: 0001: ADDHLD phase duration = 1 × fmc_ker_ck clock cycle
Page  826: 0010: ADDHLD phase duration = 2 × fmc_ker_ck clock cycle
Page  826: 1111: ADDHLD phase duration = 15 × fmc_ker_ck clock cycles (default value after reset)
Page  826: 1 Flash clock period duration.
Page  826: 0000: ADDSET phase duration = 0 × fmc_ker_ck clock cycle
Page  826: 1111: ADDSET phase duration = 15 × fmc_ker_ck clock cycles (default value after reset)
Page  826: clock period duration. In muxed mode, the minimum ADDSET value is 1.
Page  827: Number of clock cycles
Page  827: Memory setup          (fmc_ker_ck) required to set up the                    AHB clock cycle
Page  827: AHB clock cycle
Page  827: Memory wait        clock cycles) of the command           Read/Write                       2      255
Page  827: Number of clock cycles
Page  827: address must be held (as well as                      AHB clock cycle
Page  827: Number of clock cycles
Page  827: (fmc_ker_ck) during which the data                     AHB clock cycle
Page  833: These bits set time from ALE low to RE low in number of fmc_ker_ck clock cycles.
Page  833: Time is: t_ar = (TAR + SET + 2) × tfmc_ker_ck where tfmc_ker_ck is the FMC clock period
Page  834: These bits set time from CLE low to RE low in number of fmc_ker_ck clock cycles. The time
Page  834: t_clr = (TCLR + SET + 2) × tfmc_ker_ck where tfmc_ker_ck is the fmc_ker_ck clock period
Page  836: These bits define the number of fmc_ker_ck clock cycles during which the data bus is kept
Page  836: These bits define the number of fmc_ker_ck clock cycles for write accesses and
Page  836: fmc_ker_ck+1 clock cycles for read accesses during which the address is held (and data for
Page  836: These bits define the minimum number of fmc_ker_ck (+1) clock cycles to assert the
Page  836: These bits define the number of fmc_ker_ck (+1) clock cycles to set up the address before
Page  837: These bits define the number of fmc_ker_ck clock cycles during which the data bus is kept in
Page  837: These bits define the number of fmc_ker_ck clock cycles during which the address is held
Page  837: These bits define the minimum number of x fmc_ker_ck (+1) clock cycles to assert the
Page  837: These bits define the number of fmc_ker_ck (+1) clock cycles to set up address before the
Page  839: •    SDRAM clock can be fmc_ker_ck/2 or fmc_ker_ck/3
Page  839: SDCLK             O                     SDRAM clock                          -
Page  839: SDCKE0: SDRAM Bank 1 Clock Enable
Page  839: SDCKE1: SDRAM Bank 2 Clock Enable
Page  840: memory clock (FMC_SDCLK).
Page  840: clock frequency, RBURST and RPIPE must be programmed in the FMC_SDCR1
Page  840: FMC_SDCMR register to start delivering the clock to the memory (SDCKE is driven
Page  842: store data read in advance during the CAS latency period (up to 3 memory clock cycles,
Page  842: programmed FMC_SDCRx) and during the RPIPE delay when set to 2xfmc_ker_ck clock
Page  844: If necessary, the SDRAM controller inserts additional clock cycles between the following
Page  846: COUNT value in the register FMC_SDRTR. This value defines the number of memory clock
Page  847: without external clocking.
Page  847: The SDRAM clock stops running after a TRAS delay and the internal refresh timer stops
Page  850: These bits define the delay, in fmc_ker_ck clock cycles, for reading data after CAS latency.
Page  850: 00: No fmc_ker_ck clock cycle delay
Page  850: 01: One fmc_ker_ck clock cycle delay
Page  850: 10: Two fmc_ker_ck clock cycle delay
Page  850: Bits 11:10 SDCLK[1:0]: SDRAM clock configuration
Page  850: These bits define the SDRAM clock period for both SDRAM banks and allow disabling the clock
Page  850: 00: SDCLK clock disabled
Page  851: This bits sets the SDRAM CAS latency in number of memory clock cycles
Page  851: Note:              Before modifying the RBURST or RPIPE settings or disabling the SDCLK clock, the user
Page  852: of memory clock cycles.
Page  852: memory clock cycles. The TRP timing is only configured in the FMC_SDTR1 register. If two
Page  852: These bits define the delay between a Write and a Precharge command in number of memory clock
Page  852: the delay between two consecutive Refresh commands. It is expressed in number of memory clock
Page  853: These bits define the minimum Self-refresh period in number of memory clock cycles.
Page  853: command in number of memory clock cycles.
Page  853: command in number of memory clock cycles.
Page  854: 001: Clock Configuration Enable
Page  854: This register sets the refresh rate in number of SDCLK clock cycles between the refresh
Page  854: Refresh rate = ( COUNT + 1 ) × SDRAM clock frequency
Page  855: The refresh rate must be increased by 20 SDRAM clock cycles (as in the above example) to
Page  855: This 13-bit field is loaded into a timer which is decremented using the SDRAM clock. This
Page  855: least to 41 SDRAM clock cycles.
Page  855: clock cycles. It must be set at least to 41 SDRAM clock cycles (0x29).
Page  855: Refresh rate = (COUNT + 1) x SDRAM frequency clock
Page  855: TWR+TRP+TRC+TRCD+4 memory clock cycles .
Page  860: AHB bus                   Registers /         Clock
Page  860: 32-bit                Registers /         Clock
Page  861: quadspi_ker_ck           Digital input      QUADSPI kernel clock
Page  861: quadspi_hclk           Digital input      QUADSPI register interface clock
Page  861: CLK               Digital output      Clock to FLASH 1 and FLASH 2
Page  863: in order to allow the Flash memory the time to prepare for the data phase when higher clock
Page  869: 22.3.8    QUADSPI Free running clock mode
Page  869: When configured in Free running clock mode, the QUADSPI peripheral continuously
Page  869: outputs the clock for test and calibration purposes.
Page  869: Free running clock mode is entered as soon as the Free running clock mode bit (FRCM) is
Page  869: When the QUADSPI operates in Free running clock mode:
Page  869: •    the clock is running continuously,
Page  869: The clock mode (CKMODE) bit indicates the CLK signal logic level in between commands
Page  870: Clock shifting is not supported in DDR mode: the SSHIFT bit must be clear when DDRM bit
Page  870: The QUADSPI IP is configured using the QUADSPI_CR. The user shall configure the clock
Page  870: bytes are sent on both clock edges and the data are sent/received on both clock edges.
Page  871: •    Clock prescaler
Page  874: T                                                  Clock stalled       T/2
Page  876: Bits 31:24 PRESCALER[7:0]: Clock prescaler
Page  876: clock (value+1).
Page  876: 0: FCLK = Fquadspi_ker_ck, quadspi_ker_ck clock used directly as QUADSPI CLK
Page  876: For odd clock division factors, CLK’s duty cycle is not 50%. The clock signal remains
Page  882: Delay the data output by 1/4 of the QUADSPI output clock cycle in DDR mode:
Page  882: 1: Delay the data output by 1/4 of a QUADSPI output clock cycle.
Page  882: Bit 29 FRCM: Free Running Clock Mode
Page  882: When this bit is set, the QUADSPI peripheral enters Free running clock mode
Page  882: 1: Free running clock mode
Page  889: The delay block (DLYB) is used to generate an output clock which is dephased from the
Page  889: input clock. The phase of the output clock must be programmed by the user application. The
Page  889: output clock is then used to clock the data received by another peripheral such as an
Page  889: configure and recenter the output clock phase with the receive data.
Page  889: •                    Input clock frequency ranging from 25 to 208 MHz
Page  889: •                    Output clock selection multiplexer
Page  889: CLOCK OUT MUX
Page  890: dlyb_hclk               Digital input   Delay block register interface clock
Page  890: dlyb_in_ck              Digital input   Delay block input clock
Page  890: dlyb_out_ck             Digital output   Delay block output clock
Page  890: Note that the UNIT bits can be programmed only when the output clock is disabled (SEN =
Page  890: When the delay block is enabled, the output clock phase is selected through the SEL bit in
Page  890: DLYB_CFGR register. Note that SEL can be programmed only when the output clock is
Page  890: Before dephasing the output clock, the delay line length shall be configured to one input
Page  890: clock period. The delay line length can be configured by enabling the length sampler
Page  890: Once the delay line length has been configured, a dephased output clock can be selected
Page  890: by the output clock multiplexer. This is done through SEL bits. The output clock is only
Page  890: DEN SEN           UNIT                SEL               LNG       LNGF              Output clock
Page  890: 0       0    Don’t care          Don’t care                   Don’t care     Enabled (= Input clock)
Page  890: x       1    Unit delay      Output clock phase       Length Length flag             Disabled
Page  890: 1       0                   Output clock phase(2)             Don’t care   Enabled (= selected phase)
Page  890: 2. The output clock phase can only be changed when SEN = ‘1’.
Page  891: LNG bits are used to determine the delay line length with respect to the input clock period.
Page  891: The length shall be configured so that one full input clock period is covered by the delay line
Page  891: To configure the delay line length to one period of the Input clock, follow the sequence
Page  891: one input clock period.
Page  891: 5.   Determine how many unit delays (N) span one input clock period.
Page  891: If LNG[N] = ‘1’, the number of unit delays spanning the input clock period = N.
Page  891: 23.3.5   Output clock phase configuration procedure
Page  891: When the delay line length is configured to one input clock period, the output clock phase
Page  891: can be selected between the unit delays spanning one Input clock period.
Page  891: Follow the steps below to select the output clock phase:
Page  891: 1.   Disable the output clock and enable the access to the phase selection SEL bits by
Page  891: 2.   Program SEL bits with the desired output clock phase value.
Page  891: 3.   Enable the output clock on the selected phase by clearing SEN to ‘0’.
Page  892: 0: Sampler length and register access to UNIT and SEL disabled, output clock enabled.
Page  892: 1: Sampler length and register access to UNIT and SEL enabled, output clock disabled.
Page  892: These bits reflect the 12 unit delay values sampled at the rising edge of the input clock.
Page  893: Bits 3:0 SEL[3:0]: Select the phase for the Output clock.
Page  893: Output clock phase = Input clock + SEL x Unit delay
Page  895: –   ADC conversion time is independent from the AHB bus clock frequency
Page  895: –   Provides automatic control to avoid ADC overrun in low AHB bus clock frequency
Page  898: adc_hclk                    Input     AHB clock
Page  898: adc_ker_ck                  Input     ADC kernel clock
Page  899: 24.3.3   Clocks
Page  899: Dual clock domain architecture
Page  899: The dual clock-domain architecture means that the ADCs clock is independent from the
Page  899: AHB bus clock.
Page  899: The input clock is the same for the three ADCs and can be selected between two different
Page  899: clock sources (see Figure 132: ADC clock scheme):
Page  899: 1.   The ADC clock can be a specific clock source, named adc_ker_ck which is
Page  899: independent and asynchronous with the AHB clock.
Page  899: generate the ADC clock (adc_ker_ck) dedicated clock).
Page  899: 2.   The ADC clock can be derived from the AHB clock of the ADC bus interface, divided by
Page  899: Option 1) has the advantage of reaching the maximum ADC clock frequency whatever the
Page  899: AHB clock scheme selected. The ADC clock can eventually be divided by the following ratio:
Page  899: Option 2) has the advantage of bypassing the clock domain resynchronizations. This can be
Page  899: added by the resynchronizations between the two clock domains).
Page  899: The clock configured through CKMODE[1:0] bits must be compliant with the operating
Page  900: Figure 132. ADC clock scheme
Page  900: clock           adc_hclk
Page  900: Clock ratio constraint between ADC clock and AHB clock
Page  900: There are generally no constraints to be respected for the ratio between the ADC clock and
Page  900: the AHB clock except if some injected channels are programmed. In this case, it is
Page  900: This bit must be set when the ADC clock is more than 20 MHz. When ADC clock is less than
Page  906: Refer to the datasheets for the clock cycle requirement for both linear and offset calibration.
Page  912: The software can write the RCC control bits to configure and enable the ADC clock (refer to
Page  914: •    SMP = 000: 1.5 ADC clock cycles
Page  914: •    SMP = 001: 2.5 ADC clock cycles
Page  914: •    SMP = 010: 8.5 ADC clock cycles
Page  914: •    SMP = 011: 16.5 ADC clock cycles
Page  914: •    SMP = 100: 32.5 ADC clock cycles
Page  914: •    SMP = 101: 64.5 ADC clock cycles
Page  914: •    SMP = 110: 387.5 ADC clock cycles
Page  914: •    SMP = 111: 810.5 ADC clock cycles
Page  914: TCONV = Sampling time + 7.5 ADC clock cycles
Page  914: With Fadc_ker_ck = 24 MHz and a sampling time of 1.5 ADC clock cycles (14-bit mode):
Page  914: TCONV = (1.5 + 7.5) ADC clock cycles = 9 ADC clock cycles = 0.375 µs (14 bit mode for
Page  923: longer than the injection sequence. For instance, if the sequence length is 20 ADC clock
Page  923: cycles (that is two conversions with a sampling time of 1.5 clock periods), the minimum
Page  923: interval between triggers must be 21 ADC clock cycles.
Page  934: Tadc_ker_ck (ADC clock     Tadc_ker_ck (ns)
Page  934: (ADC clock cycles)                       (with Sampling Time=       Fadc_ker_ck=24
Page  934: 1.5 ADC clock cycles)           MHz
Page  934: 16     8.5 ADC clock cycles       354.2           10 ADC clock cycles           416.7
Page  934: 14     7.5 ADC clock cycles       312.5            9 ADC clock cycles            375
Page  934: 12     6.5 ADC clock cycles       270.8            8 ADC clock cycles           333.3
Page  934: 10     5.5 ADC clock cycles       229.2            7 ADC clock cycles           291.7
Page  934: 8     4.5 ADC clock cycles       187.5            6 ADC clock cycles           250.0
Page  943: optimize performance of an application clocked at low frequency where there would be risk
Page  962: •    The slave ADC starts after a delay of several ADC clock cycles after the sampling
Page  965: The time interval between 2 trigger events must be greater than or equal to 1 ADC clock
Page  983: 0: Boost mode off. Used when ADC clock < 20 MHz to save power at lower clock frequency.
Page  983: 1: Boost mode on. Must be used when ADC clock > 20 MHz.
Page  992: 000: 1.5 ADC clock cycles
Page  992: 001: 2.5 ADC clock cycles
Page  992: 010: 8.5 ADC clock cycles
Page  992: 011: 16.5 ADC clock cycles
Page  992: 100: 32.5 ADC clock cycles
Page  992: 101: 64.5 ADC clock cycles
Page  992: 110: 387.5.5 ADC clock cycles
Page  992: 111: 810.5 ADC clock cycles
Page  993: 000: 1.5 ADC clock cycles
Page  993: 001: 2.5 ADC clock cycles
Page  993: 010: 8.5 ADC clock cycles
Page  993: 011: 16.5 ADC clock cycles
Page  993: 100: 32.5 ADC clock cycles
Page  993: 101: 64.5 ADC clock cycles
Page  993: 110: 387.5 ADC clock cycles
Page  993: 111: 810.5 ADC clock cycles
Page 1013: These bits are set and cleared by software to select the frequency of the clock to the ADC.
Page 1013: The clock is common for all the ADCs.
Page 1013: 0000: input ADC clock not divided
Page 1013: 0001: input ADC clock divided by 2
Page 1013: 0010: input ADC clock divided by 4
Page 1013: 0011: input ADC clock divided by 6
Page 1013: 0100: input ADC clock divided by 8
Page 1013: 0101: input ADC clock divided by 10
Page 1013: 0110: input ADC clock divided by 12
Page 1013: 0111: input ADC clock divided by 16
Page 1013: 1000: input ADC clock divided by 32
Page 1013: 1001: input ADC clock divided by 64
Page 1013: 1010: input ADC clock divided by 128
Page 1013: 1011: input ADC clock divided by 256
Page 1013: Bits 17:16 CKMODE[1:0]: ADC clock mode
Page 1013: These bits are set and cleared by software to define the ADC clock scheme (which is
Page 1013: 00: CK_ADCx (x=1 to 3) (Asynchronous clock mode), generated at product level (refer to
Page 1013: Section Reset and Clock Control (RCC))
Page 1013: 01: adc_hclk/1 (Synchronous clock mode). This configuration must be enabled only if the
Page 1013: AHB clock prescaler is set to 1 (HPRE[3:0] = 0xxx in RCC_CFGR register) and if the system
Page 1013: clock has a 50% duty cycle.
Page 1013: 10: adc_hclk/2 (Synchronous clock mode)
Page 1013: 11: adc_hclk/4 (Synchronous clock mode)
Page 1013: In all synchronous clock modes, there is no jitter in the delay from a timer trigger to the start
Page 1023: •      Sample and Hold block and registers operational in Stop mode, using LSI clock source
Page 1023: registers can run in Stop mode using the LSI clock source.
Page 1023: dac_pclk            Input      DAC peripheral clock
Page 1025: register after one dac_pclk clock cycle, if no hardware trigger is selected (TENx bit in
Page 1025: DAC_CR register is set) and a trigger occurs, the transfer is performed three dac_pclk clock
Page 1026: DAC_DORx register takes only one dac_pclk clock cycle.
Page 1027: preloaded value in LFSR is 0xAAA. This register is updated three dac_pclk clock cycles
Page 1029: is incremented three dac_pclk clock cycles after each trigger event. The value of this
Page 1030: speed clock (LSI) in addition to the dac_pclk clock, allowing to use the DAC channels in
Page 1030: 1 to synchronize between both clocks domains (APB and low speed clock) and
Page 1030: The timings for the three phases above are in units of LSI clocks. As an example, to
Page 1035: (three dac_pclk clock cycles later).
Page 1035: (three dac_pclk clock cycles later).
Page 1035: the DHR1 register and the sum is transferred into DAC_DOR1 (three dac_pclk clock cycles
Page 1035: the DHR2 register and the sum is transferred into DAC_DOR2 (three dac_pclk clock cycles
Page 1035: (three dac_pclk clock cycles later). Then the LFSR1 counter is updated.
Page 1035: (three dac_pclk clock cycles later). Then the LFSR2 counter is updated.
Page 1036: DAC_DOR1 (three dac_pclk clock cycles later). The DAC channel1 triangle counter is then
Page 1036: DAC_DOR2 (three dac_pclk clock cycles later). The DAC channel2 triangle counter is then
Page 1036: transferred into DAC_DOR1 (three dac_pclk clock cycles later). The DAC channel1 triangle
Page 1036: transferred into DAC_DOR2 (three dac_pclk clock cycles later). The DAC channel2 triangle
Page 1036: In this configuration, one dac_pclk clock cycle later, the DHR1 and DHR2 registers are
Page 1037: DAC_DOR2, respectively (after three dac_pclk clock cycles).
Page 1037: register and the sum is transferred into DAC_DOR1 (three dac_pclk clock cycles later). The
Page 1037: clock cycles later). The LFSR2 counter is then updated.
Page 1037: clock cycles later). The LFSR1 counter is then updated.
Page 1037: the DHR2 register and the sum is transferred into DAC_DOR2 (three dac_pclk clock cycles
Page 1038: dac_pclk clock cycles later). The DAC channel1 triangle counter is then updated.
Page 1038: clock cycles later). The DAC channel2 triangle counter is then updated.
Page 1038: DAC_DOR1 (three APB clock cycles later). Then the DAC channel1 triangle counter is
Page 1038: (three dac_pclk clock cycles later). Then the DAC channel2 triangle counter is updated.
Page 1039: selected using lsi_ck clock
Page 1041: transferred one dac_pclk clock cycle later to the DAC_DOR2 register
Page 1041: three dac_pclk clock cycles later to the DAC_DOR2 register
Page 1041: DAC_DOR2 register takes only one dac_pclk clock cycle.
Page 1043: transferred one dac_pclk clock cycle later to the DAC_DOR1 register
Page 1043: three dac_pclk clock cycles later to the DAC_DOR1 register
Page 1043: DAC_DOR1 register takes only one dac_pclk clock cycle.
Page 1043: Note: This bit is cleared by hardware (one dac_pclk clock cycle later) once the DAC_DHR2
Page 1043: Note: This bit is cleared by hardware (one dac_pclk clock cycle later) once the DAC_DHR1
Page 1053: Note:          It represents the number of LSI clocks to perform a sample phase. Sampling time =
Page 1053: (TSAMPLE1[9:0] + 1) x LSI clock period.
Page 1053: Note:          It represents the number of LSI clocks to perform a sample phase. Sampling time =
Page 1053: (TSAMPLE1[9:0] + 1) x LSI clock period.
Page 1054: Hold time= (THOLD[9:0]) x LSI clock period
Page 1054: Hold time= (THOLD[9:0]) x LSI clock period
Page 1055: Refresh time= (TREFRESH[7:0]) x LSI clock period
Page 1055: Refresh time= (TREFRESH[7:0]) x LSI clock period
Page 1063: comp_pclk         Digital input    APB clock for both COMP channels
Page 1064: 27.3.3      COMP reset and clocks
Page 1064: The clock comp_pclk provided by the clock controller is synchronous with the APB clock.
Page 1064: independently from the APB clock. This allows the comparator to work even in Stop mode.
Page 1064: The interrupt line, connected to the NVIC of CPU, requires the APB clock (comp_pclk) to
Page 1064: work. In absence of the APB clock, the interrupt signal comp_it cannot be generated.
Page 1068: when the CPU is active to handle low latency interrupt. It requires APB clock running.
Page 1069: COMP_CFGR1                         (With APB clock)
Page 1069: COMP_CFGR2                         (With APB clock)
Page 1069: Note:         It is mandatory to enable APB clock to use this interrupt. If clock is not enabled, interrupt is
Page 1078: 28.3.1      OPAMP reset and clocks
Page 1078: The operational amplifier clock is necessary for accessing the registers. When the
Page 1078: application does not need to have read or write access to those registers, the clock can be
Page 1078: switched off using the peripheral clock enable register (see OPAMPEN bit in Section 7.7.43:
Page 1078: RCC APB1 Clock Register (RCC_APB1LENR)).
Page 1097: –    clock output for Σ∆ modulator(s)
Page 1097: •   Interrupts: end of conversion, overrun, analog watchdog, short-circuit, channel clock
Page 1099: Clock 0   order           ratio             ratio
Page 1099: CKOUT                   Clock       Mode                                                                  16
Page 1099: Clock      Mode                                                                 Clock 3
Page 1099: Clock in
Page 1099: control, clock control                            4) overrun                      Extremes
Page 1100: CKIN[7:0]             Clock input       Clock signal provided from external Σ∆ modulator. FT input.
Page 1100: Clock output to provide clock signal into external Σ∆
Page 1100: CKOUT                 Clock output
Page 1101: 29.4.3   DFSDM reset and clocks
Page 1101: stopping the system clock to enter in the STOP mode of the device.
Page 1102: DFSDM clocks
Page 1102: The internal DFSDM clock fDFSDMCLK, which is used to drive the channel transceivers,
Page 1102: block and is derived from the system clock SYSCLK or peripheral clock PCLK2 (see
Page 1102: DFSDMSEL bit description in ). The DFSDM clock is automatically stopped in stop mode (if
Page 1102: The DFSDM serial channel transceivers can receive an external serial clock to sample an
Page 1102: external serial data stream. The internal DFSDM clock must be at least 4 times faster than
Page 1102: the external serial clock if standard SPI coding is used, and 6 times faster than the external
Page 1102: serial clock if Manchester coding is used.
Page 1102: DFSDM can provide one external output clock signal to drive external Σ∆ modulator(s) clock
Page 1102: input(s). It is provided on CKOUT pin. This output clock signal must be in the range
Page 1102: specified in given device datasheet and is derived from DFSDM clock or from audio clock
Page 1102: range 2 - 256 (CKOUTDIV in DFSDM_CH0CFGR1 register). Audio clock source is SAI1
Page 1102: clock selected by SAI1SEL[1:0] field in RCC configuration (see ).
Page 1102: Serial inputs (data and clock signals) from DATINy and CKINy pins can be redirected from
Page 1102: stereo microphone type. PDM stereo microphone has one data and one clock signal. Data
Page 1102: signal provides information for both left and right audio channel (rising clock edge samples
Page 1102: for left channel and falling clock edge samples for right channel).
Page 1102: •   PDM microphone signals (data, clock) will be connected to DFSDM input serial channel
Page 1103: Output clock generation
Page 1103: A clock signal can be provided on CKOUT pin to drive external Σ∆ modulator clock inputs.
Page 1103: The frequency of this CKOUT signal is derived from DFSDM clock or from audio clock (see
Page 1103: bits in DFSDM_CH0CFGR1 register). If the output clock is stopped, then CKOUT signal is
Page 1103: set to low state (output clock can be stopped by CKOUTDIV=0 in DFSDM_CHyCFGR1
Page 1103: register or by DFSDMEN=0 in DFSDM_CH0CFGR1 register). The output clock stopping is
Page 1103: •       4 system clocks after DFSDMEN is cleared (if CKOUTSRC=0)
Page 1103: •       1 system clock and 3 audio clocks after DFSDMEN is cleared (if CKOUTSRC=1)
Page 1103: glitch on CKOUT pin. The output clock signal frequency must be in the range 0 - 20 MHz.
Page 1104: In SPI format, the data stream is sent in serial format through data and clock signals. Data
Page 1104: signal is always provided from DATINy pin. A clock signal can be provided externally from
Page 1104: In case of external clock source selection (SPICKSEL[1:0]=0) data signal (on DATINy pin) is
Page 1104: sampled on rising or falling clock edge (of CKINy pin) according SITP[1:0] bits setting (in
Page 1104: Internal clock sources - see SPICKSEL[1:0] in DFSDM_CHyCFGR1 register:
Page 1104: –    For connection to external Σ∆ modulator which uses directly its clock input (from
Page 1104: CKOUT) to generate its output serial communication clock.
Page 1104: –    For connection to external Σ∆ modulator which divides its clock input (from
Page 1104: CKOUT) by 2 to generate its output serial communication clock (and this output
Page 1104: clock change is active on each clock input rising edge).
Page 1104: –    For connection to external Σ∆ modulator which divides its clock input (from
Page 1104: CKOUT) by 2 to generate its output serial communication clock (and this output
Page 1104: clock change is active on each clock input falling edge).
Page 1104: Note:       An internal clock source can only be used when the external Σ∆ modulator uses CKOUT
Page 1104: signal as a clock input (to have synchronous clock and data operation).
Page 1104: Internal clock source usage can save CKINy pin connection (CKINy pins can be used for
Page 1104: The clock source signal frequency must be in the range 0 - 20 MHz for SPI coding and less
Page 1104: only. Decoded data and clock signal are recovered from serial stream after Manchester
Page 1104: The recovered clock signal frequency for Manchester coding must be in the range
Page 1104: ( ( CKOUTDIV + 1 ) × T SYSCLK ) < T Manchester clock < ( 2 × CKOUTDIV × T SYSCLK )
Page 1105: recovered clock
Page 1106: Clock absence detection
Page 1106: Channels serial clock inputs can be checked for clock absence/presence to ensure the
Page 1106: correct operation of conversion and error reporting. Clock absence detection can be
Page 1106: register. If enabled, then this clock absence detection is performed continuously on a given
Page 1106: channel. A clock absence flag is set (CKABF[y] = 1) and an interrupt can be invoked (if
Page 1106: CKABIE=1) in case of an input clock error (see CKABF[7:0] in DFSDM_FLT0ISR register
Page 1106: and CKABEN in DFSDM_CHyCFGR1). After a clock absence flag clearing (by CLRCKABF
Page 1106: in DFSDM_FLT0ICR register), the clock absence flag is refreshed. Clock absence status bit
Page 1106: When a clock absence event has occurred, the data conversion (and/or analog watchdog
Page 1106: discard given data while a clock absence is reported.
Page 1106: The clock absence feature is available only when the system clock is used for the CKOUT
Page 1106: When the transceiver is not yet synchronized, the clock absence flag is set and cannot be
Page 1106: concerning clock absence detection feature should be:
Page 1106: •    Try to clear the clock absence flag (by CLRCKABF = 1) until the clock absence flag is
Page 1106: really cleared (CKABF = 0). At this time, the transceiver is synchronized (signal clock is
Page 1106: •    Enable the clock absence feature CKABEN = 1 and the associated interrupt CKABIE =
Page 1106: 1 to detect if the SPI clock is lost or Manchester data edges are missing.
Page 1106: If SPI data format is used, then the clock absence detection is based on the comparison of
Page 1106: an external input clock with an output clock generation (CKOUT signal). The external input
Page 1106: clock signal into the input channel must be changed at least once per 8 signal periods of
Page 1106: Figure 226. Clock absence timing diagram for SPI
Page 1106: SPI clock presence
Page 1106: last clock change
Page 1106: If Manchester data format is used, then the clock absence means that the clock recovery is
Page 1106: unable to perform from Manchester coded signal. For a correct clock recovery, it is first
Page 1107: The detection of a clock absence in Manchester coding (after a first successful
Page 1107: output clock generation (CKOUT signal). There must be a voltage level change on DATINy
Page 1107: to correctly recover the Manchester coded data and clock signals.
Page 1107: ( ( CKOUTDIV + 1 ) × T SYSCLK ) < T Manchester clock < ( 2 × CKOUTDIV × T SYSCLK )
Page 1107: A clock absence flag is set (CKABF[y] = 1) and an interrupt can be invoked (if CKABIE=1) in
Page 1107: case of an input clock recovery error (see CKABF[7:0] in DFSDM_FLT0ISR register and
Page 1107: CKABEN in DFSDM_CHyCFGR1). After a clock absence flag clearing (by CLRCKABF in
Page 1107: DFSDM_FLT0ICR register), the clock absence flag is refreshed.
Page 1107: Figure 227. Clock absence timing diagram for Manchester coding
Page 1107: Manchester clock presence
Page 1107: recovered clock
Page 1108: ( ( CKOUTDIV + 1 ) × T SYSCLK ) < T Manchester clock < ( 2 × CKOUTDIV × T SYSCLK )
Page 1108: SPI coded stream is synchronized after first detection of clock input signal (valid
Page 1108: Note:       When the transceiver is not yet synchronized, the clock absence flag is set and cannot be
Page 1109: recovered clock
Page 1109: External serial clock frequency measurement
Page 1109: The measuring of a channel serial clock input frequency provides a real data rate from an
Page 1109: An external serial clock input frequency can be measured by a timer counting DFSDM
Page 1109: clocks (fDFSDMCLK) during one conversion duration. The counting starts at the first input data
Page 1109: clock after a conversion trigger (regular or injected) and finishes by last input data clock
Page 1110: •    fCKIN is the channel input clock frequency (on given channel CKINy pin) or input data
Page 1111: •    Output clock predivider. There is a programmable predivider to generate the output
Page 1111: clock from DFSDM clock (2 - 256). It is defined by CKOUTDIV[7:0] bits in
Page 1111: •    Serial interface type and input clock phase. Selection of SPI or Manchester coding
Page 1111: and sampling edge of input clock. It is defined by SITP [1:0] bits in
Page 1111: •    Input clock source. External source from CKINy pin or internal from CKOUT pin. It is
Page 1111: •    short-circuit detector and clock absence per channel enable. To enable or disable
Page 1111: the short-circuit detector (by SCDEN bit) and the clock absence monitoring (by
Page 1114: causes that the conversion will never end - because no input data is provided (with no clock
Page 1117: executed in 8 DFSDM clock cycles. So, the bandwidth from each channel is limited to 8
Page 1117: DFSDM clock cycles (if AWDCH[7:0] = 0xFF). Because the maximum input channel
Page 1117: sampling clock frequency is the DFSDM clock frequency divided by 4, the configuration
Page 1117: feature at this input clock speed. Therefore user must properly configure the number of
Page 1117: clock speed and DFSDM frequency.
Page 1118: given by the analog watchdog filter setting and the channel input clock frequency.
Page 1118: watchdog filter output (at channel input clock frequency fCKIN):
Page 1124: •   Channel clock absence interrupt:
Page 1124: –      occurred when there is clock absence on CKINy pin (see Clock absence detection
Page 1124: Channel clock absence         CKABF[7:0]     writing CLRCKABF[7:0] = 1
Page 1125: Bit 30 CKOUTSRC: Output serial clock source selection
Page 1125: 0: Source for output clock is from system clock
Page 1125: 1: Source for output clock is from audio clock
Page 1126: Bits 23:16 CKOUTDIV[7:0]: Output serial clock divider
Page 1126: 0: Output clock generation is disabled (CKOUT signal is set to low state)
Page 1126: 1- 255: Defines the division of system clock for the serial clock output for CKOUT signal in range 2 -
Page 1126: CKOUTDIV also defines the threshold for a clock absence detection.
Page 1126: performed one DFSDM clock cycle after DFSDMEN=0).
Page 1127: Bit 6 CKABEN: Clock absence detector enable on channel y
Page 1127: 0: Clock absence detector disabled on channel y
Page 1127: 1: Clock absence detector enabled on channel y
Page 1127: Bits 3:2 SPICKSEL[1:0]: SPI clock select for channel y
Page 1127: 0: clock coming from external CKINy input - sampling point according SITP[1:0]
Page 1127: 1: clock coming from internal CKOUT output - sampling point according SITP[1:0]
Page 1127: 2: clock coming from internal CKOUT - sampling point on each second CKOUT falling edge.
Page 1127: For connection to external Σ∆ modulator which divides its clock input (from CKOUT) by 2 to
Page 1127: generate its output serial communication clock (and this output clock change is active on each
Page 1127: clock input rising edge).
Page 1127: 3: clock coming from internal CKOUT output - sampling point on each second CKOUT rising edge.
Page 1127: For connection to external Σ∆ modulator which divides its clock input (from CKOUT) by 2 to
Page 1127: generate its output serial communication clock (and this output clock change is active on each
Page 1127: clock input falling edge).
Page 1131: where: fCKIN is the channel input clock frequency (on given channel CKINy pin) or input data rate in
Page 1132: Note: synchronous trigger has latency up to one fDFSDMCLK clock cycle (with deterministic jitter),
Page 1132: asynchronous trigger has latency 2-3 fDFSDMCLK clock cycles (with jitter up to 1 cycle).
Page 1133: Bit 6 CKABIE: Clock absence interrupt enable
Page 1133: 0: Detection of channel input clock absence interrupt is disabled
Page 1133: 1: Detection of channel input clock absence interrupt is enabled
Page 1135: Bits 23:16 CKABF[7:0]: Clock absence flag
Page 1135: CKABF[y]=0: Clock signal on channel y is present.
Page 1135: CKABF[y]=1: Clock signal on channel y is not present.
Page 1135: Given y bit is set by hardware when clock absence is detected on channel y. It is held at
Page 1136: Bits 23:16 CLRCKABF[7:0]: Clear the clock absence flag
Page 1136: DFSDM_FLTxISR register. When the transceiver is not yet synchronized, the clock absence flag is
Page 1144: The timer has an input clock from DFSDM clock (system clock fDFSDMCLK). Conversion time
Page 1144: where: fCKIN is the channel input clock frequency (on given channel CKINy pin) or input data rate in
Page 1154: 30.3        DCMI clocks
Page 1154: The digital camera interface uses two clock domains, DCMI_PIXCLK and HCLK. The
Page 1154: data flows. It consists of up to 14 data lines (D13-D0) and a pixel clock line (DCMI_PIXCLK).
Page 1154: The pixel clock has a programmable polarity, so that data can be captured on either the
Page 1154: rising or the falling edge of the pixel clock.
Page 1156: dcmi_hclk               Digital input      DCMI interface clock
Page 1156: DCMI_PIXCLK                     Digital input   Pixel clock
Page 1156: pixel clock depending on the polarity.
Page 1157: this case, to capture a 32-bit word, the camera interface takes four pixel clock cycles.
Page 1157: cleared to zero. So, in this case, a 32-bit data word is made up every two pixel clock cycles.
Page 1158: data word is made up every two pixel clock cycles.
Page 1158: data word is made up every two pixel clock cycles.
Page 1162: number of pixel clocks and vertical dimension in number of lines) are specified using two 32-
Page 1162: number of pixel clocks (horizontal dimension) and in number of lines (vertical dimension).
Page 1162: number (in the frame, starting from 0) and a number of pixel clocks (on the line, starting from
Page 1162: 0), and the size of the window as a line number and a number of pixel clocks. The CAPCNT
Page 1164: for green) takes two clock cycles to be transferred.
Page 1167: 00: Interface captures 8-bit data on every pixel clock
Page 1167: 01: Interface captures 10-bit data on every pixel clock
Page 1167: 10: Interface captures 12-bit data on every pixel clock
Page 1167: 11: Interface captures 14-bit data on every pixel clock
Page 1168: Bit 5 PCKPOL: Pixel clock polarity
Page 1168: This bit configures the capture edge of the pixel clock
Page 1177: This value gives the number of pixel clocks to count before starting a capture.
Page 1178: This value gives the number of pixel clocks to be captured from the starting
Page 1180: pixel clock and data enable as output to interface directly to a variety of LCD and TFT
Page 1181: Pixel clock domain
Page 1181: ltdc_aclk                       Digital input         Clock for LCD-TFT registers in AXI clock domain
Page 1181: ltdc_pclk                       Digital input         LCD-TFT register interface clock
Page 1181: LCD-TFT kernel clock used for LCD_CLK (pixel
Page 1181: clock) generation
Page 1182: LCD_CLK          O        Clock output
Page 1182: 31.3.4      LTDC reset and clocks
Page 1182: The LCD-TFT controller peripheral uses 3 clock domains:
Page 1182: •     AXI clock domain (ltdc_aclk)
Page 1182: •     APB clock domain (ltdc_pclk):
Page 1182: •     Pixel clock domain (LCD_CLK)
Page 1182: output (refer to the reset and clock control section).
Page 1182: Table 261 summarizes the clock domain for each register.
Page 1183: Table 261. Clock domain for each register
Page 1183: LTDC register                                     Clock domain
Page 1183: LTDC_CDSR                                         Pixel clock (LCD_CLK)
Page 1183: -                                           Register clock domain
Page 1183: -                  AXI domain                  APB domain                     Pixel clock domain
Page 1184: register. It resets the three clock domains.
Page 1184: horizontal and vertical synchronization timings panel signals, the pixel clock and the data
Page 1185: The horizontal and vertical synchronization, data enable and pixel clock output signals
Page 1192: •   Enable the LTDC clock in the RCC register.
Page 1192: •   Configure the required pixel clock following the panel datasheet.
Page 1192: •   Configure the synchronous signals and clock polarity in the LTDC_GCR register.
Page 1193: Bits 27:16 HSW[11:0]: horizontal synchronization width (in units of pixel clock period)
Page 1194: Bits 27:16 AHBP[11:0]: accumulated horizontal back porch (in units of pixel clock period)
Page 1194: Bits 27:16 AAW[11:0]: accumulated active width (in units of pixel clock period)
Page 1194: clock.
Page 1194: clock.
Page 1195: Bits 27:16 TOTALW[11:0]: total width (in units of pixel clock period)
Page 1196: Bit 28 PCPOL: pixel clock polarity
Page 1196: 0: pixel clock polarity is active low.
Page 1196: 1: pixel clock is active high.
Page 1215: •   Single-clock-per-pixel encode/decode
Page 1215: •   Single-clock Huffman coding and decoding
Page 1216: jpeg_hclk                      Digital input               JPEG kernel and register interface clock
Page 1230: •   It produces four 32-bit random samples every 16x ------------ AHB clock cycles, if value is
Page 1230: –    Includes too low sampling clock detection and repetition count tests.
Page 1231: AHB clock domain
Page 1231: Clock checker                                           Raw data shift reg
Page 1231: RNG clock domain
Page 1231: rng_hclk2                                  Digital input               AHB2 clock
Page 1231: rng_clk                           Digital input               RNG dedicated clock, asynchronous to rng_hclk2
Page 1232: •    A sampling stage of these outputs clocked by a dedicated clock input (rng_clk),
Page 1233: This noise source sampling is independent to the AHB interface clock frequency
Page 1233: Note:    In Section 33.7: Entropy source validation recommended RNG clock frequencies are given.
Page 1233: maximum when the RNG 128-bit FIFO is emptied by application after 64 RNG clock cycles.
Page 1233: The conditioning component is clocked by the faster AHB clock.
Page 1233: added to the conditioning output register 213 AHB clock cycles later.
Page 1234: –    Real-time “too slow” sampling clock detector, flagging an error when one RNG
Page 1234: clock cycle is smaller than AHB clock cycle divided by 32.
Page 1236: 33.3.6      RNG clocking
Page 1236: The RNG runs on two different clocks: the AHB bus clock and a dedicated RNG clock.
Page 1236: The AHB clock is used to clock the AHB banked registers and conditioning component. The
Page 1236: RNG clock is used for noise source sampling. Recommended clock configurations are
Page 1236: Caution:    When the CED bit in the RNG_CR register is set to “0”, the RNG clock frequency must be
Page 1236: higher than AHB clock frequency divided by 32, otherwise the clock checker will flag a clock
Page 1236: See Section 33.3.1: RNG block diagram for details (AHB and RNG clock domains).
Page 1236: source behavior and the frequency of the RNG source clock as detailed in this section.
Page 1236: Clock error detection
Page 1236: When the clock error detection is enabled (CED = 0) and if the RNG clock frequency is too
Page 1236: bits to indicate that a clock error occurred. In this case, the application should check that the
Page 1236: RNG clock is configured correctly (see Section 33.3.6: RNG clocking) and then it must clear
Page 1237: the CEIS bit interrupt flag. As soon as the RNG clock operates correctly, the CECS bit will
Page 1237: The RNG operates only when the CECS flag is set to “0”. However note that the clock error
Page 1237: corresponds to 16 RNG clock cycles to sample new bits, and 216 AHB clock cycles to
Page 1237: all the logic clocked by the RNG clock. Note that this strategy is adding latency before a
Page 1238: •    Clock error, see Section 33.3.7: Error management
Page 1238: Clock error flag                                      CEIS                        IE
Page 1238: The conditioning stage can produce four 32-bit random numbers every 16x ------------  clock
Page 1238: •    128 RNG clock cycles + 426 AHB cycles, if fAHB < fthreshold
Page 1238: •    192 RNG clock cycles + 213 AHB cycles, if fAHB ≥ fthreshold
Page 1239: •    RNG clock rng_clk= 48 MHz (CED bit = ’0’ in RNG_CR register) and rng_clk = 400 kHz
Page 1239: •    AHB clock rng_hclk= 216 MHz
Page 1240: Bit 5 CED: Clock error detection
Page 1240: 0: Clock error detection is enable
Page 1240: 1: Clock error detection is disable
Page 1240: The clock error detection cannot be enabled nor disabled on-the-fly when the RNG is
Page 1240: logic clocked by the RNG clock is gated.
Page 1241: Bit 5 CEIS: Clock error interrupt status
Page 1241: 0: The RNG clock is correct (fRNGCLK> fHCLK/32)
Page 1241: Bit 1 CECS: Clock error current status
Page 1241: 0: The RNG clock is correct (fRNGCLK> fHCLK/32). If the CEIS bit is set, this means that a
Page 1241: slow clock was detected and the situation has been recovered.
Page 1241: 1: The RNG clock is too slow (fRNGCLK< fHCLK/32).
Page 1242: After being read this register delivers a new random value after 216 periods of AHB clock if
Page 1244: –    14 (respectively 18) clock cycles for processing one 128-bit block of data with a
Page 1245: –   16 (respectively 64) clock cycles for processing one 64-bit block of data in DES
Page 1247: cryp_hclk         digital input   AHB bus clock
Page 1258: Note:       The latency of the key preparation operation is 14, 16 or 18 clock cycles depending on the
Page 1297: Table 284. Processing time (in clock cycle) for ECB, CBC and CTR per 128-bit block
Page 1297: Table 285. Processing time (in clock cycle) for GCM and CCM per 128-bit block
Page 1314: –    82 (respectively 66) clock cycles for processing one 512-bit block of data using
Page 1314: –    66 clock cycles for processing one 512-bit block of data using MD5 algorithm
Page 1315: hash_hclk2                              digital input          AHB2 bus clock
Page 1326: Table 290. Processing time (in clock cycle)
Page 1343: System fault gathering MCU internal fault events (Clock security system,
Page 1344: hrtim_bm_ck[4:1]      Digital input Burst mode clock (on-chip interconnect)
Page 1344: hrtim_pclk         Digital input APB clock
Page 1344: hrtim_ker_ck        Digital input HRTIM kernel clock (hereafter mentioned as fHRTIM).
Page 1344: 36.3.3       Clocks
Page 1344: The HRTIM must be supplied by the tHRTIM system clock to offer a full resolution. All clocks
Page 1344: present in the HRTIM are derived from this reference clock.
Page 1344: fHRTIM: main HRTIM clock (hrtim_ker_ck). All subsequent clocks are derived and
Page 1344: fDTG: deadtime generator clock. For convenience, only the tDTG period (tDTG = 1/fDTG)
Page 1344: fCHPFRQ: chopper stage clock source.
Page 1344: f1STPW: clock source defining the length of the initial pulse in chopper mode. For
Page 1344: fBRST: burst mode controller counter clock.
Page 1344: fSAMPLING: clock needed to sample the fault or the external events inputs.
Page 1344: fFLTS: clock derived from fHRTIM which is used as a source for fSAMPLING to filter fault
Page 1344: fEEVS: clock derived from fHRTIM which is used as a source for fSAMPLING to filter
Page 1344: fpclk (hrtim_pclk): APB bus clock, needed for register read/write accesses
Page 1345: Timer clock and prescaler
Page 1345: Each timer in the HRTIM has its own individual clock prescaler, which allows you to adjust
Page 1345: Deadtime generator clock
Page 1346: Chopper stage clock
Page 1346: The chopper stage clock source fCHPFRQ is derived from fHRTIM with a division factor
Page 1346: It uses fHRTIM / 16 as clock source (25 MHz for fHRTIM= 400 MHz).
Page 1346: The burst mode controller counter clock fBRST can be supplied by several sources, among
Page 1346: Fault input sampling clock
Page 1346: External Event input sampling clock
Page 1347: •       The minimum value must be greater than or equal to 3 periods of the fHRTIM clock
Page 1347: clock
Page 1348: Clocking and event generation
Page 1349: –      To serve as a burst mode clock source or a burst start trigger
Page 1350: within the same fHRTIM clock cycle, the last counter reset is taken into account.
Page 1350: When the fHRTIM clock prescaling ratio is above 1, the counter reset event is delayed to the
Page 1350: next active edge of the prescaled clock. This allows to maintain a jitterless waveform
Page 1350: Figure 284 shows how the reset is handled for a clock prescaling ratio of 4 (fHRTIM divided
Page 1350: clock
Page 1353: Clock
Page 1354: The period must be greater than or equal to 6 periods of the fHRTIM clock when the HALF
Page 1355: and HRTIM_CMP4xR Compares cannot be programmed with a value below 3 fHRTIM clock
Page 1357: delay: practically, there is a delay of 1 to 2 fHRTIM clock periods between the falling edge and
Page 1361: specific clock prescaled according to DTPRSC[2:0] bits, as follows:
Page 1365: requests occur within the same fHRTIM clock period.
Page 1365: If multiple requests from the master timer occur within the same fHRTIM clock period, a
Page 1365: When multiple requests internal to the timer occur within the same fHRTIM clock period, a
Page 1366: A set or reset event occurring within the prescaler clock cycle is delayed to the next active
Page 1366: edge of the prescaled clock (as for a counter reset), even if the arbitration is still performed
Page 1366: If a reset event is followed by a set event within the same prescaler clock cycle, the latest
Page 1368: external events being filtered, depending on the sampling clock and on the filter length
Page 1368: The sampling clock is either the fHRTIM clock or a specific prescaled clock fEEVS derived
Page 1368: •     A regular operating mode, in which the external event is resampled with the clock
Page 1369: clock                     clock          high-resolution
Page 1369: (depends whether the                              1 cycle of fHRTIM clock jitter pulse width
Page 1369: When EExFAST bit is set, the output cannot be changed during the 11 fHRTIM clock periods
Page 1370: fHRTIM clock
Page 1370: fHRTIM clock
Page 1381: The minimum pulsewidth that can be handled in balanced idle mode is 4 fHRTIM clock
Page 1381: is extended up to 4 fHRTIM clock periods before being copied into the secondary output. In
Page 1382: •    TxBM bit must be reset (counter clock maintained during the burst, see
Page 1384: Note:       The update events are synchronized to the prescaler clock when CKPSC[2:0] > 5.
Page 1391: crossbar output. If the timer clock is stopped, the level will either be inactive (after an HRTIM
Page 1392: clock
Page 1392: •     A counter that can be clocked by various sources, either within or outside the HRTIM
Page 1393: When MTBM or TxBM bit is reset, the counter clock is maintained. This allows to keep a
Page 1393: Burst mode clock
Page 1393: The burst mode controller counter can be clocked by several sources, selected with
Page 1393: •    BMCLK[3:0] = 0110 to 1001: The clocking is provided by the general purpose timers,
Page 1393: •    BMCLK[3:0] = 1010: The fHRTIM clock prescaled by a factor defined with BMPRSC[3:0]
Page 1394: Table 310. Burst mode clock sources from general purpose timer
Page 1394: BMCLK[3:0]                                  Clock source
Page 1394: The pulsewidth on TIMxx OC output must be at least N fHRTIM clock cycles long to be
Page 1396: When durations defined by DTRx[8:0] and DTFx[8:0] are lower than 3 fHRTIM clock cycle
Page 1402: fFLTS clock source
Page 1402: clock. For all other FLTxF[3:0] bitfield values, the signal is digitally filtered. The digital filter is
Page 1403: depending on the sampling clock and on the filter length (number of valid samples
Page 1403: The filtering period ranges from 2 cycles of the fHRTIM clock up to 8 cycles of the fFLTS clock
Page 1403: Table 312 summarizes the sampling rate and the filter length. A jitter of 1 sampling clock
Page 1403: Table 312. Sampling rate and filter length vs FLTFxF[3:0] and clock setting
Page 1404: Table 312. Sampling rate and filter length vs FLTFxF[3:0] and clock setting (continued)
Page 1404: •      the Clock Security System
Page 1407: 16 fHRTIM clock cycles length for the synchronization). If SYNCOUT[0] = 1, the idle level is
Page 1407: Note:     The synchronization pulse is followed by an idle level of 16 fHRTIM clock cycles during which
Page 1411: An output pulse of 1 fHRTIM clock periods is generated on the hrtim_dac_trgx output.
Page 1418: The HRTIM clock source must be enabled in the Reset and Clock control unit (RCC).
Page 1419: If the HRTIM peripheral is reset with the Reset and Clock Controller, the HRTIM outputs are
Page 1426: Note: This bit must not be changed within a minimum of 8 cycles of fHRTIM clock.
Page 1427: Note: This bit must not be changed within a minimum of 8 cycles of fHRTIM clock.
Page 1427: Note: This bit must not be changed within a minimum of 8 cycles of fHRTIM clock.
Page 1427: Note: This bit must not be changed within a minimum of 8 cycles of fHRTIM clock.
Page 1427: Note: This bit must not be changed within a minimum of 8 cycles of fHRTIM clock.
Page 1427: Note: This bit must not be changed within a minimum of 8 cycles of fHRTIM clock.
Page 1427: 10: Positive pulse on HRTIM_SCOUT output (16x fHRTIM clock cycles)
Page 1427: 11: Negative pulse on HRTIM_SCOUT output (16x fHRTIM clock cycles)
Page 1428: Bits 2:0 CKPSC[2:0]: Clock prescaler
Page 1428: These bits define the master timer clock prescaler ratio.
Page 1428: The counter clock equivalent frequency (fCOUNTER) is equal to fHRCK / 2(CKPSC[2:0]-5).
Page 1433: The period value must be above or equal to 3 periods of the fHRTIM clock.
Page 1434: The compare value must be above or equal to 3 periods of the fHRTIM clock.
Page 1435: The compare value must be above or equal to 3 periods of the fHRTIM clock.
Page 1435: The compare value must be above or equal to 3 periods of the fHRTIM clock.
Page 1436: The compare value must be above or equal to 3 periods of the fHRTIM clock.
Page 1440: Bits 2:0 CKPSCx[2:0]: HRTIM Timer x Clock prescaler
Page 1440: These bits define the master timer clock prescaler ratio.
Page 1440: The counter clock equivalent frequency (fCOUNTER) is equal to fHRCK / 2(CKPSC[2:0]-5).
Page 1447: The period value must be above or equal to 3 periods of the fHRTIM clock.
Page 1448: The compare value must be above or equal to 3 periods of the fHRTIM clock.
Page 1449: The compare value must be above or equal to 3 periods of the fHRTIM clock.
Page 1450: The compare value must be above or equal to 3 periods of the fHRTIM clock.
Page 1450: The compare value must be above or equal to 3 periods of the fHRTIM clock.
Page 1453: This register holds the value of the deadtime clock prescaler.
Page 1483: 0: Timer A counter clock is maintained and the timer operates normally
Page 1483: 1: Timer A counter clock is stopped and the counter is reset
Page 1483: 0: Master Timer counter clock is maintained and the timer operates normally
Page 1483: 1: Master Timer counter clock is stopped and the counter is reset
Page 1484: Defines the prescaling ratio of the fHRTIM clock for the burst mode controller. This bitfield cannot be
Page 1484: 0000: Clock not divided
Page 1484: Bits 5:2 BMCLK[3:0]: Burst Mode Clock source
Page 1484: This bitfield defines the clock source for the burst mode counter. It cannot be changed while the
Page 1484: 0110: On-chip Event 1 (hrtim_bm_ck1), acting as a burst mode counter clock
Page 1484: 0111: On-chip Event 2 (hrtim_bm_ck2) acting as a burst mode counter clock
Page 1484: 1000: On-chip Event 3 (hrtim_bm_ck3) acting as a burst mode counter clock
Page 1484: 1001: On-chip Event 4 (hrtim_bm_ck4) acting as a burst mode counter clock
Page 1484: 1010: Prescaled fHRTIM clock (as per BMPRSC[3:0] setting)
Page 1487: Note: BMCMP[15:0] cannot be set to 0x0000 when using the fHRTIM clock without a prescaler as the
Page 1487: burst mode clock source (BMCLK[3:0] = 1010 and BMPRESC[3:0] = 0000).
Page 1489: fHRTIM clock-related latency
Page 1491: Bits 31:30 EEVSD[1:0]: External Event Sampling clock division
Page 1491: This bitfield indicates the division ratio between the timer clock frequency (fHRTIM) and the
Page 1491: External Event signal sampling clock (fEEVS) used by the digital filters.
Page 1500: Bits 25:24 FLTSD[1:0]: Fault Sampling clock division
Page 1500: This bitfield indicates the division ratio between the timer clock frequency (fHRTIM) and the
Page 1500: fault signal sampling clock (fFLTS) used by the digital filters.
Page 1514: milliseconds using the timer prescaler and the RCC clock controller prescalers.
Page 1514: •   16-bit programmable prescaler allowing dividing (also “on the fly”) the counter clock
Page 1514: •   Trigger input for external clock or cycle-by-cycle current management
Page 1515: Internal clock (CK_INT)
Page 1516: counter clock can be divided by a prescaler.
Page 1516: The counter is clocked by the prescaler output CK_CNT, which is enabled only when the
Page 1516: Note that the counter starts counting 1 clock cycle after setting the CEN bit in the TIMx_CR1
Page 1516: The prescaler can divide the counter clock frequency by any factor between 1 and 65536. It
Page 1517: Timerclock = CK_CNT
Page 1517: Timerclock = CK_CNT
Page 1518: The following figures show some examples of the counter behavior for different clock
Page 1519: Figure 346. Counter timing diagram, internal clock divided by 1
Page 1519: Timerclock = CK_CNT
Page 1519: Figure 347. Counter timing diagram, internal clock divided by 2
Page 1519: Timerclock = CK_CNT
Page 1520: Figure 348. Counter timing diagram, internal clock divided by 4
Page 1520: Timerclock = CK_CNT
Page 1520: Figure 349. Counter timing diagram, internal clock divided by N
Page 1520: Timerclock = CK_CNT
Page 1521: Timerclock = CK_CNT
Page 1521: Timerclock = CK_CNT
Page 1522: The following figures show some examples of the counter behavior for different clock
Page 1523: Figure 352. Counter timing diagram, internal clock divided by 1
Page 1523: Timerclock = CK_CNT
Page 1523: Figure 353. Counter timing diagram, internal clock divided by 2
Page 1523: Timerclock = CK_CNT
Page 1524: Figure 354. Counter timing diagram, internal clock divided by 4
Page 1524: Timerclock = CK_CNT
Page 1524: Figure 355. Counter timing diagram, internal clock divided by N
Page 1524: Timerclock = CK_CNT
Page 1525: Timerclock = CK_CNT
Page 1526: The following figures show some examples of the counter behavior for different clock
Page 1526: Figure 357. Counter timing diagram, internal clock divided by 1, TIMx_ARR = 0x6
Page 1526: Timerclock = CK_CNT
Page 1527: Figure 358. Counter timing diagram, internal clock divided by 2
Page 1527: Timerclock = CK_CNT
Page 1527: Figure 359. Counter timing diagram, internal clock divided by 4, TIMx_ARR=0x36
Page 1527: Timerclock = CK_CNT
Page 1528: Figure 360. Counter timing diagram, internal clock divided by N
Page 1528: Timerclock = CK_CNT
Page 1528: Timerclock = CK_CNT
Page 1529: Timer clock = CK_CNT
Page 1531: •       external clock (external clock mode 2, see Section 37.3.5)
Page 1532: 37.3.5      Clock selection
Page 1532: The counter clock can be provided by the following clock sources:
Page 1532: •     Internal clock (CK_INT)
Page 1532: •     External clock mode1: external input pin
Page 1532: •     External clock mode2: external trigger input ETR
Page 1532: Internal clock source (CK_INT)
Page 1532: is written to 1, the prescaler is clocked by the internal clock CK_INT.
Page 1532: Figure 366. Control circuit in normal mode, internal clock divided by 1
Page 1532: Internal clock
Page 1532: Counter clock = CK_CNT = CK_PSC
Page 1532: External clock source mode 1
Page 1533: Figure 367. TI2 external clock connection example
Page 1533: TIMx_CH2                                                             TI1_ED               TRGI         External clock
Page 1533: TI2                 Edge                     0   TI2FP2 00110         ETRF         External clock
Page 1533: (1)          CK_INT        Internal clock
Page 1533: ICF[3:0]                           CC2P                     (internal clock) mode
Page 1533: 5.         Configure the timer in external clock mode 1 by writing SMS=111 in the TIMx_SMCR
Page 1533: The delay between the rising edge on TI2 and the actual clock of the counter is due to the
Page 1534: Figure 368. Control circuit in external clock mode 1
Page 1534: Counter clock = CK_CNT = CK_PSC
Page 1534: External clock source mode 2
Page 1534: External clock
Page 1534: Divider      ETRP                      ETRF          External clock
Page 1534: CK_INT         Internal clock
Page 1534: (internal clock)
Page 1535: 4.   Enable external clock mode 2 by writing ECE=1 in the TIMx_SMCR register.
Page 1535: The delay between the rising edge on ETR and the actual clock of the counter is due to the
Page 1535: Figure 370. Control circuit in external clock mode 2
Page 1535: Counter clock =
Page 1539: imagine that, when toggling, the input signal is not stable during at must 5 internal clock
Page 1539: cycles. We must program a filter duration longer than these 5 clock cycles. We can
Page 1541: 1.   Select the counter clock (internal, external, prescaler).
Page 1550: (clock failure, parity error,...) and application fault (from input pins and built-in comparator),
Page 1551: written, a delay of 1 APB clock cycle is applied before the writing is effective. Consequently,
Page 1551: it is necessary to wait 1 APB clock period to correctly read back the bit after the write
Page 1551: - a clock failure event generated by the CSS detector
Page 1552: Note:               An asynchronous (clockless) operation is only guaranteed when the programmable filter is
Page 1552: disabled. If it is enabled, a fail safe clock mode (for example by using the internal PLL and/or
Page 1553: asynchronously so that it works even if no clock is provided to the timer.
Page 1553: –    If the timer clock is still present, then the dead-time generator is reactivated in
Page 1553: dead-time duration is slightly longer than usual (around 2 ck_tim clock cycles).
Page 1557: 2.   The external clock mode 2 must be disabled: bit ECE of the TIMx_SMCR register set to
Page 1560: clock frequency and the counter prescaler).
Page 1560: output toggle. But several clock cycles are needed for these operations and it limits the
Page 1561: Table 321. The counter is clocked by each valid transition on TI1FP1 or TI2FP2 (TI1 and TI2
Page 1561: Encoder interface mode acts simply as an external clock with direction selection. This
Page 1561: clock mode 2 are not compatible and must not be selected together.
Page 1567: The counter starts counting on the internal clock, then behaves normally until TI1 rising
Page 1567: Counter clock = ck_cnt = ck_psc
Page 1568: The counter starts counting on the internal clock as long as TI1 is low and stops as soon as
Page 1568: Counter clock = ck_cnt = ck_psc
Page 1569: When a rising edge occurs on TI2, the counter starts counting on the internal clock and the
Page 1569: Counter clock = ck_cnt = ck_psc
Page 1569: Slave mode: external clock mode 2 + trigger mode
Page 1569: The external clock mode 2 can be used in addition to another slave mode (except external
Page 1569: clock mode 1 and encoder mode). In this case, the ETR signal is used as external clock
Page 1570: –   ETP=0: detection of rising edges on ETR and ECE=1 to enable the external clock
Page 1570: Figure 402. Control circuit in external clock mode 2 + trigger mode
Page 1570: Counter clock = CK_CNT = CK_PSC
Page 1570: Note:       The clock of the slave peripherals (timer, ADC, ...) receiving the TRGO or the TRGO2
Page 1570: signals must be enabled prior to receive events from the master timer, and the clock
Page 1571: Note:     The clock of the slave peripherals (timer, ADC, ...) receiving the TRGO or the TRGO2
Page 1571: signals must be enabled prior to receive events from the master timer, and the clock
Page 1571: Note:     The clock of the ADC must be enabled prior to receive events from the master timer, and
Page 1573: Bits 9:8 CKD[1:0]: Clock division
Page 1573: This bit-field indicates the division ratio between the timer clock (CK_INT) frequency and the
Page 1573: dead-time and sampling clock (tDTS)used by the dead-time generators and the digital filters
Page 1574: Note: External clock, gated mode and encoder mode can work only if the CEN bit has been
Page 1575: Note: The clock of the slave timer or ADC must be enabled prior to receive events from the
Page 1576: Note: The clock of the slave timer or ADC must be enabled prior to receive events from the
Page 1577: Bit 14 ECE: External clock enable
Page 1577: This bit enables External clock mode 2.
Page 1577: 0: External clock mode 2 disabled
Page 1577: 1: External clock mode 2 enabled. The counter is clocked by any active edge on the ETRF
Page 1577: Note: 1: Setting the ECE bit has the same effect as selecting external clock mode 1 with
Page 1577: 2: It is possible to simultaneously use external clock mode 2 with the following slave
Page 1577: 3: If external clock mode 1 and external clock mode 2 are enabled at the same time,
Page 1577: the external clock input is ETRF.
Page 1578: clocks.
Page 1579: 0000: Slave mode disabled - if CEN = ‘1’ then the prescaler is clocked directly by the internal
Page 1579: clock.
Page 1579: 0101: Gated Mode - The counter clock is enabled when the trigger input (TRGI) is high. The
Page 1579: 0111: External Clock Mode 1 - Rising edges of the selected trigger (TRGI) clock the counter.
Page 1579: Note: The clock of the slave peripherals (timer, ADC, ...) receiving the TRGO or the TRGO2
Page 1579: signals must be enabled prior to receive events from the master timer, and the clock
Page 1587: 5 clock cycles.
Page 1587: the trigger input and to activate CC1 output is reduced to 3 clock cycles. OCFE acts only if
Page 1592: operations in reset, external clock or trigger mode), TIxFP1 is not inverted (trigger operation
Page 1592: operations in reset, external clock or trigger mode), TIxFP1 is inverted (trigger operation in
Page 1592: (capture or trigger operations in reset, external clock or trigger mode), TIxFP1 is not inverted
Page 1593: 1                                          Then (this is valid only if BRK is triggered), if the clock is
Page 1594: The counter clock frequency (CK_CNT) is equal to fCK_PSC / (PSC[15:0] + 1).
Page 1597: Note: Any write operation to this bit takes a delay of 1 APB clock cycle to become effective.
Page 1598: Note: Any write operation to this bit takes a delay of 1 APB clock cycle to become effective.
Page 1599: Note: Any write operation to this bit takes a delay of 1 APB clock cycle to become effective.
Page 1599: Note: Any write operation to this bit takes a delay of 1 APB clock cycle to become effective.
Page 1619: milliseconds using the timer prescaler and the RCC clock controller prescalers.
Page 1619: •   16-bit programmable prescaler used to divide (also “on the fly”) the counter clock
Page 1619: •   Trigger input for external clock or cycle-by-cycle current management
Page 1620: Internal clock (CK_INT)
Page 1621: up and down. The counter clock can be divided by a prescaler.
Page 1621: The counter is clocked by the prescaler output CK_CNT, which is enabled only when the
Page 1621: Note that the actual counter enable signal CNT_EN is set 1 clock cycle after CEN.
Page 1621: The prescaler can divide the counter clock frequency by any factor between 1 and 65536. It
Page 1622: Timerclock = CK_CNT
Page 1622: Timerclock = CK_CNT
Page 1623: The following figures show some examples of the counter behavior for different clock
Page 1623: Figure 406. Counter timing diagram, internal clock divided by 1
Page 1623: Timerclock = CK_CNT
Page 1624: Figure 407. Counter timing diagram, internal clock divided by 2
Page 1624: Timerclock = CK_CNT
Page 1624: Figure 408. Counter timing diagram, internal clock divided by 4
Page 1624: Timerclock = CK_CNT
Page 1625: Figure 409. Counter timing diagram, internal clock divided by N
Page 1625: Timerclock = CK_CNT
Page 1625: Timerclock = CK_CNT
Page 1626: Timerclock = CK_CNT
Page 1627: The following figures show some examples of the counter behavior for different clock
Page 1627: Figure 412. Counter timing diagram, internal clock divided by 1
Page 1627: Timerclock = CK_CNT
Page 1627: Figure 413. Counter timing diagram, internal clock divided by 2
Page 1627: Timerclock = CK_CNT
Page 1628: Figure 414. Counter timing diagram, internal clock divided by 4
Page 1628: Timerclock = CK_CNT
Page 1628: Figure 415. Counter timing diagram, internal clock divided by N
Page 1628: Timerclock = CK_CNT
Page 1629: Timerclock = CK_CNT
Page 1630: The following figures show some examples of the counter behavior for different clock
Page 1630: Figure 417. Counter timing diagram, internal clock divided by 1, TIMx_ARR=0x6
Page 1630: Timerclock = CK_CNT
Page 1631: Figure 418. Counter timing diagram, internal clock divided by 2
Page 1631: Timerclock = CK_CNT
Page 1631: Figure 419. Counter timing diagram, internal clock divided by 4, TIMx_ARR=0x36
Page 1631: Timerclock = CK_CNT
Page 1632: Figure 420. Counter timing diagram, internal clock divided by N
Page 1632: Timerclock = CK_CNT
Page 1632: Timerclock = CK_CNT
Page 1633: Timer clock = CK_CNT
Page 1633: 38.3.3   Clock selection
Page 1633: The counter clock can be provided by the following clock sources:
Page 1633: •      Internal clock (CK_INT)
Page 1633: •      External clock mode1: external input pin (TIx)
Page 1633: •      External clock mode2: external trigger input (ETR)
Page 1633: Internal clock source (CK_INT)
Page 1633: automatically). As soon as the CEN bit is written to 1, the prescaler is clocked by the internal
Page 1633: clock CK_INT.
Page 1634: Figure 423. Control circuit in normal mode, internal clock divided by 1
Page 1634: Internal clock
Page 1634: Counter clock = CK_CNT = CK_PSC
Page 1634: External clock source mode 1
Page 1634: Figure 424. TI2 external clock connection example
Page 1634: TIMx_CH2                                                            TI1_ED                   TRGI         External clock
Page 1634: TI2                  Edge                     0     TI2FP2 00110             ETRF         External clock
Page 1634: (1)          CK_INT        Internal clock
Page 1634: ICF[3:0]                            CC2P                           (internal clock) mode
Page 1635: 5.   Configure the timer in external clock mode 1 by writing SMS=111 in the TIMx_SMCR
Page 1635: The delay between the rising edge on TI2 and the actual clock of the counter is due to the
Page 1635: Figure 425. Control circuit in external clock mode 1
Page 1635: Counter clock = CK_CNT = CK_PSC
Page 1635: External clock source mode 2
Page 1636: TRGI         External clock
Page 1636: ETR1..15 inputs from                                                                 Filter            ETRF         External clock
Page 1636: CK_INT         Internal clock
Page 1636: (internal clock)
Page 1636: 5.      Enable external clock mode 2 by writing ECE=1 in the TIMx_SMCR register.
Page 1636: The delay between the rising edge on ETR and the actual clock of the counter is due to the
Page 1636: Figure 427. Control circuit in external clock mode 2
Page 1636: Counter clock =
Page 1639: imagine that, when toggling, the input signal is not stable during at must 5 internal clock
Page 1639: cycles. We must program a filter duration longer than these 5 clock cycles. We can
Page 1641: 1.   Select the counter clock (internal, external, prescaler).
Page 1648: 2.   The external clock mode 2 must be disabled: bit ECE in the TIM1_SMCR register is
Page 1650: clock frequency and the counter prescaler).
Page 1650: output toggle. But several clock cycles are needed for these operations and it limits the
Page 1651: Table 326. The counter is clocked by each valid transition on TI1FP1 or TI2FP2 (TI1 and TI2
Page 1651: Encoder interface mode acts simply as an external clock with direction selection. This
Page 1653: generated by a Real-Time clock.
Page 1654: The counter starts counting on the internal clock, then behaves normally until TI1 rising
Page 1654: Counter clock = ck_cnt = ck_psc
Page 1655: The counter starts counting on the internal clock as long as TI1 is low and stops as soon as
Page 1655: Counter clock = ck_cnt = ck_psc
Page 1656: When a rising edge occurs on TI2, the counter starts counting on the internal clock and the
Page 1656: Counter clock = ck_cnt = ck_psc
Page 1656: Slave mode: External Clock mode 2 + trigger mode
Page 1656: The external clock mode 2 can be used in addition to another slave mode (except external
Page 1656: clock mode 1 and encoder mode). In this case, the ETR signal is used as external clock
Page 1656: –    ETP=0: detection of rising edges on ETR and ECE=1 to enable the external clock
Page 1657: Figure 445. Control circuit in external clock mode 2 + trigger mode
Page 1657: Counter clock = CK_CNT = CK_PSC
Page 1657: one Timer is configured in Master Mode, it can reset, start, stop or clock the counter of
Page 1657: Clock
Page 1658: 3.   Then you put the slave mode controller in external clock mode 1 (write SMS=111 in the
Page 1658: TIM2_SMCR register). This causes TIM2 to be clocked by the rising edge of the
Page 1658: Note:       If OCx is selected on TIM3 as the trigger output (MMS=1xx), its rising edge is used to clock
Page 1658: to Figure 446 for connections. TIM2 counts on the divided internal clock only when OC1REF
Page 1658: of TIM3 is high. Both counter clock frequencies are divided by 3 by the prescaler compared
Page 1658: Note:       The counter 2 clock is not synchronized with counter 1, this mode only affects the TIM2
Page 1659: non-zero) on the divided internal clock as soon as the update event is generated by Timer 1.
Page 1659: counts until we write ‘0 to the CEN bit in the TIM2_CR1 register. Both counter clock
Page 1661: the internal clock and both TIF flags are set.
Page 1661: Note:     The clock of the slave peripherals (timer, ADC, ...) receiving the TRGO or the TRGO2
Page 1661: signals must be enabled prior to receive events from the master timer, and the clock
Page 1664: Bits 9:8 CKD[1:0]: Clock division
Page 1664: This bit-field indicates the division ratio between the timer clock (CK_INT) frequency and
Page 1664: sampling clock used by the digital filters (ETR, TIx),
Page 1665: Note: External clock, gated mode and encoder mode can work only if the CEN bit has been
Page 1666: Note: The clock of the slave timer or ADC must be enabled prior to receive events from the
Page 1667: Bit 14 ECE: External clock enable
Page 1667: This bit enables External clock mode 2.
Page 1667: 0: External clock mode 2 disabled
Page 1667: 1: External clock mode 2 enabled. The counter is clocked by any active edge on the ETRF
Page 1667: 1: Setting the ECE bit has the same effect as selecting external clock mode 1 with TRGI
Page 1667: 2: It is possible to simultaneously use external clock mode 2 with the following slave modes:
Page 1667: 3: If external clock mode 1 and external clock mode 2 are enabled at the same time, the
Page 1667: external clock input is ETRF.
Page 1667: clocks.
Page 1669: 0000: Slave mode disabled - if CEN = ‘1 then the prescaler is clocked directly by the internal
Page 1669: clock.
Page 1669: 0101: Gated Mode - The counter clock is enabled when the trigger input (TRGI) is high. The
Page 1669: 0111: External Clock Mode 1 - Rising edges of the selected trigger (TRGI) clock the counter.
Page 1669: Note: The clock of the slave peripherals (timer, ADC, ...) receiving the TRGO or the TRGO2
Page 1669: signals must be enabled prior to receive events from the master timer, and the clock
Page 1676: 5 clock cycles.
Page 1676: the trigger input and to activate CC1 output is reduced to 3 clock cycles. OCFE acts only if
Page 1680: Circuit is sensitive to TIxFP1 rising edge (capture, trigger in reset, external clock or trigger
Page 1680: Circuit is sensitive to TIxFP1 falling edge (capture, trigger in reset, external clock or trigger
Page 1680: clock or trigger mode), TIxFP1 is not inverted (trigger in gated mode). This configuration
Page 1681: The counter clock frequency CK_CNT is equal to fCK_PSC / (PSC[15:0] + 1).
Page 1694: milliseconds using the timer prescaler and the RCC clock controller prescalers.
Page 1694: •   16-bit programmable prescaler used to divide the counter clock frequency by any factor
Page 1695: Internal clock (CK_INT)
Page 1695: •    16-bit programmable prescaler used to divide the counter clock frequency by any factor
Page 1696: Internal clock (CK_INT)
Page 1697: counter clock can be divided by a prescaler.
Page 1697: The counter is clocked by the prescaler output CK_CNT, which is enabled only when the
Page 1697: Note that the counter starts counting 1 clock cycle after setting the CEN bit in the TIMx_CR1
Page 1697: The prescaler can divide the counter clock frequency by any factor between 1 and 65536. It
Page 1698: Timerclock = CK_CNT
Page 1698: Timerclock = CK_CNT
Page 1699: The following figures show some examples of the counter behavior for different clock
Page 1699: Figure 456. Counter timing diagram, internal clock divided by 1
Page 1699: Timerclock = CK_CNT
Page 1700: Figure 457. Counter timing diagram, internal clock divided by 2
Page 1700: Timerclock = CK_CNT
Page 1700: Figure 458. Counter timing diagram, internal clock divided by 4
Page 1700: Timerclock = CK_CNT
Page 1701: Figure 459. Counter timing diagram, internal clock divided by N
Page 1701: Timerclock = CK_CNT
Page 1701: Timerclock = CK_CNT
Page 1702: Timerclock = CK_CNT
Page 1702: 39.3.3      Clock selection
Page 1702: The counter clock can be provided by the following clock sources:
Page 1702: •     Internal clock (CK_INT)
Page 1702: •     External clock mode1 (for TIM12): external input pin (TIx)
Page 1702: Internal clock source (CK_INT)
Page 1702: The internal clock source is the default clock source for TIM13/TIM14.
Page 1702: For TIM12, the internal clock source is selected when the slave mode controller is disabled
Page 1702: clocked by the internal clock CK_INT.
Page 1703: Figure 462. Control circuit in normal mode, internal clock divided by 1
Page 1703: Internal clock
Page 1703: r clock = CK_CNT = CK_PSC
Page 1703: External clock source mode 1 (TIM12)
Page 1703: Figure 463. TI2 external clock connection example
Page 1703: TRGI              External clock
Page 1703: CK_INT             Internal clock
Page 1703: ICF[3:0]                         CC2P                     (internal clock)           de
Page 1704: 5.   Configure the timer in external clock mode 1 by writing SMS=’111’ in the TIMx_SMCR
Page 1704: The delay between the rising edge on TI2 and the actual clock of the counter is due to the
Page 1704: Figure 464. Control circuit in external clock mode 1
Page 1704: Counter clock = CK_CNT = CK_PSC
Page 1706: must 5 internal clock cycles. We must program a filter duration longer than these 5
Page 1706: clock cycles. We can validate a transition on TI1 when 8 consecutive samples with the
Page 1709: 1.   Select the counter clock (internal, external, prescaler).
Page 1713: clock frequency and the counter prescaler).
Page 1714: output toggle. But several clock cycles are needed for these operations and it limits the
Page 1716: The counter starts counting on the internal clock, then behaves normally until TI1 rising
Page 1716: Counter clock = ck_cnt = ck_psc
Page 1716: The counter starts counting on the internal clock as long as TI1 is low and stops as soon as
Page 1717: Counter clock = ck_cnt = ck_psc
Page 1717: When a rising edge occurs on TI2, the counter starts counting on the internal clock and the
Page 1718: Counter clock = ck_cnt = ck_psc
Page 1719: Note:            The clock of the slave timer must be enabled prior to receive events from the master timer,
Page 1719: Bits 9:8 CKD[1:0]: Clock division
Page 1719: This bit-field indicates the division ratio between the timer clock (CK_INT) frequency and
Page 1719: sampling clock used by the digital filters (TIx),
Page 1720: Note: External clock and gated mode can work only if the CEN bit has been previously set by
Page 1722: 0000: Slave mode disabled - if CEN = ‘1’ then the prescaler is clocked directly by the internal
Page 1722: clock.
Page 1722: 0101: Gated Mode - The counter clock is enabled when the trigger input (TRGI) is high. The
Page 1722: 0111: External Clock Mode 1 - Rising edges of the selected trigger (TRGI) clock the counter.
Page 1722: Note: The clock of the slave timer must be enabled prior to receive events from the master
Page 1727: input is 5 clock cycles
Page 1727: sample the trigger input and to activate CC1 output is reduced to 3 clock cycles. OC1FE acts
Page 1729: Circuit is sensitive to TIxFP1 rising edge (capture, trigger in reset, external clock or trigger
Page 1729: Circuit is sensitive to TIxFP1 falling edge (capture, trigger in reset, external clock or trigger
Page 1729: clock or trigger mode), TIxFP1 is not inverted (trigger in gated mode). This configuration
Page 1730: The counter clock frequency CK_CNT is equal to fCK_PSC / (PSC[15:0] + 1).
Page 1735: Bits 9:8 CKD[1:0]: Clock division
Page 1735: This bit-field indicates the division ratio between the timer clock (CK_INT) frequency and
Page 1735: sampling clock used by the digital filters (TIx),
Page 1736: Note: External clock and gated mode can work only if the CEN bit has been previously set by
Page 1739: 5 clock cycles.
Page 1739: trigger input and to activate CC1 output is reduced to 3 clock cycles. OC1FE acts only if the
Page 1742: The counter clock frequency CK_CNT is equal to fCK_PSC / (PSC[15:0] + 1).
Page 1746: milliseconds using the timer prescaler and the RCC clock controller prescalers.
Page 1746: •   16-bit programmable prescaler used to divide (also “on the fly”) the counter clock
Page 1747: •   16-bit programmable prescaler used to divide (also “on the fly”) the counter clock
Page 1748: Internal clock (CK_INT) from RCC
Page 1748: - A clock failure event generated by CSS. For further information on the CSS, refer to Section 7.5.3: Clock Security System
Page 1749: Internal clock (CK_INT)
Page 1749: - A clock failure event generated by CSS. For further information on the CSS, refer to Section 7.5.3: Clock Security System
Page 1750: related auto-reload register. The counter clock can be divided by a prescaler.
Page 1750: The counter is clocked by the prescaler output CK_CNT, which is enabled only when the
Page 1750: Note that the counter starts counting 1 clock cycle after setting the CEN bit in the TIMx_CR1
Page 1750: The prescaler can divide the counter clock frequency by any factor between 1 and 65536. It
Page 1751: Timerclock = CK_CNT
Page 1751: Timerclock = CK_CNT
Page 1752: The following figures show some examples of the counter behavior for different clock
Page 1753: Figure 482. Counter timing diagram, internal clock divided by 1
Page 1753: Timerclock = CK_CNT
Page 1753: Figure 483. Counter timing diagram, internal clock divided by 2
Page 1753: Timerclock = CK_CNT
Page 1754: Figure 484. Counter timing diagram, internal clock divided by 4
Page 1754: Timerclock = CK_CNT
Page 1754: Figure 485. Counter timing diagram, internal clock divided by N
Page 1754: Timerclock = CK_CNT
Page 1755: Timerclock = CK_CNT
Page 1755: Timerclock = CK_CNT
Page 1757: 40.4.4   Clock selection
Page 1757: The counter clock can be provided by the following clock sources:
Page 1757: •   Internal clock (CK_INT)
Page 1757: •   External clock mode1: external input pin
Page 1757: Internal clock source (CK_INT)
Page 1758: is written to 1, the prescaler is clocked by the internal clock CK_INT.
Page 1758: Figure 489. Control circuit in normal mode, internal clock divided by 1
Page 1758: Internal clock
Page 1758: Counter clock = CK_CNT = CK_PSC
Page 1758: External clock source mode 1
Page 1758: Figure 490. TI2 external clock connection example
Page 1758: 00100         TRGI                External clock
Page 1758: CK_INT                 Internal clock
Page 1758: ICF[3:0]                                  CC2P                                   (internal clock)
Page 1759: 5.   Configure the timer in external clock mode 1 by writing SMS=111 in the TIMx_SMCR
Page 1759: The delay between the rising edge on TI2 and the actual clock of the counter is due to the
Page 1759: Figure 491. Control circuit in external clock mode 1
Page 1759: Counter clock = CK_CNT = CK_PSC
Page 1762: imagine that, when toggling, the input signal is not stable during at least 5 internal clock
Page 1762: cycles. We must program a filter duration longer than these 5 clock cycles. We can
Page 1765: 1.     Select the counter clock (internal, external, prescaler).
Page 1770: The break channel gathers both system-level fault (clock failure, parity error,...) and
Page 1770: clock cycle is applied before the writing is effective. Consequently, it is necessary to wait 1
Page 1770: APB clock period to correctly read back the bit after the write operation.
Page 1771: - a clock failure event generated by the CSS detector
Page 1771: Caution:           An asynchronous (clockless) operation is only guaranteed when the programmable filter is
Page 1771: disabled. If it is enabled, a fail safe clock mode (example, using the internal PLL and/or the
Page 1772: This is done asynchronously so that it works even if no clock is provided to the
Page 1772: –    If the timer clock is still present, then the dead-time generator is reactivated in
Page 1772: dead-time duration is a bit longer than usual (around 2 ck_tim clock cycles).
Page 1775: clock frequency and the counter prescaler).
Page 1775: output toggle. But several clock cycles are needed for these operations and it limits the
Page 1778: The counter starts counting on the internal clock, then behaves normally until TI1 rising
Page 1778: Counter clock = ck_cnt = ck_psc
Page 1779: The counter starts counting on the internal clock as long as TI1 is low and stops as soon as
Page 1779: Counter clock = ck_cnt = ck_psc
Page 1780: When a rising edge occurs on TI2, the counter starts counting on the internal clock and the
Page 1780: Counter clock = ck_cnt = ck_psc
Page 1782: Note:       The clock of the slave peripherals (timer, ADC, ...) receiving the TRGO or the TRGO2
Page 1782: signals must be enabled prior to receive events from the master timer, and the clock
Page 1783: Bits 9:8 CKD[1:0]: Clock division
Page 1783: This bitfield indicates the division ratio between the timer clock (CK_INT) frequency and the
Page 1783: dead-time and sampling clock (tDTS) used by the dead-time generators and the digital filters
Page 1784: Note: External clock and gated mode can work only if the CEN bit has been previously set by
Page 1787: 0000: Slave mode disabled - if CEN = ‘1’ then the prescaler is clocked directly by the internal
Page 1787: clock.
Page 1787: 0101: Gated Mode - The counter clock is enabled when the trigger input (TRGI) is high. The
Page 1787: 0111: External Clock Mode 1 - Rising edges of the selected trigger (TRGI) clock the counter.
Page 1787: Note: The clock of the slave peripherals (timer, ADC, ...) receiving the TRGO or the TRGO2
Page 1787: signals must be enabled prior to receive events from the master timer, and the clock
Page 1794: 5 clock cycles.
Page 1794: trigger input and to activate CC1 output is reduced to 3 clock cycles. OCFE acts only if the
Page 1796: operations in reset, external clock or trigger mode), TIxFP1 is not inverted (trigger operation
Page 1796: operations in reset, external clock or trigger mode), TIxFP1 is inverted (trigger operation in
Page 1796: (capture or trigger operations in reset, external clock or trigger mode), TIxFP1 is not inverted
Page 1797: Then if the clock is present: OCx=OISx and OCxN=OISxN
Page 1798: The counter clock frequency (CK_CNT) is equal to fCK_PSC / (PSC[15:0] + 1).
Page 1801: 2: Any write operation to this bit takes a delay of 1 APB clock cycle to become effective.
Page 1801: 0: Break inputs (BRK and CCS clock failure event) disabled
Page 1801: 1; Break inputs (BRK and CCS clock failure event) enabled
Page 1801: Note: Any write operation to this bit takes a delay of 1 APB clock cycle to become effective.
Page 1808: Bits 9:8 CKD[1:0]: Clock division
Page 1808: This bit-field indicates the division ratio between the timer clock (CK_INT) frequency and the
Page 1808: dead-time and sampling clock (tDTS)used by the dead-time generators and the digital filters
Page 1809: Note: External clock and gated mode can work only if the CEN bit has been previously set by
Page 1814: 5 clock cycles.
Page 1814: the trigger input and to activate CC1 output is reduced to 3 clock cycles. OC1FE acts only if
Page 1816: trigger operations in reset, external clock or trigger mode), TIxFP1 is not inverted (trigger
Page 1816: operations in reset, external clock or trigger mode), TIxFP1 is inverted (trigger operation in
Page 1816: (capture or trigger operations in reset, external clock or trigger mode), TIxFP1 is not inverted
Page 1817: Then if the clock is present: OCx=OISx and OCxN=OISxN
Page 1818: The counter clock frequency (CK_CNT) is equal to fCK_PSC / (PSC[15:0] + 1).
Page 1821: 2. Any write operation to this bit takes a delay of 1 APB clock cycle to become effective.
Page 1821: 0: Break inputs (BRK and CCS clock failure event) disabled
Page 1821: 1; Break inputs (BRK and CCS clock failure event) enabled
Page 1821: 2. Any write operation to this bit takes a delay of 1 APB clock cycle to become effective.
Page 1827: 0001: SPDIFRX_FRAME_SYNC is connected to TIM17_CH1 to measure the clock drift of
Page 1830: •   16-bit programmable prescaler used to divide (also “on the fly”) the counter clock
Page 1830: Internal clock (CK_INT)          controller
Page 1831: register. The counter clock can be divided by a prescaler.
Page 1831: The counter is clocked by the prescaler output CK_CNT, which is enabled only when the
Page 1831: Note that the actual counter enable signal CNT_EN is set 1 clock cycle after CEN.
Page 1831: The prescaler can divide the counter clock frequency by any factor between 1 and 65536. It
Page 1832: Timerclock = CK_CNT
Page 1832: Timerclock = CK_CNT
Page 1833: The following figures show some examples of the counter behavior for different clock
Page 1833: Figure 514. Counter timing diagram, internal clock divided by 1
Page 1833: Timerclock = CK_CNT
Page 1834: Figure 515. Counter timing diagram, internal clock divided by 2
Page 1834: Timerclock = CK_CNT
Page 1834: Figure 516. Counter timing diagram, internal clock divided by 4
Page 1834: Timerclock = CK_CNT
Page 1835: Figure 517. Counter timing diagram, internal clock divided by N
Page 1835: Timerclock = CK_CNT
Page 1835: Timerclock = CK_CNT
Page 1836: Timerclock = CK_CNT
Page 1836: 41.3.4      Clock source
Page 1836: The counter clock is provided by the Internal clock (CK_INT) source.
Page 1836: automatically). As soon as the CEN bit is written to 1, the prescaler is clocked by the internal
Page 1836: clock CK_INT.
Page 1837: Figure 520. Control circuit in normal mode, internal clock divided by 1
Page 1837: Internal clock
Page 1837: Counter clock = CK_CNT = CK_PSC
Page 1839: Note: The clock of the slave timer or ADC must be enabled prior to receive events from the
Page 1841: The counter clock frequency CK_CNT is equal to fCK_PSC / (PSC[15:0] + 1).
Page 1843: consumption reduction. Thanks to its diversity of clock sources, the LPTIM is able to keep
Page 1843: no internal clock source, the LPTIM can be used as a “Pulse Counter” which can be useful
Page 1843: The LPTIM introduces a flexible clock scheme that provides the needed functionalities and
Page 1843: •      Selectable clock
Page 1843: –    Internal clock sources: LSE, LSI, HSI or APB clock
Page 1843: –    External clock source over LPTIM input (working with no LP oscillator running,
Page 1844: lptim_pclk                                                       lptim_ker_ck clock domain
Page 1844: clock domain                    Up/down                                                        lptim_in2_mux1
Page 1845: lptim_pclk                                                                           lptim_ker_ck clock domain
Page 1845: clock domain
Page 1845: lptim_pclk                                                                    lptim_ker_ck clock domain
Page 1845: clock domain
Page 1846: lptim_pclk               Digital input     LPTIM APB clock domain
Page 1846: lptim_ker_ck               Digital input     LPTIM kernel clock
Page 1849: 42.4.4   LPTIM reset and clocks
Page 1849: The LPTIM can be clocked using several clock sources. It can be clocked using an internal
Page 1849: clock signal which can be chosen among APB, LSI, LSE or HSI sources through the Reset
Page 1849: and Clock controller (RCC). Also, the LPTIM can be clocked using an external clock signal
Page 1849: injected on its external Input1. When clocked with an external clock source, the LPTIM may
Page 1849: •    The first configuration is when the LPTIM is clocked by an external signal but in the
Page 1849: same time an internal clock signal is provided to the LPTIM either from APB or any
Page 1849: •    The second configuration is when the LPTIM is solely clocked by an external clock
Page 1849: use an external clock source or an internal one.
Page 1849: When configured to use an external clock source, the CKPOL bits are used to select the
Page 1849: external clock signal active edge. If both edges are configured to be active ones, an internal
Page 1849: clock signal should also be provided (first configuration). In this case, the internal clock
Page 1849: signal frequency should be at least four times higher than the external clock signal
Page 1849: Before activating the digital filters, an internal clock source should first be provided to the
Page 1850: Note:       In case no internal clock signal is provided, the digital filter must be deactivated by setting
Page 1851: detection, a two-counter-clock period latency is needed before the timer starts running due
Page 1854: Signals with frequencies up to the LPTIM clock frequency divided by 2 can be generated.
Page 1855: The LPTIM APB interface and the LPTIM kernel logic use different clocks, so there is some
Page 1855: used to count internal clock cycles. The CKSEL and COUNTMODE bits control which
Page 1855: •   CKSEL = 0: the LPTIM is clocked by an internal clock source
Page 1855: The LPTIM is configured to be clocked by an internal clock source and the LPTIM
Page 1855: counter is configured to be updated following each internal clock pulse.
Page 1855: The LPTIM external Input1 is sampled with the internal clock provided to the
Page 1855: external Input1 signal should never exceed the frequency of the internal clock
Page 1855: provided to the LPTIM. Also, the internal clock provided to the LPTIM must not be
Page 1855: •   CKSEL = 1: the LPTIM is clocked by an external clock source
Page 1855: In this configuration, the LPTIM has no need for an internal clock source (except if the
Page 1855: system clock for the LPTIM. This configuration is suitable for operation modes where
Page 1855: falling edges of the input1 clock signal but not on both rising and falling edges.
Page 1855: Since the signal injected on the LPTIM external Input1 is also used to clock the LPTIM
Page 1856: kernel logic. After setting the ENABLE bit, a delay of two counter clock is needed before the
Page 1856: the reset signal is propagated in the LPTIM kernel clock domain. So it is important to
Page 1856: note that a few clock pulses of the LPTIM kernel logic will elapse before the reset is
Page 1856: located in the APB clock domain and the LPTIM counter is located in the LPTIM kernel
Page 1856: clock domain, a delay of 3 clock cycles of the kernel clock is needed to synchronize the
Page 1856: reset signal issued by the APB clock domain when writing '1' to the COUNTRST bit.
Page 1856: should be triggered within a timeframe in which no LPTIM core clock is provided. For
Page 1856: example when LPTIM Input1 is used as external clock source, the asynchronous reset
Page 1857: position of rotary elements. Encoder interface mode acts simply as an external clock with
Page 1857: From the two external input signals, Input1 and Input2, a clock signal is generated to clock
Page 1857: The Encoder mode is only available when the LPTIM is clocked by an internal clock source.
Page 1857: clock frequency divided by 4. This is mandatory in order to guarantee a proper operation of
Page 1857: Caution:   In this mode the LPTIM must be clocked by an internal clock source, so the CKSEL bit must
Page 1858: The LPTIM peripheral is active when it is clocked by LSE or LSI. LPTIM
Page 1863: The COUNTMODE bit selects which clock source is used by the LPTIM to clock the counter:
Page 1863: 0: the counter is incremented following each internal clock pulse
Page 1863: 1: the counter is incremented following each valid clock pulse on the LPTIM external Input1
Page 1865: Bits 11:9 PRESC[2:0]: Clock prescaler
Page 1865: internal clock source must be present to use this feature
Page 1865: 01: trigger active level change must be stable for at least 2 clock periods before it is considered as
Page 1865: 10: trigger active level change must be stable for at least 4 clock periods before it is considered as
Page 1865: 11: trigger active level change must be stable for at least 8 clock periods before it is considered as
Page 1866: Bits 4:3 CKFLT[1:0]: Configurable digital filter for external clock
Page 1866: level change occurs on an external clock signal before it is considered as a valid level transition. An
Page 1866: internal clock source must be present to use this feature
Page 1866: 00: any external clock signal level change is considered as a valid transition
Page 1866: 01: external clock signal level change must be stable for at least 2 clock periods before it is
Page 1866: 10: external clock signal level change must be stable for at least 4 clock periods before it is
Page 1866: 11: external clock signal level change must be stable for at least 8 clock periods before it is
Page 1866: Bits 2:1 CKPOL[1:0]: Clock Polarity
Page 1866: If LPTIM is clocked by an external clock source:
Page 1866: When the LPTIM is clocked by an external clock source, CKPOL bits is used to configure the active
Page 1866: 10: both edges are active edges. When both external clock signal edges are considered active
Page 1866: ones, the LPTIM must also be clocked by an internal clock source with a frequency equal to at
Page 1866: least four time the external clock frequency.
Page 1866: Bit 0 CKSEL: Clock selector
Page 1866: The CKSEL bit selects which clock source the LPTIM will use:
Page 1866: 0: LPTIM is clocked by internal clock source (APB clock or any of the embedded oscillators)
Page 1866: 1: LPTIM is clocked by an external clock source through the LPTIM external Input1
Page 1867: place after a synchronization delay of 3 LPTimer core clock cycles (LPTimer core clock may be
Page 1867: different from APB clock).
Page 1869: When the LPTIM is running with an asynchronous clock, reading the LPTIM_CNT register may
Page 1873: The WWDG clock is prescaled from the APB clock and has a configurable time-window that
Page 1874: pclk                     Digital input            APB bus clock
Page 1876: tPCLK: APB clock period measured in ms
Page 1878: 000: CK Counter Clock (PCLK div 4096) div 1
Page 1878: 001: CK Counter Clock (PCLK div 4096) div 2
Page 1878: 010: CK Counter Clock (PCLK div 4096) div 4
Page 1878: 011: CK Counter Clock (PCLK div 4096) div 8
Page 1878: 100: CK Counter Clock (PCLK div 4096) div 16
Page 1878: 101: CK Counter Clock (PCLK div 4096) div 32
Page 1878: 110: CK Counter Clock (PCLK div 4096) div 64
Page 1878: 111: CK Counter Clock (PCLK div 4096) div 128
Page 1880: The independent watchdog (IWDG) is clocked by its own dedicated low-speed clock (LSI)
Page 1880: and thus stays active even if the main clock fails.
Page 1880: •     Clocked from an independent RC oscillator (can operate in Standby and Stop modes)
Page 1881: lsi_ck                       LSI clock
Page 1884: written by software to select the prescaler divider feeding the counter clock. PVU bit of the
Page 1885: The timeout period is a function of this value and the clock prescaler. Refer to the datasheet for
Page 1889: RM0433                                                                           Real-time clock (RTC)
Page 1889: 45       Real-time clock (RTC)
Page 1889: The real-time clock (RTC) is an independent BCD timer/counter. The RTC provides a time-
Page 1889: of-day clock/calendar with programmable alarm interrupts.
Page 1890: Real-time clock (RTC)                                                                                                  RM0433
Page 1890: •       Reference clock detection: a more precise second source clock (50 or 60 Hz) can be
Page 1890: •       Accurate synchronization with an external clock using the subsecond shift feature.
Page 1891: RM0433                                                                                            Real-time clock (RTC)
Page 1892: Real-time clock (RTC)                                                                                     RM0433
Page 1892: –    RTC_CALIB: 512 Hz or 1Hz clock output (with an LSE frequency of 32.768 kHz).
Page 1892: –    RTC_REFIN: 50 or 60 Hz reference clock input
Page 1893: RM0433                                                                                            Real-time clock (RTC)
Page 1893: RTC_REFIN                           Input        Reference clock input
Page 1893: rtc_ker_ck (RTCCLK)             Internal input   RTC clock source (LSE clock, LSI clock and HSE clock)
Page 1893: rtc_pclk                        Internal input   RTC APB interface clock
Page 1894: Real-time clock (RTC)                                                                                             RM0433
Page 1895: RM0433                                                                                                                                          Real-time clock (RTC)
Page 1895: 45.3.4   Clock and prescalers
Page 1895: The RTC clock source (RTCCLK) is selected through the clock controller among the LSE
Page 1895: clock, the LSI oscillator clock, and the HSE clock. For more information on the RTC clock
Page 1895: source configuration, refer to Section 7: Reset and Clock Control (RCC).
Page 1895: A programmable prescaler stage generates a 1 Hz clock which is used to update the
Page 1895: factor to 256, to obtain an internal clock frequency of 1 Hz (ck_spre) with an LSE frequency
Page 1895: The ck_apre clock is used to clock the binary RTC_SSR subseconds downcounter. When it
Page 1895: The ck_spre clock can be used either to update the calendar or as timebase for the 16-bit
Page 1896: Real-time clock (RTC)                                                                           RM0433
Page 1896: 45.3.5      Real-time clock and calendar
Page 1896: are synchronized with PCLK (APB clock). They can also be accessed directly in order to
Page 1896: frequency of the APB clock (fAPB) must be at least 7 times the frequency of the RTC clock
Page 1897: RM0433                                                                        Real-time clock (RTC)
Page 1897: The wakeup timer clock input can be:
Page 1897: •    RTC clock (RTCCLK) divided by 2, 4, 8, or 16.
Page 1897: •    ck_spre (usually 1 Hz internal clock)
Page 1898: Real-time clock (RTC)                                                                               RM0433
Page 1898: INITF is set to 1. It takes around 2 RTCCLK clock cycles (due to clock synchronization).
Page 1898: 3.   To generate a 1 Hz clock for the calendar counter, program both the prescaler factors in
Page 1898: then automatically loaded and the counting restarts after 4 RTCCLK clock cycles.
Page 1898: Note:       Each change of the RTC_CR register is taken into account after around 2 RTCCLK clock
Page 1898: cycles due to clock synchronization.
Page 1899: RM0433                                                                           Real-time clock (RTC)
Page 1899: counter and to WUCKSEL[2:0] bits is allowed. It takes around 2 RTCCLK clock cycles
Page 1899: (due to clock synchronization).
Page 1899: 3.   Program the wakeup auto-reload value WUT[15:0], and the wakeup clock selection
Page 1899: clock cycles after WUTE is cleared, due to clock synchronization.
Page 1899: clock frequency (fPCLK) must be equal to or greater than seven times the RTC clock
Page 1899: If the APB clock frequency is less than seven times the RTC clock frequency, the software
Page 1899: read access must be done. In any case the APB clock frequency must never be lower than
Page 1899: the RTC clock frequency.
Page 1900: Real-time clock (RTC)                                                                           RM0433
Page 1900: In addition, when it is clocked by the LSE, the RTC keeps on running under system reset if
Page 1900: the reset source is different from the Backup domain reset one (refer to the RTC clock
Page 1900: section of the Reset and clock controller for details on the list of RTC clock sources not
Page 1900: The RTC can be synchronized to a remote clock with a high degree of precision. After
Page 1900: precise offset between the times being maintained by the remote clock and the RTC. The
Page 1900: RTC can then be adjusted to eliminate this offset by “shifting” its clock by a fraction of a
Page 1900: allowed (30.52 μs with a 32768 Hz clock) is obtained with PREDIV_S set to 0x7FFF.
Page 1900: to RTC_SHIFTR can shift (either delay or advance) the clock by up to a second with a
Page 1901: RM0433                                                                            Real-time clock (RTC)
Page 1901: SUBFS[14:0] value to the synchronous prescaler counter SS[15:0]: this will delay the clock.
Page 1901: time subtracting a fraction of second, so this will advance the clock.
Page 1901: Caution:   This synchronization feature is not compatible with the reference clock detection feature:
Page 1901: 45.3.12    RTC reference clock detection
Page 1901: The update of the RTC calendar can be synchronized to a reference clock, RTC_REFIN,
Page 1901: reference clock should be higher than the 32.768 kHz LSE clock. When the RTC_REFIN
Page 1901: detection is enabled (REFCKON bit of RTC_CR set to 1), the calendar is still clocked by the
Page 1901: Each 1 Hz clock edge is compared to the nearest RTC_REFIN clock edge (if one is found
Page 1901: within a given time window). In most cases, the two clock edges are properly aligned. When
Page 1901: the 1 Hz clock becomes misaligned due to the imprecision of the LSE clock, the RTC shifts
Page 1901: the 1 Hz clock a bit so that future 1 Hz clock edges are aligned. Thanks to this mechanism,
Page 1901: the calendar becomes as precise as the reference clock.
Page 1901: The RTC detects if the reference clock source is present by using the 256 Hz clock
Page 1901: periods when detecting the first reference clock edge. A smaller window of 3 ck_apre
Page 1901: Each time the reference clock is detected in the window, the synchronous prescaler which
Page 1901: outputs the ck_spre clock is forced to reload. This has no effect when the reference clock
Page 1901: and the 1 Hz clock are aligned because the prescaler is being reloaded at the same
Page 1901: moment. When the clocks are not aligned, the reload shifts future 1 Hz clock edges a little
Page 1901: for them to be aligned with the reference clock.
Page 1901: If the reference clock halts (no reference clock edge occurred during the 3 ck_apre window),
Page 1901: the calendar is updated continuously based solely on the LSE clock. The RTC then waits for
Page 1901: the reference clock using a large 7 ck_apre period detection window centered on the
Page 1901: Note:      RTC_REFIN clock detection is not available in Standby mode.
Page 1902: Real-time clock (RTC)                                                                           RM0433
Page 1902: counter, cal_cnt[19:0], clocked by RTCCLK.
Page 1902: The smooth calibration register (RTC_CALR) specifies the number of RTCCLK clock cycles
Page 1902: •   and so on up to CALM[8] set to 1 which causes 256 clocks to be masked.
Page 1902: and so on up to CALM[8]=1 which causes 256 clocks to be masked (cal_cnt = 0xXX800).
Page 1902: that 512 clocks are added during every 32-second cycle.
Page 1902: (PREDIV_S) should be reduced so that each second is accelerated by 8 RTCCLK clock
Page 1902: cycles, which is equivalent to adding 256 clock cycles every 32 seconds. As a result,
Page 1902: between 255 and 256 clock pulses (corresponding to a calibration range from 243.3 to
Page 1903: RM0433                                                                           Real-time clock (RTC)
Page 1903: calibrated input clock is as follows:
Page 1903: measurement error of up to 2 RTCCLK clock cycles over the measurement period,
Page 1904: Real-time clock (RTC)                                                                             RM0433
Page 1905: RM0433                                                                        Real-time clock (RTC)
Page 1906: Real-time clock (RTC)                                                                              RM0433
Page 1906: 45.3.16     Calibration clock output
Page 1906: When the COE bit is set to 1 in the RTC_CR register, a reference clock is provided on the
Page 1907: RM0433                                                                        Real-time clock (RTC)
Page 1907: The RTC remains active when the RTC clock source is LSE or LSI. RTC alarm,
Page 1908: Real-time clock (RTC)                                                                                         RM0433
Page 1908: 1. Wakeup from STOP and Standby modes is possible only when the RTC clock source is LSE or LSI.
Page 1909: RM0433                                                                                                    Real-time clock (RTC)
Page 1910: Real-time clock (RTC)                                            RM0433
Page 1911: RM0433                                                                                    Real-time clock (RTC)
Page 1911: (PREDIV_A=127 and PREDIV_S=255). Refer to Section 45.3.16: Calibration clock output
Page 1912: Real-time clock (RTC)                                                                                       RM0433
Page 1913: RM0433                                                                                Real-time clock (RTC)
Page 1913: Note: If the frequency of the APB clock is less than seven times the frequency of RTCCLK,
Page 1913: Bit 4 REFCKON: RTC_REFIN reference clock detection enable (50 or 60 Hz)
Page 1913: Bits 2:0 WUCKSEL[2:0]: Wakeup clock selection
Page 1913: 000: RTC/16 clock is selected
Page 1913: 001: RTC/8 clock is selected
Page 1913: 010: RTC/4 clock is selected
Page 1913: 011: RTC/2 clock is selected
Page 1913: 10x: ck_spre (usually 1 Hz) clock is selected
Page 1913: 11x: ck_spre (usually 1 Hz) clock is selected and 216 is added to the WUT counter value
Page 1914: Real-time clock (RTC)                                                                                                    RM0433
Page 1915: RM0433                                                                                  Real-time clock (RTC)
Page 1916: Real-time clock (RTC)                                                                                RM0433
Page 1916: Note:       The bits ALRAF, ALRBF, WUTF and TSF are cleared 2 APB clock cycles after programming
Page 1917: RM0433                                                                                         Real-time clock (RTC)
Page 1918: Real-time clock (RTC)                                                                                       RM0433
Page 1919: RM0433                                                                                         Real-time clock (RTC)
Page 1920: Real-time clock (RTC)                                                                                                 RM0433
Page 1921: RM0433                                                                                            Real-time clock (RTC)
Page 1922: Real-time clock (RTC)                                                                                              RM0433
Page 1922: 1: Add one second to the clock/calendar
Page 1922: add a fraction of a second to the clock in an atomic operation.
Page 1922: counter counts down, this operation effectively subtracts from (delays) the clock by:
Page 1922: A fraction of a second can effectively be added to the clock (advancing the clock) when the
Page 1922: ADD1S function is used in conjunction with SUBFS, effectively advancing the clock by:
Page 1923: RM0433                                                                                          Real-time clock (RTC)
Page 1924: Real-time clock (RTC)                                                                                                           RM0433
Page 1925: RM0433                                                                                    Real-time clock (RTC)
Page 1926: Real-time clock (RTC)                                                                                             RM0433
Page 1927: RM0433                                                                                  Real-time clock (RTC)
Page 1928: Real-time clock (RTC)                                                                                   RM0433
Page 1929: RM0433                                                                                  Real-time clock (RTC)
Page 1930: Real-time clock (RTC)                                                                                         RM0433
Page 1931: RM0433                                                                                      Real-time clock (RTC)
Page 1932: Real-time clock (RTC)                                                                                        RM0433
Page 1933: Real-time clock (RTC)
Page 1934: Real-time clock (RTC)
Page 1935: –    Optional clock stretching
Page 1936: •     Independent clock: a choice of independent clock sources allowing the I2C
Page 1936: Independent clock                                                    X           X           X           X
Page 1936: connected to the I2C bus by a data pin (SDA) and by a clock pin (SCL). It can be connected
Page 1936: This interface can also be connected to a SMBus with the data pin (SDA) and clock pin
Page 1937: match     Clock control
Page 1937: Master clock
Page 1937: Slave clock                         GPIO     I2C_SCL
Page 1937: The I2C is clocked by an independent clock source which allows to the I2C to operate
Page 1938: 46.4.2      I2C clock requirements
Page 1938: The I2C kernel is clocked by i2c_ker_ck.
Page 1938: The i2c_pclk clock period tPCLK must respect the following condition:
Page 1938: Caution:    When the I2C kernel is clocked by i2c_pclk, this clock must respect the conditions for
Page 1938: In Master mode, the I2C interface initiates a data transfer and generates the clock signal. A
Page 1938: A 9th clock pulse follows the 8 clock cycles of a byte transfer, during which the receiver must
Page 1939: The I2C peripheral clock must be configured and enabled in the clock controller.
Page 1939: suppressed spikes                                       clocks
Page 1941: –    Delay due to SCL synchronization to i2c_ker_ck clock (2 to 3 i2c_ker_ck periods)
Page 1941: SCL signal. If the clock stretches the SCL, the data must be valid by the set-up time before
Page 1941: it releases the clock.
Page 1941: clock because the data was not yet written in I2C_TXDR register, SCL line is kept at
Page 1942: Note:         At every clock pulse, after SCL falling edge detection, the I2C master or slave stretches SCL
Page 1942: Additionally, in master mode, the SCL clock high and low levels must be configured by
Page 1943: PE must be kept low during at least 3 APB clock cycles in order to perform the software
Page 1947: By default, the slave uses its clock stretching capability, which means that it stretches the
Page 1947: does not support clock stretching, the I2C must be configured with NOSTRETCH=1 in the
Page 1947: Slave clock stretching (NOSTRETCH = 0)
Page 1947: In default mode, the I2C slave stretches the SCL clock in the following situations:
Page 1947: Slave without clock stretching (NOSTRETCH = 1)
Page 1947: •    The SCL clock is not stretched while the ADDR flag is set.
Page 1949: Caution:   When NOSTRETCH=1, the SCL clock is not stretched while the ADDR flag is set, so the
Page 1955: Before enabling the peripheral, the I2C master clock must be configured by setting the
Page 1955: A clock synchronization mechanism is implemented in order to support multi-master
Page 1955: environment and slave clock stretching.
Page 1955: In order to allow clock synchronization:
Page 1955: •   The low level of the clock is counted using the SCLL counter, starting from the SCL low
Page 1955: •   The high level of the clock is counted using the SCLH counter, starting from the SCL
Page 1955: clock. The I2C releases SCL to high level once the SCLL counter reaches the value
Page 1955: edge, SCL input noise filters (analog + digital) and SCL synchronization to I2CxCLK clock.
Page 1955: Consequently the master clock period is:
Page 1955: –    Delay due to SCL synchronization with i2c_ker_ck clock (2 to 3 i2c_ker_ck
Page 1955: –    Delay due to SCL synchronization with i2c_ker_ck clock (2 to 3 i2c_ker_ck
Page 1956: Figure 549. Master clock generation
Page 1956: SCL master clock generation
Page 1956: SCL master clock synchronization
Page 1956: Caution:    In order to be I2C or SMBus compliant, the master clock must respect the timings given
Page 1957: Table 374. I2C-SMBUS specification clock timings
Page 1957: fSCL     SCL clock frequency                        -    100     -      400    -     1000    -    100     kHz
Page 1957: tLOW     Low period of the SCL clock               4.7    -     1.3      -    0.5     -     4.7    -       µs
Page 1957: tHIGH    Period of the SCL clock                   4.0    -     0.6      -    0.26    -     4.0    50      µs
Page 1968: •      A master is a device that issues commands, generates the clocks and terminates the
Page 1970: tTIMEOUT         Detect clock low timeout                                         25             35          ms
Page 1970: tLOW:SEXT(1)       Cumulative clock low extend time (slave device)                   -             25         ms
Page 1970: tLOW:MEXT(2)       Cumulative clock low extend time (master device)                  -             10         ms
Page 1970: 1. tLOW:SEXT is the cumulative time a given slave device is allowed to extend the clock cycles in one message
Page 1970: clock causing the combined clock low extend time to be greater than tLOW:SEXT. Therefore, this parameter is
Page 1970: 2. tLOW:MEXT is the cumulative time a master device is allowed to extend its clock cycles within each byte of a
Page 1970: or another master also extends the clock causing the combined clock low time to be greater than tLOW:MEXT
Page 1971: A master can assume that the bus is free if it detects that the clock and data signals have
Page 1981: The I2C is able to wakeup the MCU from Stop mode (APB clock is off), when it is
Page 1981: HSI or CSI oscillator must be selected as the clock source for I2CCLK in order to allow
Page 1981: Note:      If the I2C clock is the system clock, or if WUPEN = 0, the HSI or CSI is not switched on after
Page 1981: Caution:   This feature is available only when the I2C clock source is the HSI or CSI oscillator.
Page 1981: Caution:   Clock stretching must be enabled (NOSTRETCH=0) to ensure proper operation of the
Page 1981: after a multiple of 9 SCL clock pulses. A START or a STOP condition is detected when a
Page 1982: •    Master cumulative clock low extend time reached the time defined in the
Page 1982: •    Slave cumulative clock low extend time reached the time defined in TIMEOUTB[11:0]
Page 1984: The I2C registers content is kept. If WUPEN = 1 and I2C is clocked by an internal
Page 1987: Bit 17 NOSTRETCH: Clock stretching disable
Page 1987: This bit is used to disable clock stretching in slave mode. It must be kept cleared in master
Page 1987: 0: Clock stretching enabled
Page 1987: 1: Clock stretching disabled
Page 1989: least 3 APB clock cycles.
Page 1994: This field is used to prescale i2c_ker_ck in order to generate the clock period tPRESC used for
Page 1995: Bit 31 TEXTEN: Extended clock timeout enable
Page 1995: 0: Extended clock timeout detection is disabled
Page 1995: 1: Extended clock timeout detection is enabled. When a cumulative SCL stretch for more
Page 1995: This field is used to configure the cumulative clock extension timeout:
Page 1995: In master mode, the master cumulative clock low extend time (tLOW:MEXT) is detected
Page 1995: In slave mode, the slave cumulative clock low extend time (tLOW:SEXT) is detected
Page 1995: Bit 15 TIMOUTEN: Clock timeout enable
Page 1995: Bit 12 TIDLE: Idle clock timeout detection
Page 1996: This flag is set by hardware when a timeout or extended clock timeout occurred. It is cleared
Page 2004: between speed and clock tolerance
Page 2004: •   Dual clock domain with dedicated kernel clock for peripherals independent from PCLK
Page 2004: •   Synchronous master/slave mode and clock output/input for synchronous
Page 2005: Dual clock domain and wakeup from low-power mode              X                 X                X
Page 2006: usart_ker_ck clock domain
Page 2006: usart_tx_dma                            clock domain
Page 2006: The simplified block diagram given in Figure 567 shows two fully-independent clock
Page 2006: •   The usart_pclk clock domain
Page 2006: The usart_pclk clock signal feeds the peripheral bus interface. It must be active when
Page 2006: •    The usart_ker_ck kernel clock domain.
Page 2006: The usart_ker_ck is the USART clock source. It is independent from usart_pclk and
Page 2006: when the usart_ker_ck clock is stopped.
Page 2006: When the dual clock domain feature is disabled, the usart_ker_ck clock is the same as
Page 2006: the usart_pclk clock.
Page 2006: clock derived from the external SCLK signal provided by the external master SPI device.
Page 2006: The usart_ker_ck clock must be at least 3 times faster than the clock on the CK input.
Page 2007: This pin acts as Clock output in Synchronous master and Smartcard modes.
Page 2007: It acts as Clock input is Synchronous slave mode.
Page 2007: In Synchronous Master mode, this pin outputs the transmitter data clock for
Page 2007: synchronous transmission corresponding to SPI master mode (no clock pulses on start
Page 2007: bit and stop bit, and a software option to send a clock pulse on the last data bit). In
Page 2007: to control peripherals featuring shift registers (e.g. LCD drivers). The clock phase and
Page 2007: In Smartcard mode, CK output provides the clock to the smartcard.
Page 2008: and reception clock are generated when the enable bit is set for the transmitter and receiver,
Page 2009: Clock                                                                            **
Page 2009: Clock                                                                   **
Page 2009: Clock                                                          **
Page 2009: ** LBCL bit controls last data clock pulse
Page 2010: data in the transmit shift register is output on the TX pin while the corresponding clock
Page 2011: CLOCK                                                                           **
Page 2011: ** LBCL bit controls last data clock pulse
Page 2015: clock
Page 2015: clock
Page 2018: Selecting the clock source and the appropriate oversampling method
Page 2018: The choice of the clock source is done through the Clock Control system (see Section 7:
Page 2018: Reset and Clock Control (RCC)). The clock source must be selected through the UE bit
Page 2018: The clock source must be selected according to two criteria:
Page 2018: The clock source frequency is usart_ker_ck.
Page 2018: When the dual clock domain and the wakeup from low-power mode features are supported,
Page 2018: the usart_ker_ck clock source can be configurable in the RCC (see Section 7: Reset and
Page 2018: Clock Control (RCC)). Otherwise the usart_ker_ck clock is the same as usart_pclk.
Page 2018: The usart_ker_ck clock can be divided by a programmable factor, defined in the
Page 2018: Figure 572. usart_ker_ck clock divider block diagram
Page 2018: For the other clock sources, the system must be active to allow USART communications.
Page 2018: determined by the clock source.
Page 2018: speed and noise/clock inaccuracy immunity.
Page 2018: USART_CR1 register either to 16 or 8 times the baud rate clock (see Figure 573 and
Page 2019: usart_ker_ck_pres/8). In this case the maximum receiver tolerance to clock deviation is
Page 2019: reduced (refer to Section 47.5.8: Tolerance of the USART receiver to clock deviation on
Page 2019: •   select oversampling by 16 (OVER8=0) to increase the tolerance of the receiver to clock
Page 2019: usart_ker_ck_pres/16 (where usart_ker_ck_pres is the USART input clock divided by a
Page 2019: increase the receiver tolerance to clock deviations (see Section 47.5.8: Tolerance
Page 2019: of the USART receiver to clock deviation on page 2023). In this case the NE bit
Page 2020: Sample clock       1   2   3    4      5   6    7       8   9       10   11   12     13     14   15   16
Page 2020: clock (x8)           1       2           3        4               5        6           7           8
Page 2021: Sampling for 1.5 stop bits is done on the 16th, 17th and 18th samples (1 baud clock
Page 2021: one 0.5 baud clock period during which nothing happens, followed by 1 normal stop bit
Page 2023: 47.5.8    Tolerance of the USART receiver to clock deviation
Page 2023: The USART asynchronous receiver operates correctly only if the total clock system
Page 2023: instant when the clock (requested by the peripheral) is ready and reaching the
Page 2024: •     The system is using a relatively low accuracy clock source and this mechanism allows
Page 2024: the correct baud rate to be obtained without measuring the clock deviation.
Page 2024: The clock source frequency must be compatible with the expected communication speed.
Page 2025: detection range (bit duration not between 16 and 65536 clock periods (oversampling by 16)
Page 2025: and not between 8 and 65536 clock periods (oversampling by 8)).
Page 2032: clock. No clock pulses are sent to the SCLK pin during start bit and stop bit. Depending on
Page 2032: the state of the LBCL bit in the USART_CR2 register, clock pulses are, or are not, generated
Page 2032: used to select the clock polarity, and the CPHA bit in the USART_CR2 register is used to
Page 2032: select the phase of the external clock (see Figure 579, Figure 580 and Figure 581).
Page 2032: During the Idle state, preamble and send break, the external SCLK clock is not activated.
Page 2033: Note:     In master mode, the SCLK pin operates in conjunction with the TX pin. Thus, the clock is
Page 2033: SCLK                  Clock
Page 2033: Figure 580. USART data clock timing diagram in synchronous master mode
Page 2033: Clock (CPOL=0, CPHA=0)                                                                *
Page 2033: Clock (CPOL=0, CPHA=1)
Page 2033: Clock (CPOL=1, CPHA=0)                                                                *
Page 2033: Clock (CPOL=1, CPHA=1)                                                        *
Page 2034: Figure 581. USART data clock timing diagram in synchronous master mode
Page 2034: Clock (CPOL=0,
Page 2034: Clock (CPOL=0,
Page 2034: Clock (CPOL=1,                                                                            *
Page 2034: Clock (CPOL=1,                                                                    *
Page 2034: Note:       When the peripheral is used in SPI slave mode, the frequency of peripheral clock source
Page 2034: The CPOL bit and the CPHA bit in the USART_CR2 register are used to select the clock
Page 2034: polarity and the phase of the external clock, respectively (see Figure 582).
Page 2034: clock pulse for data transmission appears while the software has not yet loaded any value to
Page 2035: Figure 582. USART data clock timing diagram in synchronous slave mode
Page 2035: Clock (CPOL=0, CPHA=0)
Page 2035: Clock (CPOL=0, CPHA=1)
Page 2035: Clock (CPOL=1, CPHA=0)
Page 2035: Clock (CPOL=1, CPHA=1)
Page 2035: the USART is disabled (UE=0) to ensure that the clock pulses function correctly.
Page 2035: (or between frames while the clock is stable). Otherwise, if the USART slave is enabled
Page 2035: clock or before the end of the ongoing communication, otherwise the SPI slave will transmit
Page 2037: The CLKEN bit can also be set to provide a clock to the Smartcard.
Page 2037: minimum of 1/2 baud clock. In normal operation a full transmit shift register starts
Page 2037: shifting on the next baud clock edge. In Smartcard mode this transmission is further
Page 2037: delayed by a guaranteed 1/2 baud clock.
Page 2037: baud clock) causes a framing error on the transmitter side (configured with 1.5 stop
Page 2038: period, the transmit line is pulled low for a baud clock period after the completion of the
Page 2038: clock periods.
Page 2039: The USART can provide a clock to the Smartcard through the SCLK output. In Smartcard
Page 2039: peripheral input clock through a 5-bit prescaler. The division ratio is configured in the
Page 2039: usart_ker_ck_pres/62, where usart_ker_ck_pres is the peripheral input clock divided by a
Page 2042: power mode programmable divisor divides the system clock to achieve this value.
Page 2042: clock (PSC value in the USART_GTPR).
Page 2044: clock is disabled. Software must wait until TC=1. The TC flag remains cleared during all
Page 2048: Note:       For correct behavior, nCTS must be asserted at least 3 USART clock source periods before
Page 2049: even when the usart_pclk clock is disabled.
Page 2049: specific action requiring the activation of the usart_pclk clock is needed:
Page 2049: usart_pclk clock has to be activated to empty the USART data register.
Page 2049: usart_pclk clock has to be activated to:
Page 2050: Wakeup from low-power mode when USART kernel clock (usart_ker_ck) is
Page 2050: If during low-power mode, the usart_ker_ck clock is switched OFF when a falling edge on
Page 2050: the USART receive line is detected, the USART interface requests the usart_ker_ck clock to
Page 2050: woken up and remains in low-power mode, and the kernel clock request is released.
Page 2052: USART receiver tolerance (see Section 47.5.8: Tolerance of the USART receiver to clock
Page 2054: USART_RDR. In Stop mode, USART_RDR is not clocked. As a result, this register will not be written and once n data are
Page 2061: Bit 11 CLKEN: Clock enable
Page 2061: In Smartcard mode, in order to provide correctly the SCLK clock to the smartcard, the steps
Page 2061: Bit 10 CPOL: Clock polarity
Page 2061: This bit allows the user to select the polarity of the clock output on the SCLK pin in synchronous
Page 2061: mode. It works in conjunction with the CPHA bit to produce the desired clock/data relationship
Page 2061: Bit 9 CPHA: Clock phase
Page 2061: This bit is used to select the phase of the clock output on the SCLK pin in synchronous mode. It
Page 2061: works in conjunction with the CPOL bit to produce the desired clock/data relationship (see
Page 2061: 0: The first clock transition is the first data capture edge
Page 2061: 1: The second clock transition is the first data capture edge
Page 2061: Bit 8 LBCL: Last bit clock pulse
Page 2061: This bit is used to select whether the clock pulse associated with the last data bit transmitted (MSB)
Page 2061: 0: The clock pulse of the last data bit is not output to the SCLK pin
Page 2061: 1: The clock pulse of the last data bit is output to the SCLK pin
Page 2068: This bitfield is used to program the Guard time value in terms of number of baud clock
Page 2068: Used for programming the prescaler for dividing the USART source clock to achieve the low-
Page 2068: The source clock is divided by the value given in the register (8 significant bits):
Page 2068: 00000001: divides the source clock by 1
Page 2068: 00000010: divides the source clock by 2
Page 2068: Used for programming the prescaler for dividing the USART source clock to provide the
Page 2068: Smartcard clock.
Page 2068: of the source clock frequency:
Page 2068: 00001: divides the source clock by 2
Page 2068: 00010: divides the source clock by 4
Page 2068: 00011: divides the source clock by 6
Page 2069: This bitfield gives the Receiver timeout value in terms of number of baud clocks.
Page 2073: In slave transmission mode, this flag is set when the first clock pulse for data transmission
Page 2076: Tolerance of the USART receiver to clock deviation on page 2023).
Page 2079: Bits 3:0 PRESCALER[3:0]: Clock prescaler
Page 2079: The USART input clock can be divided by a prescaler factor:
Page 2079: 0000: input clock not divided
Page 2079: 0001: input clock divided by 2
Page 2079: 0010: input clock divided by 4
Page 2079: 0011: input clock divided by 6
Page 2079: 0100: input clock divided by 8
Page 2079: 0101: input clock divided by 10
Page 2079: 0110: input clock divided by 12
Page 2079: 0111: input clock divided by 16
Page 2079: 1000: input clock divided by 32
Page 2079: 1001: input clock divided by 64
Page 2079: 1010: input clock divided by 128
Page 2079: 1011: input clock divided by 256
Page 2079: programmed prescaler value will be ‘1011’ i.e. input clock divided by 256.
Page 2082: power consumption. Only 32.768 kHz LSE clock is required to allow UART communications
Page 2082: up to 9600 baud/s. Higher baud rates can be reached when the LPUART is clocked by clock
Page 2082: sources different from the LSE clock.
Page 2083: •   From 300 baud/s to 9600 baud/s using a 32.768 kHz clock source.
Page 2083: •   Higher baud rates can be achieved by using a higher frequency clock source
Page 2083: •   Dual clock domain with dedicated kernel clock for peripherals independent from PCLK.
Page 2084: lpuart_ker_ck clock domain
Page 2084: lpuart_tx_dma                            clock domain
Page 2084: The simplified block diagram given in Figure 594 shows two fully independent clock
Page 2084: •     The lpuart_pclk clock domain
Page 2084: The lpuart_pclk clock signal feeds the peripheral bus interface. It must be active when
Page 2084: •     The lpuart_ker_ck kernel clock domain
Page 2084: The lpuart_ker_ck is the LPUART clock source. It is independent of the lpuart_pclk
Page 2084: When the dual clock domain feature is disabled, the lpuart_ker_ck is the same as the
Page 2084: lpuart_pclk clock.
Page 2085: and reception clocks are generated when the enable bit is set for the transmitter and
Page 2086: Clock                                                                            **
Page 2086: Clock                                                                   **
Page 2086: Clock                                                          **
Page 2086: ** LBCL bit controls last data clock pulse
Page 2088: CLOCK                                                                            **
Page 2088: ** LBCL bit controls last data clock pulse
Page 2093: Selecting the clock source
Page 2093: The choice of the clock source is done through the Clock Control system (see Section Reset
Page 2093: and clock controller (RCC)). The clock source must be selected through the UE bit, before
Page 2093: The clock source must be selected according to two criteria:
Page 2093: The clock source frequency is lpuart_ker_ck.
Page 2093: When the dual clock domain and the wakeup from low-power mode features are supported,
Page 2093: the lpuart_ker_ck clock source can be configured in the RCC (see Section Reset and clock
Page 2093: Figure 598. lpuart_ker_ck clock divider block diagram
Page 2093: For the other clock sources, the system must be active to allow LPUART communications.
Page 2093: determined by the clock source.
Page 2094: The maximum baud rate that can be reached when the LPUART clock source is the LSE, is
Page 2094: 9600 baud. Higher baud rates can be reached when the LPUART is clocked by clock
Page 2094: sources different from the LSE clock. For example, if the LPUART clock source frequency is
Page 2096: 48.3.8         Tolerance of the LPUART receiver to clock deviation
Page 2096: The asynchronous receiver of the LPUART works correctly only if the total clock system
Page 2104: Note:       For correct behavior, nCTS must be asserted at least 3 LPUART clock source periods
Page 2104: The LPUART DEAT and DEDT are expressed in LPUART clock source (fCK) cycles:
Page 2105: even when the lpuart_pclk clock is disabled.
Page 2105: specific action requiring the activation of the usart_pclk clock is needed:
Page 2105: luart_pclk clock has to be activated to empty the LPUART data register.
Page 2105: luart_pclk clock has to be activated
Page 2106: Wakeup from low-power mode when LPUART kernel clock lpuart_ker_ck is
Page 2106: If during low-power mode, the lpuart_ker_ck clock is switched OFF, when a falling edge on
Page 2106: clock to be switched ON thanks to the lpuart_ker_ck_req signal. The lpuart_ker_ck is then
Page 2106: waken up and stays in low-power mode and the kernel clock request is released.
Page 2108: receiver tolerance (see Section 48.3.8: Tolerance of the LPUART receiver to clock
Page 2109: LPUART_RDR. In Stop mode, LPUART_RDR is not clocked. As a result, this register will not be written and once n data
Page 2111: the beginning of the start bit. It is expressed in lpuart_ker_ck clock cycles. For more
Page 2111: lpuart_ker_ck clock cycles. For more details, refer Section 48.3.13: RS232 Hardware flow
Page 2113: provided that the LPUART clock selection is HSI or LSE in the RCC.
Page 2113: the clock source for the LPUART must be HSI or LSE (see RCC chapter)
Page 2126: Bits 3:0 PRESCALER[3:0]: Clock prescaler
Page 2126: The LPUART input clock can be divided by a prescaler:
Page 2126: 0000: input clock not divided
Page 2126: 0001: input clock divided by 2
Page 2126: 0010: input clock divided by 4
Page 2126: 0011: input clock divided by 6
Page 2126: 0100: input clock divided by 8
Page 2126: 0101: input clock divided by 10
Page 2126: 0110: input clock divided by 12
Page 2126: 0111: input clock divided by 16
Page 2126: 1000: input clock divided by 32
Page 2126: 1001: input clock divided by 64
Page 2126: 1010: input clock divided by 128
Page 2126: 1011: input clock divided by 256
Page 2126: programmed prescaler value will be «1011» i.e. input clock divided by 256.
Page 2129: clock (SCK) to the external slave device. The slave select signal can be provided by the
Page 2130: •    Dual clock domain, separated clock for the peripheral kernel which can be independent
Page 2130: •    Programmable clock polarity and phase
Page 2130: •    Slave's transmission and/or reception capability in Stop mode (no clock provided to the
Page 2131: Serial interface clock domain
Page 2131: Clock Generator
Page 2131: spi_pclk                                              clock domain
Page 2131: spi_ker_ck clock domain
Page 2131: The simplified scheme of Figure 608 shows three fully independent clock domains:
Page 2131: •   The spi_pclk clock domain,
Page 2131: •   The spi_ker_ck kernel clock domain,
Page 2131: •   The serial interface clock domain,
Page 2131: no specific constraint concerning the frequency ratio between these clock signals. The user
Page 2132: The spi_pclk clock signal feeds the peripheral bus interface. It has to be active when it
Page 2132: The SPI working in slave mode handles data flow using the serial interface clock derived
Page 2132: slave is able to receive and send data even when the spi_pclk and spi_ker_ck clock
Page 2132: This is not the case for the SPI master as it needs an active spi_ker_ck kernel clock coming
Page 2132: from the RCC to feed the clock generator at least. On the other side, a specific slave logic
Page 2132: working within the serial interface clock domain needs some additional traffic to be setup
Page 2132: becomes into idle. At specific case the slave even requires the clock generator working (see
Page 2132: •    SCK: Serial Clock output pin for SPI masters and input pin for SPI slaves.
Page 2132: devices. The bus consists of at least two wires: one for the clock signal and the other for
Page 2132: communication is always initiated and controlled by the master. The master provides a clock
Page 2133: communication, the data are shifted synchronously on the SCK clock edges provided by the
Page 2133: SPI clock                SCK                       SCK
Page 2133: synchronously shifted between the shift registers on the SCK clock edge in the transfer
Page 2133: SPI clock                SCK                       SCK
Page 2134: The master in transmit-only mode generates the clock as long as there are data
Page 2134: The slave in transmit only mode sends data as long as it receives a clock on the SCK
Page 2134: In master mode, the MOSI output is disabled and may be used as GPIO. The clock
Page 2134: the SPI_CR1 register is set. The clock is stopped either by SW explicitly requesting this
Page 2135: SPI clock                  SCK                        SCK
Page 2136: SPI clock                 SCK                        SCK
Page 2136: at serial chain under common slave select and clock control. All the information is shifted
Page 2136: configuration and clock setting has to be the same for all the nodes in the chain at this
Page 2137: SPI clock                SCK                          SCK
Page 2138: SPI clock                  SCK                       SCK                  SPI clock
Page 2139: frames, and kept inactive for a number of SPI clock periods defined by the MIDI
Page 2139: possible conflicts on data and clock line. The SPE is not automatically reset, as this would
Page 2140: frames and insert an extra delay at begin of every transaction (to separate the SS and clock
Page 2142: The serial clock (SCK) synchronizes the shifting and sampling of the information on the data
Page 2142: lines. The communication format depends on the clock phase, the clock polarity and the
Page 2142: Clock phase and polarity controls
Page 2142: bits in the SPI_CFG2 register. The CPOL (clock polarity) bit controls the idle state value of
Page 2142: the clock when no data are being transferred. This bit affects both master and slave modes.
Page 2142: each occurrence of this clock transition type. If the CPHA bit is reset, the first edge on the
Page 2142: if the CPOL bit is reset). Data are latched on each occurrence of this clock transition type.
Page 2142: The combination of the CPOL (clock polarity) and CPHA (clock phase) bits selects the data
Page 2142: capture clock edge.
Page 2143: Figure 618. Data clock timing diagram
Page 2143: frame are clocked and transferred.
Page 2145: It is recommended to configure and enable the SPI slave before the master sends the clock
Page 2145: before the master starts its clocking.The SCK signal must be settled to idle state level
Page 2145: In any master receive only mode, the master starts to communicate and the clock starts
Page 2147: 0). In master receive only mode, with MASRX = 1, the generated clock stops automatically
Page 2148: present in the TxFIFO of the master. The clock signal is provided permanently by the master
Page 2148: the CSTART bit. The clock signal is provided by the master and it does not stop until either
Page 2148: Caution:    If SPE is written to 0 at master, while reception is ongoing without any suspending, the clock
Page 2148: slower clock or separate frames or data sessions with sufficient delays by MIDI[3:0] bits
Page 2149: when the peripheral clock is stopped. Otherwise, ongoing transactions may be corrupted in
Page 2149: clocks are stopped, without interruption, until any end of communication or data service
Page 2149: providing data for transmission. In this case, the clock stops after the last data transaction.
Page 2153: In slave mode, the clock generator is used to define time when the slave output at MISO pin
Page 2154: transaction starts (propagation of the data into TxFIFO takes few APB clock cycles). If the
Page 2154: •    Any fill of empty TxFIFO when master starts clocking (at UDRDET[1:0]=00 especially)
Page 2154: always takes 3 SPI clock cycles after the event happen (underrun captured by hardware or
Page 2156: The CRC computation is done, bit by bit, on the sampling clock edge defined by the CPHA
Page 2157: between the FIFOs and the serial interface even when the spi_pclk clock is disabled.
Page 2157: In master mode the spi_ker_ck kernel clock is needed in order to provide the timings of the
Page 2157: In slave mode, the spi_ker_ck clock can be removed as well during the transfer of data
Page 2157: between the FIFOs and the serial interface. In this mode the clock is provided by the
Page 2157: When the spi_pclk clock is gated, (and the spi_ker_ck clock as well if the SPI is in slave),
Page 2157: activation of the spi_pclk clock is needed, such as:
Page 2157: The generation of spi_ker_ck and spi_pclk clock are controlled by the RCC block
Page 2157: The Figure 622 shows an example of the clock handling when the SPI2S is working in low-
Page 2157: In master mode the spi_ker_ck clock is required for the timing generation.
Page 2157: kernel clock in slave mode:
Page 2157: •   In most of the slave modes, the spi_ker_ck kernel clock can be disabled,
Page 2157: •   In some products, the spi_ker_ck kernel clock activation may follow the system state.
Page 2158: power mode, and thus to activate the bus clock (spi_pclk).
Page 2158: system wake-up automatically enables the spi_ker_ck kernel clock as well.
Page 2158: continue. Note that spi_wkup falling edge is aligned with the serial interface clock
Page 2158: domain, and the falling edge of the spi_it is aligned with the spi_pclk clock domain.
Page 2160: •    Programmable clock polarity
Page 2160: •    Master clock can be output to drive an external audio component. The ratio is fixed at
Page 2161: parameters, which include the clock generator, and the serial link interface.
Page 2161: The I2S/PCM function uses the clock generator to produce the communication clock when
Page 2161: the SPI/I2S is set in master mode. This clock generator is also the source of the master
Page 2161: clock output (MCK).
Page 2161: •   CK: Serial Clock (mapped on the SCK pin) is the serial bit clock. It is configured as
Page 2161: An additional pin can be used when a master clock output is needed for some external
Page 2161: •   MCK: Master Clock (mapped separately) is used, when the I2S is configured in master
Page 2161: mode. The master clock rate is fixed to 256 x FWS, where FWS is the audio sampling
Page 2163: •   In I2S Philips standard, the shift-in or shift-out of each data is triggered one bit clock
Page 2163: •   In PCM standard, the shift-in or shift-out of each data is triggered one bit clock after the
Page 2163: Note:    Note as well that there is no need to provide a kernel clock when the SPI/I2S is configured in
Page 2165: In this standard, the WS signal toggles one CK clock cycle before the first bit (MSb in I2S
Page 2168: for the Slave mode) one CK clock cycle before the first bit.
Page 2171: empty. Note that the bit clock CK is activated 4 rising edges before the falling edge of WS in
Page 2172: Note:       Due to clock domain resynchronization, the CSTART bit is taken into account by the
Page 2172: hardware after about 3 periods of CK clock (SYNC_DLY1).
Page 2172: transmission/reception starts one bit clock later.
Page 2172: transmission/reception starts one bit clock later for PCM protocol.
Page 2172: Note:       Due to clock domain resynchronization, the CSTART bit is taken into account by the
Page 2172: hardware after 2 periods of CK clock (SYNC_DLY).
Page 2173: 49.9.9   Clock generator
Page 2173: When the I2S or PCM is configured in master mode, the user needs to program the clock
Page 2173: generator in order to produce the Frame Synchronization (WS), the bit clock (CK) and the
Page 2173: master clock (MCK) at the desired frequency.
Page 2173: If the I2S or PCM is used in slave mode, there is no need to configure the clock generator.
Page 2173: Figure 636. I2S clock generator architecture
Page 2173: and MCKOE. The bit MCKOE indicates if a master clock need to be generated or not. The
Page 2173: master clock has a frequency 256 times higher than the frame synchronization. This master
Page 2173: clock is often required to provide a reference clock to external audio codecs.
Page 2173: Note:    In master mode, there is no specific constraints on the ratio between the bus clock rate
Page 2173: (Fpclk) and the bit clock (FCK). The bus clock frequency must be high enough in order to
Page 2174: When the master clock is generated (MCKOE = 1), the frequency of the frame
Page 2174: When the master clock is disabled (MCKOE = 0), the frequency of the frame
Page 2174: the kernel clock provided to the SPI/I2S block.
Page 2174: Table 404 provides examples of clock generator programming for I2S modes.
Page 2174: The master clock MCK can be generated regardless to the SPE bit. The MCK generating is
Page 2177: hardware after at least 2 periods of CK clock.
Page 2178: transfer with the WS there is still no misalignment risk, and if the amount of bit clock
Page 2179: and the amount of bit clock periods for left channel are not enough to shift-in or shift-out the
Page 2179: 31 clock periods instead of 32.                           33 clock periods instead of 32.
Page 2181: master transmit mode, with a sampling rate of 48 kHz, using the master clock. The
Page 2181: assumption taken is that SPI/I2S is receiving a kernel clock (i2s_clk) of 61.44 MHz from the
Page 2181: clock controller of the circuit.
Page 2181: 1.   Enable the bus interface clock (pclk or hclk), release the reset signal if needed in order
Page 2181: 4.   Program the clock generator in order to provide the MCK clock and to have a frame
Page 2181: 3.   Stop DMA peripheral, bus clock...
Page 2182: master clock. We took the assumption that the SPI/I2S is receiving a kernel clock (i2s_clk)
Page 2182: of 12.288 MHz from the clock controller of the circuit.
Page 2182: 1.   Enable the bus interface clock (pclk or hclk), release the reset signal if needed in order
Page 2182: 4.   Program the clock generator in order to provide the MCK clock, and to have a frame
Page 2183: 1.   Enable the bus interface clock (pclk or hclk), release the reset signal if needed in order
Page 2183: 2.   Stop DMA peripheral, bus clock...
Page 2186: 0: SPI flow/clock generation is continuous, regardless of overrun condition. (data are lost)
Page 2186: bits of next frame are already clocked out due to internal synchronization delay. Once the
Page 2186: clock periods at minimum.
Page 2187: 000: SPI master clock/2
Page 2187: 001: SPI master clock/4
Page 2187: 010: SPI master clock/8
Page 2187: 011: SPI master clock/16
Page 2187: 100: SPI master clock/32
Page 2187: 101: SPI master clock/64
Page 2187: 110: SPI master clock/128
Page 2187: 111: SPI master clock/256
Page 2190: Bit 25 CPOL: clock polarity
Page 2191: Bit 24 CPHA: clock phase
Page 2191: 0: the first clock transition is the first data capture edge
Page 2191: 1: the second clock transition is the first data capture edge
Page 2191: Specifies minimum time delay (expressed in SPI clock cycles periods) inserted between two
Page 2191: 0001: 1 clock cycle period delay
Page 2191: 1111: 15 clock cycle periods delay
Page 2191: Specifies an extra delay, expressed in number of SPI clock cycle periods, inserted
Page 2191: 0001: 1 clock cycle period delay added
Page 2191: 1111: 15 clock cycle periods delay added
Page 2200: Bit 25 MCKOE: master clock output enable
Page 2200: 0: Master clock output is disabled
Page 2200: 1: Master clock output is enabled
Page 2200: Refer to Section 49.9.9: Clock generator for details
Page 2200: Refer to Section 49.9.9: Clock generator for details
Page 2200: Bit 11 CKPOL: serial audio clock polarity
Page 2204: sub-blocks. Each block has it own clock generator and I/O line controller.
Page 2205: •   Clock generator for each audio block to target independent audio frequency sampling
Page 2205: •   Communication clock strobing edge configurable (SCK).
Page 2206: sai_a_     Clock generator                                                                             FS_A
Page 2206: sai_b_     Clock generator                                                                             CK[4:1]
Page 2206: The SAI is mainly composed of two audio sub-blocks with their own clock generator. Each
Page 2207: mode means the SCK_x bit clock and the frame synchronization signal are generated from
Page 2207: controller) is set-up to consume the SCK clock (and so to be in Slave mode).
Page 2207: sai_sync_out_sck,                 Internal clock and frame synchronization output signals
Page 2207: sai_sync_in_sck,                  Internal clock and frame synchronization input signals
Page 2207: Input      Audio block A/B kernel clock.
Page 2207: sai_pclk           Input      APB clock.
Page 2207: SAI_SCK_A/B        Input/output Audio block A/B bit clock.
Page 2207: SAI_MCLK_A/B         Output      Audio block A/B master clock.
Page 2207: SAI_CK[4:1]         Output      PDM bitstream clock.
Page 2207: •     The bit clock and the frame synchronization are output on pin SCK_x and FS_x,
Page 2207: •     If needed, the SAI can also generate a master clock on MCLK_x pin.
Page 2208: SCK clock frequencies. In this case they have to be configured in asynchronous mode.
Page 2208: clock line, data line and synchronization line in slave mode.
Page 2208: In master TX mode, enabling the audio block immediately generates the bit clock for the
Page 2208: block in the same SAI. In this case, the bit clock and the frame synchronization signals are
Page 2209: the bit rate clock frequency.
Page 2210: The audio frame length can be configured to up to 256 bit clock cycles, by setting
Page 2210: ensure that an audio frame contains an integer number of MCLK pulses per bit clock
Page 2210: Section 50.3.8: SAI clock generator”.
Page 2210: The audio frame length is mainly used to specify to the slave the number of bit clock
Page 2211: level of the Frame synchronization signal. The length can be set from 1 to 128 bit clock
Page 2211: channel and half the number for the right channel. If the number of bit clock cycles on half
Page 2211: is sent for transmission for the remaining bit clock cycles in the SAI_xCR2 register.
Page 2211: clock cycles are not considered until the channel side changes.
Page 2215: 50.3.8   SAI clock generator
Page 2215: Each audio sub-block has its own clock generator that makes these two blocks completely
Page 2215: independent. There is no difference in terms of functionality between these two clock
Page 2215: When the audio block is configured as master, the clock generator provides the bit clock
Page 2215: (SCK_x) and the master clock (MCLK_x) for external decoders. The frame synchronization
Page 2215: (FS_x) is also derived from the signals provided by the clock generator. The clock source for
Page 2215: the SAI clock generator (sai_x_ker_ck) is delivered by the product clock controller (RCC).
Page 2215: When the audio block is defined as slave, the clock generator is OFF. The value of NOMCK,
Page 2215: The bit clock strobing edge of (SCK_x) can be configured through CKSTR bit in the
Page 2215: Figure 648 illustrates the architecture of the audio block clock generator.
Page 2215: Figure 648. Audio block clock generator overview
Page 2215: SAI clock generator x
Page 2215: Clock divider                                         0
Page 2215: The NOMCK bit of the SAI_xCR1 register is used to define whether the master clock is
Page 2215: When the SAI is used in master mode, the clock generator configuration differs depending
Page 2215: on whether a master clock (MCLK_x) needs to be provided or not.
Page 2215: If NOMCK is set to 1, the master clock is not generated, and the user has more flexibility to
Page 2215: used to adjust the SCK_x clock to the required frequency.
Page 2215: If NOMCK is set to 0, the master clock is generated, and can be used as reference clock for
Page 2215: the master clock is fixed to 512 or 256, and the frame length must be a power of 2. More
Page 2216: Clock generator programming with MCLK (NOMCK = 0)
Page 2216: The frequency of the bit clock (SCK_x) is given by the following expression:
Page 2216: When MCKDIV division ratio is odd, the duty cycle of MCLK will not be 50%. The bit clock
Page 2216: Clock generator programming without MCLK (NOMCK = 1)
Page 2217: Clock generator programming examples
Page 2217: Table 410. Clock generator programming examples
Page 2217: clock frequency
Page 2219: microphones share the same bitstream clock and data line. Thanks to a configuration pin
Page 2219: provides valid data on SAI_CK[m] falling edge (m being the number of clock lines).
Page 2219: bitstream clock (SAI_CK[m]).
Page 2220: 1.     The PDM interface builds the bitstream clock from the bit clock received from the TDM
Page 2220: accuracy of the bitstream clock.
Page 2221: b)   Enable the bitstream clock needed in the application by setting the corresponding
Page 2221: After 8 SAI_CK clock periods, a data byte coming from each microphone is available, and
Page 2224: Signal transitions occur on the rising edge of the SCK_A bit clock. Signals
Page 2224: are stable on the falling edge of the bit clock.
Page 2224: FSALL            0       Pulse width is one bit clock cycle
Page 2225: NOMCK          1      No need to generate a master clock MCLK
Page 2225: MCKDIV         X      This parameter shall be adjusted to generate the proper bitstream clock
Page 2225: Adjusting the bitstream clock rate
Page 2225: 1.     Adjust the bit clock frequency (FSCK_A) according to the required frequency for the
Page 2225: PDM bitstream clock, using the following formula:
Page 2226: Wanted      bit clock
Page 2226: 1. Refer to Table 411: TDM settings for additional information on TDM configuration. The sai_a_ker_ck clock frequency
Page 2228: (Bit clock provider)
Page 2228: Block B              Clock                                           Sdata_in
Page 2228: Synchronous with       Clock                                          Secondary codec 2
Page 2228: other SAI clocks     generator                    Slave
Page 2228: Clock generator programming in AC’97 mode
Page 2228: 48 kHz. The formulas given in Section 50.3.8: SAI clock generator shall be used with FRL =
Page 2229: •    MODE[1] bit is forced to 0 to select the master mode in order to enable the clock
Page 2229: •    The clock generator must be configured to define the symbol-rate, knowing that the bit
Page 2229: clock should be twice the symbol-rate. The data is coded in Manchester protocol.
Page 2231: Clock generator programming in SPDIF generator mode
Page 2231: For the SPDIF generator, the SAI shall provide a bit clock twice faster as the symbol-rate.
Page 2231: clock rate (FSCK_X) is given by the formula:
Page 2231: And the bit clock rate is obtained as follow:
Page 2236: •      Wrong clock configuration in master mode.
Page 2238: In a noisy environment, glitches on the SCK clock may be wrongly detected by the audio
Page 2239: Wrong clock configuration in master mode (with NOMCK = 0)
Page 2242: Bit 26 OSR: Oversampling ratio for master clock
Page 2242: 0: Master clock frequency = FFS x 256
Page 2242: 1: Master clock frequency = FFS x 512
Page 2242: Bits 25:20 MCKDIV[5:0]: Master clock divider
Page 2242: 000000: Divides by 1 the kernel clock input (sai_x_ker_ck).
Page 2242: Otherwise, The master clock frequency is calculated according to the formula given in
Page 2242: Section 50.3.8: SAI clock generator.
Page 2242: 0: Master clock generator is enabled
Page 2242: 1: Master clock generator is disabled. The clock divider controlled by MCKDIV can still be used to
Page 2242: generate the bit clock.
Page 2242: Note: When the SAI block (A or B) is configured in master mode, the clock must be present on the
Page 2243: Bit 9 CKSTR: Clock strobing edge
Page 2244: Bit 26 OSR: Oversampling ratio for master clock
Page 2244: 0: Master clock frequency = FFS x 256
Page 2244: 1: Master clock frequency = FFS x 512
Page 2244: Bits 25:20 MCKDIV[5:0]: Master clock divider
Page 2244: 000000: Divides by 1 the kernel clock input (sai_x_ker_ck).
Page 2244: Otherwise, The master clock frequency is calculated according to the formula given in
Page 2244: Section 50.3.8: SAI clock generator.
Page 2244: 0: Master clock generator is enabled
Page 2244: 1: Master clock generator is disabled. The clock divider controlled by MCKDIV can still be used to
Page 2244: generate the bit clock.
Page 2245: Note: When the SAI block (A or B) is configured in master mode, the clock must be present on the
Page 2246: Bit 9 CKSTR: Clock strobing edge
Page 2246: clocks immediately.
Page 2252: These bits are set and cleared by software. They specify the length in number of bit clock
Page 2252: of SCK clock cycles: the number of bits in the frame is equal to FRL[7:0] + 1.
Page 2252: In master mode, if the master clock (available on MCLK_x pin) is used, the frame length should be
Page 2252: aligned with a number equal to a power of 2, ranging from 8 to 256. When the master clock is not
Page 2253: These bits are set and cleared by software. They specify the length in number of bit clock
Page 2253: of SCK clock cycles: the number of bits in the frame is equal to FRL[7:0] + 1.
Page 2253: In master mode, if the master clock (available on MCLK_x pin) is used, the frame length should be
Page 2253: aligned with a number equal to a power of 2, ranging from 8 to 256. When the master clock is not
Page 2256: Bit 2 WCKCFGIE: Wrong clock configuration interrupt enable.
Page 2258: Bit 2 WCKCFGIE: Wrong clock configuration interrupt enable.
Page 2260: Bit 2 WCKCFG: Wrong clock configuration flag.
Page 2260: 0: Clock configuration is correct
Page 2260: 1: Clock configuration does not respect the rule concerning the frame length specification defined in
Page 2262: Bit 2 WCKCFG: Wrong clock configuration flag.
Page 2262: 0: Clock configuration is correct
Page 2262: 1: Clock configuration does not respect the rule concerning the frame length specification defined in
Page 2263: Bit 2 CWCKCFG: Clear wrong clock configuration flag.
Page 2264: Bit 2 CWCKCFG: Clear wrong clock configuration flag.
Page 2265: Bit 11 CKEN4: Clock enable of bitstream clock number 4
Page 2265: 0: SAI_CK4 clock disabled
Page 2265: 1: SAI_CK4 clock enabled
Page 2265: Bit 10 CKEN3: Clock enable of bitstream clock number 3
Page 2265: 0: SAI_CK3 clock disabled
Page 2265: 1: SAI_CK3 clock enabled
Page 2266: Bit 9 CKEN2: Clock enable of bitstream clock number 2
Page 2266: 0: SAI_CK2 clock disabled
Page 2266: 1: SAI_CK2 clock enabled
Page 2266: Bit 8 CKEN1: Clock enable of bitstream clock number 1
Page 2266: 0: SAI_CK1 clock disabled
Page 2266: 1: SAI_CK1 clock enabled
Page 2272: clock domain                              spdif_ker_ck clock domain
Page 2272: spdifrx_ker_ck                  Digital input              SPDIFRX kernel clock
Page 2272: spdifrx_pclk                  Digital input              SPDIFRX register interface clock
Page 2274: In order to minimize the DC component value on the transmission line, and to facilitate clock
Page 2275: Bit Clock
Page 2276: spdifrx_ker_ck clock (acquisition clock). A simple filtering is applied in order cancel spurs.
Page 2276: measure the time interval duration. It is clocked by the spdifrx_ker_ck signal. On every
Page 2279: 51.3.4   SPDIFRX tolerance to clock deviation
Page 2279: The SPDIFRX tolerance to clock deviation depends on the number of sample clock cycles in
Page 2283: into the spdifrx_ker_ck clock domain (RX_BUF), and the SPDIFRX_FMTx_DR register. The
Page 2283: the period of spdifrx_pclk clock, and Tspdifrx_ker_ck is the period of spdifrx_ker_ck clock.
Page 2286: spdifrx_ker_ck clock. It represents at most a time interval of 11.6 frames.
Page 2288: 51.3.10          Clocking strategy
Page 2288: The SPDIFRX block needs two different clocks:
Page 2288: •         The APB clock (spdifrx_pclk), which is used for the register interface,
Page 2288: •         The spdifrx_ker_ck which is mainly used by the SPDIFRX_DC part. Those clocks are
Page 2288: not supposed to be phase locked, so all signals crossing those clock domains are re-
Page 2288: the received data with a clock at least 11 times higher than the maximum symbol rate, or
Page 2288: symbol rate to up to 12.288 MHz, the sample rate shall be at least 135.2 MHz. The clock
Page 2291: the minimum clock frequency versus supported audio sampling rate.
Page 2297: This value represents the amount of spdifrx_ker_ck clock periods contained on a length of 5
Page 2308: Refer to the bit SWPSRC in Section 7.7.18: RCC Domain 2 Kernel Clock Configuration
Page 2308: Register (RCC_D2CCIP1R) to select the swpmi_ker_ck (SWPMI core clock source).
Page 2309: swpmi_pclk                      APB clock
Page 2309: swpmi_ker_ck                     SWPMI kernel clock
Page 2326: programmed in the RCC (Reset and Clock Control), according to the following formula:
Page 2334: •   MDC: the Management Data Clock
Page 2335: MDIOS_MDC                         MDIO master clock
Page 2335: mdios_pclk                       APB clock
Page 2336: 1.   MDIOS_MDC: the clock, always driven by the master
Page 2336: clocks. The master can continue to keep MDIO at ‘1’, indicating the “idle” condition, when it
Page 2338: (from the corresponding DOUTn register) to the MDIOS clock domain during the 15th cycle
Page 2338: clock domain. Thus, when a write to DOUTn is ignored (when the value read back is not the
Page 2339: Here is a procedure which can be used if the MDC clock is very slow:
Page 2339: register is set. RDFn becomes ‘1’ at the moment that DOUTn is copied to the MDC clock
Page 2340: clocks).
Page 2352: Max Bus Speed (3)            Max Clock frequency       Signal Voltage
Page 2352: 2. DDR double data rate signaling. (data is sampled on both SDMMC_CK clock edges).
Page 2353: Max bus speed (3)      Max clock frequency     Signal voltage
Page 2353: 2. DDR double data rate signaling. (data is sampled on both SDMMC_CK clock edges).
Page 2353: card such as the clock generation unit, command and data transfer.
Page 2353: •      A delay block (DLYB) taking care of the receive data sample clock alignment. The
Page 2354: sdmmc_ker_ck              Digital input     SDMMC kernel clock
Page 2354: sdmmc_hclk              Digital input     AHB clock
Page 2354: SD/SDIO/e•MMC card feedback clock. This signal is
Page 2354: SD/SDIO/e•MMC card tuned feedback clock after
Page 2354: SDMMC_CK           Digital output Clock to SD/SDIO/e•MMC card
Page 2354: Clock feedback from an external driver for SD/SDIO/e•MMC
Page 2355: SDMMC_CK clock to the card originates from sdmmc_ker_ck:
Page 2355: •     When the sdmmc_ker_ck clock has 50 % duty cycle, it can be used even in bypass
Page 2356: By default, the sdmmc_io_in_ck feedback clock input is selected for sampling incoming
Page 2356: For tuning the phase of the sampling clock to accommodate the receive data timing, the
Page 2356: signal (DLYB input dlyb_in_ck) and sdmmc_fb_ck clock input of SDMMC (DLYB output
Page 2356: dlyb_out_ck). Selecting the sdmmc_fb_ck clock input in the receive path then allows using
Page 2356: the phase-tuned sampling clock for the incoming data. This is required for SDMMC to
Page 2356: clock input can be selected to sample the receive data.
Page 2356: For an SD/SDIO/e•MMC card, the clock frequency can vary between 0 and 208 MHz
Page 2357: SDMMC_D[7:0] lines with each clock cycle. The SDMMC_CMD line transfers only one bit
Page 2357: per clock cycle.
Page 2357: •   Receive data path clock multiplexer
Page 2357: Note:    The adapter registers and FIFO use the AHB clock domain (sdmmc_hclk). The control unit,
Page 2357: command path and data transmit path use the SDMMC adapter clock domain
Page 2357: feedback clock domain from the sdmmc_io_in_ck, or SDMMC_CKIN, or from the
Page 2357: to tune the phase of the sampling clock for incoming data in SDMMC receive mode. It is
Page 2357: SDMMC_CK clock management with divider, and the I/O direction management.
Page 2358: sdmmc_ker_ck        Clock
Page 2358: The clock management subunit uses the sdmmc_ker_ck to generate the SDMMC_CK and
Page 2358: The clock outputs are inactive:
Page 2358: Idle state for eight clock periods. The clock will be stopped eight cycles after both the
Page 2358: The clock will be restarted when the command/response CPSM or data path DPSM is
Page 2358: SDMMC_CMD line. The Command path is clocked on the SDMMC_CK and sends
Page 2358: commands to the card,.The Response path is clocked on the sdmmc_rx_ck and receives
Page 2360: the enable bit (CPSMEN) is set, the CPSM will activate the SDMMC_CK clock (when
Page 2362: Note:       The response timeout has a fixed value of 64 SDMMC_CK clock periods.
Page 2365: data transmit path is clocked on the SDMMC_CK and sends data to the card.The data
Page 2365: receive path is clocked on the sdmmc_rx_ck and receives data from the card. Figure 705
Page 2366: The card data bus width can be programmed in the clock control register bits WIDBUS. The
Page 2366: Next to the data bus width the data sampling mode can be programmed in the clock control
Page 2366: •   Single data rate signaling (SDR), data is clocked on the rising edge of the clock.
Page 2366: •   Double data rate signaling (DDR), data is clocked on the both edges of the clock. DDR
Page 2367: •   On the rising edge of the clock Odd bytes are sampled.
Page 2367: •   On the falling edge of the clock Even bytes are sampled.
Page 2367: –     Odd bits CRC16 clocked on the falling edge of the clock.
Page 2367: –     Even bits CRC16 clocked on the rising edge of the clock.
Page 2367: sampled on the rising edge of the clock.
Page 2367: In DDR mode the SDMMC_CK clock division shall be >= 2.
Page 2367: Figure 706. DDR mode data packet clocking
Page 2367: Figure 707. DDR mode CRC status / boot acknowledgment clocking
Page 2368: When not busy, the DPSM will activate the SDMMC_CK clock (when stopped due to
Page 2368: When busy the DPSM will keep the SDMMC_CK clock active and move to the Busy
Page 2371: Note:    The DPSM remains in the Wait_S state for at least two clock periods to meet the NWR timing
Page 2371: requirements, where NWR is the number of clock cycles between the reception of the card
Page 2375: operates in the AHB clock domain (sdmmc_hclk), all signals from the subunits in the
Page 2375: SDMMC clock domain (SDMMC_CK/sdmmc_rx_ck) are resynchronized.
Page 2378: The CLKMUX selects the source for clock sdmmc_rx_ck to be used with the received data
Page 2378: and command response. The receive data clock source can be selected by the clock control
Page 2378: •    sdmmc_io_in_ck bus master main feedback clock.
Page 2378: •    SDMMC_CKIN external bus feedback clock.
Page 2378: •    sdmmc_fb_ck bus tuned feedback clock.
Page 2378: The sdmmc_fb_ck clock input must be selected when the DLYB block on the device is used
Page 2381: 54.4.8         AHB and SDMMC_CK clock relation
Page 2381: Table 453. AHB and SDMMC_CK clock frequency relation
Page 2381: SDMMC bus         Maximum SDMMC_CK          Minimum AHB clock
Page 2382: •    SDIO read wait operation by stopping the clock
Page 2382: ReadWait SDMMC_CK clock stop (START)                      X        1       0         1        1
Page 2382: ReadWait SDMMC_CK clock stop (STOP)                      X        1       1         1        1
Page 2383: period is synchronous to the SD clock.
Page 2383: •     The interrupt period ends at the next clock from the End bit of a command that
Page 2388: ready the host resumes by restarting clock, see Figure 715.
Page 2388: Figure 715. Clock stop with SDMMC_CK for DS, HS, SDR12, SDR25
Page 2388: SDMMC_CK cycles, after the End bit. When ready the host resumes by restarting clock, see
Page 2388: when the clock line is low.)
Page 2388: Figure 716. Clock stop with SDMMC_CK for DDR50, SDR50, SDR104
Page 2389: In ReadWait SDMMC_CK clock stopping, when RWSTART is set, the DSPM stops the clock
Page 2389: after the End bit of the current received data block CRC. The clock start again after writing 1
Page 2389: the SDMMC_CK clock (see Figure 718).
Page 2390: ReadWait state for two more SDMMC_CK clock cycles to drive SDMMC_D2 to 1 for one
Page 2390: clock cycle (in accordance with SDIO specification), where after the DPSM waits for a Start
Page 2390: clock cycles after the End bit of the Stop Transmission command.
Page 2394: (GO_IRQ_STATE). While waiting for an interrupt response the SDMMC_CK clock signal
Page 2395: If the SDMMC_CMD line is held low for at least 74 clock cycles after card power-up or reset,
Page 2397: 74 clock cycles before CMD0 is issued, the card recognizes that boot mode is being
Page 2397: to be clocked before any command.
Page 2399: In the power-on state the SDMMC_CK clock is running. First 74 SDMMC_CK cycles will be
Page 2399: clocked after which the SDMMC is enabled and command and data can be transfered.
Page 2400: 6.    After the 1ms delay set the SDMMC to power-on state in which the SDMMC_CK clock
Page 2400: clocks   MSv39275V1
Page 2400: clocked by SDMMC_CK are frozen, the AHB interfaces are still alive. The FIFO can thus be
Page 2401: SDMMC_CK      Provide SD clock at 3.3 V                    Provide SD clock at 1.8 V
Page 2402: 4.   The card drives CMD and SDMMC_D[3:0] to low at the next clock after the R1
Page 2402: clock cycles after the Response. The Firmware may read the BUSYD0 register bit
Page 2402: SDMMC_CK clock, which will have a maximum frequency of 25MHz (SD mode), as set by
Page 2402: the clock divider CLKDIV. The >5ms time will be counted by 2^12 cycles (10.24ms @ 400
Page 2402: kHz). If a lower SDMMC_CK frequency is selected by the clock divider CLKDIV the time for
Page 2402: the SDMMC_CK clock to be stopped will be longer.
Page 2402: 25MHz (SD mode), as set by the clock divider CLKDIV. The SDMMC will check the lines
Page 2402: SDMMC_CK frequency is selected by the clock divider CLKDIV the time to check the lines
Page 2403: SDMMC_CKIN feedback input clock
Page 2404: 0: SDMMC_CK clock kept unchanged after successfully received command response.
Page 2404: 1: SDMMC_CK clock stopped after successfully received command response.
Page 2404: 00: After reset, Reset: the SDMMC is disabled and the clock to the Card is stopped,
Page 2404: When written 00, power-off: the SDMMC is disabled and the clock to the card is
Page 2404: 10: Power-cycle, the SDMMC is disabled and the clock to the card is stopped,
Page 2404: 11: Power-on: the card is clocked, The first 74 SDMMC_CK cycles the SDMMC is still
Page 2405: 54.8.2          SDMMC clock control register (SDMMC_CLKCR)
Page 2405: The SDMMC_CLKCR register controls the SDMMC_CK output clock, the sdmmc_rx_ck
Page 2405: receive clock, and the bus width.
Page 2405: Bits 21:20 SELCLKRX[1:0]: Receive clock selection
Page 2405: 00: sdmmc_io_in_ck selected as receive clock
Page 2405: 01: SDMMC_CKIN feedback clock selected as receive clock
Page 2405: 10: sdmmc_fb_ck tuned feedback clock selected as receive clock.
Page 2405: DDR rate shall only be selected with clock division >1. (CLKDIV > 0)
Page 2406: When clock division = 1 (CLKDIV = 0), this bit has no effect. Data and Command change on
Page 2406: When clock division >1 (CLKDIV > 0) & DDR = 0:
Page 2406: When clock division >1 (CLKDIV > 0) & DDR = 1:
Page 2406: For power saving, the SDMMC_CK clock output can be disabled when the bus is idle by
Page 2406: 0: SDMMC_CK clock is always enabled
Page 2406: Bits 9:0 CLKDIV[9:0]: Clock divide factor
Page 2406: This field defines the divide factor between the input clock (sdmmc_ker_ck) and the output
Page 2406: clock (SDMMC_CK): SDMMC_CK frequency = sdmmc_ker_ck / [2 * CLKDIV].
Page 2407: 2      The clock frequency can be changed to the maximum card bus frequency when relative
Page 2407: 3      At least seven sdmmc_hclk clock periods are needed between two write accesses to this
Page 2409: Note:    1       At least seven sdmmc_hclk clock periods are needed between two write accesses to this
Page 2410: The SDMMC_DTIMER register contains the data timeout period, in card bus clock periods.
Page 2411: Data and R1b busy timeout period expressed in card bus clock periods.
Page 2416: The Command Timeout period has a fixed value of 64 SDMMC_CK clock periods.
Page 2419: Bit 26 CKSTOPIE: Voltage Switch clock stopped interrupt enable
Page 2419: Set and cleared by software to enable/disable interrupt caused by Voltage Switch clock
Page 2419: 0: Voltage Switch clock stopped interrupt disabled
Page 2419: 1: Voltage Switch clock stopped interrupt enabled
Page 2421: SDMMC_CK bus clock periods.
Page 2422: Boot acknowledgment timeout period expressed in card bus clock periods.
Page 2428: modules, a shared message RAM and a clock calibration unit. Refer to the memory map for
Page 2428: time, and clock drift compensation. The FDCAN1 contains additional registers, specific to
Page 2428: The common clock calibration unit is optional. It can be used to generate a calibrated clock
Page 2428: fdcan_ker_ck                            CAN subsystem kernel clock input
Page 2428: fdcan_pclk                              CAN subsystem APB interface clock input
Page 2430: fdcan_ker_ck                                / 1..30                                          Clock
Page 2430: Kernel     clock domain
Page 2430: clock domain
Page 2431: •   Two clock domains: APB bus interface and CAN core kernel clock
Page 2432: clock domain
Page 2432: fdcan_pclk                                                                         clock domain
Page 2432: The sync block synchronizes signals from the APB clock domain to the CAN kernel clock
Page 2436: kernel clock frequency. For example, with a FDCAN kernel clock frequency of 20 MHz and
Page 2437: fdcan_tq_ck clock).
Page 2438: FDCAN_CCCR.ASM is also controlled by the clock calibration unit. Wen the clock
Page 2439: The FDCAN can be set into power down mode controlled by clock stop request input via
Page 2439: register FDCAN_CCCR.CSR. As long as the clock stop request is active, bit
Page 2440: FDCAN_CCCR.CSA to 1. In this state, before the clocks are switched off, further register
Page 2440: module clock inputs may be switched off.
Page 2440: To leave power down mode, the application has to turn on the module clocks before
Page 2440: Due to the synchronization mechanism between CAN kernel clock and APB clock domain,
Page 2440: there may be a delay of several APB clock periods between writing to FDCAN_TEST.TX
Page 2441: FDCAN_TSCC.TCP can be configured to clock the counter in multiples of CAN bit times
Page 2442: Note:       The clock signal for the timeout counter is derived from the CAN core sample point signal.
Page 2442: feature in FDCAN is used, the timeout counter is clocked differently in arbitration and data
Page 2455: 55.3.5   Clock calibration on CAN
Page 2455: After device reset the clock calibration unit (CCU) does not provide a valid clock signal to
Page 2455: Clock calibration is bypassed when FDCAN_CCFG.BCC = 1 (see Figure 740).
Page 2456: fdcan_ker_ck                          / 1..30                          Clock
Page 2456: The clock calibration on CAN unit is designed to operate under the following conditions:
Page 2456: •    a CAN kernel clock frequency fdcan_ker_ck up to 80 MHz
Page 2456: The clock calibration on FDCAN unit generates a calibrated time quanta clock fdcan_tq_ck
Page 2456: Note:       The FDCAN requires that the CAN time quanta clock is always below or equal to the APB
Page 2456: clock (fdcan_tq_ck < fdcan_pclk). This has to be considered when the clock calibration on
Page 2456: •    Dynamic clock tolerance at the CAN kernel clock input fdcan_ker_ck
Page 2456: The distance between two calibration messages has to be chosen to fit the clock tolerance
Page 2456: Note:       Dynamic clock tolerance is the clock frequency variation between two calibration messages
Page 2456: Calibration of the time quanta clock fdcan_tq_ck via CAN messages is performed by
Page 2456: adapting a clock divider that generates the CAN protocol time quantum tq from the clock
Page 2456: clock periods. The clock divider (FDCAN_CCFG.CDIV) is updated each time a new
Page 2457: required. Precision calibration is based on the new clock divider value calculated from
Page 2457: with a stable, quartz-controlled clock. calibration frames are detected by the FDCAN1
Page 2458: In case there is only one CAN transmitter with a quartz clock in the network, this node has to
Page 2458: Note:       When the clock calibration on CAN unit transits from state Precision_Calibrated back to
Page 2458: The clock calibration on CAN unit is configured via register FDCAN_CCFG, i.e. when
Page 2458: falling edges at pin FDCAN1_RX is measured. The number of clock periods depends on the
Page 2458: clock frequency applied at input fdcan_ker_ck. In case the measured number of clock
Page 2458: together with the measured number of oscillator clock periods FDCAN_CCU_CSTAT.OCPC
Page 2458: to define the number of oscillator clocks per bit time.
Page 2458: When the clock calibration is bypassed by configuring FDCAN_CCFG.BCC = 1, the internal
Page 2458: clock divider has to be configured via FDCAN_CCFG.CDIV to fulfill the condition
Page 2458: Note:       When clock calibration on CAN is active (FDCAN_CCFG.BCC = 0), the baudrate prescalers
Page 2458: The status of the clock calibration on CAN unit can be monitored by reading register
Page 2458: FDCAN_CCU_CSTAT. When in state Precision_Calibrated the oscillator clock period
Page 2458: counter FDCAN_CCU_CSTAT.OCPC signals the number of oscillator clock periods in the
Page 2459: Clock calibration bypassed
Page 2459: The CCU internal clock divider is configured for division by one
Page 2459: (FDCAN_CCFG.CDIV = 0x0000). In this operation mode the input clock fdcan_ker_ck is
Page 2459: directly routed to the clock output fdcan_tq_ck. In this case fdcan_tq_ck is independent from
Page 2459: The clock calibration on CAN unit also supports software calibration of fdcan_ker_ck by
Page 2459: fixed to 1, the clock from fdcan_ker_ck is routed to output fdcan_tq_ck
Page 2459: The input clock fdcan_ker_ck must be in the range between 80MHz and 100 MHz. The
Page 2459: clock divider of CCU has to be configured via FDCAN_CCFG.CDIV to bring fdcan_tq_ck to
Page 2459: correct operation of tFDCAN1and FDCAN2, the APB clock fdcan_pclk needs to be equal or
Page 2459: higher than the time quanta clock (fdcan_tq_ck). CAN FD operation is not possible.
Page 2459: (FDCAN_CCCR.ASM = 1) before FDCAN_CCCR.INIT is reset. The input clock
Page 2459: fdcan_ker_ck has to be adjusted until the clock calibration on CAN unit has reached state
Page 2459: During operation the software has to check regularly whether the clock calibration on CAN
Page 2459: unit is still in state Precision_Calibrated. In case the clock calibration on CAN unit has left
Page 2459: successfully (clock calibration on CAN unit is in state Precision_Calibrated), FDCAN1 and
Page 2459: Note:    Trimming accuracy needs to be to sufficient to meet the CAN clock tolerance requirements
Page 2459: Clock calibration active
Page 2459: FDCAN1. Input clock fdcan_ker_ck must be in the range between 80 and 100 MHz.
Page 2460: external clock synchronization is not available in level 1. The information related to the
Page 2461: NTU = CAN clock period x TUR.
Page 2462: 0x10000, resulting in an NTU consisting of sixteen CAN clock periods. Local time and
Page 2462: In TTCAN level 0 and level 2 the clock calibration process adapts FDCAN_TURNA.NAV in
Page 2462: (SDL = 2 (FDCAN_TTOCF.LDSDL + 5)) and should not exceed the clock tolerance given by
Page 2463: FDCAN_TTOCF.EECS to be set (external clock synchronization enabled) while the FDCAN
Page 2463: the CAN clock domain. There is a clock domain crossing delay to be considered before the
Page 2463: same event is visible in the APB clock domain (when FDCAN_TTIR.TTMI is set or
Page 2463: completed (either transmitted or received). The output is controlled in the APB clock
Page 2463: depending on the expected clock drift between the potential time masters in the network.
Page 2463: even with maximum clock drift.
Page 2464: FDCAN_TTOCF.EECS enables the external clock synchronization, allowing the application
Page 2464: operation, to adapt the clock speed and (in levels 0 and level 2 only) the global clock phase
Page 2467: •    APB clock frequency
Page 2471: and external clock synchronization
Page 2471: external clock synchronization. In both levels, all timing features are based on a local
Page 2471: NTU. If the length of the NTU is shorter than eight CAN clock periods (as may be configured
Page 2471: in level 1, or as a result of clock calibration in level 2), the length of the NTU fraction is
Page 2472: time and Ref_Mark, both synchronized into the APB clock domain and truncated to 16 bit.
Page 2472: synchronized into the APB clock domain and truncated to 16 bit. The fractional part is used
Page 2472: for clock synchronization only.
Page 2473: subject to small adjustments, due to clock drift, when another node becomes time master, or
Page 2473: the drift between its own local clock and the time master clock by comparing the length of a
Page 2473: The current time master may synchronize its local clock speed and the global time phase to
Page 2473: an external clock source. This is enabled by bit FDCAN_TTOCF.EECS.
Page 2473: difference in clock speed between the local clock and the external clock. The local clock
Page 2479: stable clock calibration. There are no further TT-error-checks.
Page 2492: programmed in the range from 1 to 32 FDCAN clock periods. tq = (DBRP + 1) FDCAN clock
Page 2493: at the first clock edge after the sample point.
Page 2493: Note:           With a FDCAN clock of 8 MHz, the reset value 0x00000A33 configures the FDCAN for a fast
Page 2494: FDCAN_IR.WDI bit is set. The RAM watchdog counter is clocked by the fdcan_pclk clock.
Page 2496: Bit 4 CSR: Clock stop request
Page 2496: 0: No clock stop is requested
Page 2496: 1: Clock stop requested. When clock stop is requested, first INIT and then CSA will be set
Page 2496: Bit 3 CSA: Clock stop acknowledge
Page 2496: 0: No clock stop acknowledged
Page 2496: 1: FDCAN may be set in power down by stopping APB clock and kernel clock
Page 2496: If the FDCAN is connected to a clock calibration on CAN unit, ASM bit is set by hardware
Page 2496: Note:       Due to the synchronization mechanism between the two clock domains, there may be a
Page 2497: in the range of [1 … 1024] FDCAN kernel clock periods.
Page 2497: tq = (BRP + 1) FDCAN clock period fdcan_tq_ck
Page 2497: at the first clock edge after the sample point.
Page 2497: Note:         With a CAN kernel clock of 8 MHz, the reset value of 0x00000A33 configures the FDCAN
Page 2532: Bit 25 ECC: Enable clock calibration.
Page 2532: 0: Automatic clock calibration in FDCAN level 0, 2 is disabled
Page 2532: 1: Automatic clock calibration in FDCAN level 0, 2 is enabled
Page 2533: Bit 15 EECS: Enable external clock synchronization
Page 2533: 0: External clock synchronization in FDCAN level 0, 2 disabled
Page 2533: 1: External clock synchronization in FDCAN level 0, 2 enabled
Page 2533: clock tolerance given by the CAN bit timing configuration.
Page 2534: The length of the NTU is given by: NTU = CAN clock period x NC/DC.
Page 2535: The actual value of FDCAN_TUR may be changed by the clock drift compensation function
Page 2535: until the new value has been synchronized into the CAN clock domain. During this
Page 2535: with FDCAN_TURCF.ELT = 0 or if FDCAN_TTOCF.EECS (external clock synchronization
Page 2536: synchronized into the CAN clock domain.
Page 2537: Bit 1 ECS: External clock synchronization.
Page 2537: is reset after one APB clock period. The external clock synchronization takes effect at the
Page 2537: is reset after one APB clock period. The global time preset takes effect when the node
Page 2538: synchronized into the CAN clock domain.
Page 2545: Bit 30 WECS: Wait for external clock synchronization.
Page 2545: 0: No external clock synchronization pending
Page 2545: 1: Node waits for external clock synchronization to take effect. The bit is reset at the start
Page 2546: between Host and CAN clock domain. For time slaves the value configured by
Page 2546: Bit 7 QCS: Quality of clock Speed.
Page 2546: 0: Local clock speed not synchronized to time master clock speed
Page 2546: the drift between the node local clock and the time master local clock is calculated. The drift
Page 2547: Section 55.3.11: Local time, cycle time, global time, and external clock synchronization).
Page 2547: Local time, cycle time, global time, and external clock synchronization).
Page 2548: Section 55.3.11: Local time, cycle time, global time, and external clock synchronization).
Page 2556: 55.5.1          Clock calibration unit core release register (FCCAN_CCU_CREL)
Page 2557: Bits 19:16 CDIV[3:0]: Clock Divider
Page 2557: The clock divider has to be configured when the clock calibration is bypassed (BCC = 1)
Page 2557: Bits 15:8 OCPM[7:0]: Oscillator clock periods minimum
Page 2557: Bit 6 BCC: Bypass clock calibration
Page 2557: If this bit is set, the clock input fdcan_ker_ck is routed to the time quanta clock through a
Page 2557: clock divider configurable via CDIV, cu_cok is always 1. In this case the baudrate
Page 2557: time quanta clock.
Page 2557: 0: Clock calibration unit generates time quanta clock
Page 2557: 1: Clock calibration unit bypassed (default configuration)
Page 2557: Note: As long as fdcan_ker_ck is equal or above 80 MHz the clock calibration on CAN
Page 2558: and FDCAN2. The range of the resulting time quanta clock fdcan_tq_ck is from 0.5 MHz
Page 2558: clock calibration unit is in state Precision_Calibrated.
Page 2558: Bits 17:0 OCPC[17:0]: Oscillator clock period counter
Page 2558: Captured number of oscillator clock periods in calibration field (32 or 64 bits). Only valid
Page 2558: when the clock calibration unit is in state Precision_Calibrated.
Page 2559: 55.5.5        Clock calibration unit interrupt register (FCCAN_CCU_IR)
Page 2560: 55.5.6          Clock calibration unit interrupt enable register (FCCAN_CCU_IE)
Page 2564: of clock domains internal to the digital core, PHY and DFIFO power management.
Page 2568: OTG_HS_ULPI_CK         Digital input       USB OTG ULPI clock
Page 2568: The USB OTG receives the 48 MHz clock from the reset and clock controller (RCC). The
Page 2568: USB clock is used for driving the 48 MHz domain at full-speed (12 Mbit/s) and must be
Page 2578: Such utilities are especially useful for adaptive audio clock generation techniques, where
Page 2579: In host mode the number of PHY clocks occurring between the generation of two
Page 2580: •   Stop PHY clock (STPPCLK bit in OTG_PCGCCTL)
Page 2580: When setting the stop PHY clock bit in the clock gating control register, most of the
Page 2580: 48 MHz clock domain internal to the OTG full-speed core is switched off by clock
Page 2580: gating. The dynamic power consumption due to the USB clock switching activity is cut
Page 2580: even if the 48 MHz clock input is kept running by the application
Page 2580: When setting the Gate HCLK bit in the clock gating control register, most of the system
Page 2580: clock domain internal to the OTG_HS core is switched off by clock gating. Only the
Page 2580: the USB clock switching activity is cut even if the system clock is kept running by the
Page 2580: clock sources in the system. USB System Stop is activated by first setting the Stop
Page 2580: PHY clock bit and then configuring the system deep sleep mode in the power control
Page 2580: The OTG_HS core automatically reactivates both system and USB clocks by
Page 2580: To save dynamic power, the USB data FIFO is clocked only when accessed by the OTG_HS
Page 2588: •    Power and clock-gating registers
Page 2588: Only the core global, power and clock-gating, data FIFO access, and host port control and
Page 2588: implemented in the AHB clock domain.
Page 2593: Power and clock gating CSR map
Page 2593: There is a single register for power and clock gating. It is available in both host and device
Page 2593: Table 497. Power and clock gating control and status registers
Page 2593: Section 56.14.62: OTG power and clock gating control
Page 2601: Bit 19 ULPICSM: ULPI clock SuspendM
Page 2601: This bit sets the ClockSuspendM bit in the interface control register on the ULPI PHY. This bit
Page 2601: 0: PHY powers down the internal clock during suspend
Page 2601: 1: PHY does not power down the internal clock
Page 2601: Bit 15 PHYLPC: PHY Low-power clock select
Page 2601: PHY can usually operate on a 48 MHz clock to save power.
Page 2601: 0: 480 MHz internal PLL clock
Page 2601: 1: 48 MHz external clock
Page 2601: These bits allows to set the turnaround time in PHY clocks. They must be configured
Page 2602: The number of PHY clocks that the application programs in this field is added to the full-
Page 2602: times added per PHY clock is 0.25 bit times.
Page 2603: this bit before performing any operations. This bit takes eight clocks to clear, using the slower
Page 2603: clock of phy_clk or hclk.
Page 2604: bit requires 8 clocks (slowest of PHY or AHB clock) to clear.
Page 2604: Resets the HCLK and PHY clock domains as follows:
Page 2604: several clocks, depending on the current state of the core. Once this bit has been cleared,
Page 2604: the software must wait at least 3 PHY clocks before accessing the PHY domain
Page 2604: When you change the PHY, the corresponding clock for the PHY is selected and used in the
Page 2604: PHY domain. Once a new clock is selected, the PHY domain has to be reset for proper
Page 2621: timer has expired. To stop the PHY clock, the application must set the STPPCLK bit in
Page 2625: Bits 1:0 FSLSPCS[1:0]: FS/LS PHY clock select
Page 2625: 01: PHY clock is running at 48 MHz
Page 2625: 01: Select 48 MHz PHY clock frequency
Page 2625: 10: Select 6 MHz PHY clock frequency
Page 2626: PHY clocks that constitute the required frame interval. The application can write a value to
Page 2626: based on the PHY clock specified in the FS/LS PHY clock select field of the host
Page 2626: terms of the number of PHY clocks) in the current frame.
Page 2626: Indicates the amount of time remaining in the current frame, in terms of PHY clocks. This
Page 2626: field decrements on each PHY clock. When it reaches zero, this field is reloaded with the
Page 2630: SOFs when this is set. To stop the PHY clock, the application must set the port clock stop
Page 2640: accommodate clock jitter, it is recommended that the application add some extra delay to
Page 2641: 11: Full speed (PHY clock is running at 48 MHz)
Page 2645: VBUS discharge time in PHY clocks / 1 024
Page 2646: VBUS pulsing time in PHY clocks / 1 024
Page 2666: 56.14.62 OTG power and clock gating control register (OTG_PCGCCTL)
Page 2666: Bit 5 ENL1GTG: Enable sleep clock gating
Page 2666: When this bit is set, core internal clock gating is enabled in Sleep state if the core cannot
Page 2666: assert utmi_l1_suspend_n. When this bit is not set, the PHY clock is not gated in Sleep
Page 2666: Bit 0 STPPCLK: Stop PHY clock
Page 2666: The application sets this bit to stop the PHY clock when the USB is suspended, the session
Page 2678: 10. Program the HFIR register with a value corresponding to the selected PHY clock 1
Page 2729: clock frequency.
Page 2729: next token could come sooner. This worst case value is 7 PHY clocks when the AHB clock
Page 2729: is the same as the PHY clock. When the AHB clock is faster, this value is smaller.
Page 2729: clocks after it has received an IN token, to get the FIFO status, and thus the first data from
Page 2729: clocks. The worst case delay for this is when the AHB clock is the same as the PHY clock.
Page 2729: In this case, the delay is 5 clocks.
Page 2730: AHB clock by the PFC (the PFC runs on the AHB clock). The PFC then reads the data from
Page 2730: the SPRAM and writes them into the dual clock source buffer. The MAC then reads the data
Page 2737: •   IEEE 1588-2008 for precision networked clock synchronization (PTP)
Page 2742: eth_hclk                  Digital input   AHB clock
Page 2742: eth_mii_tx_clk              Digital input   MII Tx kernel clock
Page 2742: eth_mii_rx_clk              Digital input   MII Rx kernel clock
Page 2742: eth_rmii_ref_clk             Digital input   RMII reference kernel clock
Page 2743: 2. Refer to RCC chapter "Clock distribution for Ethernet" for a detailed description of the Ethernet clock architecture.
Page 2750: the data to be transferred between the application clock and MAC clock domains. The MTL
Page 2766: synchronization of clocks in measurement and control systems implemented with
Page 2766: systems that include clocks of varying inherent precision, resolution, and stability to
Page 2766: microsecond range with minimal network and local clock computing resources.
Page 2767: •   Optional snapshot based on the clock type: ordinary, boundary, end-to-end
Page 2767: •   Optional selection of the node to act as master or slave for ordinary and boundary clock
Page 2767: timing and clock information. Figure 782 shows the process that PTP uses for synchronizing
Page 2767: Master clock time                        Slave clock time
Page 2767: slave clock
Page 2768: Peer-to-peer PTP transparent clock (P2P TC) message support
Page 2768: method to calculate the propagation delay in clocks supporting peer-to-peer path correction.
Page 2768: Figure 783. Propagation delay calculation in clocks supporting
Page 2769: Clock types
Page 2769: The MAC supports the following clock types defined in the IEEE 1588-2008 specifications:
Page 2769: •    Ordinary clock
Page 2769: The ordinary clock of a domain supports a single copy of the protocol. It has a single
Page 2769: ordinary clock is associated with an application device such as a sensor or an actuator.
Page 2769: In telecom applications, the ordinary clock can be associated with a timing demarcation
Page 2769: The ordinary clock can be a grandmaster or a slave clock. It supports the following
Page 2769: Table 510. Ordinary clock: PTP messages for snapshot
Page 2769: For an ordinary clock, you can take the snapshot of either of the following PTP
Page 2769: •    Boundary clock
Page 2769: The boundary clock typically has several physical ports which communicate with the
Page 2769: signaling end in the protocol engine of the boundary clock. Such messages are not
Page 2770: The boundary clock is similar to the ordinary clock except for the following features:
Page 2770: –   The clock data sets are common to all ports of the boundary clock.
Page 2770: –   The local clock is common to all ports of the boundary clock.
Page 2770: •   End-to-end transparent clock
Page 2770: The end-to-end transparent clock supports the end-to-end delay measurement
Page 2770: mechanism between the slave clocks and the master clock. The end-to-end
Page 2770: transparent clock forwards all messages like normal bridge, router, or repeater. The
Page 2770: The residence time of a SYNC packet inside the end-to-end transparent clock is
Page 2770: transparent clock, is updated in the correction field of the associated Delay_Resp PTP
Page 2770: SYNC packet inside the end-to-end transparent clock is updated in the correction field
Page 2770: residence time of a Delay_Req packet, inside the end-to-end transparent clock, is
Page 2770: Table 511. End-to-end transparent clock: PTP messages for snapshot
Page 2770: •   Peer-to-peer transparent clock
Page 2770: The peer-to-peer transparent clock differs from the end-to-end transparent clock in the
Page 2770: identical to the end-to-end transparent clock.
Page 2770: In the peer-to-peer transparent clock, the computation of the link delay is based on an
Page 2771: Table 512. Peer-to-peer transparent clock: PTP messages for snapshot
Page 2771: The MAC clock input is uses to generate the reference time (also called the system time)
Page 2772: The 64-bit PTP time is updated using the PTP input reference clock, HCLK. This PTP time
Page 2773: In the Fine correction method, the slave clock (reference clock) frequency drift with respect
Page 2773: to the master clock (as defined in IEEE 1588 specifications) is corrected over a period of
Page 2773: time, unlike in the Coarse correction method where it is corrected in a single clock cycle.
Page 2773: The System Time Update logic requires a 50 MHz clock frequency to achieve 20 ns
Page 2773: accuracy. The frequency division is the ratio of the reference clock frequency to the required
Page 2773: clock frequency. For example, if the reference clock (HCLK) is 66 MHz, this ratio is
Page 2773: If the reference clock drifts lower, for example, to 65 MHz, the ratio is 65 / 50, that is 1.3 and
Page 2774: If the clock drifts higher, for example to 67 MHz, the addend register must be set to
Page 2774: 0xBF0B7672. When there is not clock drift, the default addend value of 0xC1F07C1F
Page 2774: Initially, the slave clock is set with FreqCompensationValue0 in the Addend register. This
Page 2774: occurs. The slave clock can then determine a precise MasterToSlaveDelay value and re-
Page 2774: 1.    At time MasterSyncTimen the master sends the slave clock a SYNC message. The
Page 2774: slave receives this message when its local clock is SlaveClockTimen and computes
Page 2774: MasterClockTimen as follows:
Page 2774: MasterClockTime n = MasterSyncTime n + MasterToSlaveDelay n
Page 2774: 2.    The master clock counts for current Sync cycle, MasterClockCountn is
Page 2774: MasterClockCount n = MasterClockTime n – MasterClockTime n-1
Page 2774: 3.    The slave clock count for current Sync cycle, SlaveClockCountn is
Page 2774: SlaveClockCount n = SlaveClockTime n – SlaveClockTime n-1
Page 2774: 4.    The difference between master and slave clock counts for current Sync cycle,
Page 2774: ClockDiffCountn is
Page 2774: ClockDiffCount n = MasterClockTime n – SlaveClockTime n
Page 2774: 5.    The frequency-scaling factor for slave clock, FreqScaleFactorn is
Page 2774: FreqScaleFactor n = ( MasterClockCount n + ClockDiffCount n ) ⁄ SlaveClockCount n
Page 2775: algorithm is self-correcting. If the slave clock is initially set to an incorrect value from the
Page 2775: the reference timing source (the PTP clock HCLK) is different from the MAC Tx or Rx clock,
Page 2792: The MAC initiates the management write or read operation with respect to the MDC clock.
Page 2792: The MDC clock is derived from the CSR clock. The division factor depends on the clock
Page 2792: range setting in the MDIO address register (ETH_MACMDIOAR) register. The MDC clock is
Page 2792: Table 520. MCD clock selection
Page 2792: Selection                        CSR clock                           MDC clock
Page 2792: 0000                          60–100 MHz                        CSR clock/42
Page 2792: 0001                         100–150 MHz                        CSR clock/62
Page 2792: 0010                           20–35 MHz                        CSR clock/16
Page 2792: 0011                           35–60 MHz                        CSR clock/26
Page 2792: 0100                         150–250 MHz                        CSR clock/102
Page 2792: 0101                         250–300 MHz                        CSR clock/124
Page 2792: IDLE                    The MDIO line is three-state; there is no clock on ETH_MDC.
Page 2794: •   TX_CLK: continuous clock that provides the timing reference for Tx data transfers. The
Page 2794: •   RX_CLK: continuous clock that provides the timing reference for Rx data transfers. The
Page 2795: to the Tx and Rx clocks. In full duplex mode the state of this signal is don’t care for the
Page 2795: required to transition synchronously with respect to the Tx and Rx clocks. In full-duplex
Page 2795: must be deasserted prior to the first clock cycle that follows the final nibble. In order to
Page 2795: This signal must be asserted for one or more clock periods (RX_CLK) to indicate to the
Page 2796: •   Provides independent 2-bits wide Transmit and Receive paths by sourcing two clock
Page 2809: Transmit and Receive clocks are running when the link is down
Page 2809: Complete the following steps when the link is down while the Transmit and Receive clocks
Page 2810: Transmit and Receive clocks are stopped when the link is down
Page 2810: Complete the following steps when the link is down and the Transmit and Receive clocks
Page 2810: clocks are absent.
Page 2810: 2.   Wait till the link is up and the clocks are restored.
Page 2810: Transmit/Receive clock is stopped. This can be checked by reading the Debug register
Page 2810: 3.   Program Sub-second increment register (ETH_MACSSIR) based on the PTP clock
Page 2811: RX_CLK_stoppable bit that indicates to the PHY whether to stop Rx clock in LPI mode
Page 2811: frequency of the clock used for accessing the CSR slave port.
Page 2812: frequency of the clock used to access the CSR slave port.
Page 2824: transmit clock periods during packet transmission). This is valid only for
Page 2833: – 0001: SYNC (all clock types)
Page 2833: – 0010: Follow_Up (all clock types)
Page 2833: – 0011: Delay_Req (all clock types)
Page 2833: – 0100: Delay_Resp (all clock types)
Page 2833: – 0101: Pdelay_Req (in peer-to-peer transparent clock)
Page 2833: – 0110: Pdelay_Resp (in peer-to-peer transparent clock)
Page 2833: – 0111: Pdelay_Resp_Follow_Up (in peer-to-peer transparent clock)
Page 2842: in all clock domains. Before reprogramming any register, a value of zero should be read in this
Page 2842: Note: The reset operation is complete only when all resets in all active clock domains are de-
Page 2842: asserted. Therefore, it is essential that all PHY inputs clocks (applicable for the selected
Page 2842: software reset operation depends on the frequency of the slowest active clock.
Page 2858: This field indicates the number of system clock cycles, multiplied by factor indicated in RWTU
Page 2867: When this bit is set, all counters are reset. This bit is cleared automatically after 1 clock cycle.
Page 2869: operation, the PHY Tx clock (eth_mii_tx_clk) should be active.
Page 2882: When this bit is set, the MAC operates in the loopback mode at MII. The MII Rx clock input
Page 2882: (eth_mii_rx_clk) is required for the loopback to work properly. This is because the Tx clock is
Page 2891: If the Hash Table register is configured to be double-synchronized to the MII clock domain,
Page 2892: If the Hash Table register is configured to be double-synchronized to the MII clock domain,
Page 2895: If the VLAN Hash Table register is configured to be double-synchronized to the MII clock
Page 2899: Pause Time bits are configured to be double-synchronized to the (G)MII clock domain,
Page 2899: consecutive writes to this register should be performed only after at least four clock cycles in
Page 2899: the destination clock domain.
Page 2904: for one or more transmission clock periods during packet transmission. This bit is valid only
Page 2905: automatically cleared after 1 clock cycle.
Page 2906: Note: You can gate-off the CSR clock during the power-down mode. However, when the CSR
Page 2906: clock is gated-off, you cannot perform any read or write operations on this register.
Page 2911: duration, such as, less than three clock cycles of CSR clock.
Page 2911: duration, such as, less than three clock cycles of CSR clock.
Page 2912: The application must program this counter so that the number of clock cycles of CSR clock is
Page 2912: For example if the CSR clock is 100 MHz then this field needs to be programmed to
Page 2919: completion of a read or write command at the end of frame transfer (before the trailing clocks
Page 2919: immediately irrespective of the number trailing clocks generated for the previous frame.
Page 2919: after the trailing clocks are generated. In this mode, it is ensured that the NTC is always
Page 2919: Bits 14:12 NTC[2:0]: Number of Training Clocks
Page 2919: This field controls the number of trailing clock cycles generated on ETH_MDC after the end
Page 2919: to 3'h3 indicates that there are additional three clock cycles on the MDC line after the end of
Page 2920: Bits 11:8 CR[3:0]: CSR Clock Range
Page 2920: The CSR Clock Range selection determines the frequency of the MDC clock according to the
Page 2920: CSR clock frequency used in your design:
Page 2920: 0000: CSR clock = 60-100 MHz; MDC clock = CSR clock/42
Page 2920: 0001: CSR clock = 100-150 MHz; MDC clock = CSR clock/62
Page 2920: 0010: CSR clock = 20-35 MHz; MDC clock = CSR clock/16
Page 2920: 0011: CSR clock = 35-60 MHz; MDC clock = CSR clock/26
Page 2920: 0100: CSR clock = 150-250 MHz; MDC clock = CSR clock/102
Page 2920: 0101: CSR clock = 250-300 MHz; MDC clock = CSR clock/124
Page 2920: The suggested range of CSR clock frequency applicable for each value (when Bit 11 = 0)
Page 2920: ensures that the MDC clock is approximately between 1.0 MHz to 2.5 MHz frequency range.
Page 2920: When Bit 11 is set, you can achieve a higher frequency of the MDC clock than the frequency
Page 2920: limit of 2.5 MHz (specified in the IEEE 802.3) and program a clock divider of lower value. For
Page 2920: example, when CSR clock is of 100 MHz frequency and you program these bits as 1010, the
Page 2920: resultant MDC clock is of 12.5 MHz which is above the range specified in IEEE 802.3.
Page 2920: Program the following values only if the interfacing chips support faster MDC clocks:
Page 2920: 1000: CSR clock/4
Page 2920: 1001: CSR clock/6
Page 2920: 1010: CSR clock/8
Page 2920: 1011: CSR clock/10
Page 2920: 1100: CSR clock/12
Page 2920: 1101: CSR clock/14
Page 2920: 1110: CSR clock/16
Page 2920: 1111: CSR clock/18
Page 2922: If the MAC address registers are configured to be double-synchronized to the MII clock
Page 2922: performed after at least four clock cycles in the destination clock domain.
Page 2925: to the CNTPRSTLVL bit. This bit is cleared automatically after 1 clock cycle.
Page 2926: When this bit is set, all counters are reset. This bit is cleared automatically after 1 clock cycle.
Page 2942: selecting the Synchronize Layer 3 and Layer 4 Address Registers to Rx Clock Domain
Page 2942: at least four clock cycles delay of the destination clock.
Page 2947: must be programmed correctly depending on the PTP reference clock frequency and the
Page 2948: ETH_MACTSCR register, the value in this register is added to the system time every clock
Page 2949: The value programmed in this field is accumulated every clock cycle (of clk_ptp_i) with the
Page 2949: contents of the sub-second register. For example, when the PTP clock is 50 MHz (period is
Page 2950: on a continuous basis, there is some delay from the actual time because of clock domain
Page 2950: transfer latencies (from HCLK to CSR clock).
Page 2952: The content of this register is added to a 32-bit accumulator in every clock cycle (of HCLK)
Page 2953: means that corresponding auxiliary triggers were sampled at the same clock. These bits are
Page 2961: values of PPSCTRL, the PPS output becomes a generated clock of following frequencies:
Page 2961: average number. The actual clock is of different frequency that gets synchronized every
Page 2961: One clock of 50 percent duty cycle and 537 ms period
Page 2961: Second clock of 463 ms period (268 ms low and 195 ms high)
Page 2961: Three clocks of 50 percent duty cycle and 268 ms period
Page 2961: Fourth clock of 195 ms period (134 ms low and 61 ms high)
Page 2963: the command is transferred or synchronized to the PTP clock domain, these bits get cleared
Page 2964: MAC to synchronize the Target Time Registers to the PTP clock domain.
Page 2964: The MAC clears this bit after synchronizing the Target Time Registers to the PTP clock
Page 2965: reference clock is 50 MHz (period of 20 ns), and desired interval between the rising edges of
Page 2965: clock is 50 MHz (period of 20 ns), and width between the rising and corresponding falling
Page 2966: programmed or trigger from application, when the MAC is programmed to be in Clock Master
Page 2978: •   Independent 32 kHz CEC kernel (refer to Section RCC kernel clock distribution)
Page 2979: cec_pclk         Digital input    APB clock
Page 2979: cec_ker_ck         Digital input    HDMI-CEC kernel clock
Page 2998: when the processor is switched off or clock-stopped.
Page 3000: JTCK/SWCLK                I       JTAG test clock               I       Serial wire clock         PA14
Page 3000: TRACECK                       O    Trace clock
Page 3001: 59.3.3            Debug infrastructure powering, clocking and reset
Page 3002: Clock domains
Page 3002: Figure 817. Clock domains of debug infrastructure
Page 3002: The debugger supplies the clock for the debug port, SWTCLK, via the debug interface pin,
Page 3002: JTCK/SWCLK. This clock is used to register the serial input data in both serial wire and
Page 3002: CK_DBG_D3 clocks the SWO and serial wire trace funnel.
Page 3002: Both DAPCLK and CK_DBG_D3 are gated versions of the D3 domain system clock
Page 3002: CK_DBG_D1 clocks the trace components in the D1 power domain: System ROM table 2,
Page 3002: system clock (CK_HCLK_D1).
Page 3002: TRACECLK is the trace port output clock. It is a gated version of the system clock
Page 3002: (CK_SYS), except when the PLL1 is the source for the system clock. In this case,
Page 3002: All the debug clocks (except DAPCLK) can be enabled and disabled by register bits in the
Page 3003: bit in the debug port CTRL/STAT register. The clock must be enabled before the debugger
Page 3003: clocked with the corresponding core clock (CK_CORE_D1).
Page 3003: switched off or stopped when not required. If a power domain is switched off or not clocked,
Page 3003: domain still enters power saving mode, but its clock and power are maintained. In other
Page 3003: •   a 2-pin (clock + data) “serial-wire” debug port (SW-DP)
Page 3004: •      SWCLK: clock from host to target
Page 3004: Serial data is transferred LSB first, synchronously with the clock. A transfer comprises three
Page 3004: Between each phase, if the direction of the data is reversed, a single clock cycle turn-
Page 3031: and interpolated to increase its resolution if the processor clock is significantly faster than
Page 3031: the generator clock. The timestamp distribution is shown in Figure 822.
Page 3031: (low-frequency clock)          (Cortex-M7 clock)
Page 3034: This field must be programmed with the trace generator clock frequency whenever it
Page 3083: Bit 5 CLKSCHEM: RAM clocking scheme (synchronous or asynchronous)
Page 3090: The trace port is a synchronous parallel port, comprising a clock output, TRACECK, and
Page 3101: Bit 9 TCLKDATA: Support of trace clock plus data
Page 3101: Bit 5 CLKRELAT: ATB clock and TRACECLKIN relation
Page 3101: Indicates the relationship between the ATB clock and TRACECLKIN (synchronous or
Page 3109: The baud rate is the trace clock frequency divided by (PRESCALER - 1). The baud rate
Page 3113: Bit 9 TCLKDATA: Trace clock plus data support
Page 3113: Indicates whether trace clock plus data is supported
Page 3113: Bit 5 CLKRELAT: ATB clock to TRACECLKIN relation
Page 3113: Indicates the relationship between the ATB clock and TRACECLKIN (synchronous or
Page 3131: The DBGMCU component contains a number of registers that control the power and clock
Page 3131: •          maintain the clock and power to the processor cores when in low-power modes (sleep,
Page 3131: •          maintain the clock and power to the system debug and trace components when in low
Page 3131: •          stop the clock to certain peripherals (CAN, SMBUS timeout, Watchdogs, Timers, RTC)
Page 3132: Bit 22 D3DBGCKEN: D3 debug clock enable
Page 3132: 0: Disabled - D3 domain debug components are disabled and their clocks gated
Page 3132: 1: Enabled - D3 domain debug components are clocked whenever the corresponding domain
Page 3132: clock (CK_HCLK_D3) is active
Page 3132: Bit 21 D1DBGCKEN: D1 debug clock enable
Page 3132: 0: Disabled - D1 domain debug components are disabled and their clocks gated
Page 3132: 1: Enabled - D1 domain debug components are clocked whenever the corresponding domain
Page 3132: clock (CK_HCLK_D1) is active
Page 3132: Bit 20 TRACECLKEN: Trace port clock enable
Page 3132: This bit enables the trace port clock, TRACECLK.
Page 3132: 0: Normal operation - all clocks are disabled and the domain powered down automatically in
Page 3132: 1: Automatic clock stop/power-down disabled - all active clocks and oscillators continue to
Page 3133: 0: Normal operation - domain clocks are disabled automatically in Stop mode(2)
Page 3133: 1: Automatic clock stop/power-down disabled - all active clocks and oscillators continue to
Page 3133: run during Stop mode. On exit from Stop mode, the clock settings is set to the Stop mode exit
Page 3133: 0: Normal operation - all clocks is disabled and the domain powered down automatically in
Page 3133: 1: Automatic clock stop/power-down disabled - all active clocks and oscillators continue to
Page 3133: 0: Normal operation - all clocks are disabled automatically in Stop mode
Page 3133: 1: Automatic clock stop disabled - all active clocks and oscillators continue to run during Stop
Page 3133: mode, allowing full debug capability. On exit from Stop mode, the clock settings is set to the
Page 3133: 0: Normal operation - processor clock is stopped automatically in Sleep mode
Page 3133: 1: Automatic clock stop disabled - processor clock continues to run, allowing full debug
Page 3133: DAPCLK active in Standby mode, even if DBGSTBY_D3 is reset. However the remaining D3 domain clocks
Page 3133: DAPCLK active in Stop mode, even if DBGSTOP_D3 is reset. However the remaining D3 domain clocks will
Page 3151: •     clock cycle counter comparator (comparator 0 only)
Page 3151: •     clock cycles
Page 3154: Bits 31:0 CYCCNT[31:0]: Processor clock cycle counter
Page 3165: The ITM contains a 21-bit counter clocked by the (pre-divided) processor clock. The
Page 3167: clock frequency, or disables generation of global timestamps. The possible values are:
Page 3167: Prescale used with the trace packet reference clock The possible values are:
Page 3167: Bit 4 SWOENA: Asynchronous clocking enable for the timestamp counter (read-only)
Page 3167: 0: Timestamp counter uses processor clock
Page 3215: SYSCFG clock should be enabled first in the RCC_APB4ENR register.
Page 3216: Section 8: Reset and Clock Control (RCC)
Page 3216: Names of all clock source selection bits changed from XXSCR to
Page 3216: Updated peripheral kernel clock names in the whole document.
Page 3216: clock distribution overview.
Page 3216: Removed lsi_ck as USBxOTG clock in Section : Peripherals
Page 3217: Section 8: Reset and Clock Control (RCC) (continued)
Page 3217: (RCC_APB1LRSTR), Section 8.7.43: RCC APB1 Clock Register
Page 3217: Clock Register (RCC_APB1LLPENR).
Page 3218: Added Section 23.3.8: QUADSPI Free running clock mode as well
Page 3218: Updated notes in Section : Dual clock domain architecture.
Page 3219: APB1 clock and LSI clock replaced by dac_pclk and by lsi_ck in the
Page 3220: Updated Section 32.3.4: LTDC reset and clocks.
Page 3221: Section 46: Real-time clock (RTC)
Page 3221: in Figure 574: USART data clock timing diagram in synchronous
Page 3221: master mode (M bits =’00’) and Figure 575: USART data clock
Page 3223: Section 8: Reset and Clock Control (RCC)
Page 3223: clock distribution overview.
Page 3225: the block diagram independent from the number of data and clock
Page 3226: Section 7: Reset and Clock Control (RCC)
Page 3226: Updated maximum allowed clock frequency for ADC1, 2, 3
Page 3226: Table 55: Kernel clock distribution overview.
Page 3226: Updated Figure 52: Kernel clock distribution for USB (2).
Page 3229: Added fADC_ker_ck in Figure 132: ADC clock scheme.
Page 3229: FHCLK replaced by Fadc_hclk in Section : Clock ratio constraint
Page 3229: between ADC clock and AHB clock.
Page 3230: Updated Section 29.4.3: DFSDM reset and clocks and
Page 3230: Updated procedure in Section : External clock source mode 1,
Page 3231: receiver to clock deviation.
Page 3232: Updated Section : Clock generator programming in SPDIF
